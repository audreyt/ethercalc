{"version":3,"sources":["node_modules/socialcalc/SocialCalc.js","third-party/class-js/lib/Class.js","third-party/wikiwyg/lib/Document/Emitter.js","third-party/wikiwyg/lib/Document/Emitter/HTML.js","third-party/wikiwyg/lib/Document/Parser.js","third-party/wikiwyg/lib/Document/Parser/Wikitext.js","static/jquery.js","static/vex.combined.min.js","static/jquery-ui.min.js"],"names":["root","factory","define","amd","bind","this","module","exports","call","SocialCalc","window","Constants","cellDataType","v","n","t","f","c","textdatadefaulttype","s_BrowserNotSupported","s_InternalError","s_pssUnknownColType","s_pssUnknownRowType","s_pssUnknownLineType","s_cfspUnknownCellType","doCanonicalizeSheet","s_escUnknownSheetCmd","s_escUnknownSetCoordCmd","s_escUnknownCmd","s_caccCircRef","defaultRowNameWidth","defaultAssumedRowHeight","defaultCellIDPrefix","defaultCellLayout","defaultCellFontStyle","defaultCellFontSize","defaultCellFontFamily","defaultPaneDividerWidth","defaultPaneDividerHeight","defaultGridCSS","defaultCommentClass","defaultCommentStyle","defaultCommentNoGridClass","defaultCommentNoGridStyle","defaultReadonlyClass","defaultReadonlyStyle","defaultReadonlyNoGridClass","defaultReadonlyNoGridStyle","defaultReadonlyComment","defaultColWidth","defaultMinimumColWidth","defaultHighlightTypeCursorClass","defaultHighlightTypeCursorStyle","defaultHighlightTypeRangeClass","defaultHighlightTypeRangeStyle","defaultColnameClass","defaultColnameStyle","defaultSelectedColnameClass","defaultSelectedColnameStyle","defaultRownameClass","defaultRownameStyle","defaultSelectedRownameClass","defaultSelectedRownameStyle","defaultUpperLeftClass","defaultUpperLeftStyle","defaultSkippedCellClass","defaultSkippedCellStyle","defaultPaneDividerClass","defaultPaneDividerStyle","defaultUnhideLeftClass","defaultUnhideLeftStyle","defaultUnhideRightClass","defaultUnhideRightStyle","defaultUnhideTopClass","defaultUnhideTopStyle","defaultUnhideBottomClass","defaultUnhideBottomStyle","defaultColResizeBarClass","defaultRowResizeBarClass","s_rcMissingSheet","defaultLinkFormatString","defaultPageLinkFormatString","defaultFormatp","defaultFormatc","defaultFormatdt","defaultFormatd","defaultFormatt","defaultDisplayTRUE","defaultDisplayFALSE","defaultImagePrefix","defaultTableEditorIDPrefix","defaultPageUpDnAmount","AllowCtrlS","defaultTableControlThickness","cteGriddivClass","s_statusline_executing","s_statusline_displaying","s_statusline_ordering","s_statusline_calculating","s_statusline_calculatingls","s_statusline_doingserverfunc","s_statusline_incell","s_statusline_calcstart","s_statusline_sum","s_statusline_recalcneeded","s_statusline_circref","s_statusline_sendemail","s_inputboxdisplaymultilinetext","defaultInputEchoClass","defaultInputEchoStyle","defaultInputEchoPromptClass","defaultInputEchoPromptStyle","defaultInputEchoHintClass","defaultInputEchoHintStyle","ietUnknownFunction","CH_radius1","CH_radius2","s_CHfillAllTooltip","s_CHfillContentsTooltip","s_CHmovePasteAllTooltip","s_CHmovePasteContentsTooltip","s_CHmoveInsertAllTooltip","s_CHmoveInsertContentsTooltip","s_CHindicatorOperationLookup","Fill","FillC","Move","MoveI","MoveC","MoveIC","s_CHindicatorDirectionLookup","Down","Right","Horizontal","Vertical","defaultTCSliderThickness","defaultTCButtonThickness","defaultTCThumbThickness","TCmainStyle","TCmainClass","TCendcapStyle","TCendcapClass","TCpanesliderClass","s_panesliderTooltiph","s_panesliderTooltipv","TClessbuttonStyle","TClessbuttonClass","TClessbuttonRepeatWait","TClessbuttonRepeatInterval","TCmorebuttonStyle","TCmorebuttonClass","TCmorebuttonRepeatWait","TCmorebuttonRepeatInterval","TCscrollareaStyle","TCscrollareaClass","TCscrollareaRepeatWait","TCscrollareaRepeatInterval","TCthumbClass","TCthumbStyle","TCPStrackinglineClass","TCPStrackinglineStyle","TCPStrackinglineThickness","TCTDFSthumbstatusvClass","TCTDFSthumbstatusvStyle","TCTDFSthumbstatushClass","TCTDFSthumbstatushStyle","TCTDFSthumbstatusrownumClass","TCTDFSthumbstatusrownumStyle","TCTDFStopOffsetv","TCTDFSleftOffsetv","s_TCTDFthumbstatusPrefixv","TCTDFStopOffseth","TCTDFSleftOffseth","s_TCTDFthumbstatusPrefixh","TooltipOffsetX","TooltipOffsetY","TDpopupElementClass","TDpopupElementStyle","SCToolbarbackground","SCTabbackground","SCTabselectedCSS","SCTabplainCSS","SCToolbartext","SCFormulabarheight","SCStatuslineheight","SCStatuslineCSS","SCFormatNumberFormats","SCFormatTextFormats","SCFormatPadsizes","SCFormatFontsizes","SCFormatFontfamilies","SCFormatFontlook","SCFormatTextAlignhoriz","SCFormatNumberAlignhoriz","SCFormatAlignVertical","SCFormatColwidth","SCFormatRecalc","SCFormatUserMaxCol","SCFormatUserMaxRow","ISCButtonNormalBackground","ISCButtonBorderNormal","ISCButtonBorderHover","ISCButtonBorderDown","ISCButtonDownBackground","s_PopupListCancel","s_PopupListCustom","s_loc_align_center","s_loc_align_left","s_loc_align_right","s_loc_alignment","s_loc_audit","s_loc_audit_trail_this_session","s_loc_auto","s_loc_auto_sum","s_loc_auto_wX_commas","s_loc_automatic","s_loc_background","s_loc_bold","s_loc_bold_XampX_italics","s_loc_bold_italic","s_loc_borders","s_loc_borders_off","s_loc_borders_on","s_loc_bottom","s_loc_bottom_border","s_loc_cell_settings","s_loc_csv_format","s_loc_cancel","s_loc_category","s_loc_center","s_loc_clear","s_loc_clear_socialcalc_clipboard","s_loc_clipboard","s_loc_color","s_loc_column_","s_loc_comment","s_loc_copy","s_loc_custom","s_loc_cut","s_loc_default","s_loc_default_alignment","s_loc_default_column_width","s_loc_default_font","s_loc_default_format","s_loc_default_padding","s_loc_delete","s_loc_delete_column","s_loc_delete_contents","s_loc_delete_row","s_loc_description","s_loc_display_clipboard_in","s_loc_down","s_loc_edit","s_loc_existing_names","s_loc_family","s_loc_fill_down","s_loc_fill_right","s_loc_font","s_loc_format","s_loc_formula","s_loc_function_list","s_loc_functions","s_loc_grid","s_loc_hidden","s_loc_hide_column","s_loc_hide_row","s_loc_horizontal","s_loc_insert_column","s_loc_insert_row","s_loc_italic","s_loc_last_sort","s_loc_left","s_loc_left_border","s_loc_link","s_loc_link_input_box","s_loc_list","s_loc_load_socialcalc_clipboard_with_this","s_loc_lock_cell","s_loc_major_sort","s_loc_manual","s_loc_merge_cells","s_loc_middle","s_loc_minor_sort","s_loc_move_insert","s_loc_move_paste","s_loc_multiXline_input_box","s_loc_name","s_loc_names","s_loc_no_padding","s_loc_normal","s_loc_number","s_loc_number_horizontal","s_loc_ok","s_loc_padding","s_loc_page_name","s_loc_paste","s_loc_paste_formats","s_loc_plain_text","s_loc_recalc","s_loc_recalculation","s_loc_redo","s_loc_right","s_loc_right_border","s_loc_sheet_settings","s_loc_save","s_loc_save_to","s_loc_set_cell_contents","s_loc_set_cells_to_sort","s_loc_set_value_to","s_loc_set_to_link_format","s_loc_setXclear_move_from","s_loc_show_cell_settings","s_loc_show_sheet_settings","s_loc_show_in_new_browser_window","s_loc_size","s_loc_socialcalcXsave_format","s_loc_sort","s_loc_sort_","s_loc_sort_cells","s_loc_swap_colors","s_loc_tabXdelimited_format","s_loc_text","s_loc_text_horizontal","s_loc_this_is_aXbrXsample","s_loc_top","s_loc_top_border","s_loc_undone_steps","s_loc_url","s_loc_undo","s_loc_unlock_cell","s_loc_unmerge_cells","s_loc_up","s_loc_value","s_loc_vertical","s_loc_wikitext","s_loc_workspace","s_loc_XnewX","s_loc_XnoneX","s_loc_Xselect_rangeX","SVStatuslineheight","SVStatuslineCSS","FormatNumber_separatorchar","FormatNumber_decimalchar","FormatNumber_defaultCurrency","s_FormatNumber_daynames","s_FormatNumber_daynames3","s_FormatNumber_monthnames","s_FormatNumber_monthnames3","s_FormatNumber_am","s_FormatNumber_am1","s_FormatNumber_pm","s_FormatNumber_pm1","s_parseerrexponent","s_parseerrchar","s_parseerrstring","s_parseerrspecialvalue","s_parseerrtwoops","s_parseerrmissingopenparen","s_parseerrcloseparennoopen","s_parseerrmissingcloseparen","s_parseerrmissingoperand","s_parseerrerrorinformula","s_calcerrerrorvalueinformula","s_parseerrerrorinformulabadval","s_formularangeresult","s_calcerrnumericnan","s_calcerrnumericoverflow","s_sheetunavailable","s_calcerrcellrefmissing","s_calcerrsheetnamemissing","s_circularnameref","s_calcerrunknownname","s_calcerrincorrectargstofunction","s_sheetfuncunknownfunction","s_sheetfunclnarg","s_sheetfunclog10arg","s_sheetfunclogsecondarg","s_sheetfunclogfirstarg","s_sheetfuncroundsecondarg","s_sheetfuncddblife","s_sheetfuncslnlife","s_fdef_ABS","s_fdef_ACOS","s_fdef_AND","s_fdef_ASIN","s_fdef_ATAN","s_fdef_ATAN2","s_fdef_AVERAGE","s_fdef_CHOOSE","s_fdef_COLUMNS","s_fdef_COS","s_fdef_CONCAT","s_fdef_CONCATENATE","s_fdef_COUNT","s_fdef_COUNTA","s_fdef_COUNTBLANK","s_fdef_COUNTIF","s_fdef_DATE","s_fdef_DAVERAGE","s_fdef_DAY","s_fdef_DCOUNT","s_fdef_DCOUNTA","s_fdef_DDB","s_fdef_DEGREES","s_fdef_DGET","s_fdef_DMAX","s_fdef_DMIN","s_fdef_DPRODUCT","s_fdef_DSTDEV","s_fdef_DSTDEVP","s_fdef_DSUM","s_fdef_DVAR","s_fdef_DVARP","s_fdef_EVEN","s_fdef_EXACT","s_fdef_EXP","s_fdef_FACT","s_fdef_FALSE","s_fdef_FIND","s_fdef_FV","s_fdef_HLOOKUP","s_fdef_HOUR","s_fdef_IF","s_fdef_INDEX","s_fdef_INT","s_fdef_IRR","s_fdef_ISBLANK","s_fdef_ISERR","s_fdef_ISERROR","s_fdef_ISLOGICAL","s_fdef_ISNA","s_fdef_ISNONTEXT","s_fdef_ISNUMBER","s_fdef_ISTEXT","s_fdef_LEFT","s_fdef_LEN","s_fdef_LN","s_fdef_LOG","s_fdef_LOG10","s_fdef_LOWER","s_fdef_MATCH","s_fdef_MAX","s_fdef_MID","s_fdef_MIN","s_fdef_MINUTE","s_fdef_MOD","s_fdef_MONTH","s_fdef_N","s_fdef_NA","s_fdef_NOT","s_fdef_NOW","s_fdef_NPER","s_fdef_NPV","s_fdef_ODD","s_fdef_OR","s_fdef_PI","s_fdef_PMT","s_fdef_POWER","s_fdef_PRODUCT","s_fdef_PROPER","s_fdef_PV","s_fdef_RADIANS","s_fdef_RATE","s_fdef_REPLACE","s_fdef_REPT","s_fdef_RIGHT","s_fdef_ROUND","s_fdef_ROWS","s_fdef_SECOND","s_fdef_SIN","s_fdef_SLN","s_fdef_SQRT","s_fdef_STDEV","s_fdef_STDEVP","s_fdef_SUBSTITUTE","s_fdef_SUM","s_fdef_SUMIF","s_fdef_SYD","s_fdef_T","s_fdef_TAN","s_fdef_TIME","s_fdef_TODAY","s_fdef_TRIM","s_fdef_TRUE","s_fdef_TRUNC","s_fdef_UPPER","s_fdef_VALUE","s_fdef_VAR","s_fdef_VARP","s_fdef_VLOOKUP","s_fdef_WEEKDAY","s_fdef_YEAR","s_fdef_SUMPRODUCT","s_fdef_CEILING","s_fdef_FLOOR","s_farg_v","s_farg_vn","s_farg_xy","s_farg_choose","s_farg_range","s_farg_rangec","s_farg_date","s_farg_dfunc","s_farg_ddb","s_farg_find","s_farg_fv","s_farg_hlookup","s_farg_iffunc","s_farg_index","s_farg_irr","s_farg_tc","s_farg_log","s_farg_match","s_farg_mid","s_farg_nper","s_farg_npv","s_farg_pmt","s_farg_pv","s_farg_rate","s_farg_replace","s_farg_vp","s_farg_valpre","s_farg_csl","s_farg_cslp","s_farg_subs","s_farg_sumif","s_farg_hms","s_farg_txt","s_farg_vlookup","s_farg_weekday","s_farg_dt","s_farg_rangen","s_farg_vsig","function_classlist","s_fclass_all","s_fclass_stat","s_fclass_lookup","s_fclass_datetime","s_fclass_financial","s_fclass_test","s_fclass_math","s_fclass_text","s_fclass_action","s_fclass_gui","lastone","ConstantsDefaultClasses","defaultComment","defaultCommentNoGrid","defaultHighlightTypeCursor","defaultHighlightTypeRange","defaultColname","defaultSelectedColname","defaultRowname","defaultSelectedRowname","defaultUpperLeft","defaultSkippedCell","defaultPaneDivider","cteGriddiv","defaultInputEcho","classname","style","TCmain","TCendcap","TCpaneslider","TClessbutton","TCmorebutton","TCscrollarea","TCthumb","TCPStrackingline","TCTDFSthumbstatus","TDpopupElement","ConstantsSetClasses","prefix","item","defaults","scc","undefined","ConstantsSetImagePrefix","imagePrefix","replace","Callbacks","expand_wiki","expand_markup","displayvalue","sheetobj","linkstyle","default_expand_markup","MakePageLink","NormalizeSheetName","Cell","coord","datavalue","datatype","formula","valuetype","readonly","CellProperties","errors","comment","bt","br","bb","bl","layout","font","color","bgcolor","cellformat","nontextvalueformat","textvalueformat","colspan","rowspan","cssc","csss","mod","displaystring","parseinfo","hcolspan","hrowspan","CellPropertiesTable","Sheet","ResetSheet","statuscallback","statuscallbackparams","sheet","cells","attribs","lastcol","lastrow","defaultlayout","usermaxcol","usermaxrow","rowattribs","hide","height","colattribs","width","names","layouts","layouthash","fonts","fonthash","colors","colorhash","borderstyles","borderstylehash","cellformats","cellformathash","valueformats","valueformathash","matched_cells","selected_search_cell","copiedfrom","changes","UndoStack","renderneeded","changedrendervalues","recalcchangedavalue","hiddencolrow","sci","SheetCommandInfo","ioEventTree","ioParameterList","prototype","AddCell","newcell","LastCol","last_col","cell_id","cr","coordToCr","col","LastRow","last_row","row","GetAssuredCell","ParseSheetSave","savedsheet","CellFromStringParts","cell","parts","j","CreateSheetSave","range","canonicalize","CellToString","CanonicalizeSheet","full","EncodeCellAttributes","EncodeSheetAttributes","DecodeCellAttributes","DecodeSheetAttributes","ScheduleSheetCommands","cmd","saveundo","SheetUndo","SheetRedo","CreateAuditString","GetStyleNum","atype","GetStyleString","num","RecalcSheet","line","i","name","lines","split","length","defaultcolwidth","defaultrowheight","defaulttextformat","defaultnontextformat","defaultfont","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","circularreferencecell","recalc","needsrecalc","decodeFromSave","toUpperCase","desc","definition","match","alert","charAt","ro","toLowerCase","sheetfields","sheetfieldsshort","sheetfieldsxlat","sheetfieldsxlatshort","sheetfieldsxlatxlt","cr1","cr2","value","prange","result","xlt","ParseRange","maxrow","maxcol","push","crToCoord","rcColname","encodeForSave","newborderstyles","newcellformats","newcolors","newfonts","newlayouts","newvalueformats","namesorder","join","r","b","l","borderstylesxlat","layoutsxlat","fontsxlat","colorsxlat","cellformatsxlat","valueformatsxlat","filled","an","a","newa","newxlat","used","ahash","alist","sort","Array","colorsUsed","borderstylesUsed","fontsUsed","layoutsUsed","cellformatsUsed","valueformatsUsed","unshift","InitAttrib","def","val","InitAttribs","namelist","SetAttrib","SetAttribStar","rowheight","newattribs","changed","CheckChanges","attribname","oldval","cmdname","DoCmd","cmdstr","str","alignvert","padtop","padright","padbottom","padleft","fontlook","fontsize","fontfamily","timerobj","firsttimerdelay","timerdelay","maxtimeslice","CmdExtensionCallbacks","parseobj","Parse","PushChange","setTimeout","SheetCommandsTimerRoutine","errortext","starttime","Date","EOF","ExecuteSheetCommand","console","log","NextLine","increment_amount","down","valid_datatype","type","editor","GetSpreadsheetControlObject","range2","returnval","hasrange","startcell","endcell","bottom","top","left","right","Range2Remove","cmd1","rest","what","attrib","pos","pos2","undostart","fillright","rowstart","colstart","crbase","rowoffset","coloffset","basecell","clipsheet","cliprange","numcols","numrows","attribtable","colend","rowend","newcolstart","newrowstart","newcolend","newrowend","rownext","colnext","colthis","rowbefore","colbefore","oldformula","oldcr","cols","dirs","lastsortcol","sortlist","sortcells","sortvalues","sorttypes","sortfunction","valtype","originalrow","sortedcr","v1","v2","cmdextension","undoNum","trackLine","cellProperties","cellChanged","RestOfStringNoMove","AddDo","NextToken","RestOfString","AddUndo","test","indexOf","substring","celldisplayneeded","_app","prevvaluetype","Clipboard","clipboard","inc","OffsetFormulaCoords","Math","max","sourceColname","colWidth","colHide","sourceRow","rowHide","slast","a1","b1","ta","cresult","tb","widgetsClean","AdjustFormulaCoords","tempRenderContext","RenderContext","CalculateCellSkipData","cellsToExpand","skipCell","cellskip","skipCellCR","mergerCellCoords","cellsToShrink","mergerCellCR","coordToCR","movingcells","dest","destcr","inserthoriz","insertvert","pushamount","movedto","ReplaceFormulaCoords","recalconce","parseInt","context","rowpanes","first","timeout","SetRowPaneFirstLast","griddiv","document","getElementById","removeChild","FitToEditTable","colpanes","SetColPaneFirstLast","func","data","tos","TOS","undo","Undo","didredo","Redo","command","stack","ttext","ttype","newcr","updatedformula","scf","Formula","tokentype","TokenType","token_op","op","token_string","string","token_coord","tokenOpExpansion","TokenOpExpansion","ParseFormulaIntoTokens","text","sheetref","RecalcInfo","currentState","state","idle","start_calc","order","calc","start_wait","done_wait","recalctimer","timeslicedelay","queue","LoadSheet","RecalcData","inrecalc","celllist","celllistitem","calclist","calclistlength","firstcalc","lastcalc","nextcalc","count","checkinfo","RecalcCheckInfo","oldcoord","parsepos","inrange","inrangestart","c1","c2","r1","r2","scri","FreshnessInfoReset","RecalcClearTimeout","RecalcSetTimeout","RecalcTimerRoutine","clearTimeout","RecalcLoadedSheet","sheetname","recalcneeded","live","AddSheetToCache","SheetCache","waitingForLoading","previousrecalcsheet","eresult","err","status","recalcdata","do_statuscallback","arg","RecalcCheckCell","total","evaluate_parsed_formula","firstRenderScheduled","ScheduleRender","RemoteFunctionInfo","waitingForServer","funcname","error","reRenderCellList","FreshnessInfo","recalc_completed","shift","startcoord","rangecoord","coordvals","token_name","mainloop","LookupName","delimiter","lineEnd","pos1","oldpos","maxRedo","maxUndo","pop","args","arguments","hideRowsCols","showGrid","showRCHeaders","rownamewidth","pixelsPerRow","colwidth","totalwidth","totalheight","colunhideleft","colunhideright","rowunhidetop","rowunhidebottom","highlights","cursorsuffix","highlightTypes","cursor","className","cursorinsertup","cursorinsertleft","cellIDprefix","defaultlinkstyle","defaultHTMLlinkstyle","defaultfontstyle","defaultfontsize","defaultfontfamily","defaultpanedividerwidth","defaultpanedividerheight","gridCSS","commentClassName","commentCSS","commentNoGridClassName","commentNoGridCSS","readonlyClassName","readonlyCSS","readonlyNoGridClassName","readonlyNoGridCSS","readonlyComment","classnames","colname","rowname","selectedcolname","selectedrowname","upperleft","skippedcell","panedivider","unhideleft","unhideright","unhidetop","unhidebottom","colresizebar","rowresizebar","explicitStyles","needcellskip","needprecompute","last","PrecomputeSheetFontsAndLayouts","CalculateColWidthData","CalculateRowHeightData","panenum","CoordInPane","rowpane","colpane","CellInPane","InitializeTable","tableobj","RenderSheet","oldtable","RenderColGroup","RenderColHeaders","RenderSizingRow","RenderRow","rownum","RenderSpacingRow","RenderCell","colnum","noElement","layoutre","dparts","sparts","s","weight","size","family","skiprow","skipcol","skipcoord","borderCollapse","cellSpacing","cellPadding","newrow","colgroupobj","tbodyobj","parentnode","createElement","appendChild","parentNode","replaceChild","newcol","newdiv","cssText","verticalAlign","innerHTML","container","position","unhide","fixPosition","resizeBar","overflow","w","span","sheetattribs","stylestr","CreatePseudoElement","id","colSpan","rowSpan","FormatValueForDisplay","title","classList","add","setStyles","panerowlimits","panecollimits","collow","colhigh","floor","String","fromCharCode","letters","coordToCol","coordToRow","ch","charCodeAt","decodeFromAjax","special_chars","Lookup","list","element","part","GetViewportInfo","innerWidth","innerHeight","horizontalScroll","pageXOffset","verticalScroll","pageYOffset","documentElement","clientWidth","clientHeight","scrollLeft","scrollTop","body","GetElementPosition","offsetLeft","offsetTop","GetComputedStyle","offsetParent","GetElementPositionWithScroll","rect","getBoundingClientRect","GetElementFixedParent","tagName","computedStyle","currentStyle","defaultView","getComputedStyle","LookupElement","array","AssignID","obj","idPrefix","GetCellContents","cellobj","valueformat","valuesubtype","valueinputwidget","formula_name","html_display_value","html_formated_value","format_text_for_display","format_number_for_display","parameters","formula_details","FunctionList","cell_html","checkedValue","parameterValue","index","paramRegExp","RegExp","html","htmlIndex","css","rawvalue","dvsc","dvue","textval","encodeURI","expand_text_link","u","FormatNumber","formatNumberWithFormat","DetermineValueType","tvalue","matches","year","hour","minute","second","denom","intgr","constr","isNaN","slice","navigator","convert_date_gregorian_to_julian","InputConstants","TRUE","FALSE","#N/A","#NULL!","#NUM!","#DIV/0!","#VALUE!","#REF!","#NAME?","url","ParseCellLinkText","pagename","newwin","workspacename","workspace","pageform","urlend","descstart","lastlt","lastIndexOf","lastbrkt","lastbrace","descend","wsend","ConvertSaveToOtherFormat","savestr","outputformat","dorecalc","clipextents","div","ele","ConvertOtherFormatToSave","inputstr","inputformat","inquote","maxc","SetConvertedCell","TableEditor","toplevel","fullgrid","noEdit","tablewidth","tableheight","inputBox","inputEcho","verticaltablecontrol","horizontaltablecontrol","logo","cellhandles","busy","ensureecell","deferredCommands","deferredEmailCommands","gridposition","headposition","firstscrollingrow","firstscrollingrowtop","lastnonscrollingrow","lastvisiblerow","firstscrollingcol","firstscrollingcolleft","lastnonscrollingcol","lastvisiblecol","rowpositions","colpositions","ecell","workingvalues","imageprefix","pageUpDnAmount","recalcFunction","EditorSheetStatusCallback","ctrlkeyFunction","charname","sel","cliptext","pasteTextarea","GetEditorCellElement","ECellReadonly","EditorScheduleSheetCommands","display","focus","select","blur","KeyboardFocus","pastescclipboard","clipstr","ntvf","newntvf","prompt","CtrlSEditor","StatusCallback","MoveECellCallback","RangeChangeCallback","SettingsCallbacks","CreateTableEditor","ResizeTableEditor","SaveEditorSettings","LoadEditorSettings","flags","EditorRenderSheet","ignorebusy","EditorStepSet","GetStatuslineString","params","EditorGetStatuslineString","EditorMouseRegister","EditorMouseUnregister","EditorMouseRange","EditorProcessKey","e","EditorAddToInput","DisplayCellContents","EditorDisplayCellContents","EditorSaveEdit","EditorApplySetCommandsToRange","cmdline","MoveECellWithKey","MoveECell","ReplaceCell","UpdateCellCSS","SetECellHeaders","selected","EnsureECellVisible","RangeAnchor","RangeExtend","RangeRemove","CalculateEditorPositions","renderwidgets","DoRenderStep","SchedulePositionCalculations","DoPositionCalculations","CalculateRowPositions","positions","sizes","CalculateColPositions","ScrollRelative","vertical","amount","ScrollRelativeBoth","vamount","hamount","PageRelative","direction","LimitLastPanes","ScrollTableUpOneRow","ScrollTableDownOneRow","ScrollTableLeftOneCol","ScrollTableRightOneCol","StopPropagation","SetMouseMoveUp","RemoveMouseMoveUp","TableControl","CreateTableControl","main","table","tbody","tr","td","layouttable","background","TooltipRegister","firstChild","InputEcho","CellHandles","userAgent","removeEventListener","SafariPasteFunction","addEventListener","MouseWheelRegister","WheelMove","EditorProcessMouseWheel","KeyboardSetFocus","preventDefault","setting","anchorcoord","save","anchorrow","anchorcol","load","cmdTokens","TriggerIoAction","Email","dcmd","signalstatus","emailcmd","sstr","progress","circ","sum","emailing","emailreponse","calculating","EditorMouseInfo","registeredElements","ignore","mousedowncoord","mouselastcoord","mouseresizecol","mouseresizeclientx","mouseresizedisplay","mouseinfo","ProcessEditorMouseDown","ProcessEditorDblClick","attachEvent","oldelement","detachEvent","splice","event","stopPropagation","cancelBubble","returnValue","move","up","setCapture","releaseCapture","target","srcElement","nodeType","mobj","clientX","clientY","GridMousePosition","rowheader","rowselect","ProcessEditorRowselectMouseDown","ProcessEditorRowsizeMouseDown","colheader","colselect","ProcessEditorColselectMouseDown","ProcessEditorColsizeMouseDown","shiftKey","CmdGotFocus","clickedCell","widget_id","cell_widget","ProcessEditorMouseMove","ProcessEditorMouseUp","inputtext","wval","GetText","partialexpr","SetText","Blur","ShowInputBox","ShowCellHandles","SetDragAutoRepeat","mouseresizecolnum","coltoresize","mousedownclientx","mousecoltounhide","coltounhide","sizedisplay","zIndex","lastChild","childNodes","ProcessEditorColsizeMouseMove","ProcessEditorColsizeMouseUp","newsize","FinishColRowSize","coord1","coord2","coord3","ProcessEditorRowselectMouseMove","ProcessEditorRowselectMouseUp","ProcessEditorColselectMouseMove","ProcessEditorColselectMouseUp","spreadsheetDiv","offsetHeight","mouseresizerownum","rowtoresize","mouseresizerow","mousedownclienty","mouserowtounhide","rowtounhide","ProcessEditorRowsizeMouseMove","ProcessEditorRowsizeMouseUp","AutoRepeatInfo","timer","repeatinterval","repeatcallback","callback","repeatinfo","rowfooter","colfooter","distance","DragAutoRepeat","EditorOpenCellEdit","disabled","Focus","Select","ecoord","erow","ecol","substr","skipOne","valueinfo","fch","oldvalue","EditedTriggerCell","actionFormulaCells","editedCellRef","actionCellId","function_name","delta","mousewheelinfo","wobj","functionobj","ceil","offsetWidth","controlborder","headerColOffset","headerRowOffset","rowindex","colindex","shifted","min","newelement","headercell","totalrows","needed","firstRow","lastRow","ComputeTableControlPositions","ignoreRender","PositionTableControlElements","toprow","offset","trowobj","leftcol","cellposition","dv","dh","vplen","vlimit","hplen","hlimit","newfirst","totalsize","current","panes","lastpane","lastvisible","sizearray","defaultsize","plen","oldrownum","newbottomrow","oldchild","bottomrownum","rowneedsrefresh","maxrowspan","newrownum","insertBefore","InputBox","onmousedown","InputBoxOnMouseDown","formulabar","InputBoxDisplayCellContents","show","ShowInputEcho","newtext","InputBoxFocus","selection","createRange","duplicate","moveToElementText","collapse","selectionStart","selectionEnd","inputbox","Keyboard","focusTable","interval","hint","functionbox","DragRegister","MouseDown","DragFunctionStart","MouseMove","DragFunctionPosition","MouseUp","Disabled","positionobj","SetInputEchoText","inputecho","clearInterval","setInterval","InputEchoHeartbeat","fname","fstr","newstr","FillFunctionInfo","FunctionArgString","InputEchoMouseDown","noCursorSuffix","movedmouse","draghandle","imagetype","dragpalette","dragtooltip","fillinghandle","CellHandlesMouseMoveOnHandle","CellHandlesMouseDown","moveshow","doshow","colinc","rowinc","mouseDown","whichhandle","SegmentDivHit","CellHandlesHoverTimeout","tooltipstimer","tooltipswhichhandle","CellHandlesTooltipsTimeout","segtable","divWithMouseHit","x","y","len","sqrt","pow","quadrant","dragtype","filltype","startingcoord","startingX","startingY","CellHandlesMouseMove","CellHandlesMouseUp","crstart","crend","CellHandlesDragAutoRepeat","abs","newcoord","vscroll","hscroll","cstr","cmdtype","cmdtype2","sizec","sizer","deltac","deltar","endcap","paneslider","lessbutton","morebutton","scrollarea","thumb","endcapstart","panesliderstart","lessbuttonstart","morebuttonstart","scrollareastart","scrollareaend","scrollareasize","thumbpos","controlthickness","sliderthickness","buttonthickness","thumbthickness","minscrollingpanesize","control","functions","etype","vh","backgroundImage","TCPSDragFunctionStart","TCPSDragFunctionMove","TCPSDragFunctionStop","repeatwait","normalstyle","downstyle","hoverstyle","Repeat","ButtonRegister","ScrollAreaClick","TCTDragFunctionStart","TCTDragFunctionMove","TCTDragFunctionStop","buttoninfo","bobj","clickpos","border","realend","draginfo","dobj","trackingline","offsetY","offsetX","thumbstatus","rowmsgele","rowpreviewele","thumbcontext","pane","TCTDragFunctionRowSetStatus","msg","thumbrowshown","DragInfo","draggingElement","startX","startY","startZ","relativeOffset","horizontal","parent","DragMouseDown","DragUnregister","DragMouseMove","DragMouseUp","TooltipInfo","registered","tooltipElement","popupElement","tiptext","tooltipinfo","TooltipMouseMove","tobj","TooltipHide","ButtonInfo","buttonDown","TooltipWaitDone","TooltipMouseDown","TooltipDisplay","offsetx","offsety","viewport","buttonElement","doingHover","paramobj","ButtonMouseDown","ButtonMouseOver","ButtonMouseOut","MouseOver","MouseOut","ButtonMouseUp","ButtonRepeat","MouseWheelInfo","ProcessMouseWheel","passThru","wheelDelta","detail","keyboardTables","specialKeysCommon",8,9,13,25,27,33,34,35,36,37,38,39,40,45,46,113,"specialKeysIE","controlKeysIE",67,83,86,88,90,"specialKeysOpera","controlKeysOpera","specialKeysSafari",63232,63233,63234,63235,63272,63273,63275,63276,63277,63237,"controlKeysSafari",99,115,118,120,122,"ignoreKeysSafari",63236,63238,63239,63240,63241,63242,63243,63244,63245,63246,63247,63289,"specialKeysFirefox","controlKeysFirefox","ignoreKeysFirefox",16,17,18,20,19,44,91,92,112,114,116,117,119,121,123,144,145,224,"areListener","didProcessKey","statusFromProcessKey","repeatingKeyPress","chForProcessKey","onkeydown","ProcessKeyDown","onkeypress","ProcessKeyPress","kt","which","keyCode","ctrlKey","ProcessKey","metaKey","charCode","ft","format_definitions","separatorchar","decimalchar","daynames","daynames3","monthnames3","monthnames","allowedcolors","BLACK","BLUE","CYAN","GREEN","MAGENTA","RED","WHITE","YELLOW","alloweddates","H","M","MM","S","SS","commands","copy","integer_placeholder","fraction_placeholder","decimal","currency","general","separator","date","comparison","section","datevalues","julian_offset","seconds_in_a_day","seconds_in_an_hour","format_string","currency_char","operandstr","fromend","cval","operandstrlc","startval","estartval","hrs","mins","secs","ehrs","emins","esecs","ampmstr","ymd","minOK","thisformat","gotcomparison","compop","compval","cpos","oppos","sectioninfo","decimalscale","scaledvalue","strvalue","strparts","integervalue","fractionvalue","integerdigits2","integerpos","fractionpos","textcolor","textstyle","scfn","isFinite","formatTextWithFormat","negativevalue","zerovalue","FormatNumber_DefaultCurrency","parse_format_string","hascomparison","operators","operands","commas","percent","fractiondigits","integerdigits","hasdate","convert_date_julian_to_gregorian","mspos","sectionstart","thousandssep","factor","LOG10E","day","month","format_defs","lastwasinteger","lastwasslash","lastwasasterisk","lastwasunderscore","quotestr","inbracket","bracketstr","bracketdata","ingeneral","indate","chpos","integerpart","parse_format_bracket","operator","operand","ampstr","juliandate","intFunc","L","N","I","J","K","ParseState","alpha","stringquote","numexp1","numexp2","alphanumeric","specialvalue","space","CharClass","numstart","eof","incoord","quote","specialstart","CharClassTable"," ","!","\"","'","#","$","%","&","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7",":","<","=",">","A","B","C","D","E","F","G","O","P","Q","R","T","U","V","W","X","Y","Z","^","_","d","g","h","k","m","o","p","q","z","UpperCaseTable","SpecialConstants","TokenPrecedence","TypeLookupTable","unaryminus","n*","e*","t*","unaryplus","unarypercent","plus","n%","nd","nt","ndt","n$","nl","concat","th","tw","tl","oneargnumeric","twoargnumeric","propagateerror","cclass","haddecimal","last_token","last_token_type","last_token_text","parsestate","charclass","charclasstable","uppercasetable","pushtoken","ParsePushToken","coordregex","topcode","opcode","allowrangereturn","revpolish","ConvertInfixToPolish","EvaluatePolish","pii","tprecedence","tstackprecedence","token_precedence","parsestack","function_start","debug_log","DebugLog","rii","prii","value1","value2","tostype","tostype2","resulttype","cond","vmatch","smatch","lookup_result_type","LookupResultType","typelookup","operand_as_number","OperandAsNumber","operand_as_text","OperandAsText","operand_value_and_type","OperandValueAndType","operands_as_coord_on_sheet","OperandsAsCoordOnSheet","missingOperandError","PushOperand","parameterInfo","OperandsAsRangeOnSheet","CalculateFunction","type1","type2","table1","TopOfStackValueAndType","stacklen","operandinfo","cellvtype","coordsheet","StepThroughRangeDown","FindInSheetCache","PlainCoord","OperandAsCoord","OperandAsType","OperandAsRange","operandtype","othersheet","OperandAsSheetName","nvalue","isEnd","specialc","startedwalk","checknamecirc","rangevalue","sequence","sheet1","rp","OrderRangeParts","DecodeRangeParts","sheetdata","coordsheetdata","col1num","ncols","row1num","nrows","FunctionClasses","FunctionArgDefs","StoreIoEventFormula","operand_reverse","io_parameters","Clone","reverse","ioTimeTriggerList","radioGroupList","PushTriggerTime","coordA1","sheetData","triggerTimeCellId","currentTriggerTimeList","rangeinfo","cellCoord","ArrayValuesEqual","timeZoneOffsetMins","getTimezoneOffset","start_1_1_1970","triggerUTCTimeList","toString","triggerCellId","PushTriggerCord","cellcr","formDataViewer","CurrentSpreadsheetControlObject","CurrentSpreadsheetViewerObject","loaded","formFields","LoadFormFields","formFieldName","sheetCmd","formFieldsLength","headerCoord","valueCoord","sheetCmdTwo","destination","source","property","A1","A2","fobj","foperand","ffunc","argnum","CopyFunctionArgs","FunctionArgsError","FunctionSpecificError","errortype","CheckForErrorValue","classes","cname","items","nargs","fdata","adef","SeriesFunctions","maxval","minval","mk","sk","mk1","sk1","typelookupplus","resulttypesum","counta","countblank","product","SumProductFunction","products","DSeriesFunctions","dbrange","fieldname","criteriarange","dbinfo","criteriainfo","fieldasnum","targetcol","criteriafieldnums","testok","criteriacr","criteria","testcol","testcr","countmatches","FieldToColnum","criterianum","CRITERIAROW","TestCriteria","fieldtype","LookupFunctions","lookupvalue","rangelookup","offsetvalue","cincr","rincr","previousOK","csave","rsave","IndexFunction","indexinfo","CountifSumifFunctions","sumrange","f2operand","IfFunction","op1","op2","DateFunction","TimeFunction","hours","minutes","seconds","DMYFunctions","dtype","doffset","datevalue","HMSFunctions","fraction","datetime","ExactFunction","v1type","v2type","ArgList","FIND","LEFT","LEN","LOWER","MID","PROPER","REPLACE","REPT","RIGHT","SUBSTITUTE","TRIM","HEXCODE","UPPER","StringFunctions","start","numargs","argdef","operand_value","operand_type","word","fulltext","oldtext","code","next","IsFunctions","NTVFunctions","Math1Functions","acos","asin","atan","cos","PI","exp","sin","tan","Math2Functions","xval","yval","quotient","atan2","LogFunction","RoundFunction","round","CeilingFloorFunctions","sig","AndOrFunctions","NotFunction","ChooseFunction","cindex","ColumnsRowsFunctions","ZeroArgFunctions","tzoffset","nowdays","getTime","volatile","NOW","TODAY","DDBFunction","method","depreciation","accumulateddepreciation","cost","salvage","lifetime","period","SLNFunction","SYDFunction","sumperiods","InterestFunctions","dval","eval","fval","pv","fv","rate","payment","paytype","guess","part1","part2","part3","part4","part5","olddelta","maxloop","tries","oldrate","aval","bval","epsilon","NPVFunction","resulttypenpv","IRRFunction","oldsum","rangeoperand","cashflows","IoFunctions","parameter","repeatIndex","wantedType","argList","BUTTON","IMAGEBUTTON","EMAIL","EMAILIF","EMAILONEDIT","EMAILAT","EMAILONEDITIF","EMAILATIF","SUBMIT","TEXTBOX","AUTOCOMPLETE","SELECT","CHECKBOX","RADIOBUTTON","COPYVALUE","COPYFORMULA","INSERT","DELETEIF","COMMAND","COMMANDIF","PANEL","SPLASH","STYLE","repeatCount","parameterType","validParameterType","getStandardizedList","cssParameter","optionSource","options","optionRegExp","showindices","firstPanelIndex","splashdone","showrows","showcols","parameterIndex","showPanelFound","showIndex","panelCoordData","getStandardizedCoords","spreadsheet","ss","forceRender","lastShowDimension","showGridDimension","lastIndex","sheetHideList","showList","getIndexOf","arrayIndex","sheetHideIndex","getRowIndex","AddAutocomplete","autocompleteSource","ui","autocomplete","filter","term","matcher","escapeRegex","grep","label","minLength","autoFocus","AutoComplete","change","Button","conditionsParameter","parameterdata","getStandardizedValues","sheetCommandList","CopyValueToRange","CopyFormulaToRange","insertCommand","colOffset","rowOffset","insertcellCoord","cellcoord","sourceDataIndex","copyCellRange","deleteCommand","criteriaParameter","testRangeParameter","criteriaValue","celldata","commandsParameter","conditionCell","cellCommand","trim","formulaData","sheetCommand","destCellCoord","cellValueType","cellDataValue","cellFormula","sourceData","emailFormulaCellId","optionalTriggerCellId","parameterValues","parameterCellRefs","maxRangeSize","rangeSizeCounter","conditionIndex","toAddressParamOffset","setStatusBarMessage","emailContentsList","rangeIndex","conditionRangeIndex","toaddressRangeIndex","subjectsRangeIndex","bodyRangeIndex","emailContents","Submit","formDataValues","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","colIndex","SelectList","selectListCellId","getHTMLselectListCellValue","selectListWidget","updateInputWidgetFormula","autoCompleteCellId","getHTMLAutoCompleteCellValue","autoCompleteWidget","TextBox","textBoxCellId","getHTMLTextBoxCellValue","textBoxWidget","CheckBox","checkBoxCellId","getHTMLCheckBoxCellValue","checkBoxWidget","checked","RadioButton","radioButtonGroupName","getHTMLRadioButtonValue","radioButtonWidget","each","attr","widgetCellId","getHTMLWidgetCellValue","inputValue","paramIndex","UpdateFormDataSheet","formCellId","parameterData","getStandardizedParameter","listParameter","listValues","includeCellCoord","includeCellData","constantDatatype","sourcerangeinfo","sourceCoord","sheets","constants","asloaded","recalcing","recalcdone","loadsheet","sfsc","nsheetname","newsheet","sfscc","newsheetname","recalcstate","scffi","scfsc","comparitor","basestring","basevalue","testvalue","search","Popup","Types","Controls","Current","LocalizeString","Create","pt","SetValue","sp","spt","spc","spcdata","changedcallback","SetDisabled","Hide","GetValue","Initialize","Reset","CClick","Show","Close","Cancel","CreatePopupDiv","mainele","backgroundColor","moveable","dragregistered","EnsurePosition","GetLayoutValues","popup","popupele","DestroyPopupDiv","RGBToHex","rgbvals","ToHex","HexDigits","FromHex","HexToRGB","makeRGB","splitRGB","rgb","List","spcid","custom","skip","cancel","MakeCustom","customele","listdiv","contentele","MakeList","ensureWithin","bg","SPLoc","ItemClicked","oele","nele","CustomToList","CustomOK","rowele","ColorChooser","spca","sampleWidth","sampleHeight","img","backgroundImageDefault","backgroundPosition","backgroundImageDisabled","CreateGrid","padding","grid","fontSize","borderRight","backgroundRepeat","marginTop","defaultbox","onclick","DefaultClicked","CustomClicked","CloseOK","GridMouseDown","DetermineColors","SetColors","gridToG","sptc","steps","commonrgb","mousedown","gpos","newrgb","oldrgb","ControlClicked","cid","CustomToGrid","SpreadsheetControl","requestedHeight","requestedWidth","requestedSpaceBelow","viewheight","tabs","tabnums","tabreplacements","currentTab","views","editorDiv","sortrange","moverange","multipartBoundary","toolbarbackground","tabbackground","tabselectedCSS","tabplainCSS","toolbartext","formulabarheight","statuslineheight","statuslineCSS","ExportCallback","statusline","SpreadsheetControlStatuslineCallback","statuslineid","recalcid1","recalcid2","movefrom","formulabuttons","formulafunctions","image","tooltip","DoFunctionList","multilineinput","DoMultiline","link","DoLink","DoSum","findbuttons","SearchUp","SearchDown","edit","oncreate","settings","view","SettingsControls","SettingControlReset","cellattribs","SettingsControlLoadPanel","values","sheetspanel","cellspanel","SpreadsheetControlSettingsSwitch","onclickFocus","viewobj","colorchooser","formatnumber","initialdata","formattext","textalignhoriz","numberalignhoriz","cformatnumber","cformattext","cfontfamily","cfontlook","cfontsize","calignhoriz","calignvert","ctextcolor","cbgcolor","cbt","cbr","cbb","cbl","cpadtop","cpadright","cpadbottom","cpadleft","SettingsControlInitializePanel","replacements","itemtitle","regex","replacement","sectiontitle","parttitle","itembody","bodypart","divStyle","SpreadsheetControlSortOnclick","SpreadsheetControlSortSave","SpreadsheetControlSortLoad","audit","SCLoc","ObjToSource","check","na","SpreadsheetControlCommentOnclick","onunclick","SpreadsheetControlCommentOnunclick","SpreadsheetControlNamesOnclick","SpreadsheetControlNamesOnunclick","SpreadsheetControlClipboardOnclick","InitializeSpreadsheetControl","node","spacebelow","DoOnResize","SizeSSDiv","ExecuteCommand","combostr","SpreadsheetControlExecuteCommand","CreateSheetHTML","SpreadsheetControlCreateSheetHTML","CreateSpreadsheetSave","otherparts","SpreadsheetControlCreateSpreadsheetSave","DecodeSpreadsheetSave","SpreadsheetControlDecodeSpreadsheetSave","CreateCellHTML","SpreadsheetControlCreateCellHTML","CreateCellHTMLSave","SpreadsheetControlCreateCellHTMLSave","child","vname","button","bele","SCLocSS","LocalizeSubstrings","Buttons","button_undo","button_redo","button_copy","button_cut","button_paste","button_pasteformats","button_lock","button_unlock","button_delete","button_filldown","button_fillright","button_movefrom","button_movepaste","button_moveinsert","button_alignleft","button_aligncenter","button_alignright","button_borderon","button_borderoff","button_swapcolors","button_merge","button_insertrow","button_insertcol","button_deleterow","button_deletecol","button_hiderow","button_hidecol","button_recalc","ISCButtonHoverBackground","DoButtonCmd","formulabarDiv","src","skipImagePrefix","marginLeft","input","searchBar","append","formulabardiv","on","FindInSheet","keyup","CalculateSheetNonViewHeight","nonviewheight","appViewDiv","formDataDiv","SpreadsheetViewer","InitializeSpreadsheetViewer","statuslineDiv","paddingTop","paddingBottom","SetSpreadsheetControlObject","nodeIndex","LocalizeStringList","csco","needresize","resized","nodestyle","newval","fudgefactorX","fudgefactorY","marginBottom","marginRight","SetTab","newtab","tname","newtabnum","newview","menutabs","tools","needsresize","onresize","rele1","rele2","UpdateSortRangeProposal","LoadColumnChoosers","nrange","rparts","sele","oldindex","selectedIndex","Option","cl","clele","slist","slistele","rele","lele","SpreadsheetCmdTable","slists","min_col","max_col","min_row","max_row","visibility","SpreadsheetCmdLookup","SpreadsheetCmdSLookup","cut","paste","pasteformats","lock","unlock","delete","filldown","erase","borderon","borderoff","merge","unmerge","align-left","align-center","align-right","align-default","insertrow","insertcol","deleterow","deletecol","hiderow","hidecol","redo","eobj","cellHTML","fcl","idp","GetFunctionNamesStr","GetFunctionInfoStr","vp","FillFunctionNames","scsc","FunctionClassChosen","FunctionChosen","HideFunctions","DoFunctionPaste","mele","HideMultiline","DoMultilineClear","DoMultilinePaste","setformat","HideLink","DoLinkClear","DoLinkPaste","ltsym","gtsym","obsym","cbsym","descele","urlele","pagenameele","workspaceele","formatele","foundvalue","searchstatus","search_cells","cellvalue","SearchSheet","selected_cell","new_cell","textContent","n_options","SpreadsheetControlCommentMoveECell","SpreadsheetControlCommentDisplay","SpreadsheetControlCommentSet","SpreadsheetControlNamesRangeChange","SpreadsheetControlNamesFillNameList","SpreadsheetControlNamesChangedName","currentname","SpreadsheetControlNamesSetValue","SpreadsheetControlNamesSave","SpreadsheetControlNamesDelete","clipele","SpreadsheetControlClipboardFormat","SpreadsheetControlClipboardLoad","savetype","SpreadsheetControlClipboardClear","SpreadsheetControlClipboardExport","sheettable","celltable","sheettoolbar","celltoolbar","SettingsControlSetCurrentPanel","SettingsControlSave","sc","panelobj","CurrentPanel","SettingsControlUnloadPanel","partname","extranl","otherpartsstr","otherpartsnames","mpregex","searchinfo","boundary","boundaryregex","blanklineregex","ending","partlist","exec","pnum","end","PopupChangeCallback","ctrlname","ctrl","str1","str2","cv","fontFamily","paddingRight","paddingLeft","borderTop","borderBottom","borderLeft","BorderSideGetValue","textAlign","fontStyle","fontWeight","PopupListSetValue","PopupListGetValue","ctl","PopupListInitialize","otext","InitialData","optionvals","PopupListReset","PopupList","OnReset","ChangedCallback","ColorChooserSetValue","ColorChooserGetValue","ColorChooserInitialize","ColorChooserReset","BorderSideSetValue","idname","idstart","BorderSideInitialize","SettingsControlOnchangeBorder","nameparts","ctrlidsuffix","ctrltype","BorderSide","OnClick","ColorComboOnClick","thickness","OtherSaveParts","whichpart","strtoedit","editbox","ebta","CtrlSEditorDone","idprefix","edittextarea","_view","SpreadsheetViewerStatuslineCallback","hasStatusLine","statuslineHTML","statuslineFull","noRecalc","repeatingMacroTimer","repeatingMacroInterval","repeatingMacroCommands","LoadSave","SpreadsheetViewerLoadSave","SpreadsheetViewerDecodeSpreadsheetSave","spreadsheetobj","rmstr","t2","startupmacro","repeatingmacro","SpreadsheetViewerDoRepeatingMacro","GetSpreadsheetViewerObject","repeatmacro","SpreadsheetViewerRepeatMacroCommand","SpreadsheetViewerStopRepeatingMacro","SpreadsheetViewerDoButtonCmd","csvo","slstr","SpreadsheetViewerCreateSheetHTML","hasreturnonly","self","thread","cb","ms","nextTick","Class","classDefinition","classWrapper","$1","baseClassName","$2","$3","incValues","strict","option","klass","global","init","isa","baseName","superFunc","addGlobal","newGlobals","extend","pairs","ii","ll","eval_strict","apply","last_key","globals","globals_after","proto","instantiate","output","content","insert","receiver","begin_node","tag","_wafl","onload","_label","imageName","_href","end_node","text_node","parse","grammar","create_grammar","parse_blocks","container_type","types","blocks","matched","find_match","handle_match","JSON","stringify","subparse","matched_func","re","capture","lookbehind","parse_phrases","phrases","begin","filtered_text","parser","matched_block","matched_phrase","$4","all_blocks","all_phrases","re_huggy","brace1","brace2","im_types","yahoo","ymsgr","callto","callme","skype","aim","im_label","im_re","key","re_list","bullet","filter_out","exclusion","_all_blocks","_all_phrases","ol","ul","blockquote","subl","li","li2","_html","pre","hr","hx","empty","else","waflparagraph","waflphrase","asis","wikilink","wikilink2","file","href","im","mail","tt","del","Error","isWindow","isFunction","inArray","readyState","ready","getAttribute","parseJSON","isEmptyObject","acceptData","expando","cache","guid","toJSON","noop","camelCase","isArray","map","cleanData","deleteExpando","db","activeElement","eb","fb","createDocumentFragment","vb","getElementsByTagName","querySelectorAll","nodeName","wb","defaultChecked","xb","ownerDocument","yb","find","zb","qb","removeAttribute","Ab","_data","Bb","hasData","events","handle","Cb","noCloneEvent","removeEvent","outerHTML","html5Clone","defaultSelected","defaultValue","Fb","appendTo","getDefaultComputedStyle","detach","Gb","Eb","Db","contentWindow","contentDocument","write","close","Mb","get","Vb","Ub","Wb","Xb","Qb","Yb","Zb","Jb","boxSizing","Kb","Ib","boxSizingReliable","parseFloat","$b","gc","_b","now","hc","opacity","ic","fc","jc","_queueHooks","unqueued","fire","always","overflowX","overflowY","inlineBlockNeedsLayout","zoom","shrinkWrapBlocks","bc","hidden","done","_removeData","kc","cssHooks","expand","lc","ec","Deferred","elem","startTime","duration","tweens","run","notifyWith","resolveWith","promise","props","opts","specialEasing","originalProperties","originalOptions","createTween","Tween","easing","stop","rejectWith","fx","anim","complete","fail","Mc","Nc","dataTypes","Jc","Oc","ajaxSettings","flatOptions","Pc","contents","mimeType","getResponseHeader","converters","Qc","responseFields","dataFilter","dataType","Wc","Sc","$c","XMLHttpRequest","_c","ActiveXObject","ed","parentWindow","hasOwnProperty","fn","jquery","constructor","selector","toArray","pushStack","prevObject","eq","isPlainObject","random","isReady","isNumeric","ownLast","globalEval","execScript","makeArray","Object","proxy","support","getElementsByClassName","qsa","ob","setAttribute","pb","mb","cacheLength","gb","hb","attrHandle","ib","sourceIndex","nextSibling","jb","kb","lb","nb","preFilter","dir","rb","sb","ub","relative","TAG","uniqueSort","getById","ID","ab","needsContext","CLASS","ATTR","PSEUDO","CHILD","bool","isXML","setDocument","attributes","createComment","getElementsByName","getAttributeNode","matchesSelector","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","compareDocumentPosition","contains","sortDetached","specified","detectDuplicates","sortStable","getText","nodeValue","selectors","createPseudo","~","pseudos","setFilters","not","has","innerText","lang","location","hash","hasFocus","tabIndex","enabled","header","even","odd","lt","gt","nth","radio","checkbox","password","submit","reset","filters","compile","expr","unique","isXMLDoc","is","parseHTML","children","prev","sibling","closest","prevAll","addBack","parents","parentsUntil","nextAll","nextUntil","prevUntil","siblings","once","memory","stopOnFalse","disable","remove","locked","fireWith","fired","then","resolve","reject","notify","pipe","when","readyWait","holdReady","trigger","off","frameElement","doScroll","noData","applet ","embed ","object ","removeData","dequeue","clearQueue","access","leadingWhitespace","htmlSerialize","cloneNode","appendChecked","noCloneChecked","checkClone","click","focusin","handler","triggered","dispatch","special","delegateType","bindType","origType","namespace","delegateCount","setup","teardown","Event","isTrigger","namespace_re","noBubble","isPropagationStopped","isDefaultPrevented","_default","fix","delegateTarget","preDispatch","handlers","currentTarget","isImmediatePropagationStopped","handleObj","postDispatch","fixHooks","mouseHooks","keyHooks","fromElement","pageX","clientLeft","pageY","clientTop","relatedTarget","toElement","beforeunload","originalEvent","simulate","isSimulated","defaultPrevented","getPreventDefault","timeStamp","stopImmediatePropagation","mouseenter","mouseleave","submitBubbles","form","_submit_bubble","changeBubbles","propertyName","_just_changed","focusinBubbles","one","triggerHandler","legend","area","param","thead","optgroup","tfoot","colgroup","caption","clone","buildFragment","createTextNode","domManip","prepend","before","after","replaceWith","_evalUrl","prependTo","insertAfter","replaceAll","cssFloat","backgroundClip","clearCloneStyle","Hb","Lb","getPropertyValue","minWidth","maxWidth","runtimeStyle","pixelLeft","swap","reliableHiddenOffsets","pixelPosition","reliableMarginRight","Nb","Ob","Pb","Rb","Sb","Tb","letterSpacing","cssNumber","columnCount","fillOpacity","lineHeight","orphans","widows","cssProps","float","set","margin","toggle","prop","cur","unit","propHooks","step","linear","swing","ac","cc","dc","Animation","tweener","prefilter","speed","speeds","old","fadeTo","animate","finish","timers","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","tick","slow","fast","delay","getSetAttribute","hrefNormalized","checkOn","optSelected","enctype","optDisabled","radioValue","mc","valHooks","scrollHeight","nc","oc","pc","qc","rc","removeAttr","attrHooks","propFix","setAttributeNode","createAttribute","coords","contenteditable","tc","uc","removeProp","for","class","vc","addClass","removeClass","toggleClass","hasClass","hover","unbind","delegate","undelegate","wc","xc","yc","Function","parseXML","DOMParser","parseFromString","async","loadXML","zc","Ac","Bc","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Kc","Lc","active","lastModified","etag","isLocal","processData","contentType","accepts","xml","json","* text","text html","text json","text xml","ajaxSetup","ajaxPrefilter","ajaxTransport","ajax","ifModified","statusText","statusCode","getAllResponseHeaders","setRequestHeader","overrideMimeType","abort","success","crossDomain","traditional","hasContent","headers","beforeSend","send","getJSON","getScript","throws","wrapAll","wrapInner","wrap","unwrap","visible","Rc","Tc","Uc","Vc","encodeURIComponent","serialize","serializeArray","xhr","Xc","Yc","Zc","cors","open","username","xhrFields","onreadystatechange","responseText","script","text script","head","scriptCharset","charset","ad","bd","jsonp","jsonpCallback","cd","animated","dd","setOffset","using","scrollTo","Height","Width","andSelf","fd","jQuery","gd","noConflict","animation","WebkitAnimation","MozAnimation","MsAnimation","OAnimation","closeByEscape","globalID","animationEndEvent","baseClassNames","vex","overlay","closing","defaultOptions","showCloseButton","escapeButtonCloses","overlayClosesOnClick","appendLocation","overlayClassName","overlayCSS","contentClassName","contentCSS","closeClassName","closeCSS","$vex","$vexOverlay","$vexContent","$closeButton","setupBodyClassName","afterOpen","getAllVexes","getVexByID","closeByID","closeAll","beforeClose","afterClose","hideLoading","showLoading","require","buttons","YES","NO","message","onSubmit","getFormValueOnSubmit","focusFirstInput","defaultAlertOptions","defaultConfirmOptions","buildDialogForm","confirm","placeholder","buttonsToDOM","dialog","_curInst","_keyEvent","_disabledInputs","_datepickerShowing","_inDialog","_mainDivId","_inlineClass","_appendClass","_triggerClass","_dialogClass","_disableClass","_unselectableClass","_currentClass","_dayOverClass","regional","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","_defaults","showOn","showAnim","showOptions","defaultDate","appendText","buttonText","buttonImage","buttonImageOnly","hideIfNoPrevNext","navigationAsDateFormat","gotoCurrent","changeMonth","changeYear","yearRange","showOtherMonths","selectOtherMonths","showWeek","calculateWeek","iso8601Week","shortYearCutoff","minDate","maxDate","beforeShowDay","beforeShow","onSelect","onChangeMonthYear","onClose","numberOfMonths","showCurrentAtPos","stepMonths","stepBigMonths","altField","altFormat","constrainInput","showButtonPanel","autoSize","en","dpDiv","datepicker","_isDisabledDatepicker","inline","_refresh","_trigger","version","BACKSPACE","COMMA","DELETE","DOWN","END","ENTER","ESCAPE","HOME","PAGE_DOWN","PAGE_UP","PERIOD","SPACE","TAB","UP","scrollParent","uniqueId","removeUniqueId","focusable","tabbable","outerWidth","outerHeight","ie","disableSelection","enableSelection","plugin","plugins","widget","Widget","_createWidget","_proto","_childConstructors","_super","_superApply","widgetEventPrefix","widgetName","widgetFullName","bridge","_init","defaultElement","create","uuid","eventNamespace","bindings","hoverable","_on","destroy","_getCreateOptions","_create","_getCreateEventData","_destroy","_setOptions","_setOption","enable","_off","_delay","_hoverable","_focusable","focusout","effect","effects","mouseup","_mouseInit","_mouseDown","started","_mouseDestroy","_mouseMoveDelegate","_mouseUpDelegate","_mouseMoved","_mouseStarted","_mouseUp","_mouseDownEvent","_mouseCapture","mouseDelayMet","_mouseDelayTimer","_mouseDistanceMet","_mouseDelayMet","_mouseStart","_mouseMove","documentMode","_mouseDrag","_mouseStop","scrollbarWidth","getScrollInfo","isDocument","scrollWidth","getWithinInfo","of","within","collision","at","my","targetWidth","targetHeight","elemWidth","elemHeight","collisionPosition","collisionWidth","collisionHeight","important","fit","flip","flipfit","mouse","addClasses","axis","connectToSortable","containment","cursorAt","helper","iframeFix","refreshPositions","revert","revertDuration","scope","scroll","scrollSensitivity","scrollSpeed","snap","snapMode","snapTolerance","drag","_setPositionRelative","_setHandleClassName","_removeHandleClassName","destroyOnClear","_blurActiveElement","_getHandle","_blockFrames","iframeBlocks","_unblockFrames","handleElement","_createHelper","_cacheHelperProportions","ddmanager","_cacheMargins","cssPosition","hasFixedAncestor","positionAbs","_refreshOffsets","originalPosition","_generatePosition","originalPageX","originalPageY","_adjustOffsetFromHelper","_setContainment","_clear","dropBehaviour","prepareOffsets","_normalizeRightBottom","dragStart","margins","_getParentOffset","_getRelativeOffset","_convertPositionTo","_uiHash","drop","dropped","dragStop","helperProportions","_isRootNode","relativeContainer","cancelHelperRemoval","sortables","sortable","isOver","_storedCSS","_helper","_intersectsWith","containerCache","_parent","currentItem","fromOutside","_revert","_cursor","_opacity","scrollParentNotHidden","overflowOffset","snapElements","snapping","release","snapItem","_zIndex","draggable","accept","activeClass","greedy","hoverClass","tolerance","activate","deactivate","out","over","isover","isout","proportions","_addToManager","droppables","_splice","_activate","_deactivate","_over","_out","_drop","droppable","intersect","absolute","default","greedyChild","alsoResize","animateDuration","animateEasing","aspectRatio","autoHide","ghost","handles","maxHeight","minHeight","resize","_num","_isNumber","_hasScroll","_aspectRatio","originalElement","_proportionallyResizeElements","resizable","elementIsWrapper","originalResizeStyle","_proportionallyResize","se","sw","ne","nw","_handles","_renderAxis","mouseover","resizing","_renderProxy","originalSize","sizeDiff","originalMousePosition","_propagate","_change","_updatePrevProperties","_updateVirtualBoundaries","_updateRatio","_respectSize","_updateCache","_applyChanges","prevPosition","prevSize","_vBoundaries","_getPaddingPlusBorderDimensions","outerDimensions","elementOffset","containerElement","containerOffset","containerPosition","parentData","containerSize","autoRefresh","selecting","unselected","unselecting","dragged","refresh","$element","startselected","selectees","opos","connectWith","dropOnEmpty","forcePlaceholderSize","forceHelperSize","beforeStop","receive","update","_isOverAxis","_isFloating","instance","reverting","_refreshItems","_removeCurrentsFromItems","currentContainer","domPosition","_createPlaceholder","storedCursor","storedStylesheet","_storedOpacity","_storedZIndex","_preserveHelperProportions","containers","dragging","lastPositionAbs","_intersectsWithPointer","_intersectsWithSides","_rearrange","_contactContainers","_noFinalSort","_getItemsAsjQuery","connected","attribute","expression","forcePointerForContainers","floating","_getDragVerticalDirection","_getDragHorizontalDirection","_connectWith","toleranceElement","refreshContainers","_createTrPlaceholder","counter","sender","collapsible","heightStyle","icons","activeHeader","beforeActivate","hideProps","borderTopWidth","borderBottomWidth","showProps","prevShow","prevHide","_processPanels","panel","_createIcons","_destroyIcons","_setupEvents","_keydown","altKey","_eventHandler","_panelKeyDown","panels","_findActive","aria-selected","aria-expanded","aria-hidden","keydown","oldHeader","oldPanel","newHeader","newPanel","_toggle","_animate","_toggleComplete","submenu","menus","role","activeMenu","mouseHandled","mousedown .ui-menu-item","click .ui-menu-item","mouseenter .ui-menu-item","previousFilter","mouseleave .ui-menu","collapseAll","_closeOnDocumentClick","previousPage","nextPage","_move","previous","filterTimer","_filterMenuItems","_isDivider","_itemRole","menu","listbox","_scrollIntoView","_close","_startOpening","_open","isFirstItem","isLastItem","response","requestIndex","pending","isMultiLine","valueMethod","isNewMenu","_value","_searchTimeout","keypress","selectedItem","cancelBlur","searching","_initSource","_appendTo","menufocus","liveRegion","menuselect","aria-live","aria-relevant","_search","cancelSearch","_response","__response","_normalize","_suggest","_renderMenu","_resizeMenu","_renderItemData","_renderItem","messages","noResults","results","primary","secondary","_determineButtonType","hasTitle","_resetButton","markerClassName","maxRows","_widgetDatepicker","setDefaults","_attachDatepicker","_newInst","_connectDatepicker","_inlineDatepicker","selectedDay","selectedMonth","selectedYear","drawMonth","drawYear","_attachments","_doKeyDown","_doKeyPress","_doKeyUp","_autoSize","_disableDatepicker","_get","_showDatepicker","alt","_lastInput","_hideDatepicker","setMonth","setDate","getDay","_formatDate","_setDate","_getDefaultDate","_updateDatepicker","_updateAlternate","_dialogDatepicker","_dialogInst","_dialogInput","_pos","blockUI","_destroyDatepicker","_enableDatepicker","_getInst","_optionDatepicker","_getDateDatepicker","_getMinMaxDate","_changeDatepicker","_refreshDatepicker","_setDateDatepicker","_setDateFromField","_getDate","_selectDay","_adjustDate","_clearDate","_gotoToday","_possibleChars","lastVal","parseDate","_getFormatConfig","_findPos","_checkOffset","_shouldFocusInput","_generateHTML","_attachHandlers","_getNumberOfMonths","yearshtml","_tidyDialog","unblockUI","_checkExternalClick","_adjustInstDate","currentDay","currentMonth","currentYear","_notifyChange","_selectMonthYear","_selectDate","formatDate","noWeekends","_ticksTo1970","_getDaysInMonth","_daylightSavingAdjust","ATOM","COOKIE","ISO_8601","RFC_822","RFC_850","RFC_1036","RFC_1123","RFC_2822","RSS","TICKS","TIMESTAMP","W3C","getYear","_restrictMinMax","_determineDate","setHours","setMinutes","setSeconds","setMilliseconds","today","selectDay","selectMonth","selectYear","te","_canAdjustMonth","_isInRange","_generateMonthYearHeader","_getFirstDayOfMonth","initialized","autoOpen","closeOnEscape","dialogClass","modal","resizeStart","resizeStop","sizeRelatedOptions","resizableRelatedOptions","originalCss","originalTitle","_createWrapper","uiDialog","_createTitlebar","_createButtonPane","_makeDraggable","_makeResizable","_isOpen","_trackFocus","_untrackInstance","_destroyOverlay","_focusedElement","opener","_hide","isOpen","moveToTop","_moveToTop","_focusTabbable","_size","_position","_createOverlay","_show","_makeFocusTarget","uiDialogButtonPane","uiDialogTitlebarClose","_keepFocus","aria-describedby","uiDialogTitlebar","_title","aria-labelledby","uiButtonSet","_createButtons","showText","_minHeight","_trackingInstances","_allowInteraction","oldValue","_constrainedValue","aria-valuemin","valueDiv","_refreshValue","indeterminate","_percentage","toFixed","overlayDiv","aria-valuemax","aria-valuenow","ids","_drawButton","_drawMenu","tabindex","aria-autocomplete","aria-owns","aria-haspopup","_setText","_resizeButton","_buttonEvents","menuItems","_refreshMenu","menuWrap","menuInstance","_setSelection","_select","focusIndex","_getSelectedItem","_parseOptions","_setAria","_toggleAttr","_documentClick","menuWidget","getSelection","removeAllRanges","addRange","rangeCount","getRangeAt","_selectFocusedItem","aria-activedescendant","orientation","slide","numPages","_keySliding","_mouseSliding","_animateOff","_handleIndex","_detectOrientation","_calculateNewMax","_createRange","_createHandles","_valueMin","_handleEvents","elementSize","_normValueFromMouse","_valueMax","_lastChangedValue","_start","_clickOffset","_slide","_stop","_trimAlignValue","_values","_precision","_precisionOf","culture","incremental","numberFormat","page","spin","_draw","_events","mousewheel","spinning","_spin","mousewheelTimer","mousedown .ui-spinner-button","_repeat","mouseup .ui-spinner-button","mouseenter .ui-spinner-button","mouseleave .ui-spinner-button","uiSpinner","_uiSpinnerHtml","_buttonHtml","_adjustValue","_increment","_parse","_format","Globalize","format","isValid","stepUp","_stepUp","stepDown","_stepDown","pageUp","pageDown","beforeLoad","_isLocal","decodeURIComponent","running","_processTabs","_initialActive","anchors","tab","_getPanelForTab","_tabKeydown","_handlePageNav","activating","_focusNextTab","_panelKeydown","_findNextTab","_setupDisabled","_setupHeightStyle","_sanitizeSelector","tablist","_getList","_createPanel","aria-controls","oldTab","newTab","_getIndex","_ajaxSettings","jqXHR","tooltipClass","track","_addDescribedBy","_removeDescribedBy","tooltips","_disable","_updateContent","_enable","_registerCloseHandlers","_find","_tooltip","mousemove","delayedShow","_removeTooltip","hiding"],"mappings":"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","sourcesContent":["// Taken from https://github.com/umdjs/umd/blob/master/templates/returnExports.js\r\n// (c) by The UMD contributors\r\n// MIT License: https://github.com/umdjs/umd/blob/master/LICENSE.md\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define([], factory.bind(root, this));\r\n    } else if (typeof module === 'object' && module.exports) {\r\n        // Node. Does not work with strict CommonJS, but\r\n        // only CommonJS-like environments that support module.exports,\r\n        // like Node.\r\n        module.exports = factory.call(root, this);\r\n    } else {\r\n        // Browser globals (root is window)\r\n        root.SocialCalc = factory.call(root, this);\r\n  }\r\n}(this, function (window) {\r\n//\r\n/*\r\n// The module of the SocialCalc package with customizable constants, strings, etc.\r\n// This is where most of the common localizations are done.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\nvar SocialCalc;\r\nif (!SocialCalc) SocialCalc = {};\r\n\r\n// *************************************\r\n//\r\n// TO LEARN HOW TO LOCALIZE OR CUSTOMIZE SOCIALCALC, PLEASE READ THIS:\r\n//\r\n// The constants are all properties of the SocialCalc.Constants object.\r\n// They are grouped here by what they are for, which module uses them, etc.\r\n//\r\n// Properties whose names start with \"s_\" are strings, or arrays of strings,\r\n// that are good candidates for translation from the English.\r\n//\r\n// Other properties relate to visual settings, localization parameters, etc.\r\n//\r\n// These values are not used when SocialCalc modules are first loaded.\r\n// They may be modified before the first use of the routines that use them,\r\n// e.g., before creating SocialCalc objects.\r\n//\r\n// The exceptions are:\r\n//    TooltipOffsetX and TooltipOffsetY, as described with their definitions.\r\n//\r\n// SocialCalc IS NOT DESIGNED FOR USE WITH A TRANSLATION FUNCTION each time a string\r\n// is used. Instead, language translations may be done by modifying this object.\r\n//\r\n// To customize SocialCalc, you may either replace this file with a modified version\r\n// or you can overwrite the values before use. An example would be to\r\n// iterate over all the properties looking for names that start with \"s_\" and\r\n// use some other mechanism to obtain a localized string and replace the values\r\n// here with those translated values.\r\n//\r\n// There is also a function, SocialCalc.ConstantsSetClasses, that may be used\r\n// to easily switch SocialCalc from using explicit CSS styles for many things\r\n// to using CSS classes. See the function, below, for more information.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.Constants = {\r\n\r\n//\r\n// Main SocialCalc module, socialcalc-3.js:\r\n//\r\n\r\n// eddy cellDataType {\r\n//    datatype: if present, v=numeric value, t=text value, f=formula,\r\n//              or c=constant that is not a simple number (like \"$1.20\")\r\n   cellDataType: { \r\n\tv:\"value\",\r\n\tn:\"value\",\r\n\tt:\"text\",\r\n\tf:\"formula\",\r\n\tc:\"constant\"\t\r\n   },\r\n// }   \r\n   \r\n   //*** Common Constants\r\n\r\n   textdatadefaulttype: \"t\", // This sets the default type for text on reading source file\r\n                             // It should normally be \"t\"\r\n\r\n   //*** Common error messages\r\n\r\n   s_BrowserNotSupported: \"Browser not supported.\", // error thrown if browser can't handle events like IE or Firefox.\r\n   s_InternalError: \"Internal SocialCalc error (probably an internal bug): \", // hopefully unlikely, but a test failed\r\n\r\n   //*** SocialCalc.ParseSheetSave\r\n\r\n   // Errors thrown on unexpected value in save file:\r\n\r\n   s_pssUnknownColType: \"Unknown col type item\",\r\n   s_pssUnknownRowType: \"Unknown row type item\",\r\n   s_pssUnknownLineType: \"Unknown line type\",\r\n\r\n   //*** SocialCalc.CellFromStringParts\r\n\r\n   // Error thrown on unexpected value in save file:\r\n\r\n   s_cfspUnknownCellType: \"Unknown cell type item\",\r\n\r\n   //*** SocialCalc.CanonicalizeSheet\r\n\r\n   doCanonicalizeSheet: true, // if true, do the canonicalization calculations\r\n\r\n   //*** ExecuteSheetCommand\r\n\r\n   s_escUnknownSheetCmd: \"Unknown sheet command: \",\r\n   s_escUnknownSetCoordCmd: \"Unknown set coord command: \",\r\n   s_escUnknownCmd: \"Unknown command: \",\r\n\r\n   //*** SocialCalc.CheckAndCalcCell\r\n\r\n   s_caccCircRef: \"Circular reference to \", // circular reference found during recalc\r\n\r\n   //*** SocialCalc.RenderContext\r\n\r\n   defaultRowNameWidth: \"30\", // used to set minimum width of the row header column - a string in pixels\r\n   defaultAssumedRowHeight: 15, // used when guessing row heights - number\r\n   defaultCellIDPrefix: \"cell_\", // if non-null, each cell will render with an ID starting with this\r\n\r\n   // Default sheet display values\r\n\r\n   defaultCellLayout: \"padding:2px 2px 1px 2px;vertical-align:top;\",\r\n   defaultCellFontStyle: \"normal normal\",\r\n   defaultCellFontSize: \"small\",\r\n   defaultCellFontFamily: \"Verdana,Arial,Helvetica,sans-serif\",\r\n\r\n   defaultPaneDividerWidth: \"3\", // a string\r\n   defaultPaneDividerHeight: \"3\", // a string\r\n\r\n   defaultGridCSS: \"1px solid #C0C0C0;\", // used as style to set each border when grid enabled (was #ECECEC)\r\n\r\n   defaultCommentClass: \"\", // class added to cells with non-null comments when grid enabled\r\n   defaultCommentStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);\", // style added to cells with non-null comments when grid enabled\r\n   defaultCommentNoGridClass: \"\", // class added to cells with non-null comments when grid not enabled\r\n   defaultCommentNoGridStyle: \"\", // style added to cells with non-null comments when grid not enabled\r\n\r\n   defaultReadonlyClass: \"\", // class added to readonly cells when grid enabled\r\n   defaultReadonlyStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);\", // style added to readonly cells when grid enabled\r\n   defaultReadonlyNoGridClass: \"\", // class added to readonly cells when grid not enabled\r\n   defaultReadonlyNoGridStyle: \"\", // style added to readonly cells when grid not enabled\r\n   defaultReadonlyComment: \"Locked cell\",\r\n\r\n   defaultColWidth: \"80\", // text\r\n   defaultMinimumColWidth: 10, // numeric\r\n\r\n   // For each of the following default sheet display values at least one of class and/or style are needed\r\n\r\n   defaultHighlightTypeCursorClass: \"\",\r\n   defaultHighlightTypeCursorStyle: \"color:#FFF;backgroundColor:#A6A6A6;\",\r\n   defaultHighlightTypeRangeClass: \"\",\r\n   defaultHighlightTypeRangeStyle: \"color:#000;backgroundColor:#E5E5E5;\",\r\n\r\n   defaultColnameClass: \"\", // regular column heading letters, needs a cursor property \r\n   defaultColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;\",\r\n   defaultSelectedColnameClass: \"\", // column with selected cell, needs a cursor property \r\n   defaultSelectedColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;\",\r\n   defaultRownameClass: \"\", // regular row heading numbers\r\n   defaultRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;\",\r\n   defaultSelectedRownameClass: \"\", // column with selected cell, needs a cursor property \r\n   defaultSelectedRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\",\r\n   defaultUpperLeftClass: \"\", // Corner cell in upper left\r\n   defaultUpperLeftStyle: \"font-size:small;\",\r\n   defaultSkippedCellClass: \"\", // used if present for spanned cells peeking into a pane (at least one of class/style needed)\r\n   defaultSkippedCellStyle: \"font-size:small;background-color:#CCC\", // used if present\r\n   defaultPaneDividerClass: \"\", // used if present for the look of the space between panes (at least one of class/style needed)\r\n   defaultPaneDividerStyle: \"font-size:small;background-color:#C0C0C0;padding:0px;\", // used if present\r\n   defaultUnhideLeftClass: \"\",\r\n   defaultUnhideLeftStyle: \"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;\", // used if present\r\n   defaultUnhideRightClass: \"\",\r\n   defaultUnhideRightStyle: \"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;\", // used if present\r\n   defaultUnhideTopClass: \"\",\r\n   defaultUnhideTopStyle: \"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;\",\r\n   defaultUnhideBottomClass: \"\",\r\n   defaultUnhideBottomStyle: \"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;\",\r\n\r\n   defaultColResizeBarClass: \"col-resize-bar\",\r\n   defaultRowResizeBarClass: \"row-resize-bar\",\r\n\r\n   s_rcMissingSheet: \"Render Context must have a sheet object\", // unlikely thrown error\r\n\r\n   //*** SocialCalc.format_text_for_display\r\n\r\n   defaultLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Link</span>', // used for format \"text-link\"; you could make this an img tag if desired\r\n//   defaultLinkFormatString: '<img src=\"images/sc-linkout.gif\" border=\"0\" alt=\"Link out\" title=\"Link out\">',\r\n   defaultPageLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Page</span>', // used for format \"text-link\"; you could make this an img tag if desired\r\n\r\n   //*** SocialCalc.format_number_for_display\r\n\r\n   defaultFormatp: '#,##0.0%',\r\n   defaultFormatc: '[$$]#,##0.00',\r\n   defaultFormatdt: 'd-mmm-yyyy h:mm:ss',\r\n   defaultFormatd: 'd-mmm-yyyy',\r\n   defaultFormatt: '[h]:mm:ss',\r\n   defaultDisplayTRUE: 'TRUE', // how TRUE shows when rendered\r\n   defaultDisplayFALSE: 'FALSE',\r\n\r\n//\r\n// SocialCalc Table Editor module, socialcalctableeditor.js:\r\n//\r\n\r\n   //*** SocialCalc.TableEditor\r\n\r\n   defaultImagePrefix: \"images/sc_\", // URL prefix for images (e.g., \"/images/sc\")\r\n   defaultTableEditorIDPrefix: \"te_\", // if present, many TableEditor elements are assigned IDs with this prefix\r\n   defaultPageUpDnAmount: 15, // number of rows to move cursor on PgUp/PgDn keys (numeric)\r\n\r\n   AllowCtrlS: true, // turns on Ctrl-S trapdoor for setting custom numeric formats and commands if true\r\n\r\n   //*** SocialCalc.CreateTableEditor\r\n\r\n   defaultTableControlThickness: 20, // the short size for the scrollbars, etc. (numeric in pixels)\r\n   cteGriddivClass: \"\", // if present, the class for the TableEditor griddiv element\r\n\r\n   //** SocialCalc.EditorGetStatuslineString -- strings shown on status line\r\n\r\n   s_statusline_executing: \"Executing...\",\r\n   s_statusline_displaying: \"Displaying...\",\r\n   s_statusline_ordering: \"Ordering...\",\r\n   s_statusline_calculating: \"Calculating...\",\r\n   s_statusline_calculatingls: \"Calculating... Loading Sheet...\",\r\n   s_statusline_doingserverfunc: \"doing server function \",\r\n   s_statusline_incell: \" in cell \",\r\n   s_statusline_calcstart: \"Calculation start...\",\r\n   s_statusline_sum: \"SUM\",\r\n   s_statusline_recalcneeded: '<span style=\"color:#999;\">(Recalc needed)</span>',\r\n   s_statusline_circref: '<span style=\"color:red;\">Circular reference: ',\r\n   s_statusline_sendemail: \"Sending Email \",  // eddy\r\n   //** SocialCalc.InputBoxDisplayCellContents\r\n\r\n   s_inputboxdisplaymultilinetext: \"[Multi-line text: Click icon on right to edit]\",\r\n\r\n   //** SocialCalc.InputEcho\r\n\r\n   defaultInputEchoClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;\"+\r\n      \"fontSize:small;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\r\n   defaultInputEchoPromptClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoPromptStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;\"+\r\n      \"borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;\"+\r\n      \"fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\r\n   defaultInputEchoHintClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoHintStyle: \"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;\"+\r\n      \"fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;\", // if present, pseudo style\r\n\r\n   //** SocialCalc.InputEchoText\r\n\r\n   ietUnknownFunction: \"Unknown function \", // displayed when typing \"=unknown(\"\r\n\r\n   //** SocialCalc.CellHandles\r\n\r\n   CH_radius1: 29.0, // extent of inner circle within 90px image\r\n   CH_radius2: 41.0, // extent of outer circle within 90px image\r\n   s_CHfillAllTooltip: \"Fill Contents and Formats Down/Right\", // tooltip for fill all handle\r\n   s_CHfillContentsTooltip: \"Fill Contents Only Down/Right\", // tooltip for fill formulas handle\r\n   s_CHmovePasteAllTooltip: \"Move Contents and Formats\", // etc.\r\n   s_CHmovePasteContentsTooltip: \"Move Contents Only\",\r\n   s_CHmoveInsertAllTooltip: \"Slide Contents and Formats within Row/Col\",\r\n   s_CHmoveInsertContentsTooltip: \"Slide Contents within Row/Col\",\r\n   s_CHindicatorOperationLookup: {\"Fill\": \"Fill\", \"FillC\": \"Fill Contents\",\r\n                                  \"Move\": \"Move\", \"MoveI\": \"Slide\", \r\n                                  \"MoveC\": \"Move Contents\", \"MoveIC\": \"Slide Contents\"}, // short form of operation to follow drag\r\n   s_CHindicatorDirectionLookup: {\"Down\": \" Down\", \"Right\": \" Right\",\r\n                                  \"Horizontal\": \" Horizontal\", \"Vertical\": \" Vertical\"}, // direction that modifies operation during drag\r\n\r\n   //*** SocialCalc.TableControl\r\n\r\n   defaultTCSliderThickness: 9, // length of pane slider (numeric in pixels)\r\n   defaultTCButtonThickness: 20, // length of scroll +/- buttons (numeric in pixels)\r\n   defaultTCThumbThickness: 15, // length of thumb (numeric in pixels)\r\n\r\n   //*** SocialCalc.CreateTableControl\r\n\r\n   TCmainStyle: \"backgroundColor:#EEE;\", // if present, pseudo style (text-align is textAlign) for main div of a table control\r\n   TCmainClass: \"\", // if present, the CSS class of the main div for a table control\r\n   TCendcapStyle: \"backgroundColor:#FFF;\", // backgroundColor may be used while waiting for image that may not come\r\n   TCendcapClass: \"\",\r\n   TCpanesliderClass: \"tc-paneslider\",\r\n   s_panesliderTooltiph: \"Drag to lock pane vertically\", // tooltip for horizontal table control pane slider\r\n   s_panesliderTooltipv: \"Drag to lock pane horizontally\",\r\n   TClessbuttonStyle: \"backgroundColor:#AAA;\",\r\n   TClessbuttonClass: \"\",\r\n   TClessbuttonRepeatWait: 300, // in milliseconds\r\n   TClessbuttonRepeatInterval: 20,//100, // in milliseconds\r\n   TCmorebuttonStyle: \"backgroundColor:#AAA;\",\r\n   TCmorebuttonClass: \"\",\r\n   TCmorebuttonRepeatWait: 300, // in milliseconds\r\n   TCmorebuttonRepeatInterval: 20,//100, // in milliseconds\r\n   TCscrollareaStyle: \"backgroundColor:#DDD;\",\r\n   TCscrollareaClass: \"\",\r\n   TCscrollareaRepeatWait: 500, // in milliseconds\r\n   TCscrollareaRepeatInterval: 100, // in milliseconds\r\n   TCthumbClass: \"\",\r\n   TCthumbStyle: \"backgroundColor:#CCC;\",\r\n\r\n   //*** SocialCalc.TCPSDragFunctionStart\r\n\r\n   TCPStrackinglineClass: \"tracklingine\", // at least one of class/style for pane slider tracking line display in table control\r\n   TCPStrackinglineStyle: \"overflow:hidden;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCPStrackinglineThickness: \"2px\", // narrow dimension of trackling line (string with units)\r\n\r\n\r\n   //*** SocialCalc.TCTDragFunctionStart\r\n\r\n   TCTDFSthumbstatusvClass: \"\", // at least one of class/style for vertical thumb dragging status display in table control\r\n   TCTDFSthumbstatusvStyle: \"height:20px;width:auto;border:3px solid #808080;overflow:hidden;\"+\r\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCTDFSthumbstatushClass: \"\", // at least one of class/style for horizontal thumb dragging status display in table control\r\n   TCTDFSthumbstatushStyle: \"height:20px;width:auto;border:1px solid black;padding:2px;\"+\r\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCTDFSthumbstatusrownumClass: \"\", // at least one of class/style for thumb dragging status display in table control\r\n   TCTDFSthumbstatusrownumStyle: \"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\", // if present, real style\r\n   TCTDFStopOffsetv: 0, // offsets for thumbstatus display while dragging\r\n   TCTDFSleftOffsetv: -80,\r\n   s_TCTDFthumbstatusPrefixv: \"Row \", // Text Control Drag Function text before row number\r\n   TCTDFStopOffseth: -30,\r\n   TCTDFSleftOffseth: 0,\r\n   s_TCTDFthumbstatusPrefixh: \"Col \", // Text Control Drag Function text before col number\r\n\r\n   //*** SocialCalc.TooltipInfo\r\n\r\n   // Note: These two values are used to set the TooltipInfo initial values when the code is first read in.\r\n   // Modifying them here after loading has no effect -- you need to modify SocialCalc.TooltipInfo directly\r\n   // to dynamically set them. This is different than most other constants which may be modified until use.\r\n\r\n   TooltipOffsetX: 2, // offset in pixels from mouse position (to right on left side of screen, to left on right)\r\n   TooltipOffsetY: 10, // offset in pixels above mouse position for lower edge\r\n\r\n   //*** SocialCalc.TooltipDisplay\r\n\r\n   TDpopupElementClass: \"\", // at least one of class/style for tooltip display\r\n   TDpopupElementStyle: \"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;\"+\r\n                        \"fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;\"+\r\n                        \"position:absolute;width:auto;zIndex:110;\",\r\n                        // if present, pseudo style (text-align is textAlign)\r\n\r\n\r\n//\r\n// SocialCalc Spreadsheet Control module, socialcalcspreadsheetcontrol.js:\r\n//\r\n\r\n   //*** SocialCalc.SpreadsheetControl\r\n\r\n   SCToolbarbackground: \"background-color:#ffffff;\",\r\n   SCTabbackground: \"background-color:#CCC;\",\r\n   SCTabselectedCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\",\r\n   SCTabplainCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\",\r\n   SCToolbartext: \"font-size:x-small;font-weight:bold;color:#888\",\r\n\r\n   SCFormulabarheight: 30, // in pixels, will contain a text input box\r\n\r\n   SCStatuslineheight: 20, // in pixels\r\n   SCStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\r\n\r\n   // Constants for default Format tab (settings)\r\n   //\r\n   // *** EVEN THOUGH THESE DON'T START WITH s_: ***\r\n   //\r\n   // These should be carefully checked for localization. Make sure you understand what they do and how they work!\r\n   // The first part of \"first:second|first:second|...\" is what is displayed and the second is the value to be used.\r\n   // The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\r\n   // they are commands to SocialCalc.SettingsControls.PopupListInitialize \r\n\r\n   SCFormatNumberFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|\"+\r\n            \"00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:\"+\r\n            \"1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|\"+\r\n            \"[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|\"+\r\n            \"[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|\"+\r\n            \"(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|\"+\r\n            \"($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|\"+\r\n            \"[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|\"+\r\n            \"[break]:|1\\\\c23:h:mm|1\\\\c23 PM:h:mm AM/PM|1\\\\c23\\\\c45:h:mm:ss|01\\\\c23\\\\c45:hh:mm:ss|26\\\\c23 (h\\\\cm):[hh]:mm|69\\\\c45 (m\\\\cs):[mm]:ss|69 (s):[ss]|\"+\r\n            \"[newcol]:|2006-01-04 01\\\\c23\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\",\r\n   SCFormatTextFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|\"+\r\n            \"HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\",\r\n   SCFormatPadsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|\"+\r\n            \"[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|\"+\r\n            \"6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\r\n            \"12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|\"+\r\n            \"18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\r\n   SCFormatFontsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|\"+\r\n                  \"[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|\"+\r\n                  \"[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|\"+\r\n                  \"[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\r\n                  \"12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|\"+\r\n                  \"18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\r\n   SCFormatFontfamilies: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|\"+\r\n                  \"Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\",\r\n   SCFormatFontlook: \"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|\"+\r\n                  \"%loc!Bold Italic!:italic bold\",\r\n   SCFormatTextAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\r\n   SCFormatNumberAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\r\n   SCFormatAlignVertical: \"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\",\r\n   SCFormatColwidth: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|\"+\r\n                  \"[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\",\r\n   SCFormatRecalc: \"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\",\r\n   SCFormatUserMaxCol: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\r\n   SCFormatUserMaxRow: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\r\n\r\n   //*** SocialCalc.InitializeSpreadsheetControl\r\n\r\n   ISCButtonNormalBackground: \"transparent\",\r\n   ISCButtonBorderNormal: \"none\",\r\n   ISCButtonBorderHover: \"none\",\r\n   ISCButtonBorderDown: \"none\",\r\n   ISCButtonDownBackground: \"#888\",\r\n\r\n   //*** SocialCalc.SettingsControls.PopupListInitialize\r\n\r\n   s_PopupListCancel: \"[Cancel]\",\r\n   s_PopupListCustom: \"Custom\",\r\n\r\n   // ***\r\n   //\r\n   // s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\r\n   //\r\n   // Used extensively by socialcalcspreadsheetcontrol.js\r\n   //\r\n   // ***\r\n\r\n   s_loc_align_center: \"Align Center\",\r\n   s_loc_align_left: \"Align Left\",\r\n   s_loc_align_right: \"Align Right\",\r\n   s_loc_alignment: \"Alignment\",\r\n   s_loc_audit: \"Audit\",\r\n   s_loc_audit_trail_this_session: \"Audit Trail This Session\",\r\n   s_loc_auto: \"Auto\",\r\n   s_loc_auto_sum: \"Auto Sum\",\r\n   s_loc_auto_wX_commas: \"Auto w/ commas\",\r\n   s_loc_automatic: \"Automatic\",\r\n   s_loc_background: \"Background\",\r\n   s_loc_bold: \"Bold\",\r\n   s_loc_bold_XampX_italics: \"Bold &amp; Italics\",\r\n   s_loc_bold_italic: \"Bold Italic\",\r\n   s_loc_borders: \"Borders\",\r\n   s_loc_borders_off: \"Borders Off\",\r\n   s_loc_borders_on: \"Borders On\",\r\n   s_loc_bottom: \"Bottom\",\r\n   s_loc_bottom_border: \"Bottom Border\",\r\n   s_loc_cell_settings: \"CELL SETTINGS\",\r\n   s_loc_csv_format: \"CSV format\",\r\n   s_loc_cancel: \"Cancel\",\r\n   s_loc_category: \"Category\",\r\n   s_loc_center: \"Center\",\r\n   s_loc_clear: \"Clear\",\r\n   s_loc_clear_socialcalc_clipboard: \"Clear SocialCalc Clipboard\",\r\n   s_loc_clipboard: \"Clipboard\",\r\n   s_loc_color: \"Color\",\r\n   s_loc_column_: \"Column \",\r\n   s_loc_comment: \"Comment\",\r\n   s_loc_copy: \"Copy\",\r\n   s_loc_custom: \"Custom\",\r\n   s_loc_cut: \"Cut\",\r\n   s_loc_default: \"Default\",\r\n   s_loc_default_alignment: \"Default Alignment\",\r\n   s_loc_default_column_width: \"Default Column Width\",\r\n   s_loc_default_font: \"Default Font\",\r\n   s_loc_default_format: \"Default Format\",\r\n   s_loc_default_padding: \"Default Padding\",\r\n   s_loc_delete: \"Delete\",\r\n   s_loc_delete_column: \"Delete Column\",\r\n   s_loc_delete_contents: \"Delete Cell Contents\",\r\n   s_loc_delete_row: \"Delete Row\",\r\n   s_loc_description: \"Description\",\r\n   s_loc_display_clipboard_in: \"Display Clipboard in\",\r\n   s_loc_down: \"Down\",\r\n   s_loc_edit: \"Edit\",\r\n   s_loc_existing_names: \"Existing Names\",\r\n   s_loc_family: \"Family\",\r\n   s_loc_fill_down: \"Fill Down\",\r\n   s_loc_fill_right: \"Fill Right\",\r\n   s_loc_font: \"Font\",\r\n   s_loc_format: \"Format\",\r\n   s_loc_formula: \"Formula\",\r\n   s_loc_function_list: \"Function List\",\r\n   s_loc_functions: \"Functions\",\r\n   s_loc_grid: \"Grid\",\r\n   s_loc_hidden: \"Hidden\",\r\n   s_loc_hide_column: \"Hide Column\",\r\n   s_loc_hide_row: \"Hide Row\",\r\n   s_loc_horizontal: \"Horizontal\",\r\n   s_loc_insert_column: \"Insert Column Before\",\r\n   s_loc_insert_row: \"Insert Row Before\",\r\n   s_loc_italic: \"Italic\",\r\n   s_loc_last_sort: \"Last Sort\",\r\n   s_loc_left: \"Left\",\r\n   s_loc_left_border: \"Left Border\",\r\n   s_loc_link: \"Link\",\r\n   s_loc_link_input_box: \"Link Input Box\",\r\n   s_loc_list: \"List\",\r\n   s_loc_load_socialcalc_clipboard_with_this: \"Load SocialCalc Clipboard With This\",\r\n   s_loc_lock_cell: \"Lock Cell\",\r\n   s_loc_major_sort: \"Major Sort\",\r\n   s_loc_manual: \"Manual\",\r\n   s_loc_merge_cells: \"Merge/Unmerge Cells\",\r\n   s_loc_middle: \"Middle\",\r\n   s_loc_minor_sort: \"Minor Sort\",\r\n   s_loc_move_insert: \"Move Insert\",\r\n   s_loc_move_paste: \"Move Paste\",\r\n   s_loc_multiXline_input_box: \"Multi-line Input Box\",\r\n   s_loc_name: \"Name\",\r\n   s_loc_names: \"Names\",\r\n   s_loc_no_padding: \"No padding\",\r\n   s_loc_normal: \"Normal\",\r\n   s_loc_number: \"Number\",\r\n   s_loc_number_horizontal: \"Number Horizontal\",\r\n   s_loc_ok: \"OK\",\r\n   s_loc_padding: \"Padding\",\r\n   s_loc_page_name: \"Page Name\",\r\n   s_loc_paste: \"Paste\",\r\n   s_loc_paste_formats: \"Paste Formats\",\r\n   s_loc_plain_text: \"Plain Text\",\r\n   s_loc_recalc: \"Recalc\",\r\n   s_loc_recalculation: \"Recalculation\",\r\n   s_loc_redo: \"Redo\",\r\n   s_loc_right: \"Right\",\r\n   s_loc_right_border: \"Right Border\",\r\n   s_loc_sheet_settings: \"SHEET SETTINGS\",\r\n   s_loc_save: \"Save\",\r\n   s_loc_save_to: \"Save to\",\r\n   s_loc_set_cell_contents: \"Set Cell Contents\",\r\n   s_loc_set_cells_to_sort: \"Set Cells To Sort\",\r\n   s_loc_set_value_to: \"Set Value To\",\r\n   s_loc_set_to_link_format: \"Set to Link format\",\r\n   s_loc_setXclear_move_from: \"Set/Clear Move From\",\r\n   s_loc_show_cell_settings: \"Show Cell Settings\",\r\n   s_loc_show_sheet_settings: \"Show Sheet Settings\",\r\n   s_loc_show_in_new_browser_window: \"Show in new browser window\",\r\n   s_loc_size: \"Size\",\r\n   s_loc_socialcalcXsave_format: \"SocialCalc-save format\",\r\n   s_loc_sort: \"Sort\",\r\n   s_loc_sort_: \"Sort \",\r\n   s_loc_sort_cells: \"Sort Cells\",\r\n   s_loc_swap_colors: \"Swap Colors\",\r\n   s_loc_tabXdelimited_format: \"Tab-delimited format\",\r\n   s_loc_text: \"Text\",\r\n   s_loc_text_horizontal: \"Text Horizontal\",\r\n   s_loc_this_is_aXbrXsample: \"This is a<br>sample\",\r\n   s_loc_top: \"Top\",\r\n   s_loc_top_border: \"Top Border\",\r\n   s_loc_undone_steps: \"UNDONE STEPS\",\r\n   s_loc_url: \"URL\",\r\n   s_loc_undo: \"Undo\",\r\n   s_loc_unlock_cell: \"Unlock Cell\",\r\n   s_loc_unmerge_cells: \"Unmerge Cells\",\r\n   s_loc_up: \"Up\",\r\n   s_loc_value: \"Value\",\r\n   s_loc_vertical: \"Vertical\",\r\n   s_loc_wikitext: \"Wikitext\",\r\n   s_loc_workspace: \"Workspace\",\r\n   s_loc_XnewX: \"[New]\",\r\n   s_loc_XnoneX: \"[None]\",\r\n   s_loc_Xselect_rangeX: \"[select range]\",\r\n\r\n//\r\n// SocialCalc Spreadsheet Viewer module, socialcalcviewer.js:\r\n//\r\n\r\n   //*** SocialCalc.SpreadsheetViewer\r\n\r\n   SVStatuslineheight: 20, // in pixels\r\n   SVStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\r\n\r\n//\r\n// SocialCalc Format Number module, formatnumber2.js:\r\n//\r\n\r\n   FormatNumber_separatorchar: \",\", // the thousands separator character when formatting numbers for display\r\n   FormatNumber_decimalchar: \".\", // the decimal separator character when formatting numbers for display\r\n   FormatNumber_defaultCurrency: \"$\", // the currency string used if none specified\r\n\r\n   // The following constants are arrays of strings with the short (3 character) and full names of days and months\r\n\r\n   s_FormatNumber_daynames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n   s_FormatNumber_daynames3: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\r\n   s_FormatNumber_monthnames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\r\n                                      \"October\", \"November\", \"December\"],\r\n   s_FormatNumber_monthnames3: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n   s_FormatNumber_am: \"AM\",\r\n   s_FormatNumber_am1: \"A\",\r\n   s_FormatNumber_pm: \"PM\",\r\n   s_FormatNumber_pm1: \"P\",\r\n\r\n//\r\n// SocialCalc Spreadsheet Formula module, formula1.js:\r\n//\r\n\r\n   s_parseerrexponent: \"Improperly formed number exponent\",\r\n   s_parseerrchar: \"Unexpected character in formula\",\r\n   s_parseerrstring: \"Improperly formed string\",\r\n   s_parseerrspecialvalue: \"Improperly formed special value\",\r\n   s_parseerrtwoops: \"Error in formula (two operators inappropriately in a row)\",\r\n   s_parseerrmissingopenparen: \"Missing open parenthesis in list with comma(s). \",\r\n   s_parseerrcloseparennoopen: \"Closing parenthesis without open parenthesis. \",\r\n   s_parseerrmissingcloseparen: \"Missing close parenthesis. \",\r\n   s_parseerrmissingoperand: \"Missing operand. \",\r\n   s_parseerrerrorinformula: \"Error in formula.\",\r\n   s_calcerrerrorvalueinformula: \"Error value in formula\",\r\n   s_parseerrerrorinformulabadval: \"Error in formula resulting in bad value\",\r\n   s_formularangeresult: \"Formula results in range value:\",\r\n   s_calcerrnumericnan: \"Formula results in an bad numeric value\",\r\n   s_calcerrnumericoverflow: \"Numeric overflow\",\r\n   s_sheetunavailable: \"Sheet unavailable:\", // when FindSheetInCache returns null\r\n   s_calcerrcellrefmissing: \"Cell reference missing when expected.\",\r\n   s_calcerrsheetnamemissing: \"Sheet name missing when expected.\",\r\n   s_circularnameref: \"Circular name reference to name\",\r\n   s_calcerrunknownname: \"Unknown name\",\r\n   s_calcerrincorrectargstofunction: \"Incorrect arguments to function\",\r\n   s_sheetfuncunknownfunction: \"Unknown function\",\r\n   s_sheetfunclnarg: \"LN argument must be greater than 0\",\r\n   s_sheetfunclog10arg: \"LOG10 argument must be greater than 0\",\r\n   s_sheetfunclogsecondarg: \"LOG second argument must be numeric greater than 0\",\r\n   s_sheetfunclogfirstarg: \"LOG first argument must be greater than 0\",\r\n   s_sheetfuncroundsecondarg: \"ROUND second argument must be numeric\",\r\n   s_sheetfuncddblife: \"DDB life must be greater than 1\",\r\n   s_sheetfuncslnlife: \"SLN life must be greater than 1\",\r\n\r\n   // Function definition text\r\n\r\n   s_fdef_ABS: 'Absolute value function. ',\r\n   s_fdef_ACOS: 'Trigonometric arccosine function. ',\r\n   s_fdef_AND: 'True if all arguments are true. ',\r\n   s_fdef_ASIN: 'Trigonometric arcsine function. ',\r\n   s_fdef_ATAN: 'Trigonometric arctan function. ',\r\n   s_fdef_ATAN2: 'Trigonometric arc tangent function (result is in radians). ',\r\n   s_fdef_AVERAGE: 'Averages the values. ',\r\n   s_fdef_CHOOSE: 'Returns the value specified by the index. The values may be ranges of cells. ',\r\n   s_fdef_COLUMNS: 'Returns the number of columns in the range. ',\r\n   s_fdef_COS: 'Trigonometric cosine function (value is in radians). ',\r\n   s_fdef_CONCAT: 'Join Together Text & Values to Create a Single Combined Text String. ',\r\n   s_fdef_CONCATENATE: 'Join Together Text & Values to Create a Single Combined Text String. ',\r\n   s_fdef_COUNT: 'Counts the number of numeric values, not blank, text, or error. ',\r\n   s_fdef_COUNTA: 'Counts the number of non-blank values. ',\r\n   s_fdef_COUNTBLANK: 'Counts the number of blank values. (Note: \"\" is not blank.) ',\r\n   s_fdef_COUNTIF: 'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). ',\r\n   s_fdef_DATE: 'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\r\n   s_fdef_DAVERAGE: 'Averages the values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DAY: 'Returns the day of month for a date value. ',\r\n   s_fdef_DCOUNT: 'Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ',\r\n   s_fdef_DCOUNTA: 'Counts the number of non-blank values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DDB: 'Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ',\r\n   s_fdef_DEGREES: 'Converts value in radians into degrees. ',\r\n   s_fdef_DGET: 'Returns the value of the specified field in the single record that meets the criteria. ',\r\n   s_fdef_DMAX: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DMIN: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DPRODUCT: 'Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSTDEV: 'Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSTDEVP: 'Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSUM: 'Returns the sum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DVAR: 'Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DVARP: 'Returns the variance of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_EVEN: 'Rounds the value up in magnitude to the nearest even integer. ',\r\n   s_fdef_EXACT: 'Returns \"true\" if the values are exactly the same, including case, type, etc. ',\r\n   s_fdef_EXP: 'Returns e raised to the value power. ',\r\n   s_fdef_FACT: 'Returns factorial of the value. ',\r\n   s_fdef_FALSE: 'Returns the logical value \"false\". ',\r\n   s_fdef_FIND: 'Returns the starting position within string2 of the first occurrence of string1 at or after \"start\". If start is omitted, 1 is assumed. ',\r\n   s_fdef_FV: 'Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_HLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ',\r\n   s_fdef_HOUR: 'Returns the hour portion of a time or date/time value. ',\r\n   s_fdef_IF: 'Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ',\r\n   s_fdef_INDEX: 'Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ',\r\n   s_fdef_INT: 'Returns the value rounded down to the nearest integer (towards -infinity). ',\r\n   s_fdef_IRR: 'Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\r\n   s_fdef_ISBLANK: 'Returns \"true\" if the value is a reference to a blank cell. ',\r\n   s_fdef_ISERR: 'Returns \"true\" if the value is of type \"Error\" but not \"NA\". ',\r\n   s_fdef_ISERROR: 'Returns \"true\" if the value is of type \"Error\". ',\r\n   s_fdef_ISLOGICAL: 'Returns \"true\" if the value is of type \"Logical\" (true/false). ',\r\n   s_fdef_ISNA: 'Returns \"true\" if the value is the error type \"NA\". ',\r\n   s_fdef_ISNONTEXT: 'Returns \"true\" if the value is not of type \"Text\". ',\r\n   s_fdef_ISNUMBER: 'Returns \"true\" if the value is of type \"Number\" (including logical values). ',\r\n   s_fdef_ISTEXT: 'Returns \"true\" if the value is of type \"Text\". ',\r\n   s_fdef_LEFT: 'Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ',\r\n   s_fdef_LEN: 'Returns the number of characters in the text value. ',\r\n   s_fdef_LN: 'Returns the natural logarithm of the value. ',\r\n   s_fdef_LOG: 'Returns the logarithm of the value using the specified base. ',\r\n   s_fdef_LOG10: 'Returns the base 10 logarithm of the value. ',\r\n   s_fdef_LOWER: 'Returns the text value with all uppercase characters converted to lowercase. ',\r\n   s_fdef_MATCH: 'Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ',\r\n   s_fdef_MAX: 'Returns the maximum of the numeric values. ',\r\n   s_fdef_MID: 'Returns the specified number of characters from the text value starting from the specified position. ',\r\n   s_fdef_MIN: 'Returns the minimum of the numeric values. ',\r\n   s_fdef_MINUTE: 'Returns the minute portion of a time or date/time value. ',\r\n   s_fdef_MOD: 'Returns the remainder of the first value divided by the second. ',\r\n   s_fdef_MONTH: 'Returns the month part of a date value. ',\r\n   s_fdef_N: 'Returns the value if it is a numeric value otherwise an error. ',\r\n   s_fdef_NA: 'Returns the #N/A error value which propagates through most operations. ',\r\n   s_fdef_NOT: 'Returns FALSE if value is true, and TRUE if it is false. ',\r\n   s_fdef_NOW: 'Returns the current date/time. ',\r\n   s_fdef_NPER: 'Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ',\r\n   s_fdef_NPV: 'Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ',\r\n   s_fdef_ODD: 'Rounds the value up in magnitude to the nearest odd integer. ',\r\n   s_fdef_OR: 'True if any argument is true ',\r\n   s_fdef_PI: 'The value 3.1415926... ',\r\n   s_fdef_PMT: 'Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_POWER: 'Returns the first value raised to the second value power. ',\r\n   s_fdef_PRODUCT: 'Returns the result of multiplying the numeric values. ',\r\n   s_fdef_PROPER: 'Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ',\r\n   s_fdef_PV: 'Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_RADIANS: 'Converts value in degrees into radians. ',\r\n   s_fdef_RATE: 'Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\r\n   s_fdef_REPLACE: 'Returns text1 with the specified number of characters starting from the specified position replaced by text2. ',\r\n   s_fdef_REPT: 'Returns the text repeated the specified number of times. ',\r\n   s_fdef_RIGHT: 'Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ',\r\n   s_fdef_ROUND: 'Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ',\r\n   s_fdef_ROWS: 'Returns the number of rows in the range. ',\r\n   s_fdef_SECOND: 'Returns the second portion of a time or date/time value (truncated to an integer). ',\r\n   s_fdef_SIN: 'Trigonometric sine function (value is in radians) ',\r\n   s_fdef_SLN: 'Returns the amount of depreciation at each period of time using the straight-line method. ',\r\n   s_fdef_SQRT: 'Square root of the value ',\r\n   s_fdef_STDEV: 'Returns the sample standard deviation of the numeric values. ',\r\n   s_fdef_STDEVP: 'Returns the standard deviation of the numeric values. ',\r\n   s_fdef_SUBSTITUTE: 'Returns text1 with the all occurrences of oldtext replaced by newtext. If \"occurrence\" is present, then only that occurrence is replaced. ',\r\n   s_fdef_SUM: 'Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ',\r\n   s_fdef_SUMIF: 'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',\r\n   s_fdef_SYD: 'Depreciation by Sum of Year\\'s Digits method. ',\r\n   s_fdef_T: 'Returns the text value or else a null string. ',\r\n   s_fdef_TAN: 'Trigonometric tangent function (value is in radians) ',\r\n   s_fdef_TIME: 'Returns the time value given the specified hour, minute, and second. ',\r\n   s_fdef_TODAY: 'Returns the current date (an integer). Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\r\n   s_fdef_TRIM: 'Returns the text value with leading, trailing, and repeated spaces removed. ',\r\n   s_fdef_TRUE: 'Returns the logical value \"true\". ',\r\n   s_fdef_TRUNC: 'Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ',\r\n   s_fdef_UPPER: 'Returns the text value with all lowercase characters converted to uppercase. ',\r\n   s_fdef_VALUE: 'Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ',\r\n   s_fdef_VAR: 'Returns the sample variance of the numeric values. ',\r\n   s_fdef_VARP: 'Returns the variance of the numeric values. ',\r\n   s_fdef_VLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ',\r\n   s_fdef_WEEKDAY: 'Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ',\r\n   s_fdef_YEAR: 'Returns the year part of a date value. ',\r\n   s_fdef_SUMPRODUCT: 'Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.',\r\n   s_fdef_CEILING: 'Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)',\r\n   s_fdef_FLOOR: 'Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)',\r\n\r\n   s_farg_v: \"value\",\r\n   s_farg_vn: \"value1, value2, ...\",\r\n   s_farg_xy: \"valueX, valueY\",\r\n   s_farg_choose: \"index, value1, value2, ...\",\r\n   s_farg_range: \"range\",\r\n   s_farg_rangec: \"range, criteria\",\r\n   s_farg_date: \"year, month, day\",\r\n   s_farg_dfunc: \"databaserange, fieldname, criteriarange\",\r\n   s_farg_ddb: \"cost, salvage, lifetime, period, [factor]\",\r\n   s_farg_find: \"string1, string2, [start]\",\r\n   s_farg_fv: \"rate, n, payment, [pv, [paytype]]\",\r\n   s_farg_hlookup: \"value, range, row, [rangelookup]\",\r\n   s_farg_iffunc: \"logical-expression, true-value, [false-value]\",\r\n   s_farg_index: \"range, rownum, colnum\",\r\n   s_farg_irr: \"range, [guess]\",\r\n   s_farg_tc: \"text, count\",\r\n   s_farg_log: \"value, base\",\r\n   s_farg_match: \"value, range, [rangelookup]\",\r\n   s_farg_mid: \"text, start, length\",\r\n   s_farg_nper: \"rate, payment, pv, [fv, [paytype]]\",\r\n   s_farg_npv: \"rate, value1, value2, ...\",\r\n   s_farg_pmt: \"rate, n, pv, [fv, [paytype]]\",\r\n   s_farg_pv: \"rate, n, payment, [fv, [paytype]]\",\r\n   s_farg_rate: \"n, payment, pv, [fv, [paytype, [guess]]]\",\r\n   s_farg_replace: \"text1, start, length, text2\",\r\n   s_farg_vp: \"value, [precision]\",\r\n   s_farg_valpre: \"value, precision\",\r\n   s_farg_csl: \"cost, salvage, lifetime\",\r\n   s_farg_cslp: \"cost, salvage, lifetime, period\",\r\n   s_farg_subs: \"text1, oldtext, newtext, [occurrence]\",\r\n   s_farg_sumif: \"range1, criteria, [range2]\",\r\n   s_farg_hms: \"hour, minute, second\",\r\n   s_farg_txt: \"text\",\r\n   s_farg_vlookup: \"value, range, col, [rangelookup]\",\r\n   s_farg_weekday: \"date, [type]\",\r\n   s_farg_dt: \"date\",\r\n   s_farg_rangen: \"range1, range2, ...\",\r\n   s_farg_vsig: 'value, [significance]',\r\n\r\n   function_classlist: [\"all\", \"stat\", \"lookup\", \"datetime\", \"financial\", \"test\", \"math\", \"text\", \"gui\", \"action\"], // order of function classes\r\n\r\n   s_fclass_all: \"All\",\r\n   s_fclass_stat: \"Statistics\",\r\n   s_fclass_lookup: \"Lookup\",\r\n   s_fclass_datetime: \"Date & Time\",\r\n   s_fclass_financial: \"Financial\",\r\n   s_fclass_test: \"Test\",\r\n   s_fclass_math: \"Math\",\r\n   s_fclass_text: \"Text\",\r\n   s_fclass_action: \"Email & Copy\",\r\n   s_fclass_gui: \"Button & Input\",\r\n\r\n   lastone: null\r\n\r\n   };\r\n\r\n// Default classnames for use with SocialCalc.ConstantsSetClasses:\r\n\r\nSocialCalc.ConstantsDefaultClasses = {\r\n   defaultComment: \"\",\r\n   defaultCommentNoGrid: \"\",\r\n   defaultHighlightTypeCursor: \"\",\r\n   defaultHighlightTypeRange: \"\",\r\n   defaultColname: \"\",\r\n   defaultSelectedColname: \"\",\r\n   defaultRowname: \"\",\r\n   defaultSelectedRowname: \"\", \r\n   defaultUpperLeft: \"\",\r\n   defaultSkippedCell: \"\",\r\n   defaultPaneDivider: \"\",\r\n   cteGriddiv: \"\", // this one has no Style version with it\r\n   defaultInputEcho: {classname: \"\", style: \"filter:alpha(opacity=90);opacity:.9;\"}, // so FireFox won't show warning\r\n   TCmain: \"\",\r\n   TCendcap: \"\",\r\n   TCpaneslider: \"\",\r\n   TClessbutton: \"\",\r\n   TCmorebutton: \"\",\r\n   TCscrollarea: \"\",\r\n   TCthumb: \"\",\r\n   TCPStrackingline: \"\",\r\n   TCTDFSthumbstatus: \"\",\r\n   TDpopupElement: \"\"\r\n   };\r\n\r\n//\r\n// SocialCalc.ConstantsSetClasses(prefix)\r\n//\r\n// This routine goes through all of the xyzClass/xyzStyle pairs and sets the Class to a default and\r\n// turns off the Style, if present. The prefix is put before each default.\r\n// The list of items to set is in SocialCalc.ConstantsDefaultClasses. The names there\r\n// correspond to the \"xyz\" parts. If there is a value, it is the default to set. If the\r\n// default is a null, no change is made. If the default is the null string (\"\"), the\r\n// name of the item is used (e.g., \"defaultComment\" would use the classname \"defaultComment\").\r\n// If the default is an object, then it expects {classname: classname, style: stylestring} - this\r\n// lets you combine both.\r\n//\r\n\r\nSocialCalc.ConstantsSetClasses = function(prefix) {\r\n\r\n   var defaults = SocialCalc.ConstantsDefaultClasses;\r\n   var scc = SocialCalc.Constants;\r\n   var item;\r\n\r\n   prefix = prefix || \"\";\r\n\r\n   for (item in defaults) {\r\n      if (typeof defaults[item] == \"string\") {\r\n         scc[item+\"Class\"] = prefix + (defaults[item] || item);\r\n         if (scc[item+\"Style\"] !== undefined) {\r\n            scc[item+\"Style\"] = \"\";\r\n            }\r\n         }\r\n      else if (typeof defaults[item] == \"object\") {\r\n         scc[item+\"Class\"] = prefix + (defaults[item].classname || item);\r\n         scc[item+\"Style\"] = defaults[item].style;\r\n         }\r\n      }\r\n   }\r\n\r\n// Set the image prefix on all images.\r\n\r\nSocialCalc.ConstantsSetImagePrefix = function(imagePrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   for (var item in scc) {\r\n      if (typeof scc[item] == \"string\") {\r\n         scc[item] = scc[item].replace(scc.defaultImagePrefix, imagePrefix);\r\n         }\r\n      }\r\n   scc.defaultImagePrefix = imagePrefix;\r\n\r\n   }\r\n\r\n//\r\n// The main SocialCalc code module of the SocialCalc package\r\n//\r\n/*\r\n// (c) Copyright 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of\r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n \r\n/*\r\n\r\n**** Overview ****\r\n\r\nThis is the beginning of a library of routines for displaying and editing spreadsheet\r\ndata in a browser. The HTML that includes this does not need to have anything\r\nspecific to the spreadsheet or editor already present -- everything is dynamically\r\nadded to the DOM by this code, including the rendered sheet and any editing controls.\r\n\r\nThe library has a few parts. This is the main SocialCalc code module.\r\nOther parts are the Table Editor module, the Formula module, and the Format Number module.\r\nNote: The Table Editor module is licensed under a different license than this module.\r\n\r\nThe class/object style is derived from O'Reilly's JavaScript by Flanagan, 5th Edition,\r\nsection 9.3, page 157.\r\n\r\nAll of the data, object definitions, functions, etc., are stored as properties of the SocialCalc\r\nobject so as not to clutter up the global variables nor conflict with other names.\r\n\r\nA design goal (not tested yet for success) is to make it possible to have more than one\r\nspreadsheet active on a page, perhaps even open for editing. It is assumed, though, that\r\nthere is only one mouse and one keyboard (a good assumption on most PCs today but not in the\r\nnew \"touch and surface world\" Apple and Microsoft are working towards).\r\n\r\nThe testing has been on Windows Firefox (2 and 3),\r\nInternet Explorer (6 and 7), Opera (9.23 and mainly later), Mac Safari (3.1), and Mac Firefox (2.0.0.6).\r\nThere are small issues with Firefox before 2.0 (cosmetic with drag handles) and larger ones\r\nwith Opera before 9.5 (the Delete key isn't recognized in some cases -- the 9.5 version was still\r\nin beta and this bug affects other products like GMail, I believe).\r\n\r\nThe data is stored in a SocialCalc.Sheet object. The data is organized in a form similar to that\r\nused by SocialCalc 1.1.0. There is a function for converting a normal SocialCalc spreadsheet\r\nsave data string (the spreadsheet part of a SocialCalc data file) into this internal form.\r\n\r\nThe SocialCalc.RenderContext class provides methods for rendering a table into the DOM representing\r\npart of the spreadsheet. It is assumed that the spreadsheet could possibly be very large\r\nand that rendering the whole thing at once could be too time consuming. It is also set up so\r\nthat it might be possible to have some of the sheet data only be loaded on demand (such as by Ajax).\r\nThe rendering can render cells to the right and below the already active area of the spreadsheet\r\nso that you can scroll to that \"clean\" area without explicitly doing \"add row/column\". The class also\r\ndoes simple operations such as \"scrolling\" within that table. The table may optionally include\r\nrow and column headers and may be split into panes. Most of the code assumes any number of panes,\r\nbut only the rightmost pane has scrolling code. In normal operation there would be one or two\r\npanes horizontally and vertically. The panes may start on any row/column, though a given row/column\r\nshould only appear in one pane at a time (not all code enforces this, yet).\r\n\r\nThe RenderContext is designed to be rendered as part of a SocialCalc.TableEditor. The TableEditor\r\nincludes the spreadsheet grid as well as scrollbars, pane sliders, and (eventually) editing controls.\r\nThe layout is dynamic and may be recomputed on the fly, such as in response to resizing the browser\r\nwindow.\r\n\r\nThe scrollbars and pane sliders are created using SocialCalc.TableControl objects. These in turn\r\nmake use of Dragging, ToolTip, Button, and MouseWheel functions.\r\n\r\nThe keyboard input is handled by keyboard code.\r\n\r\nThere are also some helper routines.\r\n\r\nMore comments yet to come...\r\n\r\n*/\r\n\r\n\r\nvar SocialCalc;\r\nif (!SocialCalc) SocialCalc = {};\r\n\r\n// *************************************\r\n//\r\n// Shared values\r\n//\r\n// These are \"global\" values shared by the classes, including default settings\r\n//\r\n// *************************************\r\n\r\n// Callbacks\r\n\r\nSocialCalc.Callbacks = {\r\n\r\n   // The next two are used by SocialCalc.format_text_for_display\r\n\r\n   // The function to expand wiki text - should be set if you want wikitext expansion\r\n   // The form is: expand_wiki(displayvalue, sheetobj, linkstyle, valueformat)\r\n   //    valueformat is text-wiki followed by optional sub-formats, e.g., text-wikipagelink\r\n\r\n   expand_wiki: null,\r\n\r\n   expand_markup: function(displayvalue, sheetobj, linkstyle) // the old function to expand wiki text - may be replaced\r\n                   {return SocialCalc.default_expand_markup(displayvalue, sheetobj, linkstyle);},\r\n\r\n   // MakePageLink is used to create the href for a link to another \"page\"\r\n   // The form is: MakePageLink(pagename, workspacename, linktyle, valueformat), returns string\r\n\r\n   MakePageLink: null,\r\n\r\n   // NormalizeSheetName is used to make different variations of sheetnames use the same cache slot\r\n\r\n   NormalizeSheetName: null // use default - lowercase\r\n\r\n   };\r\n\r\n// Shared flags\r\n\r\n   // none at present\r\n\r\n\r\n// *************************************\r\n//\r\n// Cell class:\r\n//\r\n// *************************************\r\n\r\n//\r\n// Class SocialCalc.Cell\r\n//\r\n// Usage: var s = new SocialCalc.Cell(coord);\r\n//\r\n// Cell attributes include:\r\n//\r\n//    coord: the column/row as a string, e.g., \"A1\"\r\n//    datavalue: the value to be used for computation and formatting for display,\r\n//               string or numeric (tolerant of numbers stored as strings)\r\n//    datatype: if present, v=numeric value, t=text value, f=formula,\r\n//              or c=constant that is not a simple number (like \"$1.20\")\r\n//    formula: if present, the formula (without leading \"=\") for computation or the constant\r\n//    valuetype: first char is main type, the following are sub-types.\r\n//               Main types are b=blank cell, n=numeric, t=text, e=error\r\n//               Examples of using sub-types would be \"nt\" for a numeric time value, \"n$\" for currency, \"nl\" for logical\r\n//    readonly: if present, whether the current cell is read-only of writable\r\n//    displayvalue: if present, rendered version of datavalue with formatting attributes applied\r\n//    parseinfo: if present, cached parsed version of formula\r\n//\r\n//    The following optional values, if present, are mainly used in rendering, overriding defaults:\r\n//\r\n//    bt, br, bb, bl: number of border's definition\r\n//    layout: layout (vertical alignment, padding) definition number\r\n//    font: font definition number\r\n//    color: text color definition number\r\n//    bgcolor: background color definition number\r\n//    cellformat: cell format (horizontal alignment) definition number\r\n//    nontextvalueformat: custom format definition number for non-text values, e.g., numbers\r\n//    textvalueformat: custom format definition number for text values\r\n//    colspan, rowspan: number of cells to span for merged cells (only on main cell)\r\n//    cssc: custom css classname for cell, as text (no special chars)\r\n//    csss: custom css style definition\r\n//    mod: modification allowed flag \"y\" if present\r\n//    comment: cell comment string\r\n//\r\n\r\n// Eddy - SocialCalc.Cell\r\n\r\nSocialCalc.Cell = function(coord) {\r\n\r\n   this.coord = coord;\r\n   this.datavalue = \"\";\r\n   this.datatype = null;\r\n   this.formula = \"\";\r\n   this.valuetype = \"b\";\r\n   this.readonly = false;\r\n\r\n   }\r\n\r\n// The types of cell properties\r\n//\r\n// Type 1: Base, Type 2: Attribute, Type 3: Special (e.g., displaystring, parseinfo)\r\n\r\nSocialCalc.CellProperties = {\r\n   coord: 1, datavalue: 1, datatype: 1, formula: 1, valuetype: 1, errors: 1, comment: 1, readonly: 1,\r\n   bt: 2, br: 2, bb: 2, bl: 2, layout: 2, font: 2, color: 2, bgcolor: 2,\r\n   cellformat: 2, nontextvalueformat: 2, textvalueformat: 2, colspan: 2, rowspan: 2,\r\n   cssc: 2, csss: 2, mod: 2,\r\n   displaystring: 3, // used to cache rendered HTML of cell contents\r\n   parseinfo: 3, // used to cache parsed formulas\r\n   hcolspan: 3, hrowspan: 3 // spans taking hidden cols/rows into account (!!! NOT YET !!!)\r\n   };\r\n\r\nSocialCalc.CellPropertiesTable = {\r\n   bt: \"borderstyle\", br: \"borderstyle\", bb: \"borderstyle\", bl: \"borderstyle\",\r\n   layout: \"layout\", font: \"font\", color: \"color\", bgcolor: \"color\",\r\n   cellformat: \"cellformat\", nontextvalueformat: \"valueformat\", textvalueformat: \"valueformat\"\r\n   };\r\n\r\n// *************************************\r\n//\r\n// Sheet class:\r\n//\r\n// *************************************\r\n\r\n//\r\n// Class SocialCalc.Sheet\r\n//\r\n// Usage: var s = new SocialCalc.Sheet();\r\n//\r\n\r\nSocialCalc.Sheet = function() {\r\n\r\n   SocialCalc.ResetSheet(this);\r\n\r\n   // Set other values:\r\n   //\r\n   // sheet.statuscallback(data, status, arg, this.statuscallbackparams) is called\r\n   // during recalc and commands.\r\n   //\r\n   // During recalc, data is the current recalcdata.\r\n   // The values for status and the corresponding arg are:\r\n   //\r\n   //    calcorder, {coord: coord, total: celllist length, count: count} [0 or more times per recalc]\r\n   //    calccheckdone, calclist length [once per recalc]\r\n   //    calcstep, {coord: coord, total: calclist length, count: count} [0 or more times per recalc]\r\n   //    calcloading, {sheetname: name-of-sheet}\r\n   //    calcserverfunc, {funcname: name-of-function, coord: coord, total: calclist length, count: count}\r\n   //    calcfinished, time in milliseconds [once per recalc]\r\n   //\r\n   // During commands, data is SocialCalc.SheetCommandInfo.\r\n   // These values for status and arg are:\r\n   //\r\n   //    cmdstart, cmdstr\r\n   //    cmdend\r\n   //\r\n\r\n   this.statuscallback = null; // routine called with cmdstart, calcstart, etc., status and args:\r\n                                // sheet.statuscallback(data, status, arg, params)\r\n   this.statuscallbackparams = null; // parameters passed to that routine\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.ResetSheet(sheet)\r\n//\r\n// Resets (and/or initializes) sheet data values.\r\n// \r\n\r\nSocialCalc.ResetSheet = function(sheet, reload) {\r\n\r\n   // properties:\r\n\r\n   sheet.cells = {}; // at least one for each non-blank cell: coord: cell-object\r\n   sheet.attribs = // sheet attributes\r\n      {\r\n         lastcol: 1,\r\n         lastrow: 1,\r\n         defaultlayout: 0,\r\n         usermaxcol: 0,\r\n         usermaxrow: 0\r\n\r\n      };\r\n   sheet.rowattribs =\r\n      {\r\n         hide: {}, // access by row number\r\n         height: {}\r\n      };\r\n   sheet.colattribs =\r\n      {\r\n         width: {}, // access by col name\r\n         hide: {}\r\n      };\r\n   sheet.names={}; // Each is: {desc: \"optional description\", definition: \"B5, A1:B7, or =formula\"}\r\n   sheet.layouts=[];\r\n   sheet.layouthash={};\r\n   sheet.fonts=[];\r\n   sheet.fonthash={};\r\n   sheet.colors=[];\r\n   sheet.colorhash={};\r\n   sheet.borderstyles=[];\r\n   sheet.borderstylehash={};\r\n   sheet.cellformats=[];\r\n   sheet.cellformathash={};\r\n   sheet.valueformats=[];\r\n   sheet.valueformathash={};\r\n   sheet.matched_cells=[];\r\n   sheet.selected_search_cell=undefined;\r\n\r\n   sheet.copiedfrom = \"\"; // if a range, then this was loaded from a saved range as clipboard content\r\n\r\n   sheet.changes = new SocialCalc.UndoStack();\r\n\r\n   sheet.renderneeded = false;\r\n\r\n   sheet.changedrendervalues = true; // if true, spans and/or fonts have changed (set by ExecuteSheetCommand & GetStyle)\r\n\r\n   sheet.recalcchangedavalue = false; // true if a recalc resulted in a change to a cell's calculated value\r\n\r\n   sheet.hiddencolrow = \"\"; // \"col\" or \"row\" if it was hidden\r\n\r\n   sheet.sci = new SocialCalc.SheetCommandInfo(sheet);\r\n\r\n   sheet.ioEventTree ={};\r\n   sheet.ioParameterList = {}; \r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.Sheet.prototype.ResetSheet = function() {SocialCalc.ResetSheet(this);};\r\nSocialCalc.Sheet.prototype.AddCell = function(newcell) {return this.cells[newcell.coord]=newcell;};\r\nSocialCalc.Sheet.prototype.LastCol = function() { \r\n    var last_col = 1;\r\n    for (var cell_id  in this.cells) {\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (cr.col > last_col) {\r\n            last_col = cr.col;\r\n        }\r\n    }\r\n    return last_col;\r\n}\r\nSocialCalc.Sheet.prototype.LastRow = function() { \r\n    var last_row = 1;\r\n    for (var cell_id  in this.cells) {\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (cr.row > last_row) {\r\n            last_row = cr.row;\r\n        }\r\n    }\r\n    return last_row;\r\n} \r\nSocialCalc.Sheet.prototype.GetAssuredCell = function(coord) {\r\n   return this.cells[coord] || this.AddCell(new SocialCalc.Cell(coord));\r\n   };\r\nSocialCalc.Sheet.prototype.ParseSheetSave = function(savedsheet) {SocialCalc.ParseSheetSave(savedsheet,this);};\r\nSocialCalc.Sheet.prototype.CellFromStringParts = function(cell, parts, j) {return SocialCalc.CellFromStringParts(this, cell, parts, j);};\r\nSocialCalc.Sheet.prototype.CreateSheetSave = function(range, canonicalize) {return SocialCalc.CreateSheetSave(this, range, canonicalize);};\r\nSocialCalc.Sheet.prototype.CellToString = function(cell) {return SocialCalc.CellToString(this, cell);};\r\nSocialCalc.Sheet.prototype.CanonicalizeSheet = function(full) {return SocialCalc.CanonicalizeSheet(this, full);};\r\nSocialCalc.Sheet.prototype.EncodeCellAttributes = function(coord) {return SocialCalc.EncodeCellAttributes(this, coord);};\r\nSocialCalc.Sheet.prototype.EncodeSheetAttributes = function() {return SocialCalc.EncodeSheetAttributes(this);};\r\nSocialCalc.Sheet.prototype.DecodeCellAttributes = function(coord, attribs, range) {return SocialCalc.DecodeCellAttributes(this, coord, attribs, range);};\r\nSocialCalc.Sheet.prototype.DecodeSheetAttributes = function(attribs) {return SocialCalc.DecodeSheetAttributes(this, attribs);};\r\n\r\nSocialCalc.Sheet.prototype.ScheduleSheetCommands = function(cmd, saveundo) {return SocialCalc.ScheduleSheetCommands(this, cmd, saveundo);};\r\nSocialCalc.Sheet.prototype.SheetUndo = function() {return SocialCalc.SheetUndo(this);};\r\nSocialCalc.Sheet.prototype.SheetRedo = function() {return SocialCalc.SheetRedo(this);};\r\nSocialCalc.Sheet.prototype.CreateAuditString = function() {return SocialCalc.CreateAuditString(this);};\r\nSocialCalc.Sheet.prototype.GetStyleNum = function(atype, style) {return SocialCalc.GetStyleNum(this, atype, style);};\r\nSocialCalc.Sheet.prototype.GetStyleString = function(atype, num) {return SocialCalc.GetStyleString(this, atype, num);};\r\nSocialCalc.Sheet.prototype.RecalcSheet = function() {return SocialCalc.RecalcSheet(this);};\r\n\r\n//\r\n// Sheet save format:\r\n//\r\n// linetype:param1:param2:...\r\n//\r\n// Linetypes are:\r\n//\r\n//    version:versionname - version of this format. Currently 1.5.\r\n//\r\n//    cell:coord:type:value...:type:value... - Types are as follows:\r\n//\r\n//       v:value - straight numeric value\r\n//       t:value - straight text/wiki-text in cell, encoded to handle \\, :, newlines\r\n//       vt:fulltype:value - value with value type/subtype\r\n//       vtf:fulltype:value:formulatext - formula resulting in value with value type/subtype, value and text encoded\r\n//       vtc:fulltype:value:valuetext - formatted text constant resulting in value with value type/subtype, value and text encoded\r\n//       vf:fvalue:formulatext - formula resulting in value, value and text encoded (obsolete: only pre format version 1.1)\r\n//          fvalue - first char is \"N\" for numeric value, \"T\" for text value, \"H\" for HTML value, rest is the value\r\n//       e:errortext - Error text. Non-blank means formula parsing/calculation results in error.\r\n//       b:topborder#:rightborder#:bottomborder#:leftborder# - border# in sheet border list or blank if none\r\n//       l:layout# - number in cell layout list\r\n//       f:font# - number in sheet fonts list\r\n//       c:color# - sheet color list index for text\r\n//       bg:color# - sheet color list index for background color\r\n//       cf:format# - sheet cell format number for explicit format (align:left, etc.)\r\n//       cvf:valueformat# - sheet cell value format number (obsolete: only pre format v1.2)\r\n//       tvf:valueformat# - sheet cell text value format number\r\n//       ntvf:valueformat# - sheet cell non-text value format number\r\n//       colspan:numcols - number of columns spanned in merged cell\r\n//       rowspan:numrows - number of rows spanned in merged cell\r\n//       cssc:classname - name of CSS class to be used for cell when published instead of one calculated here\r\n//       csss:styletext - explicit CSS style information, encoded to handle :, etc.\r\n//       mod:allow - if \"y\" allow modification of cell for live \"view\" recalc\r\n//       comment:value - encoded text of comment for this cell (added in v1.5)\r\n//\r\n//    col:\r\n//       w:widthval - number, \"auto\" (no width in <col> tag), number%, or blank (use default)\r\n//       hide: - yes/no, no is assumed if missing\r\n//    row:\r\n//       hide - yes/no, no is assumed if missing\r\n//\r\n//    sheet:\r\n//       c:lastcol - number\r\n//       r:lastrow - number\r\n//       w:defaultcolwidth - number, \"auto\", number%, or blank (default->80)\r\n//       h:defaultrowheight - not used\r\n//       tf:format# - cell format number for sheet default for text values\r\n//       ntf:format# - cell format number for sheet default for non-text values (i.e., numbers)\r\n//       layout:layout# - default cell layout number in cell layout list\r\n//       font:font# - default font number in sheet font list\r\n//       vf:valueformat# - default number value format number in sheet valueformat list (obsolete: only pre format version 1.2)\r\n//       ntvf:valueformat# - default non-text (number) value format number in sheet valueformat list\r\n//       tvf:valueformat# - default text value format number in sheet valueformat list\r\n//       color:color# - default number for text color in sheet color list\r\n//       bgcolor:color# - default number for background color in sheet color list\r\n//       circularreferencecell:coord - cell coord with a circular reference\r\n//       recalc:value - on/off (on is default). If not \"off\", appropriate changes to the sheet cause a recalc\r\n//       needsrecalc:value - yes/no (no is default). If \"yes\", formula values are not up to date\r\n//       usermaxcol:value - maximum column to display, 0 for unlimited (default=0)\r\n//       usermaxrow:value - maximum row to display, 0 for unlimited (default=0)\r\n//\r\n//    name:name:description:value - name definition, name in uppercase, with value being \"B5\", \"A1:B7\", or \"=formula\";\r\n//                                  description and value are encoded.\r\n//    font:fontnum:value - text of font definition (style weight size family) for font fontnum\r\n//                         \"*\" for \"style weight\", size, or family, means use default (first look to sheet, then builtin)\r\n//    color:colornum:rgbvalue - text of color definition (e.g., rgb(255,255,255)) for color colornum\r\n//    border:bordernum:value - text of border definition (thickness style color) for border bordernum\r\n//    layout:layoutnum:value - text of vertical alignment and padding style for cell layout layoutnum (* for default):\r\n//                             vertical-alignment:vavalue;padding:topval rightval bottomval leftval;\r\n//    cellformat:cformatnum:value - text of cell alignment (left/center/right) for cellformat cformatnum\r\n//    valueformat:vformatnum:value - text of number format (see FormatValueForDisplay) for valueformat vformatnum (changed in v1.2)\r\n//    clipboardrange:upperleftcoord:bottomrightcoord - ignored -- from wikiCalc\r\n//    clipboard:coord:type:value:... - ignored -- from wikiCalc\r\n//\r\n// If this is clipboard contents, then there is also information to facilitate pasting:\r\n//\r\n//    copiedfrom:upperleftcoord:bottomrightcoord - range from which this was copied\r\n//\r\n\r\n// Functions:\r\n\r\nSocialCalc.ParseSheetSave = function(savedsheet,sheetobj) {\r\n\r\n   var lines=savedsheet.split(/\\r\\n|\\n/);\r\n   var parts=[];\r\n   var line;\r\n   var i, j, t, v, coord, cell, attribs, name;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      parts = line.split(\":\");\r\n      switch (parts[0]) {\r\n         case \"cell\":\r\n            cell=sheetobj.GetAssuredCell(parts[1]);\r\n            j=2;\r\n            sheetobj.CellFromStringParts(cell, parts, j);\r\n            break;\r\n\r\n         case \"col\":\r\n            coord=parts[1];\r\n            j=2;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"w\":\r\n                     sheetobj.colattribs.width[coord]=parts[j++]; // must be text - could be auto or %, etc.\r\n                     break;\r\n                  case \"hide\":\r\n                     sheetobj.colattribs.hide[coord]=parts[j++];\r\n                     break;\r\n                  default:\r\n                     throw scc.s_pssUnknownColType+\" '\"+t+\"'\";\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"row\":\r\n            coord=parts[1]-0;\r\n            j=2;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"h\":\r\n                     sheetobj.rowattribs.height[coord]=parts[j++]-0;\r\n                     break;\r\n                  case \"hide\":\r\n                     sheetobj.rowattribs.hide[coord]=parts[j++];\r\n                     break;\r\n                  default:\r\n                     throw scc.s_pssUnknownRowType+\" '\"+t+\"'\";\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"sheet\":\r\n            attribs=sheetobj.attribs;\r\n            j=1;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"c\":\r\n                     attribs.lastcol=parts[j++]-0;\r\n                     break;\r\n                  case \"r\":\r\n                     attribs.lastrow=parts[j++]-0;\r\n                     break;\r\n                  case \"w\":\r\n                     attribs.defaultcolwidth=parts[j++]+\"\";\r\n                     break;\r\n                  case \"h\":\r\n                     attribs.defaultrowheight=parts[j++]-0;\r\n                     break;\r\n                  case \"tf\":\r\n                     attribs.defaulttextformat=parts[j++]-0;\r\n                     break;\r\n                  case \"ntf\":\r\n                     attribs.defaultnontextformat=parts[j++]-0;\r\n                     break;\r\n                  case \"layout\":\r\n                     attribs.defaultlayout=parts[j++]-0;\r\n                     break;\r\n                  case \"font\":\r\n                     attribs.defaultfont=parts[j++]-0;\r\n                     break;\r\n                  case \"tvf\":\r\n                     attribs.defaulttextvalueformat=parts[j++]-0;\r\n                     break;\r\n                  case \"ntvf\":\r\n                     attribs.defaultnontextvalueformat=parts[j++]-0;\r\n                     break;\r\n                  case \"color\":\r\n                     attribs.defaultcolor=parts[j++]-0;\r\n                     break;\r\n                  case \"bgcolor\":\r\n                     attribs.defaultbgcolor=parts[j++]-0;\r\n                     break;\r\n                  case \"circularreferencecell\":\r\n                     attribs.circularreferencecell=parts[j++];\r\n                     break;\r\n                  case \"recalc\":\r\n                     attribs.recalc=parts[j++];\r\n                     break;\r\n                  case \"needsrecalc\":\r\n                     attribs.needsrecalc=parts[j++];\r\n                     break;\r\n                  case \"usermaxcol\":\r\n                     attribs.usermaxcol=parts[j++]-0;\r\n                     break;\r\n                  case \"usermaxrow\":\r\n                     attribs.usermaxrow=parts[j++]-0;\r\n                     break;\r\n                  default:\r\n                     j+=1;\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"name\":\r\n            name = SocialCalc.decodeFromSave(parts[1]).toUpperCase();\r\n            sheetobj.names[name] = {desc: SocialCalc.decodeFromSave(parts[2])};\r\n            sheetobj.names[name].definition = SocialCalc.decodeFromSave(parts[3]);\r\n            break;\r\n\r\n         case \"layout\":\r\n            parts=lines[i].match(/^layout\\:(\\d+)\\:(.+)$/); // layouts can have \":\" in them\r\n            sheetobj.layouts[parts[1]-0]=parts[2];\r\n            sheetobj.layouthash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"font\":\r\n            sheetobj.fonts[parts[1]-0]=parts[2];\r\n            sheetobj.fonthash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"color\":\r\n            sheetobj.colors[parts[1]-0]=parts[2];\r\n            sheetobj.colorhash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"border\":\r\n            sheetobj.borderstyles[parts[1]-0]=parts[2];\r\n            sheetobj.borderstylehash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"cellformat\":\r\n            v=SocialCalc.decodeFromSave(parts[2]);\r\n            sheetobj.cellformats[parts[1]-0]=v;\r\n            sheetobj.cellformathash[v]=parts[1]-0;\r\n            break;\r\n\r\n         case \"valueformat\":\r\n            v=SocialCalc.decodeFromSave(parts[2]);\r\n            sheetobj.valueformats[parts[1]-0]=v;\r\n            sheetobj.valueformathash[v]=parts[1]-0;\r\n            break;\r\n\r\n         case \"version\":\r\n            break;\r\n\r\n         case \"copiedfrom\":\r\n            sheetobj.copiedfrom = parts[1]+\":\"+parts[2];\r\n            break;\r\n\r\n         case \"clipboardrange\": // in save versions up to 1.3. Ignored.\r\n         case \"clipboard\":\r\n            break;\r\n\r\n         case \"\":\r\n            break;\r\n\r\n         default:\r\nalert(scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\");\r\n            throw scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\";\r\n            break;\r\n         }\r\n      parts = null;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CellFromStringParts(sheet, cell, parts, j)\r\n//\r\n// Takes string that has been split by \":\" in parts, starting at item j,\r\n// and fills in cell assuming save format.\r\n//\r\n\r\nSocialCalc.CellFromStringParts = function(sheet, cell, parts, j) {\r\n\r\n   var cell, t, v;\r\n\r\n   while (t=parts[j++]) {\r\n      switch (t) {\r\n         case \"v\":\r\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n            cell.datatype=\"v\";\r\n            cell.valuetype=\"n\";\r\n            break;\r\n         case \"t\":\r\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"t\";\r\n            cell.valuetype=SocialCalc.Constants.textdatadefaulttype; \r\n            break;\r\n         case \"vt\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datatype=\"v\";\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datatype=\"t\";\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            break;\r\n         case \"vtf\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"f\";\r\n            break;\r\n         case \"vtc\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"c\";\r\n            break;\r\n         case \"ro\":\r\n            ro=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.readonly=ro.toLowerCase()==\"yes\";\r\n            break;\r\n         case \"e\":\r\n            cell.errors=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         case \"b\":\r\n            cell.bt=parts[j++]-0;\r\n            cell.br=parts[j++]-0;\r\n            cell.bb=parts[j++]-0;\r\n            cell.bl=parts[j++]-0;\r\n            break;\r\n         case \"l\":\r\n            cell.layout=parts[j++]-0;\r\n            break;\r\n         case \"f\":\r\n            cell.font=parts[j++]-0;\r\n            break;\r\n         case \"c\":\r\n            cell.color=parts[j++]-0;\r\n            break;\r\n         case \"bg\":\r\n            cell.bgcolor=parts[j++]-0;\r\n            break;\r\n         case \"cf\":\r\n            cell.cellformat=parts[j++]-0;\r\n            break;\r\n         case \"ntvf\":\r\n            cell.nontextvalueformat=parts[j++]-0;\r\n            break;\r\n         case \"tvf\":\r\n            cell.textvalueformat=parts[j++]-0;\r\n            break;\r\n         case \"colspan\":\r\n            cell.colspan=parts[j++]-0;\r\n            break;\r\n         case \"rowspan\":\r\n            cell.rowspan=parts[j++]-0;\r\n            break;\r\n         case \"cssc\":\r\n            cell.cssc=parts[j++];\r\n            break;\r\n         case \"csss\":\r\n            cell.csss=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         case \"mod\":\r\n            j+=1;\r\n            break;\r\n         case \"comment\":\r\n            cell.comment=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         default:\r\n            throw SocialCalc.Constants.s_cfspUnknownCellType+\" '\"+t+\"'\";\r\n            break;\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.sheetfields = [\"defaultrowheight\", \"defaultcolwidth\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\r\nSocialCalc.sheetfieldsshort = [\"h\", \"w\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\r\n\r\nSocialCalc.sheetfieldsxlat = [\"defaulttextformat\", \"defaultnontextformat\",\r\n                              \"defaulttextvalueformat\", \"defaultnontextvalueformat\",\r\n                              \"defaultcolor\", \"defaultbgcolor\", \"defaultfont\", \"defaultlayout\"];\r\nSocialCalc.sheetfieldsxlatshort = [\"tf\", \"ntf\", \"tvf\", \"ntvf\", \"color\", \"bgcolor\", \"font\", \"layout\"];\r\nSocialCalc.sheetfieldsxlatxlt = [\"cellformat\", \"cellformat\", \"valueformat\", \"valueformat\",\r\n                                  \"color\", \"color\", \"font\", \"layout\"];\r\n\r\n//\r\n// sheetstr = SocialCalc.CreateSheetSave(sheetobj, range, canonicalize)\r\n//\r\n// Creates a text representation of the sheetobj data.\r\n// If the range is present then only those cells are saved\r\n// (as clipboard data with \"copiedfrom\" set).\r\n//\r\n\r\nSocialCalc.CreateSheetSave = function(sheetobj, range, canonicalize) {\r\n\r\n   var cell, cr1, cr2, row, col, coord, attrib, line, value, formula, i, t, r, b, l, name, blanklen;\r\n   var result=[];\r\n\r\n   var prange;\r\n\r\n   sheetobj.CanonicalizeSheet(canonicalize || SocialCalc.Constants.doCanonicalizeSheet);\r\n   var xlt = sheetobj.xlt;\r\n\r\n   if (range) {\r\n      prange = SocialCalc.ParseRange(range);\r\n      }\r\n   else {\r\n      prange = {cr1: {row: 1, col:1},\r\n                cr2: {row: xlt.maxrow, col: xlt.maxcol}};\r\n      }\r\n   cr1 = prange.cr1;\r\n   cr2 = prange.cr2;\r\n\r\n   result.push(\"version:1.5\");\r\n\r\n   for (row=cr1.row; row <= cr2.row; row++) {\r\n      for (col=cr1.col; col <= cr2.col; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         cell=sheetobj.cells[coord];\r\n         if (!cell) continue;\r\n         line=sheetobj.CellToString(cell);\r\n         if (line.length==0) continue; // ignore completely empty cells\r\n         line=\"cell:\"+coord+line;\r\n         result.push(line);\r\n         }\r\n      }\r\n\r\n   for (col=1; col <= xlt.maxcol; col++) {\r\n      coord = SocialCalc.rcColname(col);\r\n      if (sheetobj.colattribs.width[coord])\r\n         result.push(\"col:\"+coord+\":w:\"+sheetobj.colattribs.width[coord]);\r\n      if (sheetobj.colattribs.hide[coord])\r\n         result.push(\"col:\"+coord+\":hide:\"+sheetobj.colattribs.hide[coord]);\r\n      }\r\n\r\n   for (row=1; row <= xlt.maxrow; row++) {\r\n      if (sheetobj.rowattribs.height[row])\r\n         result.push(\"row:\"+row+\":h:\"+sheetobj.rowattribs.height[row]);\r\n      if (sheetobj.rowattribs.hide[row])\r\n         result.push(\"row:\"+row+\":hide:\"+sheetobj.rowattribs.hide[row]);\r\n      }\r\n\r\n   line=\"sheet:c:\"+xlt.maxcol+\":r:\"+xlt.maxrow;\r\n\r\n   for (i=0; i<SocialCalc.sheetfields.length; i++) { // non-xlated values\r\n      value = SocialCalc.encodeForSave(sheetobj.attribs[SocialCalc.sheetfields[i]]);\r\n      if (value) line+=\":\"+SocialCalc.sheetfieldsshort[i]+\":\"+value;\r\n      }\r\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // xlated values\r\n      value = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\r\n      if (value) line+=\":\"+SocialCalc.sheetfieldsxlatshort[i]+\":\"+xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sxlat\"][value];\r\n      }\r\n\r\n   result.push(line);\r\n\r\n   for (i=1;i<xlt.newborderstyles.length;i++) {\r\n      result.push(\"border:\"+i+\":\"+xlt.newborderstyles[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newcellformats.length;i++) {\r\n      result.push(\"cellformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newcellformats[i]));\r\n      }\r\n\r\n   for (i=1;i<xlt.newcolors.length;i++) {\r\n      result.push(\"color:\"+i+\":\"+xlt.newcolors[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newfonts.length;i++) {\r\n      result.push(\"font:\"+i+\":\"+xlt.newfonts[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newlayouts.length;i++) {\r\n      result.push(\"layout:\"+i+\":\"+xlt.newlayouts[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newvalueformats.length;i++) {\r\n      result.push(\"valueformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newvalueformats[i]));\r\n      }\r\n\r\n   for (i=0; i<xlt.namesorder.length; i++) {\r\n      name = xlt.namesorder[i];\r\n      result.push(\"name:\"+SocialCalc.encodeForSave(name).toUpperCase()+\":\"+\r\n                   SocialCalc.encodeForSave(sheetobj.names[name].desc)+\":\"+\r\n                   SocialCalc.encodeForSave(sheetobj.names[name].definition));\r\n      }\r\n\r\n   if (range) {\r\n      result.push(\"copiedfrom:\"+SocialCalc.crToCoord(cr1.col, cr1.row)+\":\"+\r\n                  SocialCalc.crToCoord(cr2.col, cr2.row));\r\n      }\r\n\r\n   result.push(\"\"); // one extra to get extra \\n\r\n\r\n   delete sheetobj.xlt; // clean up\r\n\r\n   return result.join(\"\\n\");\r\n   }\r\n\r\n//\r\n// line = SocialCalc.CellToString(sheet, cell)\r\n//\r\n\r\nSocialCalc.CellToString = function(sheet, cell) {\r\n\r\n   var cell, line, value, formula, t, r, b, l, xlt;\r\n\r\n   line = \"\";\r\n\r\n   if (!cell) return line;\r\n\r\n   value = SocialCalc.encodeForSave(cell.datavalue);\r\n   if (cell.datatype==\"v\") {\r\n      if (cell.valuetype==\"n\") line += \":v:\"+value;\r\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\r\n      }\r\n   else if (cell.datatype==\"t\") {\r\n      if (cell.valuetype==SocialCalc.Constants.textdatadefaulttype)\r\n         line += \":t:\"+value;\r\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\r\n      }\r\n   else {\r\n      formula = SocialCalc.encodeForSave(cell.formula);\r\n      if (cell.datatype==\"f\") {\r\n         line += \":vtf:\"+cell.valuetype+\":\"+value+\":\"+formula;\r\n         }\r\n      else if (cell.datatype==\"c\") {\r\n         line += \":vtc:\"+cell.valuetype+\":\"+value+\":\"+formula;\r\n         }\r\n      }\r\n   if (cell.readonly) {\r\n      line += \":ro:yes\";\r\n      }\r\n   if (cell.errors) {\r\n      line += \":e:\"+SocialCalc.encodeForSave(cell.errors);\r\n      }\r\n   t = cell.bt || \"\";\r\n   r = cell.br || \"\";\r\n   b = cell.bb || \"\";\r\n   l = cell.bl || \"\";\r\n\r\n   if (sheet.xlt) { // if have canonical save info\r\n      xlt = sheet.xlt;\r\n      if (t || r || b || l)\r\n      line += \":b:\"+xlt.borderstylesxlat[t||0]+\":\"+xlt.borderstylesxlat[r||0]+\":\"+xlt.borderstylesxlat[b||0]+\":\"+xlt.borderstylesxlat[l||0];\r\n      if (cell.layout) line += \":l:\"+xlt.layoutsxlat[cell.layout];\r\n      if (cell.font) line += \":f:\"+xlt.fontsxlat[cell.font];\r\n      if (cell.color) line += \":c:\"+xlt.colorsxlat[cell.color];\r\n      if (cell.bgcolor) line += \":bg:\"+xlt.colorsxlat[cell.bgcolor];\r\n      if (cell.cellformat) line += \":cf:\"+xlt.cellformatsxlat[cell.cellformat];\r\n      if (cell.textvalueformat) line += \":tvf:\"+xlt.valueformatsxlat[cell.textvalueformat];\r\n      if (cell.nontextvalueformat) line += \":ntvf:\"+xlt.valueformatsxlat[cell.nontextvalueformat];\r\n      }\r\n   else {\r\n      if (t || r || b || l)\r\n      line += \":b:\"+t+\":\"+r+\":\"+b+\":\"+l;\r\n      if (cell.layout) line += \":l:\"+cell.layout;\r\n      if (cell.font) line += \":f:\"+cell.font;\r\n      if (cell.color) line += \":c:\"+cell.color;\r\n      if (cell.bgcolor) line += \":bg:\"+cell.bgcolor;\r\n      if (cell.cellformat) line += \":cf:\"+cell.cellformat;\r\n      if (cell.textvalueformat) line += \":tvf:\"+cell.textvalueformat;\r\n      if (cell.nontextvalueformat) line += \":ntvf:\"+cell.nontextvalueformat;\r\n      }\r\n   if (cell.colspan) line += \":colspan:\"+cell.colspan;\r\n   if (cell.rowspan) line += \":rowspan:\"+cell.rowspan;\r\n   if (cell.cssc) line += \":cssc:\"+cell.cssc;\r\n   if (cell.csss) line += \":csss:\"+SocialCalc.encodeForSave(cell.csss);\r\n   if (cell.mod) line += \":mod:\"+cell.mod;\r\n   if (cell.comment) line += \":comment:\"+SocialCalc.encodeForSave(cell.comment);\r\n\r\n   return line;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CanonicalizeSheet(sheetobj, full)\r\n//\r\n// Goes through the sheet and fills in sheetobj.xlt with the following:\r\n//\r\n//   .maxrow, .maxcol - lastrow and lastcol are as small as possible\r\n//   .newlayouts - new version of sheetobj.layouts without unused ones and all in ascending order\r\n//   .layoutsxlat - maps old layouts index to new one\r\n//   same \".new\" and \".xlat\" for fonts, colors, borderstyles, cell and value formats\r\n//   .namesorder - array with names sorted\r\n//\r\n// If full or SocialCalc.Constants.doCanonicalizeSheet are not true, then the values will leave things unchanged (to save time, etc.)\r\n//\r\n// sheetobj.xlt should be deleted when you are finished using it\r\n//\r\n\r\nSocialCalc.CanonicalizeSheet = function(sheetobj, full) {\r\n\r\n   var l, coord, cr, cell, filled, an, a, newa, newxlat, used, ahash, i, v;\r\n   var maxrow = 0;\r\n   var maxcol = 0;\r\n   var alist = [\"borderstyle\", \"cellformat\", \"color\", \"font\", \"layout\", \"valueformat\"];\r\n\r\n   var xlt = {};\r\n\r\n   xlt.namesorder = []; // always return a sorted list\r\n   for (a in sheetobj.names) {\r\n      xlt.namesorder.push(a);\r\n      }\r\n   xlt.namesorder.sort();\r\n\r\n   if (!SocialCalc.Constants.doCanonicalizeSheet || !full) { // return make-no-changes values if not wanted\r\n      for (an=0; an<alist.length; an++) {\r\n         a = alist[an];\r\n         xlt[\"new\"+a+\"s\"] = sheetobj[a+\"s\"];\r\n         l = sheetobj[a+\"s\"].length;\r\n         newxlat = new Array(l);\r\n         newxlat[0] = \"\";\r\n         for (i=1; i<l; i++) {\r\n            newxlat[i] = i;\r\n            }\r\n         xlt[a+\"sxlat\"] = newxlat;\r\n         }\r\n\r\n      xlt.maxrow = sheetobj.attribs.lastrow;\r\n      xlt.maxcol = sheetobj.attribs.lastcol;\r\n\r\n      sheetobj.xlt = xlt;\r\n\r\n      return;\r\n      }\r\n\r\n   for (an=0; an<alist.length; an++) {\r\n      a = alist[an];\r\n      xlt[a+\"sUsed\"] = {};\r\n      }\r\n\r\n   var colorsUsed = xlt.colorsUsed;\r\n   var borderstylesUsed = xlt.borderstylesUsed;\r\n   var fontsUsed = xlt.fontsUsed;\r\n   var layoutsUsed = xlt.layoutsUsed;\r\n   var cellformatsUsed = xlt.cellformatsUsed;\r\n   var valueformatsUsed = xlt.valueformatsUsed;\r\n\r\n   for (coord in sheetobj.cells) { // check all cells to see which values are used\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell = sheetobj.cells[coord];\r\n      filled = false;\r\n\r\n      if (cell.valuetype && cell.valuetype!=\"b\") filled = true;\r\n\r\n      if (cell.color) {\r\n         colorsUsed[cell.color] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.bgcolor) {\r\n         colorsUsed[cell.bgcolor] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.bt) {\r\n         borderstylesUsed[cell.bt] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.br) {\r\n         borderstylesUsed[cell.br] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.bb) {\r\n         borderstylesUsed[cell.bb] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.bl) {\r\n         borderstylesUsed[cell.bl] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.layout) {\r\n         layoutsUsed[cell.layout] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.font) {\r\n         fontsUsed[cell.font] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.cellformat) {\r\n         cellformatsUsed[cell.cellformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.textvalueformat) {\r\n         valueformatsUsed[cell.textvalueformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.nontextvalueformat) {\r\n         valueformatsUsed[cell.nontextvalueformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (filled) {\r\n         if (cr.row > maxrow) maxrow = cr.row;\r\n         if (cr.col > maxcol) maxcol = cr.col;\r\n         }\r\n      }\r\n\r\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // do sheet values, too\r\n      v = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\r\n      if (v) {\r\n         xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sUsed\"][v] = 1;\r\n         }\r\n      }\r\n\r\n   a = {\"height\": 1, \"hide\": 1}; // look at explicit row settings\r\n   for (v in a) {\r\n      for (cr in sheetobj.rowattribs[v]) {\r\n         if (cr > maxrow) maxrow = cr;\r\n         }\r\n      }\r\n   a = {\"hide\": 1, \"width\": 1}; // look at explicit col settings\r\n   for (v in a) {\r\n      for (coord in sheetobj.colattribs[v]) {\r\n         cr = SocialCalc.coordToCr(coord+\"1\");\r\n         if (cr.col > maxcol) maxcol = cr.col;\r\n         }\r\n      }\r\n\r\n   for (an=0; an<alist.length; an++) { // go through the attribs we want\r\n      a = alist[an];\r\n\r\n      newa = [];\r\n      used = xlt[a+\"sUsed\"];\r\n      for (v in used) {\r\n         newa.push(sheetobj[a+\"s\"][v]);\r\n         }\r\n      newa.sort();\r\n      newa.unshift(\"\");\r\n\r\n      newxlat = [\"\"];\r\n      ahash = sheetobj[a+\"hash\"];\r\n\r\n      for (i=1; i<newa.length; i++) {\r\n         newxlat[ahash[newa[i]]] = i;\r\n         }\r\n\r\n      xlt[a+\"sxlat\"] = newxlat;\r\n      xlt[\"new\"+a+\"s\"] = newa;\r\n\r\n      }\r\n\r\n   xlt.maxrow = maxrow || 1;\r\n   xlt.maxcol = maxcol || 1;\r\n\r\n   sheetobj.xlt = xlt; // leave for use by caller\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.EncodeCellAttributes(sheet, coord)\r\n//\r\n// Returns the cell's attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n\r\nSocialCalc.EncodeCellAttributes = function(sheet, coord) {\r\n\r\n   var value, i, b, bb;\r\n   var result = {};\r\n\r\n   var InitAttrib = function(name) {\r\n      result[name] = {def: true, val: \"\"};\r\n      }\r\n\r\n   var InitAttribs = function(namelist) {\r\n      for (var i=0; i<namelist.length; i++) {\r\n         InitAttrib(namelist[i]);\r\n         }\r\n      }\r\n\r\n   var SetAttrib = function(name, v) {\r\n      result[name].def = false;\r\n      result[name].val = v || \"\";\r\n      }\r\n\r\n   var SetAttribStar = function(name, v) {\r\n      if (v==\"*\") return;\r\n      result[name].def = false;\r\n      result[name].val = v;\r\n      }\r\n\r\n   var cell = sheet.GetAssuredCell(coord);\r\n\r\n   // cellformat: alignhoriz\r\n\r\n   InitAttrib(\"alignhoriz\");\r\n   if (cell.cellformat) {\r\n      SetAttrib(\"alignhoriz\", sheet.cellformats[cell.cellformat]);\r\n      }\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\r\n   if (cell.layout) {\r\n      parts = sheet.layouts[cell.layout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\r\n      SetAttribStar(\"padtop\", parts[1]);\r\n      SetAttribStar(\"padright\", parts[2]);\r\n      SetAttribStar(\"padbottom\", parts[3]);\r\n      SetAttribStar(\"padleft\", parts[4]);\r\n      SetAttribStar(\"alignvert\", parts[5]);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\r\n   if (cell.font) {\r\n      parts = sheet.fonts[cell.font].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      SetAttribStar(\"fontfamily\", parts[3]);\r\n      SetAttribStar(\"fontsize\", parts[2]);\r\n      SetAttribStar(\"fontlook\", parts[1]);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   InitAttrib(\"textcolor\");\r\n   if (cell.color) {\r\n      SetAttrib(\"textcolor\", sheet.colors[cell.color]);\r\n      }\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   InitAttrib(\"bgcolor\");\r\n   if (cell.bgcolor) {\r\n      SetAttrib(\"bgcolor\", sheet.colors[cell.bgcolor]);\r\n      }\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   InitAttribs([\"numberformat\", \"textformat\"]);\r\n   if (cell.nontextvalueformat) {\r\n      SetAttrib(\"numberformat\", sheet.valueformats[cell.nontextvalueformat]);\r\n      }\r\n   if (cell.textvalueformat) {\r\n      SetAttrib(\"textformat\", sheet.valueformats[cell.textvalueformat]);\r\n      }\r\n\r\n   // merges: colspan, rowspan\r\n\r\n   InitAttribs([\"colspan\", \"rowspan\"]);\r\n   SetAttrib(\"colspan\", cell.colspan || 1);\r\n   SetAttrib(\"rowspan\", cell.rowspan || 1);\r\n\r\n   // borders: bXthickness, bXstyle, bXcolor for X = t, r, b, and l\r\n\r\n   for (i=0; i<4; i++) {\r\n      b = \"trbl\".charAt(i);\r\n      bb = \"b\"+b;\r\n      InitAttrib(bb);\r\n      SetAttrib(bb, cell[bb] ? sheet.borderstyles[cell[bb]] : \"\");\r\n      InitAttrib(bb+\"thickness\");\r\n      InitAttrib(bb+\"style\");\r\n      InitAttrib(bb+\"color\");\r\n      if (cell[bb]) {\r\n         parts = sheet.borderstyles[cell[bb]].match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\r\n         SetAttrib(bb+\"thickness\", parts[1]);\r\n         SetAttrib(bb+\"style\", parts[2]);\r\n         SetAttrib(bb+\"color\", parts[3]);\r\n         }\r\n      }\r\n \r\n   // misc: cssc, csss, mod\r\n\r\n   InitAttribs([\"cssc\", \"csss\", \"mod\"]);\r\n   SetAttrib(\"cssc\", cell.cssc || \"\"); \r\n   SetAttrib(\"csss\", cell.csss || \"\");\r\n   SetAttrib(\"mod\", cell.mod || \"n\");\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.EncodeSheetAttributes(sheet)\r\n//\r\n// Returns the sheet's attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n\r\nSocialCalc.EncodeSheetAttributes = function(sheet) {\r\n\r\n   var value;\r\n   var attribs = sheet.attribs;\r\n   var result = {};\r\n\r\n   var InitAttrib = function(name) {\r\n      result[name] = {def: true, val: \"\"};\r\n      }\r\n\r\n   var InitAttribs = function(namelist) {\r\n      for (var i=0; i<namelist.length; i++) {\r\n         InitAttrib(namelist[i]);\r\n         }\r\n      }\r\n\r\n   var SetAttrib = function(name, v) {\r\n      result[name].def = false;\r\n      result[name].val = v || value;\r\n      }\r\n\r\n   var SetAttribStar = function(name, v) {\r\n      if (v==\"*\") return;\r\n      result[name].def = false;\r\n      result[name].val = v;\r\n      }\r\n\r\n   // sizes: colwidth, rowheight\r\n\r\n   InitAttrib(\"colwidth\");\r\n   if (attribs.defaultcolwidth) {\r\n      SetAttrib(\"colwidth\", attribs.defaultcolwidth);\r\n      }\r\n\r\n   InitAttrib(\"rowheight\");\r\n   if (attribs.rowheight) {\r\n      SetAttrib(\"rowheight\", attribs.defaultrowheight);\r\n      }\r\n\r\n   // cellformat: textalignhoriz, numberalignhoriz\r\n\r\n   InitAttrib(\"textalignhoriz\");\r\n   if (attribs.defaulttextformat) {\r\n      SetAttrib(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat]);\r\n      }\r\n\r\n   InitAttrib(\"numberalignhoriz\");\r\n   if (attribs.defaultnontextformat) {\r\n      SetAttrib(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat]);\r\n      }\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\r\n   if (attribs.defaultlayout) {\r\n      parts = sheet.layouts[attribs.defaultlayout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\r\n      SetAttribStar(\"padtop\", parts[1]);\r\n      SetAttribStar(\"padright\", parts[2]);\r\n      SetAttribStar(\"padbottom\", parts[3]);\r\n      SetAttribStar(\"padleft\", parts[4]);\r\n      SetAttribStar(\"alignvert\", parts[5]);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\r\n   if (attribs.defaultfont) {\r\n      parts = sheet.fonts[attribs.defaultfont].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      SetAttribStar(\"fontfamily\", parts[3]);\r\n      SetAttribStar(\"fontsize\", parts[2]);\r\n      SetAttribStar(\"fontlook\", parts[1]);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   InitAttrib(\"textcolor\");\r\n   if (attribs.defaultcolor) {\r\n      SetAttrib(\"textcolor\", sheet.colors[attribs.defaultcolor]);\r\n      }\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   InitAttrib(\"bgcolor\");\r\n   if (attribs.defaultbgcolor) {\r\n      SetAttrib(\"bgcolor\", sheet.colors[attribs.defaultbgcolor]);\r\n      }\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   InitAttribs([\"numberformat\", \"textformat\"]);\r\n   if (attribs.defaultnontextvalueformat) {\r\n      SetAttrib(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat]);\r\n      }\r\n   if (attribs.defaulttextvalueformat) {\r\n      SetAttrib(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat]);\r\n      }\r\n\r\n   // recalc: recalc\r\n\r\n   InitAttrib(\"recalc\");\r\n   if (attribs.recalc) {\r\n      SetAttrib(\"recalc\", attribs.recalc);\r\n      }\r\n\r\n   // usermaxcol, usermaxrow\r\n   InitAttrib(\"usermaxcol\");\r\n   if (attribs.usermaxcol) {\r\n      SetAttrib(\"usermaxcol\", attribs.usermaxcol);\r\n      }\r\n   InitAttrib(\"usermaxrow\");\r\n   if (attribs.usermaxrow) {\r\n      SetAttrib(\"usermaxrow\", attribs.usermaxrow);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// cmdstr = SocialCalc.DecodeCellAttributes(sheet, coord, attribs, range)\r\n//\r\n// Takes cell attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n// and returns the sheet commands to make the actual attributes correspond.\r\n// Returns a non-null string if any commands are to be executed, null otherwise.\r\n//\r\n// If range is provided, the commands are executed on the whole range.\r\n//\r\n\r\nSocialCalc.DecodeCellAttributes = function(sheet, coord, newattribs, range) {\r\n\r\n   var value, b, bb;\r\n\r\n   var cell = sheet.GetAssuredCell(coord);\r\n\r\n   var changed = false;\r\n\r\n   var CheckChanges = function(attribname, oldval, cmdname) {\r\n      var val;\r\n      if (newattribs[attribname]) {\r\n         if (newattribs[attribname].def) {\r\n            val = \"\";\r\n            }\r\n         else {\r\n            val = newattribs[attribname].val;\r\n            }\r\n         if (val != (oldval || \"\")) {\r\n            DoCmd(cmdname+\" \"+val);\r\n            }\r\n         }\r\n      }\r\n\r\n   var cmdstr = \"\";\r\n\r\n   var DoCmd = function(str) {\r\n      if (cmdstr) cmdstr += \"\\n\";\r\n      cmdstr += \"set \"+(range || coord)+\" \"+str;\r\n      changed = true;\r\n      }\r\n\r\n   // cellformat: alignhoriz\r\n\r\n   CheckChanges(\"alignhoriz\", sheet.cellformats[cell.cellformat], \"cellformat\");\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\r\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\r\n      value = \"padding:\" +\r\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\r\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\r\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\r\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\r\n         \";vertical-align:\" +\r\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.layouts[cell.layout] || \"\")) {\r\n      DoCmd(\"layout \"+value);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\r\n      value =\r\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\r\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\r\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.fonts[cell.font] || \"\")) {\r\n      DoCmd(\"font \"+value);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   CheckChanges(\"textcolor\", sheet.colors[cell.color], \"color\");\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   CheckChanges(\"bgcolor\", sheet.colors[cell.bgcolor], \"bgcolor\");\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   CheckChanges(\"numberformat\", sheet.valueformats[cell.nontextvalueformat], \"nontextvalueformat\");\r\n\r\n   CheckChanges(\"textformat\", sheet.valueformats[cell.textvalueformat], \"textvalueformat\");\r\n\r\n   // merges: colspan, rowspan - NOT HANDLED: IGNORED!\r\n\r\n   // borders: bX for X = t, r, b, and l; bXthickness, bXstyle, bXcolor ignored\r\n\r\n   for (i=0; i<4; i++) {\r\n      b = \"trbl\".charAt(i);\r\n      bb = \"b\"+b;\r\n      CheckChanges(bb, sheet.borderstyles[cell[bb]], bb);\r\n      }\r\n\r\n   // misc: cssc, csss, mod\r\n\r\n   CheckChanges(\"cssc\", cell.cssc, \"cssc\");\r\n\r\n   CheckChanges(\"csss\", cell.csss, \"csss\");\r\n\r\n   if (newattribs.mod) {\r\n      if (newattribs.mod.def) {\r\n         value = \"n\";\r\n         }\r\n      else {\r\n         value = newattribs.mod.val;\r\n         }\r\n      if (value != (cell.mod || \"n\")) {\r\n         if (value==\"n\") value = \"\"; // restrict to \"y\" and \"\" normally\r\n         DoCmd(\"mod \"+value);\r\n         }\r\n      }\r\n\r\n   // if any changes return command(s)\r\n\r\n   if (changed) {\r\n       return cmdstr;\r\n      }\r\n   else {\r\n      return null;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// changed = SocialCalc.DecodeSheetAttributes(sheet, newattribs)\r\n//\r\n// Takes sheet attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n// and returns the sheet commands to make the actual attributes correspond.\r\n// Returns a non-null string if any commands were executed, null otherwise.\r\n//\r\n\r\nSocialCalc.DecodeSheetAttributes = function(sheet, newattribs) {\r\n\r\n   var value;\r\n   var attribs = sheet.attribs;\r\n   var changed = false;\r\n\r\n   var CheckChanges = function(attribname, oldval, cmdname) {\r\n      var val;\r\n      if (newattribs[attribname]) {\r\n         if (newattribs[attribname].def) {\r\n            val = \"\";\r\n            }\r\n         else {\r\n            val = newattribs[attribname].val;\r\n            }\r\n         if (val != (oldval || \"\")) {\r\n            DoCmd(cmdname+\" \"+val);\r\n            }\r\n         }\r\n      }\r\n\r\n   var cmdstr = \"\";\r\n\r\n   var DoCmd = function(str) {\r\n      if (cmdstr) cmdstr += \"\\n\";\r\n      cmdstr += \"set sheet \"+str;\r\n      changed = true;\r\n      }\r\n\r\n   // sizes: colwidth, rowheight\r\n\r\n   CheckChanges(\"colwidth\", attribs.defaultcolwidth, \"defaultcolwidth\");\r\n\r\n   CheckChanges(\"rowheight\", attribs.defaultrowheight, \"defaultrowheight\");\r\n\r\n   // cellformat: textalignhoriz, numberalignhoriz\r\n\r\n   CheckChanges(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat], \"defaulttextformat\");\r\n\r\n   CheckChanges(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat], \"defaultnontextformat\");\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\r\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\r\n      value = \"padding:\" +\r\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\r\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\r\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\r\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\r\n         \";vertical-align:\" +\r\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.layouts[attribs.defaultlayout] || \"\")) {\r\n      DoCmd(\"defaultlayout \"+value);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\r\n      value =\r\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\r\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\r\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.fonts[attribs.defaultfont] || \"\")) {\r\n      DoCmd(\"defaultfont \"+value);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   CheckChanges(\"textcolor\", sheet.colors[attribs.defaultcolor], \"defaultcolor\");\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   CheckChanges(\"bgcolor\", sheet.colors[attribs.defaultbgcolor], \"defaultbgcolor\");\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   CheckChanges(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat], \"defaultnontextvalueformat\");\r\n\r\n   CheckChanges(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat], \"defaulttextvalueformat\");\r\n\r\n   // recalc: recalc\r\n\r\n   CheckChanges(\"recalc\", sheet.attribs.recalc, \"recalc\");\r\n\r\n   // usermaxcol, usermaxrow\r\n\r\n   CheckChanges(\"usermaxcol\", sheet.attribs.usermaxcol, \"usermaxcol\");\r\n   CheckChanges(\"usermaxrow\", sheet.attribs.usermaxrow, \"usermaxrow\");\r\n\r\n   // if any changes return command(s)\r\n\r\n   if (changed) {\r\n       return cmdstr;\r\n      }\r\n   else {\r\n      return null;\r\n      }\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Sheet command routines\r\n//\r\n// *************************************\r\n\r\n//\r\n// SocialCalc.SheetCommandInfo - object with information used during command execution\r\n//\r\n\r\nSocialCalc.SheetCommandInfo = function(sheetobj) {\r\n\r\n   this.sheetobj = sheetobj; // sheet being operated on\r\n   this.timerobj = null; // used for timeslicing\r\n   this.firsttimerdelay = 50; // wait before starting cmds (for Chrome - to give time to update)\r\n   this.timerdelay = 1; // wait between slices\r\n   this.maxtimeslice = 100; // do another slice after this many milliseconds\r\n   this.saveundo = false; // arg for ExecuteSheetCommand\r\n\r\n   this.CmdExtensionCallbacks = {}; // for startcmdextension, in form: cmdname, {func:function(cmdname, data, sheet, SocialCalc.Parse object, saveundo), data:whatever}\r\n\r\n//   statuscallback: null, // called during execution - obsolete: use sheet obj's\r\n//   statuscallbackparams: null\r\n\r\n   };\r\n\r\n//\r\n// SocialCalc.ScheduleSheetCommands\r\n//\r\n// statuscallback is called at the beginning (cmdstart) and end (cmdend).\r\n//\r\n\r\nSocialCalc.ScheduleSheetCommands = function(sheet, cmdstr, saveundo) {\r\n\r\n   var sci = sheet.sci;\r\n\r\n   var parseobj = new SocialCalc.Parse(cmdstr);\r\n\r\n   if (sci.sheetobj.statuscallback) { // notify others if requested\r\n      sheet.statuscallback(sci, \"cmdstart\", \"\", sci.sheetobj.statuscallbackparams);\r\n      }\r\n\r\n   if (saveundo) {\r\n      sci.sheetobj.changes.PushChange(\"\"); // add a step to undo stack\r\n      }\r\n\r\n   sci.timerobj = window.setTimeout(function() {\r\n      SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\r\n   }, sci.firsttimerdelay);\r\n\r\n   }\r\n\r\nSocialCalc.SheetCommandsTimerRoutine = function(sci, parseobj, saveundo) {\r\n\r\n   var errortext;\r\n   var starttime = new Date();\r\n   sci.timerobj = null;\r\n\r\n   while (!parseobj.EOF()) { // go through all commands (separated by newlines)\r\n\r\n      errortext = SocialCalc.ExecuteSheetCommand(sci.sheetobj, parseobj, saveundo);\r\n      // Error - Use  log on server   OR  alert on client \r\n      if (errortext) {\r\n        if (typeof(alert) == \"function\")  {\r\n          alert(errortext);\r\n        } else {\r\n          console.log(errortext)\r\n        }\r\n      }\r\n\r\n      parseobj.NextLine();\r\n\r\n      if (((new Date()) - starttime) >= sci.maxtimeslice) { // if taking too long, give up CPU for a while\r\n         sci.timerobj = window.setTimeout(function() {\r\n            SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\r\n         }, sci.timerdelay);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (sci.sheetobj.statuscallback) { // notify others if requested\r\n      sci.sheetobj.statuscallback(sci, \"cmdend\", \"\", sci.sheetobj.statuscallbackparams);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// errortext = SocialCalc.ExecuteSheetCommand(sheet, cmd, saveundo)\r\n//\r\n// cmd is a SocialCalc.Parse object.\r\n//\r\n// Executes commands that modify the sheet data.\r\n// Sets sheet \"needsrecalc\" as needed.\r\n// Sets sheet \"changedrendervalues\" as needed.\r\n//\r\n// The cmd string may be multiple commands, separated by newlines. In that case\r\n// only one \"step\" is put on the undo stack representing all the commands.\r\n// Note that because of this, in \"set A1 text ...\" and \"set A1 comment ...\" text is\r\n// treated as encoded (newline => \\n, \\ => \\b, : => \\c).\r\n//\r\n// The commands are in the forms:\r\n//\r\n//    set sheet attributename value (plus lastcol and lastrow)\r\n//    set 22 attributename value\r\n//    set B attributename value\r\n//    set A1 attributename value1 value2... (see each attribute in code for details)\r\n//    set A1:B5 attributename value1 value2...\r\n//    erase/copy/cut/paste/fillright/filldown A1:B5 all/formulas/format\r\n//    loadclipboard save-encoded-clipboard-data\r\n//    clearclipboard\r\n//    merge C3:F3\r\n//    unmerge C3\r\n//    insertcol/insertrow C5\r\n//    deletecol/deleterow C5:E7\r\n//    movepaste/moveinsert A1:B5 A8 all/formulas/format (if insert, destination must be in same rows or columns or else paste done)\r\n//    sort cr1:cr2 col1 up/down col2 up/down col3 up/down\r\n//    name define NAME definition\r\n//    name desc NAME description\r\n//    name delete NAME\r\n//    recalc\r\n//    redisplay\r\n//    changedrendervalues\r\n//    startcmdextension extension rest-of-command\r\n//    sendemail ??? eddy ???\r\n//\r\n// If saveundo is true, then undo information is saved in sheet.changes.\r\n//\r\n\r\nSocialCalc.ExecuteSheetCommand = function(sheet, cmd, saveundo) {\r\n\r\n   var cmdstr, cmd1, rest, what, attrib, num, pos, pos2, errortext, undostart, val;\r\n   var cr1, cr2, col, row, cr, cell, newcell;\r\n   var fillright, rowstart, colstart, crbase, rowoffset, coloffset, basecell;\r\n   var clipsheet, cliprange, numcols, numrows, attribtable;\r\n   var colend, rowend, newcolstart, newrowstart, newcolend, newrowend, rownext, colnext, colthis, cellnext;\r\n   var lastrow, lastcol, rowbefore, colbefore, oldformula, oldcr;\r\n   var cols, dirs, lastsortcol, i, sortlist, sortcells, sortvalues, sorttypes;\r\n   var sortfunction, slen, valtype, originalrow, sortedcr;\r\n   var name, v1, v2;\r\n   var cmdextension;\r\n   var col, row, editor, undoNum, trackLine;\r\n\r\n   var attribs = sheet.attribs;\r\n   var changes = sheet.changes;\r\n   var cellProperties = SocialCalc.CellProperties;\r\n   var scc = SocialCalc.Constants;\r\n   var cellChanged = false;\r\n\r\n   var ParseRange =\r\n      function() {\r\n         var prange = SocialCalc.ParseRange(what);\r\n         cr1 = prange.cr1;\r\n         cr2 = prange.cr2;\r\n         if (cr2.col > attribs.lastcol) attribs.lastcol = cr2.col;\r\n         if (cr2.row > attribs.lastrow) attribs.lastrow = cr2.row;\r\n         };\r\n\r\n   errortext = \"\";\r\n\r\n   cmdstr = cmd.RestOfStringNoMove();\r\n   if (saveundo) {\r\n      sheet.changes.AddDo(cmdstr);\r\n      }\r\n\r\n   cmd1 = cmd.NextToken();\r\n   switch (cmd1) {\r\n\r\n      case \"set\":\r\n         what = cmd.NextToken();\r\n         attrib = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         undostart = \"set \"+what+\" \"+attrib;\r\n\r\n         if (what==\"sheet\") {\r\n            sheet.renderneeded = true;\r\n            switch (attrib) {\r\n               case \"defaultcolwidth\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\r\n                  attribs[attrib] = rest;\r\n                  break;\r\n               case \"defaultcolor\":\r\n               case \"defaultbgcolor\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"color\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"color\", rest);\r\n                  break;\r\n               case \"defaultlayout\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"layout\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"layout\", rest);\r\n                  break;\r\n               case \"defaultfont\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"font\", attribs[attrib]));\r\n                  if (rest==\"* * *\") rest = \"\"; // all default\r\n                  attribs[attrib] = sheet.GetStyleNum(\"font\", rest);\r\n                  break;\r\n               case \"defaulttextformat\":\r\n               case \"defaultnontextformat\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"cellformat\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"cellformat\", rest);\r\n                  break;\r\n               case \"defaulttextvalueformat\":\r\n               case \"defaultnontextvalueformat\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"valueformat\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\r\n                  for (cr in sheet.cells) { // forget all cached display strings\r\n                     delete sheet.cells[cr].displaystring;\r\n                     }\r\n                  break;\r\n               case \"lastcol\":\r\n               case \"lastrow\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\r\n                  num = rest-0;\r\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 1;\r\n                  break;\r\n               case \"recalc\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\r\n                  if (rest == \"off\") {\r\n                     attribs.recalc = rest; // manual recalc, not auto\r\n                     }\r\n                  else { // all values other than \"off\" mean \"on\"\r\n                     delete attribs.recalc;\r\n                     }\r\n                  break;\r\n               case \"usermaxcol\":\r\n               case \"usermaxrow\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\r\n                  num = rest-0;\r\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 0;\r\n                  break;\r\n               default:\r\n                  errortext = scc.s_escUnknownSheetCmd+cmdstr;\r\n                  break;\r\n               }\r\n            }\r\n\r\n         else if (/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(what)) { // col attributes\r\n            sheet.renderneeded = true;\r\n            \r\n            what = what.toUpperCase();\r\n            pos = what.indexOf(\":\");\r\n            if (pos>=0) {\r\n               cr1 = SocialCalc.coordToCr(what.substring(0,pos)+\"1\");\r\n               cr2 = SocialCalc.coordToCr(what.substring(pos+1)+\"1\");\r\n               }\r\n            else {\r\n               cr1 = SocialCalc.coordToCr(what+\"1\");\r\n               cr2 = cr1;\r\n               }\r\n            for (col=cr1.col; col <= cr2.col; col++) {\r\n               if (attrib==\"width\") {\r\n                  cr = SocialCalc.rcColname(col);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" width\", sheet.colattribs.width[cr]);\r\n                  if (rest.length > 0 ) {\r\n                     sheet.colattribs.width[cr] = rest;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs.width[cr];\r\n                     }\r\n                  }\r\n               else if (attrib==\"hide\") {\r\n                  sheet.hiddencolrow = \"col\";\r\n                  cr = SocialCalc.rcColname(col);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" hide\", sheet.colattribs.hide[cr]);\r\n                  if (rest.length > 0) {\r\n                     sheet.colattribs.hide[cr] = rest; \r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs.hide[cr];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         else if (/^\\d+(:\\d+)?$/i.test(what)) { // row attributes\r\n            sheet.renderneeded = true;\r\n            what = what.toUpperCase();\r\n            pos = what.indexOf(\":\");\r\n            if (pos>=0) {\r\n               cr1 = SocialCalc.coordToCr(\"A\"+what.substring(0,pos));\r\n               cr2 = SocialCalc.coordToCr(\"A\"+what.substring(pos+1));\r\n               }\r\n            else {\r\n               cr1 = SocialCalc.coordToCr(\"A\"+what);\r\n               cr2 = cr1;\r\n               }\r\n            for (row=cr1.row; row <= cr2.row; row++) {\r\n               if (attrib==\"height\") {\r\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" height\", sheet.rowattribs.height[row]);\r\n                  if (rest.length > 0 ) {\r\n                     sheet.rowattribs.height[row] = rest;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs.height[row];\r\n                     }\r\n                  }\r\n               else if (attrib==\"hide\") {\r\n                  sheet.hiddencolrow = \"row\";\r\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" hide\", sheet.rowattribs.hide[row]);\r\n                  if (rest.length > 0) {\r\n                     sheet.rowattribs.hide[row] = rest; \r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs.hide[row];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         else if (/^[a-z]{1,2}\\d+(:[a-z]{1,2}\\d+)?$/i.test(what)) { // cell attributes\r\n           cellChanged = true;\r\n            ParseRange();\r\n            if (cr1.row!=cr2.row || cr1.col!=cr2.col || sheet.celldisplayneeded || sheet.renderneeded) { // not one cell\r\n               sheet.renderneeded = true;\r\n               sheet.celldisplayneeded = \"\";\r\n               }\r\n            else {\r\n               sheet.celldisplayneeded = SocialCalc.crToCoord(cr1.col, cr1.row);\r\n               }\r\n            for (row=cr1.row; row <= cr2.row; row++) {\r\n               for (col=cr1.col; col <= cr2.col; col++) {\r\n                  cr = SocialCalc.crToCoord(col, row);\r\n                  cell=sheet.GetAssuredCell(cr);\r\n                  if (cell.readonly && attrib!=\"readonly\") continue;\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n                  if (attrib==\"value\") { // set coord value type numeric-value\r\n                     pos = rest.indexOf(\" \");\r\n                     cell.datavalue = rest.substring(pos+1)-0;\r\n                     delete cell.errors;\r\n                     cell.datatype = \"v\";\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"text\") { // set coord text type text-value\r\n                     pos = rest.indexOf(\" \");\r\n                     cell.datavalue = SocialCalc.decodeFromSave(rest.substring(pos+1));\r\n                     delete cell.errors;\r\n                     cell.datatype = \"t\";\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"formula\") { // set coord formula formula-body-less-initial-=\r\n                     cell.datavalue = 0; // until recalc\r\n                     delete cell.errors;\r\n                     cell.datatype = \"f\";\r\n                     if(SocialCalc._app && cell.valuetype != \"e#N/A\") cell.prevvaluetype = cell.valuetype;  // repaint when widgets added/removed \r\n                     cell.valuetype = \"e#N/A\"; // until recalc\r\n                     cell.formula = rest;\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"constant\") { // set coord constant type numeric-value source-text\r\n                     pos = rest.indexOf(\" \");\r\n                     pos2 = rest.substring(pos+1).indexOf(\" \");\r\n                     cell.datavalue = rest.substring(pos+1,pos+1+pos2)-0;\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     if (cell.valuetype.charAt(0)==\"e\") { // error\r\n                        cell.errors = cell.valuetype.substring(1);\r\n                        }\r\n                     else {\r\n                        delete cell.errors;\r\n                        }\r\n                     cell.datatype = \"c\";\r\n                     cell.formula = rest.substring(pos+pos2+2);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"empty\") { // erase value\r\n                     cell.datavalue = \"\";\r\n                     delete cell.errors;\r\n                     cell.datatype = null;\r\n                     cell.formula = \"\";\r\n                     cell.valuetype = \"b\";\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"all\") { // set coord all :this:val1:that:val2...\r\n                     if (rest.length>0) {\r\n                        cell = new SocialCalc.Cell(cr);\r\n                        sheet.CellFromStringParts(cell, rest.split(\":\"), 1);\r\n                        sheet.cells[cr] = cell;\r\n                        }\r\n                     else {\r\n                        delete sheet.cells[cr];\r\n                        }\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (/^b[trbl]$/.test(attrib)) { // set coord bt 1px solid black\r\n                     cell[attrib] = sheet.GetStyleNum(\"borderstyle\", rest);\r\n                     sheet.renderneeded = true; // affects more than just one cell\r\n                     }\r\n                  else if (attrib==\"color\" || attrib==\"bgcolor\") {\r\n                     cell[attrib] = sheet.GetStyleNum(\"color\", rest);\r\n                     }\r\n                  else if (attrib==\"layout\" || attrib==\"cellformat\") {\r\n                     cell[attrib] = sheet.GetStyleNum(attrib, rest);\r\n                     }\r\n                  else if (attrib==\"font\") { // set coord font style weight size family\r\n                     if (rest==\"* * *\") rest = \"\";\r\n                     cell[attrib] = sheet.GetStyleNum(\"font\", rest);\r\n                     }\r\n                  else if (attrib==\"textvalueformat\" || attrib==\"nontextvalueformat\") {\r\n                     cell[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\r\n                     delete cell.displaystring;\r\n                     }\r\n                  else if (attrib==\"cssc\") {\r\n                     rest = rest.replace(/[^a-zA-Z0-9\\-]/g, \"\");\r\n                     cell.cssc = rest;\r\n                     }\r\n                  else if (attrib==\"csss\") {\r\n                     rest = rest.replace(/\\n/g, \"\");\r\n                     cell.csss = rest;\r\n                     }\r\n                  else if (attrib==\"mod\") {\r\n                     rest = rest.replace(/[^yY]/g, \"\").toLowerCase();\r\n                     cell.mod = rest;\r\n                     }\r\n                  else if (attrib==\"comment\") {\r\n                     cell.comment = SocialCalc.decodeFromSave(rest);\r\n                     }\r\n                  else if (attrib==\"readonly\") {\r\n                     cell.readonly = rest.toLowerCase()==\"yes\";\r\n                     }\r\n                  else {\r\n                     errortext = scc.s_escUnknownSetCoordCmd+cmdstr;\r\n                     }\r\n                  }\r\n               }\r\n\r\n            }\r\n         break;\r\n\r\n      case \"merge\":\r\n         sheet.renderneeded = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         cell=sheet.GetAssuredCell(cr1.coord);\r\n         if (cell.readonly) break;\r\n         if (saveundo) changes.AddUndo(\"unmerge \"+cr1.coord);\r\n\r\n         if (cr2.col > cr1.col) cell.colspan = cr2.col - cr1.col + 1;\r\n         else delete cell.colspan;\r\n         if (cr2.row > cr1.row) cell.rowspan = cr2.row - cr1.row + 1;\r\n         else delete cell.rowspan;\r\n\r\n         sheet.changedrendervalues = true;\r\n\r\n         break;\r\n\r\n      case \"unmerge\":\r\n         sheet.renderneeded = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         cell=sheet.GetAssuredCell(cr1.coord);\r\n         if (cell.readonly) break;\r\n         if (saveundo) changes.AddUndo(\"merge \"+cr1.coord+\":\"+SocialCalc.crToCoord(cr1.col+(cell.colspan||1)-1, cr1.row+(cell.rowspan||1)-1));\r\n\r\n         delete cell.colspan;\r\n         delete cell.rowspan;\r\n\r\n         sheet.changedrendervalues = true;\r\n\r\n         break;\r\n\r\n      case \"erase\":\r\n      case \"cut\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         if (cmd1==\"cut\") { // save copy of whole thing before erasing\r\n            if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n            SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\r\n            }\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) {\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               if (rest==\"all\") {\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               else if (rest == \"formulas\") {\r\n                  cell.datavalue = \"\";\r\n                  cell.datatype = null;\r\n                  cell.formula = \"\";\r\n                  cell.valuetype = \"b\";\r\n                  delete cell.errors;\r\n                  delete cell.displaystring;\r\n                  delete cell.parseinfo;\r\n                  if (cell.comment) { // comments are considered content for erasing\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               else if (rest == \"formats\") {\r\n                  newcell = new SocialCalc.Cell(cr); // create a new cell without attributes\r\n                  newcell.datavalue = cell.datavalue; // copy existing values\r\n                  newcell.datatype = cell.datatype;\r\n                  newcell.formula = cell.formula;\r\n                  newcell.valuetype = cell.valuetype;\r\n                  if (cell.comment) {\r\n                     newcell.comment = cell.comment;\r\n                     }\r\n                  sheet.cells[cr] = newcell; // replace\r\n                  }\r\n               }\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"fillright\":\r\n      case \"filldown\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         function increment_amount(down) {\r\n            function valid_datatype(type) {\r\n\t\treturn type == \"v\" || type == \"c\";\r\n            }\r\n            var editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n            var range = editor.range2;\r\n            var returnval = undefined; \r\n            if (range.hasrange) {\r\n                var startcell, endcell;\r\n                if (down && (range.bottom - range.top == 1) && range.left == range.right) {\r\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\r\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.bottom));\r\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\r\n                      returnval =  endcell.datavalue - startcell.datavalue;\r\n                  }\r\n                } else if (!down && range.left != range.right) {\r\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\r\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.right, range.top));\r\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\r\n                      returnval =  endcell.datavalue - startcell.datavalue;\r\n\t\t  }\r\n                }\r\n            }\r\n           editor.Range2Remove();\r\n           return returnval;\r\n         }\r\n\t var inc;\r\n         if (cmd1 == \"fillright\") {\r\n            fillright = true;\r\n            rowstart = cr1.row;\r\n            colstart = cr1.col + 1;\r\n\t    inc = increment_amount(false);\r\n            }\r\n         else {\r\n            fillright = false;\r\n            rowstart = cr1.row + 1;\r\n            colstart = cr1.col;\r\n\t    inc = increment_amount(true);\r\n            }\r\n         for (row = rowstart; row <= cr2.row; row++) {\r\n            for (col = colstart; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               if (fillright) {\r\n                  crbase = SocialCalc.crToCoord(cr1.col, row);\r\n                  coloffset = col - colstart + 1;\r\n                  rowoffset = 0;\r\n                  }\r\n               else {\r\n                  crbase = SocialCalc.crToCoord(col, cr1.row);\r\n                  coloffset = 0;\r\n                  rowoffset = row - rowstart + 1;\r\n                  }\r\n               basecell = sheet.GetAssuredCell(crbase);\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                  for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        cell[attrib] = basecell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  if (inc !== undefined) {\r\n                      cell.datavalue = basecell.datavalue + (fillright ? coloffset : rowoffset)*inc;\r\n                  } else {\r\n                      cell.datavalue = basecell.datavalue;\r\n                  }\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\r\n                     }\r\n                  else {\r\n                     cell.formula = basecell.formula;\r\n                     }\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"copy\":\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\r\n         break;\r\n\r\n      case \"loadclipboard\":\r\n         rest = cmd.RestOfString();\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = SocialCalc.decodeFromSave(rest);\r\n         break;\r\n\r\n      case \"clearclipboard\":\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = \"\";\r\n         break;\r\n\r\n      case \"paste\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         if (!SocialCalc.Clipboard.clipboard) {\r\n            break;\r\n            }\r\n         clipsheet = new SocialCalc.Sheet(); // load clipboard contents as another sheet\r\n         clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\r\n         cliprange = SocialCalc.ParseRange(clipsheet.copiedfrom);\r\n         coloffset = cr1.col - cliprange.cr1.col; // get sizes, etc.\r\n         rowoffset = cr1.row - cliprange.cr1.row;\r\n         numcols = Math.max(cr2.col - cr1.col + 1, cliprange.cr2.col - cliprange.cr1.col + 1);\r\n         numrows = Math.max(cr2.row - cr1.row + 1, cliprange.cr2.row - cliprange.cr1.row + 1);\r\n         if (cr1.col+numcols-1 > attribs.lastcol) attribs.lastcol = cr1.col+numcols-1;\r\n         if (cr1.row+numrows-1 > attribs.lastrow) attribs.lastrow = cr1.row+numrows-1;\r\n\r\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\r\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               crbase = SocialCalc.crToCoord(\r\n                  cliprange.cr1.col + ((col-cr1.col) % (cliprange.cr2.col - cliprange.cr1.col + 1)), \r\n                  cliprange.cr1.row + ((row-cr1.row) % (cliprange.cr2.row - cliprange.cr1.row + 1)));\r\n               basecell = clipsheet.GetAssuredCell(crbase);\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                 // get source width and hidden attribute\r\n                 // and copy to sheet \r\n                 if(row == cr1.row) { // only need 1st row of cols\r\n                   // col attributes\r\n                   sourceColname = SocialCalc.rcColname(cliprange.cr1.col + ((col-cr1.col) % (cliprange.cr2.col - cliprange.cr1.col + 1)));\r\n                   colWidth = clipsheet.colattribs.width[ sourceColname];\r\n                   colHide = clipsheet.colattribs.hide[sourceColname];\r\n                   if (colWidth != null) {\r\n                     // if source col width exists\r\n                     // set dest col width\r\n                     sheet.colattribs.width[SocialCalc.rcColname(col)] = colWidth;\r\n                     }\r\n                   if (colHide != null) {\r\n                     // if source col is hidden\r\n                     // set dest col hidden\r\n                     sheet.colattribs.hide[SocialCalc.rcColname(col)] = colHide;\r\n                     }                   \r\n                   }\r\n                 if(col == cr1.col) {  // only need 1st col or rows\r\n                   // row attributes\r\n                   sourceRow = cliprange.cr1.row + ((row-cr1.row) % (cliprange.cr2.row - cliprange.cr1.row + 1));\r\n                   rowHide = clipsheet.rowattribs.hide[sourceRow];\r\n                   if (rowHide != null) {\r\n                     // if source row is hidden\r\n                     // set dest row hidden\r\n                     sheet.rowattribs.hide[row] = rowHide;\r\n                     }                   \r\n                 }\r\n\r\n                 for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        attribtable = SocialCalc.CellPropertiesTable[attrib];\r\n                        if (attribtable && basecell[attrib]) { // table indexes to expand to strings since other sheet may have diff indexes\r\n                           cell[attrib] = sheet.GetStyleNum(attribtable, clipsheet.GetStyleString(attribtable, basecell[attrib]));\r\n                           }\r\n                        else { // these are not table indexes\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  cell.datavalue = basecell.datavalue;\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\r\n                     }\r\n                  else {\r\n                     cell.formula = basecell.formula;\r\n                     }\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\r\n                     cell.comment = basecell.comment;\r\n                     }\r\n                  else if (cell.comment) {\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"sort\": // sort cr1:cr2 col1 up/down col2 up/down col3 up/down\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         ParseRange();\r\n         cols = []; // get columns and sort directions (or \"\")\r\n         dirs = [];\r\n         lastsortcol = 0;\r\n         for (i=0; i<=3; i++) {\r\n            cols[i] = cmd.NextToken();\r\n            dirs[i] = cmd.NextToken();\r\n            if (cols[i]) lastsortcol = i;\r\n            }\r\n\r\n         sortcells = {}; // a copy of the data which will replace the original, but in the new order\r\n         sortlist = []; // an array of 0, 1, ..., nrows-1 needed for sorting\r\n         sortvalues = []; // values to be sorted corresponding to sortlist\r\n         sorttypes = []; // basic types of the values\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) { // fill in the sort info\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.cells[cr];\r\n               if (cell) { // only copy non-empty cells\r\n                  sortcells[cr] = sheet.CellToString(cell);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sortcells[cr]);\r\n                  }\r\n               else {\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\");\r\n                  }\r\n               }\r\n            sortlist.push(sortlist.length);\r\n            sortvalues.push([]);\r\n            sorttypes.push([]);\r\n            slast = sorttypes.length-1;\r\n            for (i = 0; i <= lastsortcol; i++) {\r\n               cr = cols[i] + row; // get cr on this row in sort col\r\n               cell = sheet.GetAssuredCell(cr);\r\n               val = cell.datavalue;\r\n               valtype = cell.valuetype.charAt(0) || \"b\";\r\n               if (valtype == \"t\") val = val.toLowerCase();\r\n               sortvalues[slast].push(val);\r\n               sorttypes[slast].push(valtype);\r\n               }\r\n            }\r\n\r\n         sortfunction = function(a, b) { // a comparison function that can handle all the type variations\r\n            var i, a1, b1, ta, cresult;\r\n            for (i=0; i<=lastsortcol; i++) {\r\n               if (dirs[i] == \"up\") { // handle sort direction\r\n                  a1 = a; b1 = b;\r\n                  }\r\n               else {\r\n                  a1 = b; b1 = a;\r\n                  }\r\n               ta = sorttypes[a1][i];\r\n               tb = sorttypes[b1][i];\r\n               if (ta == \"t\") { // numbers < text < errors, blank always last no matter what dir\r\n                  if (tb == \"t\") {\r\n                     a1 = sortvalues[a1][i];\r\n                     b1 = sortvalues[b1][i];\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"n\") {\r\n                     cresult = 1;\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else if (tb == \"e\") {\r\n                     cresult = -1;\r\n                     }\r\n                  }\r\n               else if (ta == \"n\") {\r\n                  if (tb == \"t\") {\r\n                     cresult = -1;\r\n                     }\r\n                  else if (tb == \"n\") {\r\n                     a1 = sortvalues[a1][i]-0; // force to numeric, just in case\r\n                     b1 = sortvalues[b1][i]-0;\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else if (tb == \"e\") {\r\n                     cresult = -1;\r\n                     }\r\n                  }\r\n               else if (ta == \"e\") {\r\n                  if (tb == \"e\") {\r\n                     a1 = sortvalues[a1][i];\r\n                     b1 = sortvalues[b1][i];\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else {\r\n                     cresult = 1;\r\n                     }\r\n                  }\r\n               else if (ta == \"b\") {\r\n                  if (tb == \"b\") {\r\n                     cresult = 0;\r\n                     }\r\n                  else {\r\n                     cresult = dirs[i] == \"up\" ? 1 : -1;\r\n                     }\r\n                  }\r\n               if (cresult) { // return if tested not equal, otherwise do next column\r\n                  return cresult;\r\n                  }\r\n               }\r\n            cresult = a > b ? 1 : (a < b ? -1 : 0); // equal - return position in original to maintain it\r\n            return cresult;\r\n            }\r\n\r\n         sortlist.sort(sortfunction);\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) { // copy original rows into sorted positions\r\n            originalrow = sortlist[row-cr1.row]; // relative position where it was in original\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               sortedcr = SocialCalc.crToCoord(col, originalrow+cr1.row); // original cell to be put in new place\r\n               if (sortcells[sortedcr]) {\r\n                  cell = new SocialCalc.Cell(cr);\r\n                  sheet.CellFromStringParts(cell, sortcells[sortedcr].split(\":\"), 1);\r\n                  if (cell.datatype == \"f\") { // offset coord refs, even to ***relative*** coords in other sheets\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(cell.formula, 0, (row-cr1.row)-originalrow);\r\n                     }\r\n                  sheet.cells[cr] = cell;\r\n                  }\r\n               else {\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"insertcol\":\r\n      case \"insertrow\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         sheet.widgetsClean = false; //  force widgets to repaint - update cell reference in widget HTML \r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n\r\n         if (cmd1 == \"insertcol\") {\r\n            coloffset = 1;\r\n            colend = cr1.col;\r\n            rowoffset = 0;\r\n            rowend = 1;\r\n            newcolstart = cr1.col;\r\n            newcolend = cr1.col;\r\n            newrowstart = 1;\r\n            newrowend = attribs.lastrow;\r\n            if (saveundo) changes.AddUndo(\"deletecol \"+cr1.coord);\r\n            }\r\n         else {\r\n            coloffset = 0;\r\n            colend = 1;\r\n            rowoffset = 1;\r\n            rowend = cr1.row;\r\n            newcolstart = 1;\r\n            newcolend = attribs.lastcol;\r\n            newrowstart = cr1.row;\r\n            newrowend = cr1.row;\r\n            if (saveundo) changes.AddUndo(\"deleterow \"+cr1.coord);\r\n            }\r\n\r\n         for (row=attribs.lastrow; row >= rowend; row--) { // copy the cells forward\r\n            for (col=attribs.lastcol; col >= colend; col--) {\r\n               crbase = SocialCalc.crToCoord(col, row);\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               if (!sheet.cells[crbase]) { // copying empty cell\r\n                  delete sheet.cells[cr]; // delete anything that may have been there\r\n                  }\r\n               else { // overwrite existing cell with moved contents\r\n                  sheet.cells[cr] = sheet.cells[crbase];\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (row=newrowstart; row <= newrowend; row++) { // fill the \"new\" empty cells\r\n            for (col=newcolstart; col <= newcolend; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell = new SocialCalc.Cell(cr);\r\n               sheet.cells[cr] = cell;\r\n               crbase = SocialCalc.crToCoord(col-coloffset, row-rowoffset); // copy attribs of the one before (0 gives you A or 1)\r\n               basecell = sheet.GetAssuredCell(crbase);\r\n               for (attrib in cellProperties) {\r\n                  if (cellProperties[attrib] == 2) { // copy only format attributes\r\n                     cell[attrib] = basecell[attrib];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell && cell.datatype == \"f\") {\r\n                cell.formula = SocialCalc.AdjustFormulaCoords(cell.formula, cr1.col, coloffset, cr1.row, rowoffset);\r\n                }\r\n             if (cell) {\r\n                delete cell.parseinfo;\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\r\n               }\r\n            }\r\n\r\n         for (row = attribs.lastrow; row >= rowend && cmd1 == \"insertrow\"; row--) { // copy the row attributes forward\r\n            rownext = row + rowoffset;\r\n            for (attrib in sheet.rowattribs) {\r\n               val = sheet.rowattribs[attrib][row];\r\n               if (sheet.rowattribs[attrib][rownext] != val) { // make assignment only if different\r\n                  if (val) {\r\n                     sheet.rowattribs[attrib][rownext] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs[attrib][rownext];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (col = attribs.lastcol; col >= colend && cmd1 == \"insertcol\"; col--) { // copy the column attributes forward\r\n            colthis = SocialCalc.rcColname(col);\r\n            colnext = SocialCalc.rcColname(col + coloffset);\r\n            for (attrib in sheet.colattribs) {\r\n               val = sheet.colattribs[attrib][colthis];\r\n               if (sheet.colattribs[attrib][colnext] != val) { // make assignment only if different\r\n                  if (val) {\r\n                     sheet.colattribs[attrib][colnext] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs[attrib][colnext];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         // Expand merged cells if the new row/col is in between\r\n\r\n         var tempRenderContext = new SocialCalc.RenderContext(sheet)\r\n         tempRenderContext.CalculateCellSkipData()\r\n\r\n         var cellsToExpand = {} // Keep track of all merge spans we've expanded\r\n                                // so we don't expand one twice\r\n         for (var skipCell in tempRenderContext.cellskip) {\r\n             var skipCellCR = SocialCalc.coordToCr(skipCell)\r\n               , mergerCellCoords = tempRenderContext.cellskip[skipCell]\r\n             // for insertcol we check if the newly inserted col has\r\n             // has any spans. This can only mean, that those cells\r\n             // are part of a row span\r\n             if (cmd1 === \"insertcol\" && skipCellCR.col === newcolstart) {\r\n                if (!cellsToExpand[mergerCellCoords]) {\r\n                    sheet.GetAssuredCell(mergerCellCoords).colspan += coloffset\r\n                    }\r\n                cellsToExpand[mergerCellCoords] = true\r\n                }\r\n             // for insertrow it's the same method\r\n             if (cmd1 === \"insertrow\" && skipCellCR.row === newrowstart) {\r\n                if (!cellsToExpand[mergerCellCoords]) {\r\n                    sheet.GetAssuredCell(mergerCellCoords).rowspan += rowoffset\r\n                    }\r\n                cellsToExpand[mergerCellCoords] = true\r\n                }\r\n            }\r\n\r\n         attribs.lastcol += coloffset;\r\n         attribs.lastrow += rowoffset;\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"deletecol\":\r\n      case \"deleterow\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         sheet.widgetsClean = false; // update cell reference in widget HTML - force widgets to repaint\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         lastcol = attribs.lastcol; // save old values since ParseRange sets...\r\n         lastrow = attribs.lastrow;\r\n         ParseRange();\r\n\r\n         if (cmd1 == \"deletecol\") {\r\n            coloffset = cr1.col - cr2.col - 1;\r\n            rowoffset = 0;\r\n            colstart = cr2.col + 1;\r\n            rowstart = 1;\r\n            }\r\n         else {\r\n            coloffset = 0;\r\n            rowoffset = cr1.row - cr2.row - 1;\r\n            colstart = 1;\r\n            rowstart = cr2.row + 1;\r\n            }\r\n\r\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // check for readonly cells\r\n            for (col=colstart; col <= lastcol - coloffset; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               cell = sheet.cells[cr];\r\n               if (cell && cell.readonly) {\r\n                    errortext = \"Unable to remove \" + (cmd1 == \"deletecol\" ? \"column\" : \"row\") + \", because cell \" + cell.coord + \" is locked\";\r\n                    return errortext; \r\n               }\r\n            }\r\n         }\r\n\r\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // copy the cells backwards - extra so no dup of last set\r\n            for (col=colstart; col <= lastcol - coloffset; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               if (saveundo && (row<rowstart-rowoffset || col<colstart\t-coloffset)) { // save cells that are overwritten as undo info\r\n                  cell = sheet.cells[cr];\r\n                  if (!cell) { // empty cell\r\n                     changes.AddUndo(\"erase \"+cr+\" all\");\r\n                     }\r\n                  else {\r\n                     changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n                     }\r\n                  }\r\n               crbase = SocialCalc.crToCoord(col, row);\r\n               cell = sheet.cells[crbase];\r\n               if (!cell) { // copying empty cell\r\n                  delete sheet.cells[cr]; // delete anything that may have been there\r\n                  }\r\n               else { // overwrite existing cell with moved contents\r\n                  sheet.cells[cr] = cell;\r\n                  }\r\n               }\r\n            }\r\n\r\n//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell) {\r\n                if (cell.datatype == \"f\") {\r\n                   oldformula = cell.formula;\r\n                   cell.formula = SocialCalc.AdjustFormulaCoords(oldformula, cr1.col, coloffset, cr1.row, rowoffset);\r\n                   if (cell.formula != oldformula) {\r\n                      delete cell.parseinfo;\r\n                      if (saveundo && cell.formula.indexOf(\"#REF!\")!=-1) { // save old version only if removed coord\r\n                         oldcr = SocialCalc.coordToCr(cr);\r\n                         changes.AddUndo(\"set \"+SocialCalc.rcColname(oldcr.col-coloffset)+(oldcr.row-rowoffset)+\r\n                                         \" formula \"+oldformula);\r\n                         }\r\n                      }\r\n                   }\r\n                else {\r\n                   delete cell.parseinfo;\r\n                   }\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\r\n               }\r\n            }\r\n\r\n         for (row = rowstart; row <= lastrow - rowoffset && cmd1 == \"deleterow\"; row++) { // copy the row attributes backwards\r\n            rowbefore = row + rowoffset;\r\n            for (attrib in sheet.rowattribs) {\r\n               val = sheet.rowattribs[attrib][row];\r\n               if (sheet.rowattribs[attrib][rowbefore] != val) { // make assignment only if different\r\n                  if (saveundo) changes.AddUndo(\"set \"+rowbefore+\" \"+attrib, sheet.rowattribs[attrib][rowbefore]);\r\n                  if (val) {\r\n                     sheet.rowattribs[attrib][rowbefore] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs[attrib][rowbefore];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (col = colstart; col <= lastcol - coloffset && cmd1 == \"deletecol\"; col++) { // copy the column attributes backwards\r\n            colthis = SocialCalc.rcColname(col);\r\n            colbefore = SocialCalc.rcColname(col + coloffset);\r\n            for (attrib in sheet.colattribs) {\r\n               val = sheet.colattribs[attrib][colthis];\r\n               if (sheet.colattribs[attrib][colbefore] != val) { // make assignment only if different\r\n                  if (saveundo) changes.AddUndo(\"set \"+colbefore+\" \"+attrib, sheet.colattribs[attrib][colbefore]);\r\n                  if (val) {\r\n                     sheet.colattribs[attrib][colbefore] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs[attrib][colbefore];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         // Shrink merged cells if the new row/col was in between\r\n\r\n         var tempRenderContext = new SocialCalc.RenderContext(sheet)\r\n         tempRenderContext.CalculateCellSkipData()\r\n\r\n         var cellsToShrink = {} // Keep track of shrinked cells, so we don't do it twice\r\n         for (var skipCell in tempRenderContext.cellskip) {\r\n             var skipCellCR = SocialCalc.coordToCr(skipCell)\r\n               , mergerCellCoords = tempRenderContext.cellskip[skipCell]\r\n               , mergerCellCR = tempRenderContext.coordToCR[mergerCellCoords]\r\n             // for deletecol we check if the removed col any spans that\r\n             // are from younger cols and shrink those\r\n             if (cmd1 === \"deletecol\" && skipCellCR.col === colstart+coloffset && mergerCellCR.col < skipCellCR.col) {\r\n                if (!cellsToShrink[mergerCellCoords]) {\r\n                    sheet.GetAssuredCell(mergerCellCoords).colspan += coloffset\r\n                    }\r\n                cellsToShrink[mergerCellCoords] = true\r\n                }\r\n             // for insertrow it's the same method\r\n             if (cmd1 === \"deleterow\" && skipCellCR.row === rowstart+rowoffset && mergerCellCR.row < skipCellCR.row) {\r\n                if (!cellsToShrink[mergerCellCoords]) {\r\n                    sheet.GetAssuredCell(mergerCellCoords).rowspan += rowoffset\r\n                    }\r\n                cellsToShrink[mergerCellCoords] = true\r\n                }\r\n            }\r\n\r\n         if (saveundo) {\r\n            if (cmd1 == \"deletecol\") {\r\n               for (col=cr1.col; col<=cr2.col; col++) {\r\n                  changes.AddUndo(\"insertcol \"+SocialCalc.rcColname(cr1.col));\r\n                  }\r\n               }\r\n            else {\r\n               for (row=cr1.row; row<=cr2.row; row++) {\r\n                  changes.AddUndo(\"insertrow \"+cr1.row);\r\n                  }\r\n               }\r\n            }\r\n\r\n         if (cmd1 == \"deletecol\") {\r\n            if (cr1.col <= lastcol) { // shrink sheet unless deleted phantom cols off the end\r\n               if (cr2.col <= lastcol) {\r\n                  attribs.lastcol += coloffset;\r\n                  }\r\n               else {\r\n                  attribs.lastcol = cr1.col - 1;\r\n                  }\r\n               }\r\n            }\r\n         else {\r\n            if (cr1.row <= lastrow) { // shrink sheet unless deleted phantom rows off the end\r\n               if (cr2.row <= lastrow) {\r\n                  attribs.lastrow += rowoffset;\r\n                  }\r\n               else {\r\n                  attribs.lastrow = cr1.row - 1;\r\n                  }\r\n               }\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n\r\n      case \"movepaste\":\r\n      case \"moveinsert\":\r\n\r\n         var movingcells, dest, destcr, inserthoriz, insertvert, pushamount, movedto;\r\n\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         dest = cmd.NextToken();\r\n         rest = cmd.RestOfString(); // rest is all/formulas/formats\r\n         if (rest==\"\") rest = \"all\";\r\n\r\n         ParseRange();\r\n\r\n         destcr = SocialCalc.coordToCr(dest);\r\n\r\n         coloffset = destcr.col - cr1.col;\r\n         rowoffset = destcr.row - cr1.row;\r\n         numcols = cr2.col - cr1.col + 1;\r\n         numrows = cr2.row - cr1.row + 1;\r\n\r\n         // get a copy of moving cells and erase from where they were\r\n\r\n         movingcells = {};\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) {\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n\r\n               if (!sheet.cells[cr]) { // if had nothing\r\n                  continue; // don't save anything\r\n                  }\r\n               movingcells[cr] = new SocialCalc.Cell(cr); // create new cell to copy\r\n\r\n               for (attrib in cellProperties) { // go through each property\r\n                  if (typeof cell[attrib] === undefined) { // don't copy undefined things and no need to delete\r\n                     continue;\r\n                     }\r\n                  else {\r\n                     movingcells[cr][attrib] = cell[attrib]; // copy for potential moving\r\n                     }\r\n                  if (rest == \"all\") {\r\n                     delete cell[attrib];\r\n                     }\r\n                  if (rest == \"formulas\") {\r\n                     if (cellProperties[attrib] == 1 || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     }\r\n                  if (rest == \"formats\") {\r\n                     if (cellProperties[attrib] == 2) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"formulas\") { // leave pristene deleted cell\r\n                  cell.datavalue = \"\";\r\n                  cell.datatype = null;\r\n                  cell.formula = \"\";\r\n                  cell.valuetype = \"b\";\r\n                  }\r\n               if (rest == \"all\") { // leave nothing for move all\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               }\r\n            }\r\n\r\n         // if moveinsert, check destination OK, and calculate pushing parameters\r\n\r\n         if (cmd1 == \"moveinsert\") {\r\n            inserthoriz = false;\r\n            insertvert = false;\r\n            if (rowoffset==0 && (destcr.col < cr1.col || destcr.col > cr2.col)) {\r\n               if (destcr.col < cr1.col) { // moving left\r\n                  pushamount = cr1.col - destcr.col;\r\n                  inserthoriz = -1;\r\n                  }\r\n               else {\r\n                  destcr.col -= 1;\r\n                  coloffset = destcr.col - cr2.col;\r\n                  pushamount = destcr.col - cr2.col;\r\n                  inserthoriz = 1;\r\n                  }\r\n               }\r\n            else if (coloffset==0 && (destcr.row < cr1.row || destcr.row > cr2.row)) {\r\n               if (destcr.row < cr1.row) { // moving up\r\n                  pushamount = cr1.row - destcr.row;\r\n                  insertvert = -1;\r\n                  }\r\n               else {\r\n                  destcr.row -= 1;\r\n                  rowoffset = destcr.row - cr2.row;\r\n                  pushamount = destcr.row - cr2.row;\r\n                  insertvert = 1;\r\n                  }\r\n               }\r\n            else {\r\n               cmd1 = \"movepaste\"; // not allowed right now - ignore\r\n               }                \r\n            }\r\n\r\n         // push any cells that need pushing\r\n\r\n         movedto = {}; // remember what was moved where\r\n\r\n         if (insertvert) {\r\n            for (row = 0; row < pushamount; row++) {\r\n               for (col = cr1.col; col <= cr2.col; col++) {\r\n                  if (insertvert < 0) {\r\n                     crbase = SocialCalc.crToCoord(col, destcr.row+pushamount-row-1); // from cell\r\n                     cr = SocialCalc.crToCoord(col, cr2.row-row); // to cell\r\n                     }\r\n                  else {\r\n                     crbase = SocialCalc.crToCoord(col, destcr.row-pushamount+row+1); // from cell\r\n                     cr = SocialCalc.crToCoord(col, cr1.row+row); // to cell\r\n                     }\r\n\r\n                  basecell = sheet.GetAssuredCell(crbase);\r\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\r\n\r\n                  cell = sheet.GetAssuredCell(cr);\r\n                  if (rest == \"all\" || rest == \"formats\") {\r\n                     for (attrib in cellProperties) {\r\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                           delete cell[attrib];\r\n                           }\r\n                        else {\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  if (rest == \"all\" || rest == \"formulas\") {\r\n                     cell.datavalue = basecell.datavalue;\r\n                     cell.datatype = basecell.datatype;            \r\n                     cell.valuetype = basecell.valuetype;\r\n                     cell.formula = basecell.formula;\r\n                     delete cell.parseinfo;\r\n                     cell.errors = basecell.errors;\r\n                     }\r\n                  delete cell.displaystring;\r\n\r\n                  movedto[crbase] = cr; // old crbase is now at cr\r\n                  }\r\n               }\r\n            }\r\n         if (inserthoriz) {\r\n            for (col = 0; col < pushamount; col++) {\r\n               for (row = cr1.row; row <= cr2.row; row++) {\r\n                  if (inserthoriz < 0) {\r\n                     crbase = SocialCalc.crToCoord(destcr.col+pushamount-col-1, row);\r\n                     cr = SocialCalc.crToCoord(cr2.col-col, row);\r\n                     }\r\n                  else {\r\n                     crbase = SocialCalc.crToCoord(destcr.col-pushamount+col+1, row);\r\n                     cr = SocialCalc.crToCoord(cr1.col+col, row);\r\n                     }\r\n\r\n                  basecell = sheet.GetAssuredCell(crbase);\r\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\r\n\r\n                  cell = sheet.GetAssuredCell(cr);\r\n                  if (rest == \"all\" || rest == \"formats\") {\r\n                     for (attrib in cellProperties) {\r\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                           delete cell[attrib];\r\n                           }\r\n                        else {\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  if (rest == \"all\" || rest == \"formulas\") {\r\n                     cell.datavalue = basecell.datavalue;\r\n                     cell.datatype = basecell.datatype;            \r\n                     cell.valuetype = basecell.valuetype;\r\n                     cell.formula = basecell.formula;\r\n                     delete cell.parseinfo;\r\n                     cell.errors = basecell.errors;\r\n                     }\r\n                  delete cell.displaystring;\r\n\r\n                  movedto[crbase] = cr; // old crbase is now at cr\r\n                  }\r\n               }\r\n            }\r\n\r\n         // paste moved cells into new place\r\n\r\n         if (destcr.col+numcols-1 > attribs.lastcol) attribs.lastcol = destcr.col+numcols-1;\r\n         if (destcr.row+numrows-1 > attribs.lastrow) attribs.lastrow = destcr.row+numrows-1;\r\n\r\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\r\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n\r\n               crbase = SocialCalc.crToCoord(col, row); // get old cell to move\r\n\r\n               movedto[crbase] = cr; // old crbase (moved cell) will now be at cr (destination)\r\n\r\n               if (rest == \"all\" && !movingcells[crbase]) { // moving an empty cell\r\n                  delete sheet.cells[cr]; // make the cell empty\r\n                  continue;\r\n                  }\r\n\r\n               basecell = movingcells[crbase];\r\n               if (!basecell) basecell = sheet.GetAssuredCell(crbase);\r\n\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                  for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        cell[attrib] = basecell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  cell.datavalue = basecell.datavalue;\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  cell.formula = basecell.formula;\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\r\n                     cell.comment = basecell.comment;\r\n                     }\r\n                  else if (cell.comment) {\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         // do fixups\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell) {\r\n                if (cell.datatype == \"f\") {\r\n                   oldformula = cell.formula;\r\n                   cell.formula = SocialCalc.ReplaceFormulaCoords(oldformula, movedto);\r\n                   if (cell.formula != oldformula) {\r\n                      delete cell.parseinfo;\r\n                      if (saveundo && !movedto[cr]) { // moved cells are already saved for undo\r\n                         changes.AddUndo(\"set \"+cr+\" formula \"+oldformula);\r\n                         }\r\n                      }\r\n                   }\r\n                else {\r\n                   delete cell.parseinfo;\r\n                   }\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               oldformula = v1;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.ReplaceFormulaCoords(v1, movedto);\r\n               if (saveundo && sheet.names[name].definition != oldformula) { // save changes\r\n                  changes.AddUndo(\"name define \"+name+\" \"+oldformula);\r\n                  }\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"name\":\r\n         what = cmd.NextToken();\r\n         name = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n\r\n         name = name.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\r\n         if (name == \"\") break; // must have something\r\n\r\n         if (what == \"define\") {\r\n            if (rest == \"\") break; // must have something\r\n            if (sheet.names[name]) { // already exists\r\n               if (saveundo) changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\r\n               sheet.names[name].definition = rest;\r\n               }\r\n            else { // new\r\n               if (saveundo) changes.AddUndo(\"name delete \"+name);\r\n               sheet.names[name] = {definition: rest, desc: \"\"};\r\n               }\r\n            }\r\n         else if (what == \"desc\") {\r\n            if (sheet.names[name]) { // must already exist\r\n               if (saveundo) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\r\n               sheet.names[name].desc = rest;\r\n               }\r\n            }\r\n         else if (what == \"delete\") {\r\n            if (saveundo) {\r\n               if (sheet.names[name].desc) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\r\n               changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\r\n               }\r\n            delete sheet.names[name];\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n\r\n         break;\r\n\r\n      case \"recalc\":\r\n         attribs.needsrecalc = \"yes\"; // request recalc\r\n         sheet.recalconce = true; // even if turned off\r\n         break;\r\n\r\n      case \"redisplay\":\r\n         sheet.renderneeded = true;\r\n         break;\r\n\r\n      case \"changedrendervalues\": // needed for undo sometimes\r\n         sheet.changedrendervalues = true;\r\n         break;\r\n\r\n      case \"pane\":\r\n\r\n         name = cmd.NextToken().toUpperCase();\r\n         undoNum = 1;\r\n         editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n\r\n         if (name.toUpperCase() === 'ROW') {\r\n           row = parseInt(cmd.NextToken(), 10);\r\n\r\n           if (typeof(editor.context.rowpanes[1]) !== 'undefined' && typeof(editor.context.rowpanes[1].first) === 'number') {\r\n             undoNum = editor.context.rowpanes[1].first;\r\n           }\r\n           if (saveundo) changes.AddUndo('pane row ' + undoNum);\r\n\r\n           // Handle hidden row.\r\n           while (editor.context.sheetobj.rowattribs.hide[row] == 'yes') {\r\n             row++;\r\n           }\r\n\r\n           if ((!row || row<=editor.context.rowpanes[0].first) && editor.context.rowpanes.length>1) { // set to no panes, leaving first pane settings\r\n             editor.context.rowpanes.length = 1;\r\n           } else if (editor.context.rowpanes.length-1 && !editor.timeout) { // has 2 already\r\n             // not waiting for position calc (so positions could be wrong)\r\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\r\n             editor.context.SetRowPaneFirstLast(1, row, row);\r\n           } else {\r\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\r\n             editor.context.SetRowPaneFirstLast(1, row, row);\r\n           }\r\n           \r\n           // remove tracklingine\r\n           if (editor.griddiv) {\r\n             //trackingline-horizon\r\n             trackLine = document.getElementById('trackingline-vertical');\r\n             if (trackLine) {\r\n               editor.griddiv.removeChild(trackLine);\r\n               editor.FitToEditTable();\r\n             }\r\n           }\r\n\r\n         } else {\r\n\r\n           col = parseInt(cmd.NextToken(), 10);\r\n\r\n           if (typeof(editor.context.colpanes[1]) !== 'undefined' && typeof(editor.context.colpanes[1].first) === 'number') {\r\n             undoNum = editor.context.colpanes[1].first;\r\n           }\r\n           if (saveundo) changes.AddUndo('pane col ' + undoNum);\r\n\r\n           // Handle hidden column.\r\n           while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == 'yes') {\r\n             col++;\r\n           }\r\n\r\n           if ((!col || col<=editor.context.colpanes[0].first) && editor.context.colpanes.length > 1) { // set to no panes, leaving first pane settings\r\n             editor.context.colpanes.length = 1;\r\n           } else if (editor.context.colpanes.length-1 && !editor.timeout) { // has 2 already\r\n             // not waiting for position calc (so positions could be wrong)\r\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\r\n             editor.context.SetColPaneFirstLast(1, col, col);\r\n           } else {\r\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\r\n             editor.context.SetColPaneFirstLast(1, col, col);\r\n           }\r\n\r\n           // remove tracklingine\r\n           if (editor.griddiv) {\r\n             trackLine = document.getElementById('trackingline-horizon');\r\n             if (trackLine) {\r\n               editor.griddiv.removeChild(trackLine);\r\n               editor.FitToEditTable();\r\n             }\r\n           }\r\n         }\r\n\r\n         sheet.renderneeded = true;\r\n\r\n         break;\r\n\r\n      case \"startcmdextension\": // startcmdextension extension rest-of-command\r\n         name = cmd.NextToken();\r\n         cmdextension = sheet.sci.CmdExtensionCallbacks[name];\r\n         if (cmdextension) {\r\n            cmdextension.func(name, cmdextension.data, sheet, cmd, saveundo);\r\n            }\r\n         break;\r\n\r\n         // eddy ExecuteSheetCommand {\r\n//      case \"setemailparameters\":    \t  \r\n//    \t  break;\r\n    \t  \r\n      case \"settimetrigger\":    \r\n      case \"sendemail\":    \r\n      case \"submitform\":    \r\n    \t  // email/form/timetrigger handled by server, so ignore here\r\n    \t  break;\r\n         // } eddy ExecuteSheetCommand \r\n    \t  \r\n      default:\r\n         errortext = scc.s_escUnknownCmd+cmdstr;\r\n         break;\r\n      }\r\n\r\n/* For Debugging:\r\nvar ustack=\"\";\r\nfor (var i=0;i<sheet.changes.stack.length;i++) {\r\n   ustack+=(i-0)+\":\"+sheet.changes.stack[i].command[0]+\" of \"+sheet.changes.stack[i].command.length+\"/\"+sheet.changes.stack[i].undo[0]+\" of \"+sheet.changes.stack[i].undo.length+\",\";\r\n   }\r\nalert(cmdstr+\"|\"+sheet.changes.stack.length+\"--\"+ustack);\r\n*/\r\n   if(SocialCalc._app) {\r\n     // widgets need focus. In app mode, render widgets only when required. Rather than default of render everything\r\n     if(cellChanged) {\r\n       if(sheet.renderneeded == true && attrib!=\"value\" && attrib!=\"text\" && attrib!=\"formula\" && attrib!=\"constant\" && attrib!=\"empty\") sheet.widgetsClean = false;  // force widgets to render\r\n       else if(attrib==\"all\") sheet.widgetsClean = false;  // force widgets to render - because of undo\r\n       } \r\n     else {\r\n       if(sheet.renderneeded == true) sheet.widgetsClean = false;  // force widgets to render\r\n       }\r\n     }\r\n   \r\n   return errortext;\r\n\r\n   }\r\n\r\nSocialCalc.SheetUndo = function(sheet) {\r\n\r\n   var i;\r\n   var tos = sheet.changes.TOS();\r\n   var lastone = tos ? tos.undo.length-1 : -1;\r\n   var cmdstr = \"\";\r\n\r\n   for (i=lastone; i>=0; i--) { // do them backwards\r\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\r\n      cmdstr += tos.undo[i];\r\n      }\r\n   sheet.changes.Undo();\r\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\r\n\r\n   }\r\n\r\nSocialCalc.SheetRedo = function(sheet) {\r\n\r\n   var tos, i;\r\n   var didredo = sheet.changes.Redo();\r\n   if (!didredo) {\r\n      sheet.ScheduleSheetCommands(\"\", false); // schedule doing nothing\r\n      return;\r\n      }\r\n   tos = sheet.changes.TOS();\r\n   var cmdstr = \"\";\r\n\r\n   for (i=0; tos && i<tos.command.length; i++) {\r\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\r\n      cmdstr += tos.command[i];\r\n      }\r\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\r\n\r\n   }\r\n\r\nSocialCalc.CreateAuditString = function(sheet) {\r\n\r\n   var i, j;\r\n   var result = \"\";\r\n   var stack = sheet.changes.stack;\r\n   var tos = sheet.changes.tos;\r\n   for (i=0; i<=tos; i++) {\r\n      for (j=0; j<stack[i].command.length; j++) {\r\n         result += stack[i].command[j] + \"\\n\";\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\nSocialCalc.GetStyleNum = function(sheet, atype, style) {\r\n\r\n   var num;\r\n\r\n   if (style.length==0) return 0; // null means use zero, which means default or global default\r\n\r\n   num = sheet[atype+\"hash\"][style];\r\n   if (!num) {\r\n      if (sheet[atype+\"s\"].length<1) sheet[atype+\"s\"].push(\"\");\r\n      num = sheet[atype+\"s\"].push(style) - 1;\r\n      sheet[atype+\"hash\"][style] = num;\r\n      sheet.changedrendervalues = true;\r\n      }\r\n   return num;\r\n\r\n   }\r\n\r\nSocialCalc.GetStyleString = function(sheet, atype, num) {\r\n\r\n   if (!num) return null; // zero, null, and undefined return null\r\n\r\n   return sheet[atype+\"s\"][num];\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.OffsetFormulaCoords(formula, coloffset, rowoffset)\r\n//\r\n// Change relative cell references by offsets (even those to other worksheets so fill, paste, sort work as expected).\r\n// If not what you want, use absolute references.\r\n//\r\n\r\nSocialCalc.OffsetFormulaCoords = function(formula, coloffset, rowoffset) {\r\n\r\n   var parseinfo, ttext, ttype, i, cr, newcr;\r\n   var updatedformula = \"\";\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = scf.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_coord) {\r\n         newcr = \"\";\r\n         cr = SocialCalc.coordToCr(ttext);\r\n         if (ttext.charAt(0)!=\"$\") { // add col offset unless absolute column\r\n            cr.col += coloffset;\r\n            }\r\n         else {\r\n            newcr += \"$\";\r\n            }\r\n         newcr += SocialCalc.rcColname(cr.col);\r\n         if (ttext.indexOf(\"$\", 1)==-1) { // add row offset unless absolute row\r\n            cr.row += rowoffset;\r\n            }\r\n         else {\r\n            newcr += \"$\";\r\n            }\r\n         newcr += cr.row;\r\n         if (cr.row < 1 || cr.col < 1) {\r\n            newcr = \"#REF!\";\r\n            }\r\n         updatedformula += newcr;\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            updatedformula += '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else updatedformula += '\"' + ttext + '\"';\r\n         }\r\n      else if (ttype == token_op) {\r\n         updatedformula += tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      else { // leave everything else alone\r\n         updatedformula += ttext;\r\n         }\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.AdjustFormulaCoords(formula, col, coloffset, row, rowoffset)\r\n//\r\n// Change all cell references to cells starting with col/row by offsets\r\n//\r\n\r\nSocialCalc.AdjustFormulaCoords = function(formula, col, coloffset, row, rowoffset) {\r\n\r\n   var ttype, ttext, i, newcr;\r\n   var updatedformula = \"\";\r\n   var sheetref = false;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_op) { // references with sheet specifier are not offset\r\n         if (ttext == \"!\") {\r\n            sheetref = true; // found a sheet reference\r\n            }\r\n         else if (ttext != \":\") { // for everything but a range, reset\r\n            sheetref = false;\r\n            }\r\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      if (ttype == token_coord) {\r\n         cr = SocialCalc.coordToCr(ttext);\r\n         if ((coloffset < 0 && cr.col >= col && cr.col < col-coloffset) ||\r\n             (rowoffset < 0 && cr.row >= row && cr.row < row-rowoffset)) { // refs to deleted cells become invalid\r\n            if (!sheetref) {\r\n               cr.col = 0;\r\n               cr.row = 0;\r\n               }\r\n            }\r\n         if (!sheetref) {\r\n            if (cr.col >= col) {\r\n               cr.col += coloffset;\r\n               }\r\n            if (cr.row >= row) {\r\n               cr.row += rowoffset;\r\n               }\r\n            }\r\n         if (ttext.charAt(0)==\"$\") {\r\n            newcr = \"$\"+SocialCalc.rcColname(cr.col);\r\n            }\r\n         else {\r\n            newcr = SocialCalc.rcColname(cr.col);\r\n            }\r\n         if (ttext.indexOf(\"$\", 1)!=-1) {\r\n            newcr += \"$\" + cr.row;\r\n            }\r\n         else {\r\n            newcr += cr.row;\r\n            }\r\n         if (cr.row < 1 || cr.col < 1) {\r\n            newcr = \"#REF!\";\r\n            }\r\n         ttext = newcr;\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else ttext = '\"' + ttext + '\"';\r\n         }\r\n      updatedformula += ttext;\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.ReplaceFormulaCoords(formula, movedto)\r\n//\r\n// Change all cell references to cells that are keys in moveto to be to moveto[coord].\r\n// Don't change references to other sheets.\r\n// Handle range extents specially.\r\n//\r\n\r\nSocialCalc.ReplaceFormulaCoords = function(formula, movedto) {\r\n\r\n   var ttype, ttext, i, newcr, coord;\r\n   var updatedformula = \"\";\r\n   var sheetref = false;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_op) { // references with sheet specifier are not change\r\n         if (ttext == \"!\") {\r\n            sheetref = true; // found a sheet reference\r\n            }\r\n         else if (ttext != \":\") { // for everything but a range, reset\r\n            sheetref = false;\r\n            }\r\n\r\n//!!!! HANDLE RANGE EXTENT MOVES\r\n\r\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      if (ttype == token_coord) {\r\n         cr = SocialCalc.coordToCr(ttext); // get parts\r\n         coord = SocialCalc.crToCoord(cr.col, cr.row); // get \"clean\" reference\r\n         if (movedto[coord] && !sheetref) { // this is a reference to a moved cell\r\n            cr = SocialCalc.coordToCr(movedto[coord]); // get new row and col\r\n            if (ttext.charAt(0)==\"$\") { // copy absolute ref marks if present\r\n               newcr = \"$\"+SocialCalc.rcColname(cr.col);\r\n               }\r\n            else {\r\n               newcr = SocialCalc.rcColname(cr.col);\r\n               }\r\n            if (ttext.indexOf(\"$\", 1)!=-1) {\r\n               newcr += \"$\" + cr.row;\r\n               }\r\n            else {\r\n               newcr += cr.row;\r\n               }\r\n            ttext = newcr;\r\n            }\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else ttext = '\"' + ttext + '\"';\r\n         }\r\n      updatedformula += ttext;\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n\r\n// ************************\r\n//\r\n// Recalc Loop Code\r\n//\r\n// ************************\r\n\r\n//\r\n// How recalc works:\r\n//\r\n// !!!!!!!!!!!!!!\r\n//\r\n\r\n// SocialCalc.RecalcInfo - object with global recalc info\r\n\r\nSocialCalc.RecalcInfo = {\r\n\r\n   sheet: null, // which sheet is being recalced\r\n\r\n   currentState: 0, // current state\r\n   state: {idle: 0, start_calc: 1, order: 2, calc: 3, start_wait: 4, done_wait: 5}, // allowed state values\r\n\r\n   recalctimer: null, // value to cancel timer\r\n   maxtimeslice: 100, // maximum milliseconds per slice of recalc time before a wait\r\n   timeslicedelay: 1, // milliseconds to wait between recalc time slices\r\n   starttime: 0, // when recalc started\r\n\r\n   queue: [], // queue of sheet waiting to be recalced\r\n\r\n   // LoadSheet: a function that returns true if started a load or false if not.\r\n   //\r\n\r\n   LoadSheet: function(sheetname) {return false;} // default returns not found\r\n\r\n   }\r\n\r\n// SocialCalc.RecalcData - object with recalc info while determining recalc order and afterward\r\n\r\nSocialCalc.RecalcData = function() { // initialize a RecalcData object\r\n\r\n   this.inrecalc = true; // if true, doing a recalc\r\n   this.celllist = []; // list with all potential cells to calculate\r\n   this.celllistitem = 0; // cell to check next when ordering\r\n   this.calclist = null; // object which is the chained list of cells to calculate\r\n                         // each in the form of \"coord: nextcoord\"\r\n                         // e.g., if B8 is calculated right after A8, then calclist.A8==\"B8\"\r\n                         // if null, need to create the list\r\n   this.calclistlength = 0; // number of items in calclist\r\n\r\n   this.firstcalc = null; // start of the calc list - a string or null\r\n   this.lastcalc = null; // last one on chain (used to add more to the end)\r\n\r\n   this.nextcalc = null; // used to keep track during background recalc to make it restartable\r\n   this.count = 0; // number calculated\r\n\r\n   // checkinfo is used when determining calc order:\r\n\r\n   this.checkinfo = {}; // attributes are coords; if no attrib for a coord, it wasn't checked or doesn't need it\r\n                        // values are RecalcCheckInfo objects while checking or TRUE when complete\r\n\r\n   }\r\n\r\n// SocialCalc.RecalcCheckInfo - object that stores checking info while determining recalc order\r\n\r\nSocialCalc.RecalcCheckInfo = function() { // initialize a RecalcCheckInfo object\r\n\r\n   this.oldcoord = null; // chain back up of cells referring to cells\r\n   this.parsepos = 0; // which token we are up to\r\n\r\n   // range info\r\n\r\n   this.inrange = false; // if true, in the process of checking a range of coords\r\n   this.inrangestart = false; // if true, have not yet filled in range loop values\r\n   this.cr1 = null; // range first coord as a cr object\r\n   this.cr2 = null; // range second coord as a cr object\r\n   this.c1 = null; // range extents\r\n   this.c2 = null;\r\n   this.r1 = null;\r\n   this.r2 = null;\r\n   this.c = null; // looping values\r\n   this.r = null;\r\n   \r\n   }\r\n\r\n// Recalc the entire sheet\r\n\r\nSocialCalc.RecalcSheet = function(sheet) {\r\n\r\n   var coord, err, recalcdata;\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   if (scri.currentState != scri.state.idle) {\r\n      scri.queue.push(sheet);\r\n      return;\r\n      }\r\n\r\n   delete sheet.attribs.circularreferencecell; // reset recalc-wide things\r\n   SocialCalc.Formula.FreshnessInfoReset();\r\n\r\n   SocialCalc.RecalcClearTimeout();\r\n\r\n   scri.sheet = sheet; // set values needed by background recalc\r\n   scri.currentState = scri.state.start_calc;\r\n\r\n   scri.starttime = new Date();\r\n\r\n   if (sheet.statuscallback) {\r\n      sheet.statuscallback(scri, \"calcstart\", null, sheet.statuscallbackparams);\r\n      }\r\n\r\n   SocialCalc.RecalcSetTimeout();\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.RecalcSetTimeout - set a timer for next recalc step\r\n//\r\n\r\nSocialCalc.RecalcSetTimeout = function() {\r\n\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   scri.recalctimer = window.setTimeout(SocialCalc.RecalcTimerRoutine, scri.timeslicedelay);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.RecalcClearTimeout - cancel any timeouts\r\n//\r\n\r\nSocialCalc.RecalcClearTimeout = function() {\r\n\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   if (scri.recalctimer) {\r\n      window.clearTimeout(scri.recalctimer);\r\n      scri.recalctimer = null;\r\n      }\r\n\r\n   }\r\n\r\n  \r\n//\r\n// SocialCalc.RecalcLoadedSheet(sheetname, str, recalcneeded, live)\r\n//\r\n// Called when a sheet finishes loading with name, string, and t/f whether it should be recalced.\r\n// If loaded sheet has sheet.attribs.recalc==\"off\", then no recalc done.\r\n// If sheetname is null, then the sheetname waiting for will be used.\r\n//\r\n\r\nSocialCalc.RecalcLoadedSheet = function(sheetname, str, recalcneeded, live) {\r\n\r\n   var sheet;\r\n   var scri = SocialCalc.RecalcInfo;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   sheet = SocialCalc.Formula.AddSheetToCache(sheetname || scf.SheetCache.waitingForLoading, str, live);\r\n\r\n   if (recalcneeded && sheet && sheet.attribs.recalc!=\"off\") { // if recalcneeded, and not manual sheet, chain in this new sheet to recalc loop\r\n      sheet.previousrecalcsheet = scri.sheet;\r\n      scri.sheet = sheet;\r\n      scri.currentState = scri.state.start_calc;\r\n      }\r\n   scf.SheetCache.waitingForLoading = null;\r\n\r\n   SocialCalc.RecalcSetTimeout();\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.RecalcTimerRoutine - handles the actual order determination and cell-by-cell recalculation in the background\r\n//\r\n\r\nSocialCalc.RecalcTimerRoutine = function() {\r\n\r\n   var eresult, cell, coord, err, status;\r\n   var starttime = new Date();\r\n   var count = 0;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var scri = SocialCalc.RecalcInfo;\r\n   var sheet = scri.sheet;\r\n   if (!sheet) {\r\n      return;\r\n      }\r\n   var recalcdata = sheet.recalcdata || (sheet.recalcdata = {});\r\n\r\n   var do_statuscallback = function(status, arg) { // routine to do callback if required\r\n      if (sheet.statuscallback) {\r\n         sheet.statuscallback(recalcdata, status, arg, sheet.statuscallbackparams);\r\n         }\r\n      }\r\n\r\n   SocialCalc.RecalcClearTimeout();\r\n\r\n   if (scri.currentState == scri.state.start_calc) {\r\n\r\n      recalcdata = new SocialCalc.RecalcData();\r\n      sheet.recalcdata = recalcdata;\r\n\r\n      for (coord in sheet.cells) { // get list of cells to check for order\r\n         if (!coord) continue;\r\n         recalcdata.celllist.push(coord);\r\n         }\r\n\r\n      recalcdata.calclist = {}; // start with empty list\r\n      scri.currentState = scri.state.order; // drop through to determining recalc order\r\n      }\r\n\r\n   if (scri.currentState == scri.state.order) {\r\n      while (recalcdata.celllistitem < recalcdata.celllist.length) { // check all the cells to see if they should be on the list\r\n         coord = recalcdata.celllist[recalcdata.celllistitem++];\r\n         err = SocialCalc.RecalcCheckCell(sheet, coord);\r\n         if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\r\n            do_statuscallback(\"calcorder\", {coord: coord, total: recalcdata.celllist.length, count: recalcdata.celllistitem});\r\n            SocialCalc.RecalcSetTimeout();\r\n            return;\r\n            }\r\n         }\r\n\r\n      do_statuscallback(\"calccheckdone\", recalcdata.calclistlength);\r\n\r\n      recalcdata.nextcalc = recalcdata.firstcalc; // start at the beginning of the recalc chain\r\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   if (scri.currentState == scri.state.start_wait) { // starting to wait for something\r\n      scri.currentState = scri.state.done_wait; // finished on next timer call\r\n      if (scri.LoadSheet) {\r\n         status = scri.LoadSheet(scf.SheetCache.waitingForLoading);\r\n         if (status) { // started a load operation\r\n            return;\r\n            }\r\n         }\r\n      SocialCalc.RecalcLoadedSheet(null, \"\", false);\r\n      return;\r\n      }\r\n\r\n   if (scri.currentState == scri.state.done_wait) {\r\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   // otherwise should be scri.state.calc\r\n\r\n   if (scri.currentState != scri.state.calc) {\r\n      alert(\"Recalc state error: \"+scri.currentState+\". Error in SocialCalc code.\");\r\n      }\r\n\r\n   coord = sheet.recalcdata.nextcalc;\r\n   while (coord) {\r\n      cell = sheet.cells[coord];\r\n\t  // app widgets need cell ID so store in parseinfo {\r\n      if (!cell.parseinfo) { // cache parsed formula\r\n        cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\r\n        }\r\n      cell.parseinfo.coord = coord;\r\n\t  // }\r\n      eresult = scf.evaluate_parsed_formula(cell.parseinfo, sheet, false);\r\n      if (scf.SheetCache.waitingForLoading) { // wait until restarted\r\n         // schedule render to run while waiting for dependent sheet to load - schedules first render of sheet\r\n         if (scri.firstRenderScheduled != true) {\r\n           var editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n           editor.ScheduleRender(false);    \r\n           scri.firstRenderScheduled = true; // stop more renders because done first render of sheet\r\n         }\r\n         recalcdata.nextcalc = coord; // start with this cell again\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcloading\", {sheetname: scf.SheetCache.waitingForLoading});\r\n         scri.currentState = scri.state.start_wait; // start load on next timer call\r\n         SocialCalc.RecalcSetTimeout();\r\n         return;\r\n         }\r\n\r\n      if (scf.RemoteFunctionInfo.waitingForServer) { // wait until restarted\r\n         recalcdata.nextcalc = coord; // start with this cell again\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcserverfunc\",\r\n            {funcname: scf.RemoteFunctionInfo.waitingForServer, coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\r\n         scri.currentState = scri.state.done_wait; // start load on next timer call\r\n         return; // return and wait for next recalc timer event\r\n         }\r\n\r\n      if (cell.datavalue != eresult.value ||\r\n       cell.valuetype != eresult.type) { // only update if changed from last time\r\n         cell.datavalue = eresult.value;\r\n         cell.valuetype = eresult.type;\r\n         delete cell.displaystring;\r\n         sheet.recalcchangedavalue = true; // remember something changed in case other code wants to know\r\n         }\r\n      if (eresult.error) {\r\n         cell.errors = eresult.error;\r\n         }\r\n      count++;\r\n      coord = sheet.recalcdata.calclist[coord];\r\n\r\n      if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\r\n         recalcdata.nextcalc = coord; // start with next cell on chain\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcstep\", {coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\r\n         SocialCalc.RecalcSetTimeout();\r\n         return;\r\n         }\r\n      }\r\n\r\n   recalcdata.inrecalc = false;\r\n\r\n   sheet.reRenderCellList = sheet.recalcdata.celllist; // GUI widgets need focus - if app then only re-render non-widget cells\r\n   delete sheet.recalcdata; // save memory and clear out for name lookup formula evaluation\r\n\r\n   delete sheet.attribs.needsrecalc; // remember recalc done\r\n\r\n   scri.sheet = sheet.previousrecalcsheet || null; // chain back if doing recalc of loaded sheets\r\n   if (scri.sheet) {\r\n      scri.currentState = scri.state.calc; // start where we left off\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   scf.FreshnessInfo.recalc_completed = true; // say freshness info is complete\r\n   scri.currentState = scri.state.idle; // we are idle\r\n\r\n   do_statuscallback(\"calcfinished\", (new Date()) - scri.starttime);\r\n\r\n   // Check queue for more sheets.\r\n   if (scri.queue.length > 0) {\r\n      sheet = scri.queue.shift();\r\n      sheet.RecalcSheet();\r\n      }\r\n   }\r\n\r\n\r\n//\r\n// circref = SocialCalc.RecalcCheckCell(sheet, coord)\r\n//\r\n// Checks cell to put on calclist, looking at parsed tokens.\r\n// Also checks cells this cell is dependent upon\r\n// if it contains a formula with cell references.\r\n// If circular reference, returns non-null.\r\n//\r\n\r\nSocialCalc.RecalcCheckCell = function(sheet, startcoord) {\r\n\r\n   var parseinfo, ttext, ttype, i, rangecoord, circref, value, pos, pos2, cell, coordvals;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_name = tokentype.name;\r\n   var token_coord = tokentype.coord;\r\n\r\n   var recalcdata = sheet.recalcdata;\r\n   var checkinfo = recalcdata.checkinfo;\r\n\r\n   var sheetref = false; // if true, a sheet reference is in effect, so don't check that\r\n   var oldcoord = null; // coord of formula that referred to this one when checking down the tree\r\n   var coord = startcoord; // the coord of the cell we are checking\r\n\r\n   // Start with requested cell, and then continue down or up the dependency tree\r\n   // oldcoord (and checkinfo[coord].oldcoord) maintains the reference stack during the tree walk\r\n   // checkinfo[coord] maintains the stack of checking looping values, e.g., token number being checked\r\n\r\nmainloop:\r\n   while (coord) {\r\n      cell = sheet.cells[coord];\r\n      coordvals = checkinfo[coord];\r\n\r\n      if (!cell || cell.datatype != \"f\" || // Don't calculate if not a formula\r\n          (coordvals && typeof coordvals != \"object\")) { // Don't calc if already calculated\r\n         coord = oldcoord; // go back up dependency tree to coord that referred to us\r\n         if (checkinfo[coord]) oldcoord = checkinfo[coord].oldcoord;\r\n         continue;\r\n         }\r\n\r\n      if (!coordvals) { // do we have checking information about this cell?\r\n         coordvals = new SocialCalc.RecalcCheckInfo(); // no - make a place to hold it\r\n         checkinfo[coord] = coordvals;\r\n         }\r\n\r\n      if (cell.errors) { // delete errors from previous recalcs\r\n         delete cell.errors;\r\n         }\r\n\r\n      if (!cell.parseinfo) { // cache parsed formula\r\n         cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\r\n         }\r\n      parseinfo = cell.parseinfo;\r\n\r\n      for (i=coordvals.parsepos; i<parseinfo.length; i++) { // go through each token in formula\r\n\r\n         if (coordvals.inrange) { // processing a range of coords\r\n            if (coordvals.inrangestart) { // first time - fill in other values\r\n               if (coordvals.cr1.col > coordvals.cr2.col) { coordvals.c1 = coordvals.cr2.col; coordvals.c2 = coordvals.cr1.col; }\r\n               else { coordvals.c1 = coordvals.cr1.col; coordvals.c2 = coordvals.cr2.col; }\r\n               coordvals.c = coordvals.c1 - 1; // start one before\r\n\r\n               if (coordvals.cr1.row > coordvals.cr2.row) { coordvals.r1 = coordvals.cr2.row; coordvals.r2 = coordvals.cr1.row; }\r\n               else { coordvals.r1 = coordvals.cr1.row; coordvals.r2 = coordvals.cr2.row; }\r\n               coordvals.r = coordvals.r1; // start on this row\r\n               coordvals.inrangestart = false;\r\n               }\r\n            else { // not first time\r\n               }\r\n            coordvals.c += 1; // increment column\r\n            if (coordvals.c > coordvals.c2) { // finished the columns of this row\r\n               coordvals.r += 1; // increment row\r\n               if (coordvals.r > coordvals.r2) { // finished checking the entire range\r\n                  coordvals.inrange = false;\r\n                  continue;\r\n                  }\r\n               coordvals.c = coordvals.c1; // start at the beginning of next row\r\n               }\r\n            rangecoord = SocialCalc.crToCoord(coordvals.c, coordvals.r);\r\n\r\n            // now check that one\r\n\r\n            coordvals.parsepos = i; // remember our position\r\n            coordvals.oldcoord = oldcoord; // remember back up chain\r\n            oldcoord = coord; // come back to us\r\n            coord = rangecoord;\r\n            if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\r\n               cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\r\n               checkinfo[startcoord] = true; // this one should be calculated once at this point\r\n               if (!recalcdata.firstcalc) {\r\n                  recalcdata.firstcalc = startcoord;\r\n                  }\r\n               else {\r\n                  recalcdata.calclist[recalcdata.lastcalc] = startcoord;\r\n                  }\r\n               recalcdata.lastcalc = startcoord;\r\n               recalcdata.calclistlength++; // count number on list\r\n               sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\r\n               return cell.errors;\r\n               }\r\n            continue mainloop;\r\n            }\r\n\r\n         ttype = parseinfo[i].type; // get token details\r\n         ttext = parseinfo[i].text;\r\n         if (ttype == token_op) { // references with sheet specifier are not checked\r\n            if (ttext == \"!\") {\r\n               sheetref = true; // found a sheet reference\r\n               }\r\n            else if (ttext != \":\") { // for everything but a range, reset\r\n               sheetref = false;\r\n               }\r\n            }\r\n\r\n         if (ttype == token_name) { // look for named range\r\n            value = scf.LookupName(sheet, ttext);\r\n            if (value.type == \"range\") { // only need to recurse here for range, which may be just one cell\r\n               pos = value.value.indexOf(\"|\");\r\n               if (pos != -1) { // range - check each cell\r\n                  coordvals.cr1 = SocialCalc.coordToCr(value.value.substring(0,pos));\r\n                  pos2 = value.value.indexOf(\"|\", pos+1);\r\n                  coordvals.cr2 = SocialCalc.coordToCr(value.value.substring(pos+1,pos2));\r\n                  coordvals.inrange = true;\r\n                  coordvals.inrangestart = true;\r\n                  i = i-1; // back up so will start up again here\r\n                  continue;\r\n                  }\r\n               }\r\n            else if (value.type == \"coord\") { // just a coord\r\n               ttype = token_coord; // treat as a coord inline\r\n               ttext = value.value; // and then drop through to next test which should succeed\r\n               }\r\n            else { // not a defined name - probably a function\r\n               }\r\n            }\r\n\r\n         if (ttype == token_coord) { // token is a coord\r\n\r\n            if (i >= 2 // look for a range\r\n             && parseinfo[i-1].type == token_op && parseinfo[i-1].text == ':'\r\n             && parseinfo[i-2].type == token_coord\r\n             && !sheetref) { // Range -- check each cell\r\n               coordvals.cr1 = SocialCalc.coordToCr(parseinfo[i-2].text); // remember range extents\r\n               coordvals.cr2 = SocialCalc.coordToCr(ttext);\r\n               coordvals.inrange = true; // next time use the range looping code\r\n               coordvals.inrangestart = true;\r\n               i = i-1; // back up so will start up again here\r\n               continue;\r\n               }\r\n\r\n            else if (!sheetref) { // Single cell reference\r\n               if (ttext.indexOf(\"$\") != -1) ttext = ttext.replace(/\\$/g, \"\"); // remove any $'s\r\n               coordvals.parsepos = i+1; // remember our position - come back on next token\r\n               coordvals.oldcoord = oldcoord; // remember back up chain\r\n               oldcoord = coord; // come back to us\r\n               coord = ttext;\r\n               if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\r\n                  cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\r\n                  checkinfo[startcoord] = true; // this one should be calculated once at this point\r\n                  if (!recalcdata.firstcalc) { // add to calclist\r\n                     recalcdata.firstcalc = startcoord;\r\n                     }\r\n                  else {\r\n                     recalcdata.calclist[recalcdata.lastcalc] = startcoord;\r\n                     }\r\n                  recalcdata.lastcalc = startcoord;\r\n                  recalcdata.calclistlength++; // count number on list\r\n                  sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\r\n                  return cell.errors;\r\n                  }\r\n               continue mainloop;\r\n               }\r\n            }\r\n         }\r\n\r\n      sheetref = false; // make sure off when bump back up\r\n\r\n      checkinfo[coord] = true; // this one is finished\r\n      if (!recalcdata.firstcalc) { // add to calclist\r\n         recalcdata.firstcalc = coord;\r\n         }\r\n      else {\r\n         recalcdata.calclist[recalcdata.lastcalc] = coord;\r\n         }\r\n      recalcdata.lastcalc = coord;\r\n      recalcdata.calclistlength++; // count number on list\r\n\r\n      coord = oldcoord; // go back to the formula that referred to us and continue\r\n      oldcoord = checkinfo[coord] ? checkinfo[coord].oldcoord : null;\r\n\r\n      }\r\n\r\n   return \"\";\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Parse class:\r\n//\r\n// Used by ExecuteSheetCommand to get elements of commands to execute.\r\n// The string it works with consists of one or more lines each\r\n// made up of one or more tokens separated by a delimiter.\r\n//\r\n// *************************************\r\n\r\n// Initialize: set string to work with\r\n\r\nSocialCalc.Parse = function(str) {\r\n\r\n   // properties:\r\n\r\n   this.str = str;\r\n   this.pos = 0;\r\n   this.delimiter = \" \";\r\n   this.lineEnd = str.indexOf(\"\\n\");\r\n   if (this.lineEnd < 0) {\r\n      this.lineEnd = str.length;\r\n      }\r\n\r\n   }\r\n\r\n// Return next token as a string\r\n\r\nSocialCalc.Parse.prototype.NextToken = function() {\r\n   if (this.pos < 0) return \"\";\r\n   var pos2 = this.str.indexOf(this.delimiter, this.pos);\r\n   var pos1 = this.pos;\r\n   if (pos2 > this.lineEnd) { // don't go past end of line\r\n      pos2 = this.lineEnd;\r\n      }\r\n   if (pos2 >= 0) {\r\n      this.pos = pos2 + 1;\r\n      return this.str.substring(pos1, pos2);\r\n      }\r\n   else {\r\n      this.pos = this.lineEnd;\r\n      return this.str.substring(pos1, this.lineEnd);\r\n      }\r\n   }\r\n\r\n// Return everything from current point until end of line\r\n\r\nSocialCalc.Parse.prototype.RestOfString = function() {\r\n   var oldpos = this.pos;\r\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\r\n   this.pos = this.lineEnd;\r\n   return this.str.substring(oldpos, this.lineEnd);\r\n   }\r\n\r\nSocialCalc.Parse.prototype.RestOfStringNoMove = function() {\r\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\r\n   return this.str.substring(this.pos, this.lineEnd);\r\n   }\r\n\r\n// Move current point to next line\r\n\r\nSocialCalc.Parse.prototype.NextLine = function() {\r\n   this.pos = this.lineEnd + 1;\r\n   this.lineEnd = this.str.indexOf(\"\\n\", this.pos);\r\n   if (this.lineEnd < 0) {\r\n      this.lineEnd = this.str.length;\r\n      }\r\n   }\r\n\r\n// Check to see if at end of string with no more to process\r\n\r\nSocialCalc.Parse.prototype.EOF = function() {\r\n   if (this.pos < 0 || this.pos >= this.str.length) return true;\r\n   return false;\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// UndoStack class:\r\n//\r\n// Implements the behavior needed for a normal application's undo/redo stack.\r\n// You add a new change sequence with PushChange.\r\n// The type argument is a string that can be used to lookup some general string \r\n// like \"typing\" or \"setting attribute\" for the menu prompts for undo/redo.\r\n//\r\n// You add the \"do\" steps with AddDo. The non-null, non-undefined arguments are\r\n// joined together with \" \" to make a command string to be saved.\r\n//\r\n// You add the undo steps as commands for the most recent change with AddUndo.\r\n// The non-null, non-undefined arguments are joined together with \" \" to make\r\n// a command string to be saved.\r\n//\r\n// The Undo and Redo functions move the Top Of Stack pointer through the changes stack\r\n// so you can undo and redo. Doing a new PushChange removes all undone items\r\n// after TOS.\r\n//\r\n// You can push more things than you can undo if you want.\r\n// There is a maximum to remember as the \"did\" stack for an audit trail (and as redo). This may be unlimited.\r\n// There is a separate maximum to remember that can be undone. This may be smaller than maxRedo.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.UndoStack = function() {\r\n\r\n   // properties:\r\n\r\n   this.stack = []; // {command: [], type: type, undo: []} -- multiple dos and undos allowed\r\n   this.tos = -1; // top of stack position, used for undo/redo\r\n   this.maxRedo = 0; // Maximum size of redo stack (and audit trail which is this.stack[n].command) or zero if no limit\r\n   this.maxUndo = 50; // Maximum number of steps kept for undo (usually the memory intensive part) or zero if no limit\r\n\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.PushChange = function(type) { // adding a new thing to the stack\r\n   while (this.stack.length > 0 && this.stack.length-1 > this.tos) { // pop off things not redone\r\n      this.stack.pop();\r\n      }\r\n   this.stack.push({command: [], type: type, undo: []});\r\n   if (this.maxRedo && this.stack.length > this.maxRedo) { // limit number kept as audit trail\r\n      this.stack.shift(); // remove the extra one\r\n      }\r\n   if (this.maxUndo && this.stack.length > this.maxUndo) { // need to trim excess undo info\r\n      this.stack[this.stack.length - this.maxUndo - 1].undo = []; // only need to remove one\r\n      }\r\n   this.tos = this.stack.length - 1;\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.AddDo = function() {\r\n   if (!this.stack[this.stack.length-1]) { return; }\r\n   var args = [];\r\n   for (var i=0; i<arguments.length; i++) {\r\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\r\n      }\r\n   var cmd = args.join(\" \");\r\n   this.stack[this.stack.length-1].command.push(cmd);\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.AddUndo = function() {\r\n   if (!this.stack[this.stack.length-1]) { return; }\r\n   var args = [];\r\n   for (var i=0; i<arguments.length; i++) {\r\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\r\n      }\r\n   var cmd = args.join(\" \");\r\n   this.stack[this.stack.length-1].undo.push(cmd);\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.TOS = function() {\r\n   if (this.tos >= 0) return this.stack[this.tos];\r\n   else return null;\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.Undo = function() {\r\n   if (this.tos >= 0 && (!this.maxUndo || this.tos > this.stack.length - this.maxUndo - 1)) {\r\n      this.tos -= 1;\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.Redo = function() {\r\n   if (this.tos < this.stack.length-1) {\r\n      this.tos += 1;\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Clipboard Object:\r\n//\r\n// This is a single object.\r\n// Stores the clipboard, which is shared by all active sheets.\r\n// Like the undo stack, it does not persist from one editing session to another.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.Clipboard = {\r\n\r\n   // properties:\r\n\r\n   clipboard:  \"\" // empty or string in save format with \"copiedfrom:\" set to a range\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// RenderContext class:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.RenderContext = function(sheetobj) {\r\n\r\n   var parts, num, s;\r\n   var attribs = sheetobj.attribs;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // properties:\r\n\r\n   this.sheetobj = sheetobj;\r\n   this.hideRowsCols = false; // Rendering with panes only works with \"false\"\r\n                              // !!!! Note: not implemented yet in rendering, just saved as an attribute\r\n   this.showGrid = false;\r\n   this.showRCHeaders = false;\r\n   this.rownamewidth = scc.defaultRowNameWidth;\r\n   this.pixelsPerRow = scc.defaultAssumedRowHeight;\r\n\r\n   this.cellskip = {}; // if present, coord of cell covering this cell\r\n   this.coordToCR = {}; // for cells starting spans, coordToCR[coord]={row:row, col:col}\r\n   this.colwidth = []; // precomputed column widths, taking into account defaults\r\n   this.rowheight = []; // precomputed row height, taking into account defaults\r\n   this.totalwidth = 0; // precomputed total table width\r\n   this.totalheight = 0; // precomputed total table height\r\n\r\n   this.rowpanes = []; // for each pane, {first: firstrow, last: lastrow}\r\n   this.colpanes = []; // for each pane, {first: firstrow, last: lastrow}\r\n   this.colunhideleft = [];\r\n   this.colunhideright = [];\r\n   this.rowunhidetop = [];\r\n   this.rowunhidebottom = [];\r\n   this.maxcol=0; // max col and row to display, adding long spans, etc.\r\n   this.maxrow=0;\r\n\r\n   this.highlights = {}; // for each cell with special display: coord:highlightType (see this.highlightTypes)\r\n   this.cursorsuffix = \"\"; // added to highlights[cr]==\"cursor\" to get type to lookup\r\n\r\n   this.highlightTypes = // attributes to change when highlit\r\n      {\r\n         cursor: {style: scc.defaultHighlightTypeCursorStyle, className: scc.defaultHighlightTypeCursorClass},\r\n         range: {style: scc.defaultHighlightTypeRangeStyle, className: scc.defaultHighlightTypeRangeClass},\r\n         cursorinsertup: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertup.gif);\", className: scc.defaultHighlightTypeCursorClass},\r\n         cursorinsertleft: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertleft.gif);\", className: scc.defaultHighlightTypeCursorClass},\r\n         range2: {style: \"color:#000;backgroundColor:#FFF;backgroundImage:url(\"+scc.defaultImagePrefix+\"range2.gif);\", className: \"\"}\r\n      }\r\n\r\n   this.cellIDprefix = scc.defaultCellIDPrefix; // if non-null, each cell will render with an ID\r\n\r\n   this.defaultlinkstyle = null; // default linkstyle object (allows you to pass values to link renderer)\r\n   this.defaultHTMLlinkstyle = {type: \"html\"}; // default linkstyle for standalone HTML\r\n\r\n   // constants:\r\n\r\n   this.defaultfontstyle = scc.defaultCellFontStyle;\r\n   this.defaultfontsize = scc.defaultCellFontSize;\r\n   this.defaultfontfamily = scc.defaultCellFontFamily;\r\n\r\n   this.defaultlayout = scc.defaultCellLayout;\r\n\r\n   this.defaultpanedividerwidth = scc.defaultPaneDividerWidth;\r\n   this.defaultpanedividerheight = scc.defaultPaneDividerHeight;\r\n\r\n   this.gridCSS = scc.defaultGridCSS;\r\n\r\n   this.commentClassName = scc.defaultCommentClass; // for cells with non-blank comments when this.showGrid is true\r\n   this.commentCSS = scc.defaultCommentStyle; // any combination of classnames and styles may be used\r\n   this.commentNoGridClassName = scc.defaultCommentNoGridClass; // for cells when this.showGrid is false\r\n   this.commentNoGridCSS = scc.defaultCommentNoGridStyle; // any combination of classnames and styles may be used\r\n\r\n   this.readonlyClassName = scc.defaultReadonlyClass; // for readonly cells with non-blank comments when this.showGrid is true\r\n   this.readonlyCSS = scc.defaultReadonlyStyle; // any combination of classnames and styles may be used\r\n   this.readonlyNoGridClassName = scc.defaultReadonlyNoGridClass; // for readonly cells when this.showGrid is false\r\n   this.readonlyNoGridCSS = scc.defaultReadonlyNoGridStyle; // any combination of classnames and styles may be used\r\n   this.readonlyComment = scc.defaultReadonlyComment;\r\n\r\n   this.classnames = // any combination of classnames and explicitStyles can be used\r\n      {\r\n         colname: scc.defaultColnameClass,\r\n         rowname: scc.defaultRownameClass,\r\n         selectedcolname: scc.defaultSelectedColnameClass,\r\n         selectedrowname: scc.defaultSelectedRownameClass,\r\n         upperleft: scc.defaultUpperLeftClass,\r\n         skippedcell: scc.defaultSkippedCellClass,\r\n         panedivider: scc.defaultPaneDividerClass,\r\n         unhideleft: scc.defaultUnhideLeftClass,\r\n         unhideright: scc.defaultUnhideRightClass,\r\n         unhidetop: scc.defaultUnhideTopClass,\r\n         unhidebottom: scc.defaultUnhideBottomClass,\r\n         colresizebar: scc.defaultColResizeBarClass,\r\n         rowresizebar: scc.defaultRowResizeBarClass\r\n      };\r\n\r\n   this.explicitStyles = // these may be used so you won't need a stylesheet with the classnames\r\n      {\r\n         colname: scc.defaultColnameStyle,\r\n         rowname: scc.defaultRownameStyle,\r\n         selectedcolname: scc.defaultSelectedColnameStyle,\r\n         selectedrowname: scc.defaultSelectedRownameStyle,\r\n         upperleft: scc.defaultUpperLeftStyle,\r\n         skippedcell: scc.defaultSkippedCellStyle,\r\n         panedivider: scc.defaultPaneDividerStyle,\r\n         unhideleft: scc.defaultUnhideLeftStyle,\r\n         unhideright: scc.defaultUnhideRightStyle,\r\n         unhidetop: scc.defaultUnhideTopStyle,\r\n         unhidebottom: scc.defaultUnhideBottomStyle\r\n      };\r\n\r\n   // processed info about cell skipping\r\n\r\n   this.cellskip = null;\r\n   this.needcellskip = true;\r\n\r\n   // precomputed values, filling in defaults indicated by \"*\"\r\n\r\n   this.fonts=[]; // for each fontnum, {style: fs, weight: fw, size: fs, family: ff}\r\n   this.layouts=[]; // for each layout, \"padding:Tpx Rpx Bpx Lpx;vertical-align:va;\"\r\n\r\n   this.needprecompute = true; // need to call PrecomputeSheetFontsAndLayouts\r\n\r\n   // if have a sheet object, initialize constants and precomputed values\r\n\r\n   if (attribs) {\r\n      this.rowpanes[0] = {first: 1, last: attribs.lastrow};\r\n      this.colpanes[0] = {first: 1, last: attribs.lastcol};\r\n      this.usermaxcol = attribs.usermaxcol;\r\n      this.usermaxrow = attribs.usermaxrow;\r\n\r\n      }\r\n   else throw scc.s_rcMissingSheet;\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts = function() {SocialCalc.PrecomputeSheetFontsAndLayouts(this);};\r\nSocialCalc.RenderContext.prototype.CalculateCellSkipData = function() {SocialCalc.CalculateCellSkipData(this);};\r\nSocialCalc.RenderContext.prototype.CalculateColWidthData = function() {SocialCalc.CalculateColWidthData(this);};\r\nSocialCalc.RenderContext.prototype.CalculateRowHeightData = function() {SocialCalc.CalculateRowHeightData(this);};\r\nSocialCalc.RenderContext.prototype.SetRowPaneFirstLast = function(panenum, first, last) {this.rowpanes[panenum]={first:first, last:last};};\r\nSocialCalc.RenderContext.prototype.SetColPaneFirstLast = function(panenum, first, last) {this.colpanes[panenum]={first:first, last:last};};\r\nSocialCalc.RenderContext.prototype.CoordInPane = function(coord, rowpane, colpane) {return SocialCalc.CoordInPane(this, coord, rowpane, colpane);};\r\nSocialCalc.RenderContext.prototype.CellInPane = function(row, col, rowpane, colpane) {return SocialCalc.CellInPane(this, row, col, rowpane, colpane);};\r\nSocialCalc.RenderContext.prototype.InitializeTable = function(tableobj) {SocialCalc.InitializeTable(this, tableobj);};\r\nSocialCalc.RenderContext.prototype.RenderSheet = function(oldtable, linkstyle) {return SocialCalc.RenderSheet(this, oldtable, linkstyle);};\r\nSocialCalc.RenderContext.prototype.RenderColGroup = function() {return SocialCalc.RenderColGroup(this);};\r\nSocialCalc.RenderContext.prototype.RenderColHeaders = function() {return SocialCalc.RenderColHeaders(this);};\r\nSocialCalc.RenderContext.prototype.RenderSizingRow = function() {return SocialCalc.RenderSizingRow(this);};\r\nSocialCalc.RenderContext.prototype.RenderRow = function(rownum, rowpane, linkstyle) {return SocialCalc.RenderRow(this, rownum, rowpane, linkstyle);};\r\nSocialCalc.RenderContext.prototype.RenderSpacingRow = function() {return SocialCalc.RenderSpacingRow(this);};\r\nSocialCalc.RenderContext.prototype.RenderCell = function(rownum, colnum, rowpane, colpane, noElement, linkstyle)\r\n      {return SocialCalc.RenderCell(this, rownum, colnum, rowpane, colpane, noElement, linkstyle);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.PrecomputeSheetFontsAndLayouts = function(context) {\r\n\r\n   var defaultfont, parts, layoutre, dparts, sparts, num, s, i;\r\n   var sheetobj = context.sheetobj;\r\n   var attribs =  sheetobj.attribs;\r\n\r\n   if (attribs.defaultfont) {\r\n      defaultfont = sheetobj.fonts[attribs.defaultfont];\r\n      defaultfont = defaultfont.replace(/^\\*/,SocialCalc.Constants.defaultCellFontStyle);\r\n      defaultfont = defaultfont.replace(/(.+)\\*(.+)/,\"$1\"+SocialCalc.Constants.defaultCellFontSize+\"$2\");\r\n      defaultfont = defaultfont.replace(/\\*$/,SocialCalc.Constants.defaultCellFontFamily);\r\n      parts=defaultfont.match(/^(\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      context.defaultfontstyle = parts[1];\r\n      context.defaultfontsize = parts[2];\r\n      context.defaultfontfamily = parts[3];\r\n      }\r\n\r\n   for (num=1; num<sheetobj.fonts.length; num++) { // precompute fonts by filling in the *'s\r\n      s=sheetobj.fonts[num];\r\n      s=s.replace(/^\\*/,context.defaultfontstyle);\r\n      s=s.replace(/(.+)\\*(.+)/,\"$1\"+context.defaultfontsize+\"$2\");\r\n      s=s.replace(/\\*$/,context.defaultfontfamily);\r\n      parts=s.match(/^(\\S+?) (\\S+?) (\\S+?) (\\S.*)$/);\r\n      context.fonts[num] = {style: parts[1], weight: parts[2], size: parts[3], family: parts[4]};\r\n\r\n      }\r\n\r\n   layoutre = /^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/;\r\n   dparts = SocialCalc.Constants.defaultCellLayout.match(layoutre); // get built-in defaults\r\n\r\n   if (attribs.defaultlayout) {\r\n      sparts = sheetobj.layouts[attribs.defaultlayout].match(layoutre); // get sheet defaults, if set\r\n      }\r\n   else {\r\n      sparts = [\"\", \"*\", \"*\", \"*\", \"*\", \"*\"];\r\n      }\r\n\r\n   for (num=1; num<sheetobj.layouts.length; num++) { // precompute layouts by filling in the *'s\r\n      s=sheetobj.layouts[num];\r\n      parts = s.match(layoutre);\r\n      for (i=1; i<=5; i++) {\r\n         if (parts[i]==\"*\") {\r\n            parts[i] = (sparts[i] != \"*\" ? sparts[i] : dparts[i]); // if *, sheet default or built-in\r\n            }\r\n         }\r\n      context.layouts[num] = \"padding:\"+parts[1]+\" \"+parts[2]+\" \"+parts[3]+\" \"+parts[4]+\r\n         \";vertical-align:\"+parts[5]+\";\";\r\n      }\r\n\r\n   context.needprecompute = false;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateCellSkipData = function(context) {\r\n\r\n   var row, col, coord, cell, contextcell, colspan, rowspan, skiprow, skipcol, skipcoord;\r\n\r\n   var sheetobj=context.sheetobj;\r\n   var sheetrowattribs=sheetobj.rowattribs;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n   context.maxrow=0;\r\n   context.maxcol=0;\r\n   context.cellskip = {}; // reset\r\n\r\n   // Calculate cellskip data\r\n\r\n   for (row=1; row<=sheetobj.attribs.lastrow; row++) {\r\n      for (col=1; col<=sheetobj.attribs.lastcol; col++) { // look for spans and set cellskip for skipped cells\r\n         coord=SocialCalc.crToCoord(col, row);\r\n         cell=sheetobj.cells[coord];\r\n         // don't look at undefined cells (they have no spans) or skipped cells\r\n         if (cell===undefined || context.cellskip[coord]) continue;\r\n         colspan=cell.colspan || 1;\r\n         rowspan=cell.rowspan || 1;\r\n         if (colspan>1 || rowspan>1) {\r\n            for (skiprow=row; skiprow<row+rowspan; skiprow++) {\r\n               for (skipcol=col; skipcol<col+colspan; skipcol++) { // do the setting on individual cells\r\n                  skipcoord=SocialCalc.crToCoord(skipcol,skiprow);\r\n                  if (skipcoord==coord) { // for coord, remember row and col\r\n                     context.coordToCR[coord]={row: row, col: col};\r\n                     }\r\n                  else { // for other cells, flag with coord of here\r\n                     context.cellskip[skipcoord]=coord;\r\n                     }\r\n                  if (skiprow>context.maxrow) maxrow=skiprow;\r\n                  if (skipcol>context.maxcol) maxcol=skipcol;\r\n                  }\r\n               }\r\n            }\r\n         }\r\n      }\r\n\r\n   context.needcellskip = false;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateColWidthData = function(context) {\r\n\r\n   var colnum, colname, colwidth, totalwidth;\r\n\r\n   var sheetobj=context.sheetobj;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n\r\n   // Calculate column width data\r\n\r\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         colname=SocialCalc.rcColname(colnum);\r\n         if (sheetobj.colattribs.hide[colname] == \"yes\") {\r\n            context.colwidth[colnum] = 0;\r\n            }\r\n         else {\r\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n            context.colwidth[colnum]=colwidth+\"\";\r\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n            }\r\n         }\r\n      }\r\n   context.totalwidth = totalwidth;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateRowHeightData = function(context) {\r\n  var rownum, rowheight, totalheight;\r\n  var sheetobj = context.sheetobj;\r\n\r\n  // Calculate row height data\r\n  totalheight = context.showRCHeaders ? context.pixelsPerRow : 0;\r\n  for (rowpane = 0; rowpane < context.rowpanes.length; rowpane++) {\r\n    for (rownum = context.rowpanes[rowpane].first; rownum <= context.rowpanes[rowpane].last; rownum++) {\r\n      if (sheetobj.rowattribs.hide[rownum] === \"yes\") {\r\n        context.rowheight[rownum] = 0;\r\n      } else {\r\n        rowheight = sheetobj.rowattribs.height[rownum] || sheetobj.attribs.defaultrowheight || SocialCalc.Constants.defaultAssumedRowHeight;\r\n        if (rowheight === \"blank\" || rowheight === \"auto\") rowheight = \"\";\r\n        context.rowheight[rownum] = rowheight+\"\";\r\n        totalheight += (rowheight && ((rowheight - 0) > 0)) ? (rowheight-0) : 10;\r\n      }\r\n    }\r\n  }\r\n  context.totalheight = totalheight;\r\n\r\n}\r\n\r\nSocialCalc.InitializeTable = function(context, tableobj) {\r\n\r\n/*\r\n\r\nUses border-collapse so corners don't have holes\r\nNote: IE and Firefox handle <col> differently (IE adds borders and padding)\r\nunder border-collapse and Safari has problems with <col> and wide text\r\nTablelayout \"fixed\" also leads to problems\r\n\r\n*/\r\n\r\n/*\r\n\r\n*** Discussion ***\r\n\r\nThe rendering assumes fixed column widths, even though SocialCalc allows \"auto\".\r\nThere may be issues with \"auto\" and it is hard to make it work cross-browser\r\nwith border-collapse, etc.\r\n\r\nThis and the RenderSheet routine are where in the code the specifics of\r\ntable attributes and column size definitions are set. As the browsers settle down\r\nand when we decide if we don't need auto width, we may want to revisit the way the\r\ncode does this (e.g., use table-layout:fixed).\r\n\r\n*/\r\n   tableobj.style.borderCollapse=\"collapse\";\r\n   tableobj.cellSpacing=\"0\";\r\n   tableobj.cellPadding=\"0\";\r\n\r\n   tableobj.style.width=context.totalwidth+\"px\";\r\n\r\n   }\r\n\r\n//\r\n// tableobj = SocialCalc.RenderSheet(context, oldtable, linkstyle)\r\n//\r\n// Renders a render context returning a DOM table object.\r\n// If there is an oldtable object, it replaces it in the parent node.\r\n// If oldtable is null, it just returns the new one.\r\n// The linkstyle is \"\" or null for editing rendering\r\n// and optionally an object passed on to formatting code.\r\n//\r\n\r\nSocialCalc.RenderSheet = function(context, oldtable, linkstyle) {\r\n\r\n   var newrow, rowpane;\r\n   var tableobj, colgroupobj, tbodyobj, parentnode;\r\n\r\n   // do precompute stuff if necessary\r\n\r\n   if (context.sheetobj.changedrendervalues) {\r\n      context.needcellskip = true;\r\n      context.needprecompute = true;\r\n      context.sheetobj.changedrendervalues = false;\r\n      }\r\n   if (context.needcellskip) {\r\n      context.CalculateCellSkipData();\r\n      }\r\n   if (context.needprecompute) {\r\n      context.PrecomputeSheetFontsAndLayouts();\r\n      }\r\n\r\n   context.CalculateColWidthData(); // always make sure col width values are up to date\r\n   context.CalculateRowHeightData();\r\n\r\n   // make the table element and fill it in\r\n\r\n   tableobj=document.createElement(\"table\");\r\n   context.InitializeTable(tableobj);\r\n\r\n   colgroupobj=context.RenderColGroup();\r\n   tableobj.appendChild(colgroupobj);\r\n\r\n   tbodyobj=document.createElement(\"tbody\");\r\n\r\n   tbodyobj.appendChild(context.RenderSizingRow());\r\n\r\n   if (context.showRCHeaders) {\r\n      newrow=context.RenderColHeaders();\r\n      if (newrow) tbodyobj.appendChild(newrow);\r\n      }\r\n\r\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\r\n      for (rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++) {\r\n         newrow=context.RenderRow(rownum, rowpane, linkstyle);\r\n         tbodyobj.appendChild(newrow);\r\n         }\r\n      if (rowpane<context.rowpanes.length-1) {\r\n         newrow=context.RenderSpacingRow();\r\n         tbodyobj.appendChild(newrow);\r\n         }\r\n      }\r\n\r\n   tableobj.appendChild(tbodyobj);\r\n\r\n   if (oldtable) {\r\n      parentnode = oldtable.parentNode;\r\n      if (parentnode) parentnode.replaceChild(tableobj, oldtable);\r\n      }\r\n\r\n   return tableobj;\r\n\r\n   }\r\n\r\nSocialCalc.RenderRow = function(context, rownum, rowpane, linkstyle) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n   var colnum, newcol, colpane, newdiv;\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"td\");\r\n      if (context.classnames) newcol.className=context.classnames.rowname;\r\n      if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.rowname;\r\n      newcol.width=context.rownamewidth;\r\n      newcol.height = context.rowheight[rownum];\r\n      newcol.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\r\n                                        // considered top of row (and can't get <row> position in Safari)\r\n      newcol.innerHTML=rownum+\"\";\r\n\r\n      // If neighbour is hidden, show an icon in this column.\r\n      if (rownum < context.rowpanes[context.rowpanes.length-1].last && sheetobj.rowattribs.hide[rownum+1] == \"yes\") {\r\n         // HACK: Because we likely want the icon floating at the bottom of the cell, we create an enclosing div \r\n         // with position relative and the icon's div will be placed inside it with position: absolute and bottom: 0.\r\n         var container = document.createElement(\"div\");\r\n         container.style.position = \"relative\";\r\n         var unhide = document.createElement(\"div\");\r\n         if (context.classnames) unhide.className=context.classnames.unhidetop;\r\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidetop;\r\n         var fixPosition = ((context.rowheight[rownum] - 0) - SocialCalc.Constants.defaultAssumedRowHeight);\r\n         fixPosition = (fixPosition === 0) ? 4 : fixPosition;\r\n         unhide.style.bottom = '-' + fixPosition + 'px';\r\n         context.rowunhidetop[rownum] = unhide;\r\n         container.appendChild(unhide);\r\n         newcol.appendChild(container);\r\n         }\r\n      if (rownum > 1 && sheetobj.rowattribs.hide[rownum-1] == \"yes\") {\r\n         var unhide = document.createElement(\"div\");\r\n         if (context.classnames) unhide.className=context.classnames.unhidebottom;\r\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidebottom;\r\n         context.rowunhidebottom[rownum] = unhide;\r\n         newcol.appendChild(unhide);\r\n         }\r\n\r\n      // add resize bar\r\n      var resizeBar = document.createElement('div');\r\n      resizeBar.className = context.classnames.rowresizebar;\r\n      newcol.appendChild(resizeBar);\r\n\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=context.RenderCell(rownum, colnum, rowpane, colpane, null, linkstyle);\r\n         if (newcol) result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         newdiv=document.createElement(\"div\"); // for Firefox to avoid squishing\r\n         newdiv.style.width=context.defaultpanedividerwidth+\"px\";\r\n         newdiv.style.overflow=\"hidden\";\r\n         newcol.appendChild(newdiv);\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n\r\n   // If hidden row, display: none.\r\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n      result.style.cssText += \";display:none\";\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderSpacingRow = function(context) {\r\n\r\n   var colnum, newcol, colpane, w;\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"td\");\r\n      newcol.width=context.rownamewidth;\r\n      newcol.height=context.defaultpanedividerheight;\r\n      if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n      if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"td\");\r\n         w = context.colwidth[colnum];\r\n         if (w) newcol.width=w;\r\n         newcol.height=context.defaultpanedividerheight;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         if (newcol) result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         newcol.height=context.defaultpanedividerheight;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderColHeaders = function(context) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n   var colnum, newcol;\r\n\r\n   if (!context.showRCHeaders) return null;\r\n\r\n   newcol=document.createElement(\"td\");\r\n   if (context.classnames) newcol.className=context.classnames.upperleft;\r\n   if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.upperleft;\r\n   newcol.width=context.rownamewidth;\r\n   result.appendChild(newcol);\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"td\");\r\n         if (context.classnames) newcol.className=context.classnames.colname;\r\n         if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.colname;\r\n\r\n         // If hidden column, display: none.\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcol.style.cssText += \";display:none\";\r\n            }\r\n\r\n         newcol.innerHTML=SocialCalc.rcColname(colnum);\r\n\r\n         // If neighbour is hidden, show an icon in this column.\r\n         if (colnum < context.colpanes[context.colpanes.length-1].last && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+1)] == \"yes\") {\r\n            var unhide = document.createElement(\"div\");\r\n            if (context.classnames) unhide.className=context.classnames.unhideleft;\r\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideleft;\r\n            context.colunhideleft[colnum] = unhide;\r\n            newcol.appendChild(unhide);\r\n         }\r\n         if (colnum > 1 && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum-1)] == \"yes\") {\r\n            unhide = document.createElement(\"div\");\r\n            if (context.classnames) unhide.className=context.classnames.unhideright;\r\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideright;\r\n            context.colunhideright[colnum] = unhide;\r\n            newcol.appendChild(unhide);\r\n         }\r\n\r\n         // add resize bar\r\n         var resizeBar = document.createElement('span');\r\n         resizeBar.style.height = SocialCalc.Constants.defaultAssumedRowHeight + 'px';\r\n         resizeBar.className = context.classnames.colresizebar;\r\n         newcol.appendChild(resizeBar);\r\n\r\n         result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   // eddy {\r\n//   if(context.formColNames != null) {\r\n//     for(var nodeIndex = 0;  nodeIndex < result.childNodes.length;  nodeIndex++ ) {\r\n//       var currentCol = result.childNodes[nodeIndex];\r\n//       if(context.formColNames[currentCol.innerText] != null) currentCol.innerText = context.formColNames[currentCol.innerText];\r\n//     }\r\n//   }\r\n   // }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderColGroup = function(context) {\r\n\r\n   var colpane, colnum, newcol, t;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"colgroup\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"col\");\r\n      newcol.width=context.rownamewidth;\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"col\");\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcol.width=\"1\";\r\n            }\r\n         else {\r\n            t = context.colwidth[colnum];\r\n            if (t) newcol.width=t;\r\n            result.appendChild(newcol);\r\n            }\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"col\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderSizingRow = function(context) {\r\n\r\n   var colpane, colnum, newcell, t;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcell=document.createElement(\"td\");\r\n      newcell.style.width=context.rownamewidth+\"px\";\r\n      newcell.height=\"1\";\r\n      result.appendChild(newcell);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcell=document.createElement(\"td\");\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcell.width=\"1\";\r\n            }\r\n         else {\r\n            t = context.colwidth[colnum];\r\n            if (t) newcell.width=t;\r\n            }\r\n         newcell.height=\"1\";\r\n         result.appendChild(newcell);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcell=document.createElement(\"td\");\r\n         newcell.width=context.defaultpanedividerwidth;\r\n         newcell.height=\"1\";\r\n         result.appendChild(newcell);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderCell = function(context, rownum, colnum, rowpane, colpane, noElement, linkstyle) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var num, t, result, span, stylename, cell, endcell, sheetattribs, scdefaults;\r\n   var stylestr=\"\";\r\n\r\n   rownum = rownum-0; // make sure a number\r\n   colnum = colnum-0;\r\n\r\n   var coord=SocialCalc.crToCoord(colnum, rownum);\r\n\r\n   if (context.cellskip[coord]) { // skip if within a span\r\n      if (context.CoordInPane(context.cellskip[coord], rowpane, colpane)) {\r\n         return null; // span starts in this pane -- so just skip\r\n         }\r\n      result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\"); // span start is scrolled away, so make a special cell\r\n      if (context.classnames.skippedcell) result.className=context.classnames.skippedcell;\r\n      if (context.explicitStyles.skippedcell) result.style.cssText=context.explicitStyles.skippedcell;\r\n      result.innerHTML=\"&nbsp;\"; // put something there so height is OK\r\n      // !!! Really need to add borders in case there isn't anything else shown in the pane to get height\r\n      return result;\r\n      }\r\n\r\n   result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\");\r\n\r\n   if (context.cellIDprefix) {\r\n      result.id = context.cellIDprefix+coord;\r\n      }\r\n\r\n   cell=sheetobj.cells[coord];\r\n\r\n   if (!cell) {\r\n      cell=new SocialCalc.Cell(coord);\r\n      }\r\n\r\n   sheetattribs=sheetobj.attribs;\r\n   scc=SocialCalc.Constants;\r\n\r\n   if (cell.colspan>1) {\r\n      span=1;\r\n      for (num=1; num<cell.colspan; num++) {\r\n          if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+num)]!=\"yes\" &&\r\n                context.CellInPane(rownum, colnum+num, rowpane, colpane)) {\r\n             span++;\r\n             }\r\n          }\r\n      result.colSpan=span;\r\n      }\r\n\r\n   if (cell.rowspan>1) {\r\n      span=1;\r\n      for (num=1; num<cell.rowspan; num++) {\r\n          if (sheetobj.rowattribs.hide[(rownum+num)+\"\"]!=\"yes\" &&\r\n                context.CellInPane(rownum+num, colnum, rowpane, colpane))\r\n             span++;\r\n         }\r\n      result.rowSpan=span;\r\n      }\r\n\r\n   if (cell.displaystring==undefined || sheetobj.widgetsClean == false) { // cache the display value\r\n      cell.displaystring = SocialCalc.FormatValueForDisplay(sheetobj, cell.datavalue, coord, (linkstyle || context.defaultlinkstyle));\r\n      }\r\n\t\r\n   result.innerHTML = cell.displaystring;\r\n\t  \r\n   num=cell.layout || sheetattribs.defaultlayout;\r\n   if (num && typeof(context.layouts[num]) !== \"undefined\") {\r\n      stylestr+=context.layouts[num]; // use precomputed layout with \"*\"'s filled in\r\n      }\r\n   else {\r\n      stylestr+=scc.defaultCellLayout;\r\n      }\r\n\r\n   num=cell.font || sheetattribs.defaultfont;\r\n   if (num && typeof(context.fonts[num]) !== \"undefined\") { // get expanded font strings in context\r\n      t = context.fonts[num]; // do each - plain \"font:\" style sets all sorts of other values, too (Safari font-stretch problem on cssText)\r\n      stylestr+=\"font-style:\"+t.style+\";font-weight:\"+t.weight+\";font-size:\"+t.size+\";font-family:\"+t.family+\";\";\r\n      }\r\n   else {\r\n      if (scc.defaultCellFontSize) {\r\n         stylestr+=\"font-size:\"+scc.defaultCellFontSize+\";\";\r\n         }\r\n      if (scc.defaultCellFontFamily) {\r\n         stylestr+=\"font-family:\"+scc.defaultCellFontFamily+\";\";\r\n         }\r\n      }\r\n\r\n   num=cell.color || sheetattribs.defaultcolor;\r\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"color:\"+sheetobj.colors[num]+\";\";\r\n\r\n   num=cell.bgcolor || sheetattribs.defaultbgcolor;\r\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"background-color:\"+sheetobj.colors[num]+\";\";\r\n\r\n   num=cell.cellformat;\r\n   if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\r\n      stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n      }\r\n   else {\r\n      t=cell.valuetype.charAt(0);\r\n      if (t==\"t\") {\r\n         num=sheetattribs.defaulttextformat;\r\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n         }\r\n      else if (t==\"n\") {\r\n         num=sheetattribs.defaultnontextformat;\r\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\r\n            stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n            }\r\n         else {\r\n            stylestr+=\"text-align:right;\";\r\n            }\r\n         }\r\n      else stylestr+=\"text-align:left;\";\r\n      }\r\n\r\n   // get the end cell for border styling\r\n   if (cell.colspan > 1 || cell.rowspan > 1) {\r\n      endcell = sheetobj.cells[SocialCalc.crToCoord(colnum+(cell.colspan || 1)-1, rownum+(cell.rowspan || 1)-1)];\r\n      }\r\n\r\n   num=cell.bt;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-top:\"+sheetobj.borderstyles[num]+\";\";\r\n\r\n   num=typeof(endcell) != \"undefined\" ? endcell.br : cell.br;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-right:\"+sheetobj.borderstyles[num]+\";\";\r\n   else if (context.showGrid) {\r\n      if (context.CellInPane(rownum, colnum+(cell.colspan || 1), rowpane, colpane))\r\n         t=SocialCalc.crToCoord(colnum+(cell.colspan || 1), rownum);\r\n      else t=\"nomatch\";\r\n      if (context.cellskip[t]) t=context.cellskip[t];\r\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bl)\r\n         stylestr+=\"border-right:\"+context.gridCSS;\r\n      }\r\n\r\n   num=typeof(endcell) != \"undefined\" ? endcell.bb : cell.bb;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-bottom:\"+sheetobj.borderstyles[num]+\";\";\r\n   else if (context.showGrid) {\r\n      if (context.CellInPane(rownum+(cell.rowspan || 1), colnum, rowpane, colpane))\r\n         t=SocialCalc.crToCoord(colnum, rownum+(cell.rowspan || 1));\r\n      else t=\"nomatch\";\r\n      if (context.cellskip[t]) t=context.cellskip[t];\r\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bt)\r\n         stylestr+=\"border-bottom:\"+context.gridCSS;\r\n      }\r\n\r\n   num=cell.bl;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-left:\"+sheetobj.borderstyles[num]+\";\";\r\n\r\n   if (cell.comment) {\r\n      result.title = cell.comment;\r\n      if (context.showGrid) {\r\n         if (context.commentClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentClassName;\r\n            }\r\n         stylestr+=context.commentCSS;\r\n         }\r\n      else {\r\n         if (context.commentNoGridClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentNoGridClassName;\r\n            }\r\n         stylestr+=context.commentNoGridCSS;\r\n         }\r\n      }\r\n\r\n   if (cell.readonly) {\r\n      if (!cell.comment) {\r\n         result.title = context.readonlyComment;\r\n         }\r\n      if (context.showGrid) {\r\n         if (context.readonlyClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyClassName;\r\n            }\r\n         stylestr+=context.readonlyCSS;\r\n         }\r\n      else {\r\n         if (context.readonlyNoGridClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyNoGridClassName;\r\n            }\r\n         stylestr+=context.readonlyNoGridCSS;\r\n         }\r\n      }\r\n\r\n   result.style.cssText=stylestr;\r\n\r\n   //!!!!!!!!!\r\n   // NOTE: csss is not supported yet.\r\n   // csss needs to be parsed into pieces to override just the attributes specified, not all with assignment to cssText.\r\n   if (cell.cssc !== undefined) {\r\n      noElement ? (result.className = (result.className ? result.className + ' ' : '') + cell.cssc) : result.classList.add(cell.cssc);\r\n   }\r\n\r\n   t = context.highlights[coord];\r\n   if (t) { // this is a highlit cell: Override style appropriately\r\n      if (t==\"cursor\") t += context.cursorsuffix; // cursor can take alternative forms\r\n      if (context.highlightTypes[t].className) {\r\n         result.className = (result.className ? result.className+\" \" : \"\") + context.highlightTypes[t].className;\r\n         }\r\n      SocialCalc.setStyles(result, context.highlightTypes[t].style);\r\n      }\r\n\r\n   // If hidden column, display: none.\r\n   if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n      result.style.cssText+=\";display:none\";\r\n      }\r\n\r\n   // If hidden row, display: none.\r\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n      result.style.cssText+=\";display:none\";\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\nSocialCalc.CoordInPane = function(context, coord, rowpane, colpane) {\r\n   var coordToCR = context.coordToCR[coord];\r\n   if (!coordToCR || !coordToCR.row || !coordToCR.col) throw \"Bad coordToCR for \"+coord;\r\n   return context.CellInPane(coordToCR.row, coordToCR.col, rowpane, colpane);\r\n   }\r\n\r\n\r\nSocialCalc.CellInPane = function(context, row, col, rowpane, colpane) {\r\n   var panerowlimits = context.rowpanes[rowpane];\r\n   var panecollimits = context.colpanes[colpane];\r\n   if (!panerowlimits || !panecollimits) throw \"CellInPane called with unknown panes \"+rowpane+\"/\"+colpane;\r\n   if (row < panerowlimits.first || row > panerowlimits.last) return false;\r\n   if (col < panecollimits.first || col > panecollimits.last) return false;\r\n   return true;\r\n   }\r\n\r\nSocialCalc.CreatePseudoElement = function() {\r\n   return {style:{cssText:\"\"}, innerHTML: \"\", className: \"\"};\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Misc. functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.rcColname = function(c) {\r\n   if (c > 702) c = 702; // maximum number of columns - ZZ\r\n   if (c < 1) c = 1;\r\n   var collow = (c - 1) % 26 + 65;\r\n   var colhigh = Math.floor((c - 1) / 26);\r\n   if (colhigh)\r\n      return String.fromCharCode(colhigh + 64) + String.fromCharCode(collow);\r\n   else\r\n      return String.fromCharCode(collow);\r\n   }\r\n\r\nSocialCalc.letters = [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\r\n                      \"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];\r\n\r\nSocialCalc.crToCoord = function(c, r) {\r\n   var result;\r\n   if (c < 1) c = 1;\r\n   if (c > 702) c = 702; // maximum number of columns - ZZ\r\n   if (r < 1) r = 1;\r\n   var collow = (c - 1) % 26;\r\n   var colhigh = Math.floor((c - 1) / 26);\r\n   if (colhigh)\r\n      result = SocialCalc.letters[colhigh-1] + SocialCalc.letters[collow] + r;\r\n   else\r\n      result = SocialCalc.letters[collow] + r;\r\n   return result;\r\n   }\r\n\r\nSocialCalc.coordToCol = {}; // too expensive to set in crToCoord since that is called so many times\r\nSocialCalc.coordToRow = {};\r\n\r\nSocialCalc.coordToCr = function(cr) {\r\n   var c, i, ch;\r\n   var r = SocialCalc.coordToRow[cr];\r\n   if (r) return {row: r, col: SocialCalc.coordToCol[cr]};\r\n   c=0;r=0;\r\n   for (i=0; i<cr.length; i++) { // this was faster than using regexes; assumes well-formed\r\n      ch = cr.charCodeAt(i);\r\n      if (ch==36) ; // skip $'s\r\n      else if (ch<=57) r = 10*r + ch-48;\r\n      else if (ch>=97) c = 26*c + ch-96;\r\n      else if (ch>=65) c = 26*c + ch-64;\r\n      }\r\n   SocialCalc.coordToCol[cr] = c;\r\n   SocialCalc.coordToRow[cr] = r;\r\n   return {row: r, col: c};\r\n\r\n   }\r\n\r\nSocialCalc.ParseRange = function(range) {\r\n   var pos, cr, cr1, cr2;\r\n   if (!range) range = \"A1:A1\"; // error return, hopefully benign\r\n   range = range.toUpperCase();\r\n   pos = range.indexOf(\":\");\r\n   if (pos>=0) {\r\n      cr = range.substring(0,pos);\r\n      cr1 = SocialCalc.coordToCr(cr);\r\n      cr1.coord = cr;\r\n      cr = range.substring(pos+1);\r\n      cr2 = SocialCalc.coordToCr(cr);\r\n      cr2.coord = cr;\r\n      }\r\n   else {\r\n      cr1 = SocialCalc.coordToCr(range);\r\n      cr1.coord = range;\r\n      cr2 = SocialCalc.coordToCr(range);\r\n      cr2.coord = range;\r\n      }\r\n   return {cr1: cr1, cr2: cr2};\r\n   }\r\n\r\nSocialCalc.decodeFromSave = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\r\n   var r=s.replace(/\\\\c/g,\":\");\r\n   r=r.replace(/\\\\n/g,\"\\n\");\r\n   return r.replace(/\\\\b/g,\"\\\\\");\r\n   }\r\n\r\nSocialCalc.decodeFromAjax = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\r\n   var r=s.replace(/\\\\c/g,\":\");\r\n   r=r.replace(/\\\\n/g,\"\\n\");\r\n   r=r.replace(/\\\\e/g,\"]]\");\r\n   return r.replace(/\\\\b/g,\"\\\\\");\r\n   }\r\n\r\nSocialCalc.encodeForSave = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")!=-1) // for performace reasons: replace nothing takes up time\r\n      s=s.replace(/\\\\/g,\"\\\\b\");\r\n   if (s.indexOf(\":\")!=-1)\r\n      s=s.replace(/:/g,\"\\\\c\");\r\n   if (s.indexOf(\"\\n\")!=-1)\r\n      s=s.replace(/\\n/g,\"\\\\n\");\r\n   return s;\r\n   }\r\n\r\n//\r\n// Returns estring where &, <, >, \" are HTML escaped\r\n// \r\nSocialCalc.special_chars = function(string) {\r\n\r\n   if (/[&<>\"]/.test(string)) { // only do \"slow\" replaces if something to replace\r\n      string = string.replace(/&/g, \"&amp;\");\r\n      string = string.replace(/</g, \"&lt;\");\r\n      string = string.replace(/>/g, \"&gt;\");\r\n      string = string.replace(/\"/g, \"&quot;\");\r\n      }\r\n   return string;\r\n\r\n   }\r\n\r\nSocialCalc.Lookup = function(value, list) {\r\n\r\n   for (i=0; i<list.length; i++) {\r\n      if (list[i] > value) {\r\n         if (i>0) return i-1;\r\n         else return null;\r\n         }\r\n      }\r\n   return list.length-1; // if all smaller, matches last\r\n\r\n   }\r\n\r\n//\r\n// setStyles(element, cssText)\r\n//\r\n// Takes a pseudo style string (e.g., text-align must be textAlign) and sets\r\n// the element's style value for each style name listed (leaving others unchanged).\r\n// OK to call with null cssText.\r\n//\r\n\r\nSocialCalc.setStyles = function (element, cssText) {\r\n\r\n   var parts, part, pos, name, value;\r\n\r\n   if (!cssText) return;\r\n\r\n   parts = cssText.split(\";\");\r\n   for (part=0; part<parts.length; part++) {\r\n      pos = parts[part].indexOf(\":\"); // find first colon (could be one in url)\r\n      if (pos != -1) {\r\n         name = parts[part].substring(0, pos);\r\n         value = parts[part].substring(pos+1);\r\n         if (name && value) { // if non-null name and value, set style\r\n            element.style[name] = value;\r\n            }\r\n         }\r\n//      namevalue = parts[part].split(\":\");\r\n//      if (namevalue[0]) element.style[namevalue[0]] = namevalue[1];\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// GetViewportInfo() - returns object with viewport width and height, and scroll offsets\r\n//\r\n// Flanagan, JavaScript, 5th Edition, page 276\r\n//\r\n\r\nSocialCalc.GetViewportInfo = function () {\r\n\r\n   var result = {};\r\n\r\n   if (window.innerWidth) { // all but IE\r\n      result.width = window.innerWidth;\r\n      result.height = window.innerHeight;\r\n      result.horizontalScroll = window.pageXOffset;\r\n      result.verticalScroll = window.pageYOffset;\r\n      }\r\n   else {\r\n      if (document.documentElement && document.documentElement.clientWidth) {\r\n         result.width = document.documentElement.clientWidth;\r\n         result.height = document.documentElement.clientHeight;\r\n         result.horizontalScroll = document.documentElement.scrollLeft;\r\n         result.verticalScroll = document.documentElement.scrollTop;\r\n         }\r\n      else if (document.body.clientWidth) {\r\n         result.width = document.body.clientWidth;\r\n         result.height = document.body.clientHeight;\r\n         result.horizontalScroll = document.body.scrollLeft;\r\n         result.verticalScroll = document.body.scrollTop;\r\n         }\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\n//\r\n// GetElementPosition(element) - returns object with left and top position of the element in the document\r\n//\r\n// Goodman's JavaScript & DHTML Cookbook, 2nd Edition, page 415\r\n//\r\n\r\nSocialCalc.GetElementPosition = function (element) {\r\n\r\n   var offsetLeft = 0;\r\n   var offsetTop = 0;\r\n   while (element) {\r\n      if (SocialCalc.GetComputedStyle(element,'position')=='relative') break;\r\n      offsetLeft+=element.offsetLeft;\r\n      offsetTop+=element.offsetTop;\r\n      element=element.offsetParent;\r\n      }\r\n   return {left:offsetLeft, top:offsetTop};\r\n\r\n   }\r\n\r\n//\r\n// GetElementPositionWithScroll(element) - returns object with left and top position of the element in the document\r\n//\r\n\r\nSocialCalc.GetElementPositionWithScroll = function (element) {\r\n  \r\n   var rect = element.getBoundingClientRect();\r\n   return {\r\n      left:rect.left,\r\n      right:rect.right,\r\n      top:rect.top,\r\n      bottom:rect.bottom,\r\n      width:rect.width?rect.width:rect.right-rect.left,\r\n      height:rect.height?rect.height:rect.bottom-rect.top\r\n      };\r\n\r\n   }\r\n\r\n//\r\n// GetElementFixedParent(element) - checks whether element has a parent with position:fixed\r\n//\r\n\r\nSocialCalc.GetElementFixedParent = function(element) {\r\n\r\n   while (element) {\r\n      if (element.tagName==\"HTML\") break;\r\n      if (SocialCalc.GetComputedStyle(element,'position')=='fixed') return element;\r\n      element=element.parentNode;\r\n      }\r\n      return false;\r\n\r\n   }\r\n\r\n//\r\n// GetComputedStyle(element, style) - returns computed style value\r\n//\r\n// http://blog.stchur.com/2006/06/21/css-computed-style/\r\n//\r\n\r\nSocialCalc.GetComputedStyle = function (element, style) {\r\n\r\n   var computedStyle;\r\n   if (typeof element.currentStyle != 'undefined') { // IE\r\n      computedStyle = element.currentStyle;\r\n      }\r\n   else {\r\n      computedStyle = document.defaultView.getComputedStyle(element, null);\r\n      }\r\n   return computedStyle[style];\r\n\r\n   }\r\n\r\n//\r\n// LookupElement(element, array) - returns array element which is an object with \"element\" of element\r\n//\r\n\r\nSocialCalc.LookupElement = function (element, array) {\r\n\r\n   var i;\r\n   for (i=0; i<array.length; i++) {\r\n      if (array[i].element == element) return array[i];\r\n      }\r\n   return null;\r\n\r\n   }\r\n\r\n//\r\n// AssignID(obj, element, id) - Optionally assigns an ID with a prefix to the element\r\n//\r\n\r\nSocialCalc.AssignID = function (obj, element, id) {\r\n\r\n   if (obj.idPrefix) { // Object must have a non-empty idPrefix attribute\r\n      element.id = obj.idPrefix + id;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.GetCellContents(sheetobj, coord)\r\n//\r\n// Returns the contents (value, formula, constant, etc.) of a cell\r\n// with appropriate prefix (\"'\", \"=\", etc.)\r\n//\r\n\r\nSocialCalc.GetCellContents = function(sheetobj, coord) {\r\n\r\n   var result = \"\";\r\n   var cellobj = sheetobj.cells[coord];\r\n   if (cellobj) {\r\n      switch (cellobj.datatype) {\r\n         case \"v\":\r\n            result = cellobj.datavalue+\"\";\r\n            break;\r\n         case \"t\":\r\n            result = \"'\"+cellobj.datavalue;\r\n            break;\r\n         case \"f\":\r\n            result = \"=\"+cellobj.formula;\r\n            break;\r\n         case \"c\":\r\n            result = cellobj.formula;\r\n            break;\r\n         default:\r\n            break;\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// Routines translated from the SocialCalc 1.1.0 Perl code:\r\n//\r\n// (Makes use of the FormatNumber JavaScript code translated from the Perl.)\r\n//\r\n\r\n//\r\n// displayvalue = FormatValueForDisplay(sheetobj, value, cr, linkstyle)\r\n//\r\n// Returns a string, in HTML, for the contents of a cell.\r\n//\r\n// The value is a either numeric or text, the cr is the coord of the cell\r\n// (its cell properties are used to determine formatting), and linkstyle\r\n// is a value passed to wiki-text expansion routines specifying the\r\n// purpose of the rendering so, for example, links can be rendered differently\r\n// during edit than with plain HTML.\r\n//\r\n\r\nSocialCalc.FormatValueForDisplay = function(sheetobj, value, cr, linkstyle) {\r\n\r\n   var valueformat, has_parens, has_commas, valuetype, valuesubtype;\r\n   var displayvalue;\r\n\r\n   var sheetattribs=sheetobj.attribs;\r\n   var scc=SocialCalc.Constants;\r\n\r\n   var cell=sheetobj.cells[cr];\r\n\r\n   if (!cell) { // get an empty cell if not there\r\n      cell=new SocialCalc.Cell(cr);\r\n      }\r\n\r\n   displayvalue = value;\r\n\r\n   valuetype = cell.valuetype || \"\"; // get type of value to determine formatting\r\n   valuesubtype = valuetype.substring(1);\r\n   \r\n   // eddy setup display cell {\r\n   valueinputwidget = valuetype.charAt(1); \r\n   var formula_name= valuetype.substring(2);\r\n   var html_display_value = null; \r\n   var html_formated_value = null;\r\n   // }\r\n\r\n   valuetype = valuetype.charAt(0);\r\n   \r\n   \r\n   if (cell.errors || valuetype==\"e\") {\r\n      displayvalue = cell.errors || valuesubtype || \"Error in cell\";\r\n      return displayvalue;\r\n      }\r\n\r\n   if (valuetype==\"t\") {\r\n      valueformat = sheetobj.valueformats[cell.textvalueformat-0] || sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0] || \"\";\r\n      if (valueformat==\"formula\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n\t  var html_display_value = displayvalue; // eddy\r\n      displayvalue = SocialCalc.format_text_for_display(displayvalue, cell.valuetype, valueformat, sheetobj, linkstyle, cell.nontextvalueformat);\r\n\t  var html_formated_value = displayvalue; // eddy\r\n\t  \r\n      }\r\n\r\n   else if (valuetype==\"n\") {\r\n      valueformat = cell.nontextvalueformat;\r\n      if (valueformat==null || valueformat==\"\") { //\r\n         valueformat = sheetattribs.defaultnontextvalueformat;\r\n         }\r\n      valueformat = sheetobj.valueformats[valueformat-0];\r\n      if (valueformat==null || valueformat==\"none\") {\r\n         valueformat = \"\";\r\n         }\r\n\t\t \r\n\t\t \r\n      if (valueformat==\"formula\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n      else if (valueformat==\"forcetext\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n\t\t \r\n\t  var html_display_value = displayvalue; // eddy\r\n      displayvalue = SocialCalc.format_number_for_display(displayvalue, cell.valuetype, valueformat);\r\n\t  var html_formated_value = displayvalue; // eddy\r\n\r\n      }\r\n   else { // unknown type - probably blank\r\n      displayvalue = \"&nbsp;\";\r\n      }\r\n\r\n\r\n   // eddy display cell HTML {      \r\n   if(valueinputwidget==\"i\" && html_display_value!=null && html_formated_value!=null) {\r\n     var parameters = sheetobj.ioParameterList[cr];\r\n    \r\n\t   var formula_details = SocialCalc.Formula.FunctionList[formula_name]; \r\n//\t var ecell = SocialCalc.GetSpreadsheetControlObject().editor.ecell; // check if widget has focus\r\n//\t SocialCalc.GetSpreadsheetControlObject().debug.push({formula_name:formula_name});\r\n\t\t if( formula_details) {\r\n\t\t\t var cell_html = formula_details[5];\r\n\t\t\t // var cell_html = \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction('<%=cell_reference%>');\\\"><%=display_value%></button>\";\r\n\t\t\t \r\n\t\t\t var checkedValue = (html_display_value == 0) ? \"\" : \"checked\"; // for checkbox\r\n\t\t\t cell_html = cell_html.replace(/<%=checked%>/g, checkedValue);\r\n\t\t\t cell_html = cell_html.replace(/<%=formated_value%>/g, html_formated_value);\r\n       cell_html = cell_html.replace(/<%=display_value%>/g, html_display_value);\r\n       // replace widget HTML with parameter \r\n       // FOR each parameter\r\n       var parameterValue; // set to value of param for if coord, value of cell\r\n       if(parameters) { \r\n         // add forumla parameters to widget html\r\n         for(var index=0; index < parameters.length; index ++) {\r\n           // IF coord THEN replace with cell value\r\n           if(parameters[index].type == 'coord') {\r\n             parameterValue = sheetobj.GetAssuredCell(parameters[index].value).datavalue;\r\n           } else {\r\n             // ELSE with param value \r\n             parameterValue = parameters[index].value;\r\n           }\r\n           var paramRegExp = new RegExp(\"<%=parameter\"+index+\"_value%>\",'g');\r\n           cell_html = cell_html.replace(paramRegExp, parameterValue);\r\n         }\r\n         if(parameters.html) { // add html created in formula1.js to widget\r\n           for(var htmlIndex=0; htmlIndex < parameters.html.length; htmlIndex ++) {\r\n             var paramRegExp = new RegExp(\"<%=html\"+htmlIndex+\"_value%>\",'g');\r\n             cell_html = cell_html.replace(paramRegExp, parameters.html[htmlIndex]);\r\n           }\r\n         }\r\n         if(parameters.css) { // add style(css) formula css value, if any - e.g. =textbox(\"\")+style(\"margin: 8px 0;\")\r\n           // * RegEx Unit Test **  https://regex101.com/r/oV7wU5/2\r\n           cell_html = cell_html.replace(/^(<\\w+)(\\W)/, \"$1 style='\"+parameters.css+ \"'$2\");\r\n         }\r\n\r\n       }\r\n       \r\n\t\t\t return cell_html.replace(/<%=cell_reference%>/g, cr);\r\n\t\t\t }\r\n\t\t return \"error:Widget HTML missing\";\r\n\t }\r\n   // }\r\n\t  \r\n\t  \r\n\t  \r\n   return displayvalue;\r\n\r\n   }\r\n\r\n \r\n   \r\n//\r\n// displayvalue = format_text_for_display(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat)\r\n//\r\n\r\nSocialCalc.format_text_for_display = function(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat) {\r\n\r\n   var valueformat, valuesubtype, dvsc, dvue, textval;\r\n   var displayvalue;\r\n\r\n   valuesubtype = valuetype.substring(1);\r\n\r\n   displayvalue = rawvalue;\r\n\r\n   if (valueformat==\"none\" || valueformat==null) valueformat=\"\";\r\n   if (!/^(text-|custom|hidden)/.test(valueformat)) valueformat=\"\";\r\n   if (valueformat==\"\" || valueformat==\"General\") { // determine format from type\r\n      if (valuesubtype==\"h\") valueformat=\"text-html\";\r\n      if (valuesubtype==\"w\" || valuesubtype==\"r\") valueformat=\"text-wiki\";\r\n      if (valuesubtype==\"l\") valueformat=\"text-link\";\r\n      if (!valuesubtype) valueformat=\"text-plain\";\r\n      }\r\n   if (valueformat==\"text-html\") { // HTML - output as it as is\r\n      ;\r\n      }\r\n   else if (SocialCalc.Callbacks.expand_wiki && /^text-wiki/.test(valueformat)) { // do general wiki markup\r\n      displayvalue = SocialCalc.Callbacks.expand_wiki(displayvalue, sheetobj, linkstyle, valueformat);\r\n      }\r\n   else if (valueformat==\"text-wiki\") { // wiki text\r\n      displayvalue = (SocialCalc.Callbacks.expand_markup\r\n                      && SocialCalc.Callbacks.expand_markup(displayvalue, sheetobj, linkstyle)) || // do old wiki markup\r\n                     SocialCalc.special_chars(\"wiki-text:\"+displayvalue);\r\n      }\r\n   else if (valueformat==\"text-url\") { // text is a URL for a link\r\n      dvsc = SocialCalc.special_chars(displayvalue);\r\n      dvue = encodeURI(displayvalue);\r\n      displayvalue = '<a href=\"'+dvue+'\">'+dvsc+'</a>';\r\n      }\r\n   else if (valueformat==\"text-link\") { // more extensive link capabilities for regular web links\r\n      displayvalue = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat);\r\n      }\r\n   else if (valueformat==\"text-image\") { // text is a URL for an image\r\n      dvue = encodeURI(displayvalue);\r\n      displayvalue = '<img src=\"'+dvue+'\">';\r\n      }\r\n   else if (valueformat.substring(0,12)==\"text-custom:\") { // construct a custom text format: @r = text raw, @s = special chars, @u = url encoded\r\n      dvsc = SocialCalc.special_chars(displayvalue); // do special chars\r\n      dvsc = dvsc.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      dvsc = dvsc.replace(/\\n/g, \"<br>\");  // keep line breaks\r\n      dvue = encodeURI(displayvalue);\r\n      textval={};\r\n      textval.r = displayvalue;\r\n      textval.s = dvsc;\r\n      textval.u = dvue;\r\n      displayvalue = valueformat.substring(12); // remove \"text-custom:\"\r\n      displayvalue = displayvalue.replace(/@(r|s|u)/g, function(a,c){return textval[c];}); // replace placeholders\r\n      }\r\n   else if (valueformat.substring(0,6)==\"custom\") { // custom\r\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\r\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n      displayvalue += \" (custom format)\";\r\n      }\r\n   else if (valueformat==\"hidden\") {\r\n      displayvalue = \"&nbsp;\";\r\n      }\r\n   else if (nontextvalueformat != null && nontextvalueformat != \"\" && sheetobj.valueformats[nontextvalueformat-0] != \"none\" && sheetobj.valueformats[nontextvalueformat-0] != \"\" ) {\r\n      valueformat = sheetobj.valueformats[nontextvalueformat];\r\n      displayvalue = SocialCalc.format_number_for_display(rawvalue, valuetype, valueformat);\r\n      }\r\n   else { // plain text\r\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\r\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n      }\r\n\r\n   return displayvalue;\r\n\r\n   }\r\n\r\n\r\n//\r\n// displayvalue = format_number_for_display(rawvalue, valuetype, valueformat)\r\n//\r\n\r\nSocialCalc.format_number_for_display = function(rawvalue, valuetype, valueformat) {\r\n\r\n   var value, valuesubtype;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   value = rawvalue-0;\r\n\r\n   valuesubtype = valuetype.substring(1);\r\n\r\n   if (valueformat==\"Auto\" || valueformat==\"\") { // cases with default format\r\n      if (valuesubtype==\"%\") { // will display a % character\r\n         valueformat = scc.defaultFormatp;\r\n         }\r\n      else if (valuesubtype=='$') {\r\n         valueformat = scc.defaultFormatc;\r\n         }\r\n      else if (valuesubtype=='dt') {\r\n         valueformat = scc.defaultFormatdt;\r\n         }\r\n      else if (valuesubtype=='d') {\r\n         valueformat = scc.defaultFormatd;\r\n         }\r\n      else if (valuesubtype=='t') {\r\n         valueformat = scc.defaultFormatt;\r\n         }\r\n      else if (valuesubtype=='l') {\r\n         valueformat = 'logical';\r\n         }\r\n      else {\r\n         valueformat = \"General\";\r\n         }\r\n      }\r\n\r\n   if (valueformat==\"logical\") { // do logical format\r\n      return value ? scc.defaultDisplayTRUE : scc.defaultDisplayFALSE;\r\n      }\r\n\r\n   if (valueformat==\"hidden\") { // do hidden format\r\n      return \"&nbsp;\";\r\n      }\r\n\r\n   // Use format\r\n\r\n   return SocialCalc.FormatNumber.formatNumberWithFormat(rawvalue, valueformat, \"\");\r\n\r\n   }\r\n\r\n//\r\n// valueinfo = DetermineValueType(rawvalue)\r\n//\r\n// Takes a value and looks for special formatting like $, %, numbers, etc.\r\n// Returns the value as a number or string and the type as {value: value, type: type}.\r\n// Tries to follow the spec for spreadsheet function VALUE(v).\r\n//\r\n\r\nSocialCalc.DetermineValueType = function(rawvalue) {\r\n\r\n   var value = rawvalue + \"\";\r\n   var type = \"t\";\r\n   var tvalue, matches, year, hour, minute, second, denom, num, intgr, constr;\r\n\r\n   tvalue = value.replace(/^\\s+/, \"\"); // remove leading and trailing blanks\r\n   tvalue = tvalue.replace(/\\s+$/, \"\");\r\n\r\n   if (value.length==0) {\r\n      type = \"\";\r\n      }\r\n   else if (value.match(/^\\s+$/)) { // just blanks\r\n      ; // leave type \"t\"\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*(?:[eE][-+]?\\d+)?$/)) { // general number, including E\r\n      value = tvalue - 0; // try converting to number\r\n      if (isNaN(value)) { // leave alone - catches things like plain \"-\"\r\n         value = rawvalue + \"\";\r\n         }\r\n      else {\r\n         type = \"n\";\r\n         }\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*\\s*%$/)) { // percent form: 15.1%\r\n      value = (tvalue.slice(0, -1) - 0) / 100; // convert and scale\r\n      type = \"n%\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\$\\s*\\d*(?:\\.)?\\d*\\s*$/) && tvalue.match(/\\d/)) { // $ format: $1.49\r\n      value = tvalue.replace(/\\$/, \"\") - 0;\r\n      type = \"n$\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*$/)) { // number format ignoring commas: 1,234.49\r\n      value = tvalue.replace(/,/g, \"\") - 0;\r\n      type = \"n\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*\\s*%$/)) { // % with commas: 1,234.49%\r\n      value = (tvalue.replace(/[%,]/g, \"\") - 0) / 100;\r\n      type = \"n%\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\$\\s*(\\d*,\\d*)+(?:\\.)?\\d*$/) && tvalue.match(/\\d/)) { // $ and commas: $1,234.49\r\n      value = tvalue.replace(/[\\$,]/g, \"\") - 0;\r\n      type = \"n$\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,4})\\s*$/)) { // MM-DD-YYYY, MM/DD/YYYY\r\n      year = matches[3] - 0;\r\n      year = year < 1000 ? year + 2000 : year;\r\n      value = ((navigator.language).indexOf(\"fr\") === 0)  ? (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[1]-0)-2415019) : (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[1]-0, matches[2]-0)-2415019);\r\n      type = \"nd\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD\r\n      year = matches[1]-0;\r\n      year = year < 1000 ? year + 2000 : year;\r\n      value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n      type = \"nd\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM\r\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM\r\n     year = matches[1]-0;\r\n     year = year < 1000 ? year + 2000 : year;\r\n     hour = matches[4]-0;\r\n     minute = matches[5]-0;\r\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n     type = \"nd\";\r\n     if (hour < 24 && minute < 60) {\r\n       value += hour/24 + minute/(24*60);\r\n       type = \"ndt\";\r\n       }\r\n     }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\r\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\r\n     year = matches[1]-0;\r\n     year = year < 1000 ? year + 2000 : year;\r\n     hour = matches[4]-0;\r\n     minute = matches[5]-0;\r\n     second = matches[6]-0;\r\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n     type = \"nd\";\r\n     if (hour < 24 && minute < 60 && second < 60) {\r\n       value += hour/24 + minute/(24*60) + second/(24*60*60);\r\n       type = \"ndt\";\r\n       }\r\n     }\r\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM\r\n      hour = matches[1]-0;\r\n      minute = matches[2]-0;\r\n      if (hour < 24 && minute < 60) {\r\n         value = hour/24 + minute/(24*60);\r\n         type = \"nt\";\r\n         }\r\n      }\r\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM:SS\r\n      hour = matches[1]-0;\r\n      minute = matches[2]-0;\r\n      second = matches[3]-0;\r\n      if (hour < 24 && minute < 60 && second < 60) {\r\n         value = hour/24 + minute/(24*60) + second/(24*60*60);\r\n         type = \"nt\";\r\n         }\r\n      }\r\n   else if (matches=value.match(/^\\s*([-+]?\\d+) (\\d+)\\/(\\d+)\\s*$/)) { // 1 1/2\r\n      intgr = matches[1]-0;\r\n      num = matches[2]-0;\r\n      denom = matches[3]-0;\r\n      if (denom && denom > 0) {\r\n         value = intgr + (intgr < 0 ? -num/denom : num/denom);\r\n         type = \"n\";\r\n         }\r\n      }\r\n   else if (constr=SocialCalc.InputConstants[value.toUpperCase()]) { // special constants, like \"false\" and #N/A\r\n      num = constr.indexOf(\",\");\r\n      value = constr.substring(0,num)-0;\r\n      type = constr.substring(num+1);\r\n      }\r\n   else if (tvalue.length > 7 && tvalue.substring(0,7).toLowerCase()==\"http://\") { // URL\r\n      value = tvalue;\r\n      type = \"tl\";\r\n      }\r\n   else if (tvalue.match(/<([A-Z][A-Z0-9]*)\\b[^>]*>[\\s\\S]*?<\\/\\1>/i)) { // HTML\r\n      value = tvalue;\r\n      type = \"th\";\r\n      }\r\n\r\n   return {value: value, type: type};\r\n\r\n   }\r\n\r\nSocialCalc.InputConstants = { // strings that turn into constants for SocialCalc.DetermineValueType\r\n      \"TRUE\": \"1,nl\", \"FALSE\": \"0,nl\", \"#N/A\": \"0,e#N/A\", \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\",\r\n      \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\", \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\r\n\r\n//\r\n// result = default_expand_markup(displayvalue, sheetobj, linkstyle)\r\n//\r\n// Processes wiki-text -- this is a placeholder.\r\n// Reference to here in SocialCalc.expand_markup should be replaced by application-specific routine.\r\n//\r\n\r\nSocialCalc.default_expand_markup = function(displayvalue, sheetobj, linkstyle) {\r\n\r\n   var result = displayvalue;\r\n\r\n   result = SocialCalc.special_chars(result); // do special chars\r\n   result = result.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n   result = result.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n\r\n   return result; // do very little by default\r\n\r\n   result = result.replace(/('*)'''(.*?)'''/g, \"$1<b>$2<\\/b>\"); // Wiki-style bold/italics\r\n   result = result.replace(/''(.*?)''/g, \"<i>$1<\\/i>\");\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat)\r\n//\r\n// Parses link text (URL, descriptions, pagenames, workspace names) and returns HTML\r\n//\r\n\r\nSocialCalc.expand_text_link = function(displayvalue, sheetobj, linkstyle, valueformat) {\r\n\r\n   var desc, tb, str;\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var url = \"\";\r\n   var parts = SocialCalc.ParseCellLinkText(displayvalue+\"\");\r\n\r\n   if (parts.desc) {\r\n      desc = SocialCalc.special_chars(parts.desc);\r\n      }\r\n   else {\r\n      desc = parts.pagename ? scc.defaultPageLinkFormatString : scc.defaultLinkFormatString;\r\n      }\r\n\r\n   if (displayvalue.length > 7 && displayvalue.substring(0,7).toLowerCase()==\"http://\" \r\n      && displayvalue.charAt(displayvalue.length-1)!=\">\") {\r\n      desc = desc.substring(7); // remove http:// unless explicit\r\n      }\r\n\r\n   tb = (parts.newwin || !linkstyle) ? ' target=\"_blank\"' : \"\";\r\n\r\n   if (parts.pagename) {\r\n      if (SocialCalc.Callbacks.MakePageLink) {\r\n         url = SocialCalc.Callbacks.MakePageLink(parts.pagename, parts.workspacename, linkstyle, valueformat);\r\n         }\r\n//      else if (parts.workspace) {\r\n//         url = \"/\" + encodeURI(parts.workspace) + \"/\" + encodeURI(parts.pagename);\r\n//         }\r\n//      else {\r\n//         url = parts.pagename;\r\n//         }\r\n      }\r\n   else {\r\n      url = encodeURI(parts.url);\r\n      }\r\n   str = '<a href=\"' + url + '\"' + tb + '>' + desc + '</a>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ParseCellLinkText(str)\r\n//\r\n// Given: url = http://www.someurl.com/more, desc = Some descriptive text\r\n//\r\n// Takes the following:\r\n//\r\n//    url\r\n//    <url>\r\n//    desc<url>\r\n//    \"desc\"<url>\r\n//    <<>> instead of <> => target=\"_blank\" (new window)\r\n//\r\n//    [page name]\r\n//    \"desc\"[page name]\r\n//    desc[page name]\r\n//    {workspace name [page name]}\r\n//    \"desc\"{workspace name [page name]}\r\n//    [[]] instead of [] => target=\"_blank\" (new window)\r\n//\r\n//\r\n// Returns: {url: url, desc: desc, newwin: t/f, pagename: pagename, workspace: workspace}\r\n//\r\n\r\nSocialCalc.ParseCellLinkText = function(str) {\r\n\r\n   var result = {url: \"\", desc: \"\", newwin: false, pagename: \"\", workspace: \"\"};\r\n\r\n   var pageform = false;\r\n   var urlend = str.length - 1;\r\n   var descstart = 0;\r\n   var lastlt = str.lastIndexOf(\"<\");\r\n   var lastbrkt = str.lastIndexOf(\"[\");\r\n   var lastbrace = str.lastIndexOf(\"{\");\r\n   var descend = -1;\r\n\r\n   if ((str.charAt(urlend) != \">\" || lastlt == -1)\r\n         && (str.charAt(urlend) != \"]\" || lastbrkt == -1)\r\n         && (str.charAt(urlend) != \"}\" || str.charAt(urlend-1) != \"]\" || \r\n             lastbrace == -1 || lastbrkt == -1 || lastbrkt < lastbrace)) { // plain url\r\n      urlend++;\r\n      descend = urlend;\r\n      }\r\n   else { // some markup\r\n      if (str.charAt(urlend)==\">\") { // url form\r\n         descend = lastlt - 1;\r\n         if (lastlt > 0 && str.charAt(descend) == \"<\" && str.charAt(urlend-1) == \">\") {\r\n            descend--;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         }\r\n\r\n      else if (str.charAt(urlend)==\"]\") { // plain page form\r\n         descend = lastbrkt - 1;\r\n         pageform = true;\r\n         if (lastbrkt > 0 && str.charAt(descend) == \"[\" && str.charAt(urlend-1) == \"]\") {\r\n            descend--;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         }\r\n\r\n      else if (str.charAt(urlend)==\"}\") { // page and workspace form\r\n         descend = lastbrace - 1;\r\n         pageform = true;\r\n         wsend = lastbrkt;\r\n         urlend--;\r\n         if (lastbrkt > 0 && str.charAt(lastbrkt-1) == \"[\" && str.charAt(urlend-1) == \"]\") {\r\n            wsend = lastbrkt-1;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         if (str.charAt(wsend-1)==\" \") { // trim trailing space in workspace name\r\n            wsend--;\r\n            }\r\n         result.workspace = str.substring(lastbrace+1, wsend) || \"\";\r\n         }\r\n\r\n      if (str.charAt(descend)==\" \") { // trim trailing space on desc\r\n         descend--;\r\n         }\r\n\r\n      if (str.charAt(descstart) == '\"' && str.charAt(descend) == '\"') {\r\n         descstart++;\r\n         descend--;\r\n         }\r\n      }\r\n\r\n   if (pageform) {\r\n      result.pagename = str.substring(lastbrkt+1, urlend) || \"\";\r\n      }\r\n   else {\r\n      result.url = str.substring(lastlt+1, urlend) || \"\";\r\n      }\r\n\r\n   if (descend >= descstart) {\r\n      result.desc = str.substring(descstart, descend+1);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ConvertSaveToOtherFormat(savestr, outputformat, dorecalc)\r\n//\r\n// Returns a string in the specificed format: \"scsave\", \"html\", \"csv\", \"tab\" (tab delimited)\r\n// If dorecalc is true, performs a recalc after loading (NO: obsolete!).\r\n//\r\n\r\nSocialCalc.ConvertSaveToOtherFormat = function(savestr, outputformat, dorecalc) {\r\n\r\n   var sheet, context, clipextents, div, ele, row, col, cr, cell, str;\r\n\r\n   var result = \"\";\r\n\r\n   if (outputformat == \"scsave\") {\r\n      return savestr;\r\n      }\r\n\r\n   if (savestr == \"\") {\r\n      return \"\";\r\n      }\r\n\r\n   sheet = new SocialCalc.Sheet();\r\n   sheet.ParseSheetSave(savestr);\r\n\r\n   if (dorecalc) {\r\n      // no longer supported as of 9/10/08\r\n      // Recalc is now async, so can't do it this way\r\n      throw(\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\");\r\n      }\r\n\r\n   if (sheet.copiedfrom) {\r\n      clipextents = SocialCalc.ParseRange(sheet.copiedfrom);\r\n      }\r\n   else {\r\n      clipextents = {cr1: {row: 1, col: 1}, cr2: {row: sheet.attribs.lastrow, col: sheet.attribs.lastcol}};\r\n      }\r\n\r\n   if (outputformat == \"html\") {\r\n      context=new SocialCalc.RenderContext(sheet);\r\n      if (sheet.copiedfrom) {\r\n         context.rowpanes[0] = {first: clipextents.cr1.row, last: clipextents.cr2.row};\r\n         context.colpanes[0] = {first: clipextents.cr1.col, last: clipextents.cr2.col};\r\n         }\r\n      div = document.createElement(\"div\");\r\n      ele = context.RenderSheet(null, context.defaultHTMLlinkstyle);\r\n      div.appendChild(ele);\r\n      delete context;\r\n      delete sheet;\r\n      result = div.innerHTML;\r\n      delete ele;\r\n      delete div;\r\n      return result;\r\n      }\r\n\r\n   for (row = clipextents.cr1.row; row <= clipextents.cr2.row; row++) {\r\n      for (col = clipextents.cr1.col; col <= clipextents.cr2.col; col++) {\r\n         cr = SocialCalc.crToCoord(col, row);\r\n         cell = sheet.GetAssuredCell(cr);\r\n\r\n         if (cell.errors) {\r\n            str = cell.errors;\r\n            }\r\n         else {\r\n            str = cell.datavalue+\"\"; // get value as text\r\n            }\r\n\r\n         if (outputformat == \"csv\") {\r\n            if (str.indexOf('\"')!=-1) {\r\n               str = str.replace(/\"/g, '\"\"'); // double quotes\r\n               }\r\n            if (/[, \\n\"]/.test(str)) {\r\n               str = '\"' + str + '\"'; // add quotes\r\n               }\r\n            if (col>clipextents.cr1.col) {\r\n               str = \",\" + str; // add commas\r\n               }\r\n            }\r\n         else if (outputformat == \"tab\") {\r\n            if (str.indexOf('\\n')!=-1) { // if multiple lines\r\n               if (str.indexOf('\"')!=-1) {\r\n                  str = str.replace(/\"/g, '\"\"'); // double quotes\r\n                  }\r\n               str = '\"' + str + '\"'; // add quotes\r\n               }\r\n            if (col>clipextents.cr1.col) {\r\n               str = \"\\t\" + str; // add tabs\r\n               }\r\n            }\r\n         result += str;\r\n         }\r\n      result += \"\\n\";\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ConvertOtherFormatToSave(inputstr, inputformat)\r\n//\r\n// Returns a string converted from the specified format: \"scsave\", \"csv\", \"tab\" (tab delimited)\r\n//\r\n\r\nSocialCalc.ConvertOtherFormatToSave = function(inputstr, inputformat) {\r\n\r\n   var sheet, context, lines, i, line, value, inquote, j, ch, values, row, col, cr, maxc;\r\n\r\n   var result = \"\";\r\n\r\n   var AddCell = function() {\r\n      col++;\r\n      if (col>maxc) maxc = col;\r\n      cr = SocialCalc.crToCoord(col, row);\r\n      SocialCalc.SetConvertedCell(sheet, cr, value);\r\n      value = \"\";\r\n      }\r\n\r\n   if (inputformat == \"scsave\") {\r\n      return inputstr;\r\n      }\r\n\r\n   sheet = new SocialCalc.Sheet();\r\n\r\n   lines = inputstr.split(/\\r\\n|\\n/);\r\n\r\n   maxc = 0;\r\n   if (inputformat == \"csv\") {\r\n      row = 0;\r\n      inquote = false;\r\n      for (i=0; i<lines.length; i++) {\r\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\r\n            break;\r\n            }\r\n         if (inquote) { // if inquote, just continue from where left off\r\n            value += \"\\n\";\r\n            }\r\n         else { // otherwise next row\r\n            value = \"\";\r\n            row++;\r\n            col = 0;\r\n            }\r\n         line = lines[i];\r\n         for (j=0; j<line.length; j++) {\r\n            ch = line.charAt(j);\r\n            if (ch == '\"') {\r\n               if (inquote) {\r\n                  if (j<line.length-1 && line.charAt(j+1) == '\"') { // double quotes\r\n                     j++; // skip the second one\r\n                     value += '\"'; // add one quote\r\n                     }\r\n                  else {\r\n                     inquote = false;\r\n                     if (j==line.length-1) { // at end of line\r\n                        AddCell();\r\n                        }\r\n                     }\r\n                  }\r\n               else {\r\n                  inquote = true;\r\n                  }\r\n               continue;\r\n               }\r\n            if (ch == \",\" && !inquote) {\r\n               AddCell();\r\n               }\r\n            else {\r\n               value += ch;\r\n               }\r\n            if (j==line.length-1 && !inquote) {\r\n               AddCell();\r\n               }\r\n            }\r\n         }\r\n      if (maxc>0) {\r\n         sheet.attribs.lastrow = row;\r\n         sheet.attribs.lastcol = maxc;\r\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\r\n         }\r\n      }\r\n\r\n   if (inputformat == \"tab\") {\r\n      row = 0;\r\n      inquote = false;\r\n      for (i=0; i<lines.length; i++) {\r\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\r\n            break;\r\n            }\r\n         if (inquote) { // if inquote, just continue from where left off\r\n            value += \"\\n\";\r\n            }\r\n         else { // otherwise next row\r\n            value = \"\";\r\n            row++;\r\n            col = 0;\r\n            }\r\n         line = lines[i];\r\n         for (j=0; j<line.length; j++) {\r\n            ch = line.charAt(j);\r\n            if (ch == '\"') {\r\n               if (inquote) {\r\n                  if (j<line.length-1) {\r\n                     if (line.charAt(j+1) == '\"') { // double quotes\r\n                        j++; // skip the second one\r\n                        value += '\"'; // add one quote\r\n                        }\r\n                     else if (line.charAt(j+1) == '\\t') { // end of quoted item\r\n                        j++;\r\n                        inquote = false;\r\n                        AddCell();\r\n                        }\r\n                     }\r\n                  else { // at end of line\r\n                     inquote = false;\r\n                     AddCell();\r\n                     }\r\n                  continue;\r\n                  }\r\n               if (value==\"\") { // quote at start of item\r\n                  inquote = true;\r\n                  continue;\r\n                  }\r\n               }\r\n            if (ch == \"\\t\" && !inquote) {\r\n               AddCell();\r\n               }\r\n            else {\r\n               value += ch;\r\n               }\r\n            if (j==line.length-1 && !inquote) {\r\n               AddCell();\r\n               }\r\n            }\r\n         }\r\n      if (maxc>0) {\r\n         sheet.attribs.lastrow = row;\r\n         sheet.attribs.lastcol = maxc;\r\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SetConvertedCell(sheet, cr, rawvalue)\r\n//\r\n// Sets the cell cr with a value and type determined from rawvalue\r\n//\r\n\r\nSocialCalc.SetConvertedCell = function(sheet, cr, rawvalue) {\r\n\r\n   var cell, value;\r\n\r\n   cell = sheet.GetAssuredCell(cr);\r\n\r\n   value = SocialCalc.DetermineValueType(rawvalue);\r\n\r\n   if (value.type == 'n' && value.value == rawvalue) { // check that we don't need \"constant\" to remember original value\r\n      cell.datatype = \"v\";\r\n      cell.valuetype = \"n\";\r\n      cell.datavalue = value.value;\r\n      }\r\n   else if (value.type.charAt(0) == 't') { // text of some sort but left unchanged\r\n      cell.datatype = \"t\";\r\n      cell.valuetype = value.type;\r\n      cell.datavalue = value.value;\r\n      }\r\n   else { // special number types\r\n      cell.datatype = \"c\";\r\n      cell.valuetype = value.type;\r\n      cell.datavalue = value.value;\r\n      cell.formula = rawvalue;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalcTableEditor\r\n//\r\n/*\r\n// The code module of the SocialCalc package that displays a scrolling grid with panes\r\n// and handles keyboard and mouse I/O.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n*/\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript TableEditor.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the TableEditor is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/xoattrib\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) { // created here, too, in case load order is wrong, but main routines are required\r\n      SocialCalc = {};\r\n      }\r\n\r\n// *************************************\r\n//\r\n// Table Editor class:\r\n//\r\n// *************************************\r\n\r\n// Constructor:\r\n\r\nSocialCalc.TableEditor = function(context) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.context = context; // editing context\r\n   this.toplevel = null; // top level HTML element for this table editor\r\n   this.fullgrid = null; // rendered editing context\r\n\r\n   this.noEdit = false; // if true, disable all edit UI and make read-only\r\n\r\n   this.width = null;\r\n   this.tablewidth = null;\r\n   this.height = null;\r\n   this.tableheight = null;\r\n\r\n   this.inputBox = null;\r\n   this.inputEcho = null;\r\n   this.verticaltablecontrol = null;\r\n   this.horizontaltablecontrol = null;\r\n\r\n   this.logo = null;\r\n\r\n   this.cellhandles = null;\r\n\r\n   // Dynamic properties:\r\n\r\n   this.timeout = null; // if non-null, timer id for position calculations\r\n   this.busy = false; // true when executing command, calculating, etc.\r\n   this.ensureecell = false; // if true, ensure ecell is visible after timeout\r\n   this.deferredCommands = []; // commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\r\n   this.deferredEmailCommands = []; // Email commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\r\n\r\n   this.gridposition = null; // screen coords of full grid\r\n   this.headposition = null; // screen coords of upper left of grid within header rows\r\n   this.firstscrollingrow = null; // row number of top row in last (the scrolling) pane\r\n   this.firstscrollingrowtop = null;  // position of top row in last (the scrolling) pane\r\n   this.lastnonscrollingrow = null; // row number of last displayed row in last non-scrolling\r\n                                    // pane, or zero (for thumb position calculations)\r\n   this.lastvisiblerow = null; // used for paging down\r\n   this.firstscrollingcol = null; // column number of top col in last (the scrolling) pane\r\n   this.firstscrollingcolleft = null;  // position of top col in last (the scrolling) pane\r\n   this.lastnonscrollingcol = null; // col number of last displayed column in last non-scrolling\r\n                                    // pane, or zero (for thumb position calculations)\r\n   this.lastvisiblecol = null; // used for paging right\r\n\r\n   this.rowpositions = []; // screen positions of the top of some rows\r\n   this.colpositions = []; // screen positions of the left side of some rows\r\n   this.rowheight = []; // size in pixels of each row when last checked, or null/undefined, for page up\r\n   this.colwidth = []; // size in pixels of each column when last checked, or null/undefined, for page left\r\n\r\n   this.ecell = null; // either null or {coord: c, row: r, col: c}\r\n   this.state = \"start\"; // the keyboard states: see EditorProcessKey\r\n\r\n   this.workingvalues = {}; // values used during keyboard editing, etc.\r\n\r\n   // Constants:\r\n\r\n   this.imageprefix = scc.defaultImagePrefix; // URL prefix for images (e.g., \"/images/sc\")\r\n   this.idPrefix = scc.defaultTableEditorIDPrefix;\r\n   this.pageUpDnAmount = scc.defaultPageUpDnAmount; // number of rows to move cursor on PgUp/PgDn keys (numeric)\r\n\r\n   // Callbacks\r\n\r\n   // recalcFunction: if present, function(editor) {...}, called to do a recalc\r\n   // Default (sheet.RecalcSheet) does all the right stuff.\r\n\r\n   this.recalcFunction = function(editor) {\r\n      if (editor.context.sheetobj.RecalcSheet) {\r\n         editor.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback, editor);\r\n         }\r\n      else return null;\r\n      };\r\n\r\n   // ctrlkeyFunction: if present, function(editor, charname) {...}, called to handle ctrl-V, etc., at top level\r\n   // Returns true (pass through for continued processing) or false (stop processing this key).\r\n\r\n   this.ctrlkeyFunction = function(editor, charname) {\r\n\r\n      var ta, cell, position, cmd, sel, cliptext;\r\n\r\n      switch (charname) {\r\n         case \"[ctrl-c]\":\r\n         case \"[ctrl-x]\":\r\n            ta = editor.pasteTextarea;\r\n            ta.value = \"\";\r\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n            if (cell) {\r\n               position = SocialCalc.GetElementPosition(cell.element);\r\n               ta.style.left = (position.left-1)+\"px\";\r\n               ta.style.top = (position.top-1)+\"px\";\r\n               }\r\n            if (editor.range.hasrange) {\r\n               sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                  \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n               }\r\n            else {\r\n               sel = editor.ecell.coord;\r\n               }\r\n\r\n            // get what to copy to clipboard\r\n            cliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"tab\");\r\n\r\n            if (charname == \"[ctrl-c]\" || editor.noEdit || editor.ECellReadonly()) { // if copy or cut but in no edit\r\n               cmd = \"copy \"+sel+\" formulas\";\r\n               }\r\n            else { // [ctrl-x]\r\n               cmd = \"cut \"+sel+\" formulas\";\r\n               }\r\n            editor.EditorScheduleSheetCommands(cmd, true, false); // queue up command to put on SocialCalc clipboard\r\n\r\n            ta.style.display = \"block\";\r\n            ta.value = cliptext; // must follow \"block\" setting for Webkit\r\n            ta.focus();\r\n            ta.select();\r\n            window.setTimeout(function() {\r\n               var ta = editor.pasteTextarea;\r\n               ta.blur();\r\n               ta.style.display = \"none\";\r\n               SocialCalc.KeyboardFocus();\r\n               }, 200);\r\n\r\n            return true;\r\n\r\n         case \"[ctrl-v]\":\r\n            if (editor.noEdit || editor.ECellReadonly()) return true; // not if no edit\r\n            ta = editor.pasteTextarea;\r\n            ta.value = \"\";\r\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n            if (cell) {\r\n               position = SocialCalc.GetElementPosition(cell.element);\r\n               ta.style.left = (position.left-1)+\"px\";\r\n               ta.style.top = (position.top-1)+\"px\";\r\n               }\r\n            ta.style.display = \"block\";\r\n            ta.value = \"\";  // must follow \"block\" setting for Webkit\r\n            ta.focus();\r\n            window.setTimeout(function() {\r\n               var ta = editor.pasteTextarea;\r\n               var value = ta.value;\r\n               ta.blur();\r\n               ta.style.display = \"none\";\r\n               var cmd = \"\";\r\n               if(editor.pastescclipboard) {\r\n                 // Clipboard loaded from \"clipboard tab\" - see  SpreadsheetControlClipboardLoad \r\n                 // ignore windows clipboard contents\r\n                 editor.pastescclipboard = false;\r\n                 } \r\n               else {\r\n                 // Use windows clipboard contents if value does not match last copy\r\n                 var clipstr = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\r\n                 value = value.replace(/\\r\\n/g, \"\\n\");\r\n                 // pastes SocialCalc clipboard if did a Ctrl-C and contents still the same\r\n                 // Webkit adds an extra blank line, so need to allow for that\r\n                 if (value != clipstr && (value.length-clipstr.length!=1 || value.substring(0,value.length-1)!=clipstr)) {\r\n                    cmd = \"loadclipboard \"+\r\n                    SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(value, \"tab\")) + \"\\n\";\r\n                    }\r\n                 }\r\n               var cr;\r\n               if (editor.range.hasrange) {\r\n                  var clipsheet = new SocialCalc.Sheet();\r\n                  clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\r\n                  var matches = clipsheet.copiedfrom.match(/(.+):(.+)/);\r\n                  if (matches !== null && matches[1] === matches[2]) {\r\n                    // copy one cell to selected range\r\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top) +\r\n                      ':' + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n                  } else {\r\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top);\r\n                  }\r\n                  }\r\n               else {\r\n                  cr = editor.ecell.coord;\r\n                  }\r\n               cmd += \"paste \"+cr+\" formulas\";\r\n               editor.EditorScheduleSheetCommands(cmd, true, false);\r\n               SocialCalc.KeyboardFocus();\r\n               }, 200);\r\n            return true;\r\n\r\n         case \"[ctrl-z]\":\r\n            editor.EditorScheduleSheetCommands(\"undo\", true, false);\r\n            return false;\r\n\r\n         case \"[ctrl-s]\": // !!!! temporary hack\r\n            if (!SocialCalc.Constants.AllowCtrlS) break;\r\n            window.setTimeout(\r\n               function() {\r\n                  var sheet = editor.context.sheetobj;\r\n                  var cell = sheet.GetAssuredCell(editor.ecell.coord);\r\n                  var ntvf = cell.nontextvalueformat ? sheet.valueformats[cell.nontextvalueformat-0] || \"\" : \"\";\r\n                  var newntvf = window.prompt(\"Advanced Feature:\\n\\nCustom Numeric Format or Command\", ntvf);\r\n                  if (newntvf != null) { // not cancelled\r\n                     if (newntvf.match(/^cmd:/)) {\r\n                        cmd = newntvf.substring(4); // execute as command\r\n                        }\r\n                     else if (newntvf.match(/^edit:/)) {\r\n                        cmd = newntvf.substring(5); // execute as command\r\n                        if (SocialCalc.CtrlSEditor) {\r\n                           SocialCalc.CtrlSEditor(cmd);\r\n                           }\r\n                        return;\r\n                        }\r\n                     else {\r\n                        if (editor.range.hasrange) {\r\n                           sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                              \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n                           }\r\n                        else {\r\n                          sel = editor.ecell.coord;\r\n                           }\r\n                        cmd = \"set \"+sel+\" nontextvalueformat \"+newntvf;\r\n                        }\r\n                     editor.EditorScheduleSheetCommands(cmd, true, false);\r\n                     }\r\n                  },\r\n               200);\r\n            return false;\r\n\r\n         default:\r\n            break;\r\n            }\r\n      return true;\r\n      };\r\n\r\n   // Set sheet's status callback:\r\n\r\n   context.sheetobj.statuscallback = SocialCalc.EditorSheetStatusCallback;\r\n   context.sheetobj.statuscallbackparams = this; // this object: the table editor object\r\n\r\n\r\n   // StatusCallback: all values are called at appropriate times, add with unique name, delete when done\r\n   //\r\n   // Each value must be an object in the form of:\r\n   //\r\n   //    func: function(editor, status, arg, params) {...},\r\n   //    params: params value to call func with\r\n   //\r\n   // The values for status and arg are:\r\n   //\r\n   //    all the SocialCalc RecalcSheet statuscallbacks, including:\r\n   //\r\n   //       calccheckdone, calclist length\r\n   //       calcorder, {coord: coord, total: celllist length, count: count}\r\n   //       calcstep, {coord: coord, total: calclist length, count: count}\r\n   //       calcfinished, time in milliseconds\r\n   //\r\n   //    the command callbacks, like cmdstart and cmdend\r\n   //    cmdendnorender\r\n   //\r\n   //    calcstart, null\r\n   //    moveecell, new ecell coord\r\n   //    rangechange, \"coord:coord\" or \"coord\" or \"\"\r\n   //    specialkey, keyname (\"[esc]\")\r\n   //\r\n\r\n   this.StatusCallback = {};\r\n\r\n\r\n   this.MoveECellCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\r\n   this.RangeChangeCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\r\n   this.SettingsCallbacks = {}; // See SocialCalc.SaveEditorSettings\r\n\r\n   // Set initial cursor\r\n\r\n   this.ecell = {coord: \"A1\", row: 1, col: 1};\r\n   context.highlights[this.ecell.coord] = \"cursor\";\r\n\r\n   // Initialize range data\r\n   // Range has at least hasrange (true/false).\r\n   // It may also have: anchorcoord, anchorrow, anchorcol, top, bottom, left, and right.\r\n\r\n   this.range = {hasrange: false};\r\n\r\n   // Initialize range2 data (used to show selections, such as for move)\r\n   // Range2 has at least hasrange (true/false).\r\n   // It may also have: top, bottom, left, and right.\r\n\r\n   this.range2 = {hasrange: false};\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.TableEditor.prototype.CreateTableEditor = function(width, height) {return SocialCalc.CreateTableEditor(this, width, height);};\r\nSocialCalc.TableEditor.prototype.ResizeTableEditor = function(width, height) {return SocialCalc.ResizeTableEditor(this, width, height);};\r\n\r\nSocialCalc.TableEditor.prototype.SaveEditorSettings = function() {return SocialCalc.SaveEditorSettings(this);};\r\nSocialCalc.TableEditor.prototype.LoadEditorSettings = function(str, flags) {return SocialCalc.LoadEditorSettings(this, str, flags);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorRenderSheet = function() {SocialCalc.EditorRenderSheet(this);};\r\nSocialCalc.TableEditor.prototype.EditorScheduleSheetCommands = function(cmdstr, saveundo, ignorebusy) {SocialCalc.EditorScheduleSheetCommands(this, cmdstr, saveundo, ignorebusy);};\r\nSocialCalc.TableEditor.prototype.ScheduleSheetCommands = function(cmdstr, saveundo) {\r\n   this.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\r\n   };\r\nSocialCalc.TableEditor.prototype.SheetUndo = function() {\r\n   this.context.sheetobj.SheetUndo();\r\n   };\r\nSocialCalc.TableEditor.prototype.SheetRedo = function() {\r\n   this.context.sheetobj.SheetRedo();\r\n   };\r\nSocialCalc.TableEditor.prototype.EditorStepSet = function(status, arg) {SocialCalc.EditorStepSet(this, status, arg);};\r\nSocialCalc.TableEditor.prototype.GetStatuslineString = function(status, arg, params) {return SocialCalc.EditorGetStatuslineString(this, status, arg, params);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorMouseRegister = function() {return SocialCalc.EditorMouseRegister(this);};\r\nSocialCalc.TableEditor.prototype.EditorMouseUnregister = function() {return SocialCalc.EditorMouseUnregister(this);};\r\nSocialCalc.TableEditor.prototype.EditorMouseRange = function(coord) {return SocialCalc.EditorMouseRange(this, coord);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorProcessKey = function(ch, e) {return SocialCalc.EditorProcessKey(this, ch, e);};\r\nSocialCalc.TableEditor.prototype.EditorAddToInput = function(str, prefix) {return SocialCalc.EditorAddToInput(this, str, prefix);};\r\nSocialCalc.TableEditor.prototype.DisplayCellContents = function() {return SocialCalc.EditorDisplayCellContents(this);};\r\nSocialCalc.TableEditor.prototype.EditorSaveEdit = function(text) {return SocialCalc.EditorSaveEdit(this, text);};\r\nSocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange = function(cmdline, type) {return SocialCalc.EditorApplySetCommandsToRange(this, cmdline, type);};\r\n\r\nSocialCalc.TableEditor.prototype.MoveECellWithKey = function(ch) {return SocialCalc.MoveECellWithKey(this, ch);};\r\nSocialCalc.TableEditor.prototype.MoveECell = function(newcell) { if (SocialCalc._app) return \"A1\"; return SocialCalc.MoveECell(this, newcell);};\r\nSocialCalc.TableEditor.prototype.ReplaceCell = function(cell, row, col) {SocialCalc.ReplaceCell(this, cell, row, col);};\r\nSocialCalc.TableEditor.prototype.UpdateCellCSS = function(cell, row, col) {SocialCalc.UpdateCellCSS(this, cell, row, col);};\r\nSocialCalc.TableEditor.prototype.SetECellHeaders = function(selected) {SocialCalc.SetECellHeaders(this, selected);};\r\nSocialCalc.TableEditor.prototype.EnsureECellVisible = function() {SocialCalc.EnsureECellVisible(this);};\r\nSocialCalc.TableEditor.prototype.ECellReadonly = function(coord) {return SocialCalc.ECellReadonly(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeAnchor = function(coord) {SocialCalc.RangeAnchor(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeExtend = function(coord) {SocialCalc.RangeExtend(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeRemove = function() {SocialCalc.RangeRemove(this);};\r\nSocialCalc.TableEditor.prototype.Range2Remove = function() {SocialCalc.Range2Remove(this);};\r\n\r\nSocialCalc.TableEditor.prototype.FitToEditTable = function() {SocialCalc.FitToEditTable(this);};\r\nSocialCalc.TableEditor.prototype.CalculateEditorPositions = function() {SocialCalc.CalculateEditorPositions(this);};\r\nSocialCalc.TableEditor.prototype.ScheduleRender = function() {this.ScheduleRender(true);};\r\nSocialCalc.TableEditor.prototype.ScheduleRender = function(renderwidgets) {    \r\n  // App widgets need focus - so only render widgets when needed, rather than the default of rendering everything. \r\n  if(SocialCalc._app && renderwidgets == true) this.context.sheetobj.widgetsClean = false;  \r\n  SocialCalc.ScheduleRender(this);\r\n  };\r\nSocialCalc.TableEditor.prototype.DoRenderStep = function() {SocialCalc.DoRenderStep(this);};\r\nSocialCalc.TableEditor.prototype.SchedulePositionCalculations = function() {SocialCalc.SchedulePositionCalculations(this);};\r\nSocialCalc.TableEditor.prototype.DoPositionCalculations = function() {SocialCalc.DoPositionCalculations(this);};\r\nSocialCalc.TableEditor.prototype.CalculateRowPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateRowPositions(this,  panenum, positions, sizes);};\r\nSocialCalc.TableEditor.prototype.CalculateColPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateColPositions(this,  panenum, positions, sizes);};\r\n\r\nSocialCalc.TableEditor.prototype.ScrollRelative = function(vertical, amount) {SocialCalc.ScrollRelative(this, vertical, amount);};\r\nSocialCalc.TableEditor.prototype.ScrollRelativeBoth = function(vamount, hamount) {SocialCalc.ScrollRelativeBoth(this, vamount, hamount);};\r\nSocialCalc.TableEditor.prototype.PageRelative = function(vertical, direction) {SocialCalc.PageRelative(this, vertical, direction);};\r\nSocialCalc.TableEditor.prototype.LimitLastPanes = function() {SocialCalc.LimitLastPanes(this);};\r\n\r\nSocialCalc.TableEditor.prototype.ScrollTableUpOneRow = function() {return SocialCalc.ScrollTableUpOneRow(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableDownOneRow = function() {return SocialCalc.ScrollTableDownOneRow(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableLeftOneCol = function() {return SocialCalc.ScrollTableLeftOneCol(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableRightOneCol = function() {return SocialCalc.ScrollTableRightOneCol(this);};\r\n\r\nSocialCalc.TableEditor.prototype.StopPropagation = function() {\r\n    return SocialCalc.StopPropagation(this);\r\n};\r\n\r\nSocialCalc.TableEditor.prototype.SetMouseMoveUp = function() {\r\n    return SocialCalc.SetMouseMoveUp(this);\r\n};\r\n\r\nSocialCalc.TableEditor.prototype.RemoveMouseMoveUp = function() {\r\n    return SocialCalc.RemoveMouseMoveUp(this);\r\n};\r\n\r\n// Functions:\r\n\r\nSocialCalc.CreateTableEditor = function(editor, width, height) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var AssignID = SocialCalc.AssignID;\r\n\r\n   editor.toplevel = document.createElement(\"div\");\r\n   editor.toplevel.style.position = \"relative\";\r\n   AssignID(editor, editor.toplevel, \"toplevel\");\r\n   editor.width = width;\r\n   editor.height = height;\r\n\r\n   editor.griddiv = document.createElement(\"div\");\r\n   editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\r\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\r\n   editor.griddiv.style.width = editor.tablewidth+\"px\";\r\n   editor.griddiv.style.height = editor.tableheight+\"px\";\r\n   editor.griddiv.style.overflow = \"hidden\";\r\n   editor.griddiv.style.cursor = \"default\";\r\n   if (scc.cteGriddivClass) editor.griddiv.className = scc.cteGriddivClass;\r\n   AssignID(editor, editor.griddiv, \"griddiv\");\r\n\r\n   editor.FitToEditTable();\r\n\r\n   editor.EditorRenderSheet();\r\n\r\n   editor.griddiv.appendChild(editor.fullgrid);\r\n\r\n   editor.verticaltablecontrol = new SocialCalc.TableControl(editor, true, editor.tableheight);\r\n   editor.verticaltablecontrol.CreateTableControl();\r\n   AssignID(editor, editor.verticaltablecontrol.main, \"tablecontrolv\");\r\n\r\n   editor.horizontaltablecontrol = new SocialCalc.TableControl(editor, false, editor.tablewidth);\r\n   editor.horizontaltablecontrol.CreateTableControl();\r\n   AssignID(editor, editor.horizontaltablecontrol.main, \"tablecontrolh\");\r\n\r\n   var table, tbody, tr, td, img, anchor, ta;\r\n\r\n   table = document.createElement(\"table\");\r\n   editor.layouttable = table;\r\n   table.cellSpacing = 0;\r\n   table.cellPadding = 0;\r\n   AssignID(editor, table, \"layouttable\");\r\n\r\n   tbody = document.createElement(\"tbody\");\r\n   table.appendChild(tbody);\r\n\r\n   tr = document.createElement(\"tr\");\r\n   tbody.appendChild(tr);\r\n   td = document.createElement(\"td\");\r\n   td.appendChild(editor.griddiv);\r\n   tr.appendChild(td);\r\n   if (SocialCalc._app != true) { // no scroll bar in app\r\n     // Add v scroll bar  \r\n     td = document.createElement(\"td\");\r\n     td.appendChild(editor.verticaltablecontrol.main);\r\n     tr.appendChild(td);\r\n   }\r\n   tr = document.createElement(\"tr\");\r\n   tbody.appendChild(tr);\r\n   if (SocialCalc._app != true) { // no scroll bar in app\r\n     // Add h scroll bar  \r\n     td = document.createElement(\"td\");\r\n     td.appendChild(editor.horizontaltablecontrol.main);\r\n     tr.appendChild(td);\r\n   }\r\n\r\n   td = document.createElement(\"td\"); // logo display: Required by CPAL License for this code!\r\n   if (SocialCalc._app) { // in app right align Required CPAL License logo\r\n     td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat right center\";\r\n   } else {\r\n     td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat center center\";\r\n   }\r\n   td.innerHTML = \"<div style='cursor:pointer;font-size:1px;'><img src='\"+editor.imageprefix+\"1x1.gif' border='0' width='18' height='18'></div>\";\r\n   tr.appendChild(td);\r\n   editor.logo = td;\r\n   AssignID(editor, editor.logo, \"logo\");\r\n   SocialCalc.TooltipRegister(td.firstChild.firstChild, \"SocialCalc\", null, editor.toplevel);\r\n\r\n   editor.toplevel.appendChild(editor.layouttable);\r\n\r\n   if (!editor.noEdit) {\r\n      editor.inputEcho = new SocialCalc.InputEcho(editor);\r\n      AssignID(editor, editor.inputEcho.main, \"inputecho\");\r\n      }\r\n\r\n   editor.cellhandles = new SocialCalc.CellHandles(editor);\r\n\r\n   ta = document.createElement(\"textarea\"); // used for ctrl-c/ctrl-v where an invisible text area is needed\r\n   SocialCalc.setStyles(ta, \"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\");\r\n   ta.value = \"\";\r\n   editor.pasteTextarea = ta;\r\n   AssignID(editor, editor.pasteTextarea, \"pastetextarea\");\r\n\r\n   if (navigator.userAgent.match(/Safari\\//) &&!navigator.userAgent.match(/Chrome\\//)) { // special code for Safari 5 change\r\n      window.removeEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\r\n      window.removeEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\r\n      window.removeEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\r\n      }\r\n\r\n   editor.toplevel.appendChild(editor.pasteTextarea);\r\n\r\n   SocialCalc.MouseWheelRegister(editor.toplevel, {WheelMove: SocialCalc.EditorProcessMouseWheel, editor: editor});\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n\r\n   // do status reporting things\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"startup\", null, editor);\r\n\r\n   // done\r\n\r\n   return editor.toplevel;\r\n\r\n   }\r\n\r\n// Special code needed for change that occurred with Safari 5 that made paste not work for some reason\r\n\r\nSocialCalc.SafariPasteFunction = function(e) {\r\n   e.preventDefault();\r\n   }\r\n\r\n//\r\n// SocialCalc.ResizeTableEditor(editor, width, height)\r\n//\r\n// Move things around as appropriate and resize\r\n//\r\n\r\nSocialCalc.ResizeTableEditor = function(editor, width, height) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   editor.width = width;\r\n   editor.height = height;\r\n\r\n   editor.toplevel.style.width = width+\"px\";\r\n   editor.toplevel.style.height = height+\"px\";\r\n\r\n   if (SocialCalc._app) {\r\n     editor.tablewidth = Math.max(0, width ); // no v scroll bar with app\r\n   } else {\r\n     editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);     \r\n   }\r\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\r\n   editor.griddiv.style.width=editor.tablewidth+\"px\";\r\n   editor.griddiv.style.height=editor.tableheight+\"px\";\r\n\r\n   editor.verticaltablecontrol.main.style.height = editor.tableheight + \"px\";\r\n   editor.horizontaltablecontrol.main.style.width = editor.tablewidth + \"px\";\r\n\r\n   editor.FitToEditTable();\r\n\r\n   editor.ScheduleRender();\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// str = SaveEditorSettings(editor)\r\n//\r\n// Returns a string representation of the pane settings, etc.\r\n//\r\n// The format is:\r\n//\r\n//    version:1.0\r\n//    rowpane:panenumber:firstnum:lastnum\r\n//    colpane:panenumber:firstnum:lastnum\r\n//    ecell:coord -- if set\r\n//    range:anchorcoord:top:bottom:left:right -- if set\r\n//\r\n// You can add additional values to be saved by using editor.SettingsCallbacks:\r\n//\r\n//   editor.SettingsCallbacks[\"item-name\"] = {save: savefunction, load: loadfunction}\r\n//\r\n// where savefunction(editor, \"item-name\") returns a string with the new lines to be added to the saved settings\r\n// which include the trailing newlines, and loadfunction(editor, \"item-name\", line, flags) is given the line to process\r\n// without the trailing newlines.\r\n//\r\n\r\nSocialCalc.SaveEditorSettings = function(editor) {\r\n\r\n   var i, setting;\r\n   var context = editor.context;\r\n   var range = editor.range;\r\n   var result = \"\";\r\n\r\n   result += \"version:1.0\\n\";\r\n\r\n   for (i=0; i<context.rowpanes.length; i++) {\r\n      result += \"rowpane:\"+i+\":\"+context.rowpanes[i].first+\":\"+context.rowpanes[i].last+\"\\n\";\r\n      }\r\n   for (i=0; i<context.colpanes.length; i++) {\r\n      result += \"colpane:\"+i+\":\"+context.colpanes[i].first+\":\"+context.colpanes[i].last+\"\\n\";\r\n      }\r\n\r\n   if (editor.ecell) {\r\n      result += \"ecell:\"+editor.ecell.coord+\"\\n\";\r\n      }\r\n\r\n   if (range.hasrange) {\r\n      result += \"range:\"+range.anchorcoord+\":\"+range.top+\":\"+range.bottom+\":\"+range.left+\":\"+range.right+\"\\n\";\r\n      }\r\n\r\n   for (setting in editor.SettingsCallbacks) {\r\n      result += editor.SettingsCallbacks[setting].save(editor, setting);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// LoadEditorSettings(editor, str, flags)\r\n//\r\n// Sets the editor settings based on str. See SocialCalc.SaveEditorSettings for more details.\r\n// Unrecognized lines are ignored.\r\n//\r\n\r\nSocialCalc.LoadEditorSettings = function(editor, str, flags) {\r\n\r\n   var lines=str.split(/\\r\\n|\\n/);\r\n   var parts=[];\r\n   var line, i, cr, row, col, coord, setting;\r\n   var context = editor.context;\r\n   var highlights, range;\r\n\r\n   context.rowpanes = [{first: 1, last: 1}]; // reset to start\r\n   context.colpanes = [{first: 1, last: 1}];\r\n   editor.ecell = null;\r\n   editor.range = {hasrange: false};\r\n   editor.range2 = {hasrange: false};\r\n   range = editor.range;\r\n   context.highlights = {};\r\n   highlights = context.highlights;\r\n\r\n   for (i=0; i<lines.length; i++) {\r\n      line=lines[i];\r\n      parts = line.split(\":\");\r\n      setting = parts[0];\r\n      switch (setting) {\r\n         case \"version\":\r\n            break;\r\n\r\n         case \"rowpane\":\r\n            context.rowpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\r\n            break;\r\n\r\n         case \"colpane\":\r\n            context.colpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\r\n            break;\r\n\r\n         case \"ecell\":\r\n            editor.ecell = SocialCalc.coordToCr(parts[1]);\r\n            editor.ecell.coord = parts[1];\r\n            highlights[parts[1]] = \"cursor\";\r\n            break;\r\n\r\n         case \"range\":\r\n            range.hasrange = true;\r\n            range.anchorcoord = parts[1];\r\n            cr = SocialCalc.coordToCr(range.anchorcoord);\r\n            range.anchorrow = cr.row;\r\n            range.anchorcol = cr.col;\r\n            range.top = parts[2]-0;\r\n            range.bottom = parts[3]-0;\r\n            range.left = parts[4]-0;\r\n            range.right = parts[5]-0;\r\n            for (row=range.top; row<=range.bottom; row++) {\r\n               for (col=range.left; col<=range.right; col++) {\r\n                  coord = SocialCalc.crToCoord(col, row);\r\n                  if (highlights[coord]!=\"cursor\") {\r\n                     highlights[coord] = \"range\";\r\n                     }\r\n                  }\r\n               }\r\n            break;\r\n\r\n         default:\r\n            if (editor.SettingsCallbacks[setting]) {\r\n               editor.SettingsCallbacks[setting].load(editor, setting, line, flags);\r\n               }\r\n            break;\r\n         }\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// EditorRenderSheet(editor)\r\n//\r\n// Renders the sheet and updates editor.fullgrid.\r\n// Sets event handlers.\r\n//\r\n\r\nSocialCalc.EditorRenderSheet = function(editor) {\r\n\r\n   editor.EditorMouseUnregister();\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   // App widgets need to keep focus -  only render widgets if needed \r\n   if(sheetobj.reRenderCellList != null && SocialCalc._app && sheetobj.widgetsClean === true) {\r\n     // re-render each individual cells - but not widget with focus \r\n     for(var index in sheetobj.reRenderCellList) {\r\n       var coord = sheetobj.reRenderCellList[index];\r\n       var valuetype = sheetobj.cells[coord].valuetype;\r\n       if(valuetype.charAt(1) != \"i\" || valuetype !=  sheetobj.cells[coord].prevvaluetype) { // skip widgets - but paint when added/replaced\r\n         cr = SocialCalc.coordToCr(coord);\r\n         cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n         if(cell!=null) editor.ReplaceCell(cell, cr.row, cr.col);\r\n       }\r\n     }\r\n     sheetobj.reRenderCellList = [];\r\n   } else {\r\n      editor.fullgrid = editor.context.RenderSheet(editor.fullgrid);\r\n      if (sheetobj.reRenderCellList != null && SocialCalc._app) {\r\n        sheetobj.widgetsClean = true; // widgets have been rendered\r\n        sheetobj.reRenderCellList = [];        \r\n      }\r\n   }\r\n   \r\n   if (editor.ecell) editor.SetECellHeaders(\"selected\");\r\n\r\n   SocialCalc.AssignID(editor, editor.fullgrid, \"fullgrid\"); // give it an id\r\n   // eddy EditorRenderSheet {\r\n   if(!SocialCalc._app) editor.fullgrid.className = \"te_download\";\r\n   editor.EditorMouseRegister();\r\n   // } EditorRenderSheet\r\n   \r\n   }\r\n\r\n//\r\n// EditorScheduleSheetCommands(editor, cmdstr, saveundo, ignorebusy)\r\n//\r\n\r\nSocialCalc.EditorScheduleSheetCommands = function(editor, cmdstr, saveundo, ignorebusy) {\r\n\r\n   if (editor.state!=\"start\" && !ignorebusy) { // ignore commands if editing a cell\r\n      return;\r\n      }\r\n\r\n   if (editor.busy && !ignorebusy) { // hold off on commands if doing one\r\n      editor.deferredCommands.push({cmdstr: cmdstr, saveundo: saveundo});\r\n      return;\r\n      }\r\n\r\n   // eddy ExecuteSheetCommand {\r\n   var cmdTokens = cmdstr.split(\" \");\r\n\r\n   switch (cmdTokens[0]) {\r\n\t   // } eddy ExecuteSheetCommand \r\n      case \"recalc\":\r\n      case \"redisplay\":\r\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, false);\r\n         break;\r\n\r\n      case \"undo\":\r\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render     \r\n         editor.SheetUndo();\r\n         break;\r\n\r\n      case \"redo\":\r\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render\r\n         editor.SheetRedo();\r\n         break;\r\n         \r\n      case \"setemailparameters\":    \t  \r\n\t\t  SocialCalc.TriggerIoAction.Email(cmdTokens[1], cmdTokens[2]);\r\n    \t  break;\r\n         \r\n         \r\n      default:\r\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\r\n         break;\r\n      }\r\n   }\r\n\r\n\r\n//\r\n// EditorSheetStatusCallback(recalcdata, status, arg, editor)\r\n//\r\n// Called during recalc, executing commands, etc.\r\n//\r\n\r\nSocialCalc.EditorSheetStatusCallback = function(recalcdata, status, arg, editor) {\r\n\r\n   var f, cell, dcmd;\r\n   var sheetobj = editor.context.sheetobj;\r\n\r\n   var signalstatus = function(s) {\r\n      for (f in editor.StatusCallback) {\r\n         if (editor.StatusCallback[f].func) {\r\n            editor.StatusCallback[f].func(editor, s, arg, editor.StatusCallback[f].params);\r\n            }\r\n         }\r\n      }\r\n\r\n   switch (status) {\r\n\r\n      case \"startup\":\r\n         break;\r\n\r\n      case \"cmdstart\":\r\n         editor.busy = true;\r\n         sheetobj.celldisplayneeded = \"\";\r\n         break;\r\n\r\n      case \"cmdextension\":\r\n         break;\r\n\r\n      case \"cmdend\":\r\n         signalstatus(status);\r\n\r\n         if (sheetobj.changedrendervalues) {\r\n            editor.context.PrecomputeSheetFontsAndLayouts();\r\n            editor.context.CalculateCellSkipData();\r\n            sheetobj.changedrendervalues = false;\r\n            }\r\n\r\n         if (sheetobj.celldisplayneeded && !sheetobj.renderneeded) {\r\n             if (sheetobj.cells[sheetobj.celldisplayneeded] && sheetobj.cells[sheetobj.celldisplayneeded].valuetype != \"e#N/A\") {\r\n                cr = SocialCalc.coordToCr(sheetobj.celldisplayneeded);\r\n                cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n                editor.ReplaceCell(cell, cr.row, cr.col); // if no value set, wait for recalc and render . \r\n                }\r\n             }\r\n         if (editor.deferredCommands.length) {\r\n            dcmd = editor.deferredCommands.shift();\r\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\r\n            return;\r\n            }\r\n         if (sheetobj.attribs.needsrecalc &&\r\n               (sheetobj.attribs.recalc!=\"off\" || sheetobj.recalconce)\r\n               && editor.recalcFunction) {\r\n            editor.FitToEditTable();\r\n            sheetobj.renderneeded = false; // recalc will force a render\r\n            if (sheetobj.recalconce) delete sheetobj.recalconce; // only do once\r\n            editor.recalcFunction(editor);\r\n            }\r\n         else {\r\n            if (sheetobj.renderneeded) {\r\n               editor.FitToEditTable();\r\n               sheetobj.renderneeded = false;\r\n               editor.ScheduleRender(false);\r\n               }\r\n            else {\r\n               editor.SchedulePositionCalculations(); // just in case command changed positions\r\n//               editor.busy = false;\r\n//               signalstatus(\"cmdendnorender\");\r\n               }\r\n            }\r\n\r\n         // Handle hidden column.\r\n         if (sheetobj.hiddencolrow == \"col\") {\r\n            if (editor.ecell !== null) {\r\n               var col = editor.ecell.col;\r\n               while (sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n                  col++;\r\n                  }\r\n               var coord = SocialCalc.crToCoord(col, editor.ecell.row);\r\n               editor.MoveECell(coord);\r\n               sheetobj.hiddencolrow = \"\";\r\n               }\r\n            }\r\n\r\n         // Handle hidden row.\r\n         if (sheetobj.hiddencolrow == \"row\") {\r\n            if (editor.ecell !== null) {\r\n               var row = editor.ecell.row;\r\n               while (sheetobj.rowattribs.hide[row] == \"yes\") {\r\n                  row++;\r\n                  }\r\n               var coord = SocialCalc.crToCoord(editor.ecell.col, row);\r\n               editor.MoveECell(coord);\r\n               sheetobj.hiddencolrow = \"\";\r\n               }\r\n            }\r\n\r\n         return;\r\n\r\n      case \"calcstart\":\r\n         editor.busy = true;\r\n         break;\r\n\r\n      case \"calccheckdone\":\r\n      case \"calcorder\":\r\n      case \"calcstep\":\r\n      case \"calcloading\":\r\n      case \"calcserverfunc\":\r\n         break;\r\n\r\n      case \"calcfinished\":\r\n         signalstatus(status);\r\n         editor.ScheduleRender(false);                        \r\n         return;\r\n\r\n      case \"schedrender\":\r\n         editor.busy = true; // in case got here without cmd or recalc\r\n         break;\r\n\r\n      case \"renderdone\":\r\n         break;\r\n\r\n      case \"schedposcalc\":\r\n         editor.busy = true; // in case got here without cmd or recalc\r\n         break;\r\n\r\n      case \"doneposcalc\":\r\n          if (editor.deferredEmailCommands.length) {\r\n              signalstatus(status);\r\n              var emailcmd = editor.deferredEmailCommands.shift();\r\n              editor.EditorScheduleSheetCommands(emailcmd.cmdstr, emailcmd.saveundo, true);\r\n              return;\r\n              }\r\n    \t  \r\n    \t  \r\n         if (editor.deferredCommands.length) {\r\n            signalstatus(status);\r\n            dcmd = editor.deferredCommands.shift();\r\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\r\n            }\r\n         else {\r\n            editor.busy = false;\r\n            signalstatus(status);\r\n            if (editor.state==\"start\") editor.DisplayCellContents(); // make sure up to date\r\n            }\r\n         return;\r\n      // eddy EditorSheetStatusCallback {\r\n      case \"emailing\":\r\n      case \"confirmemailsent\":\r\n        break;\r\n      // } EditorSheetStatusCallback eddy \r\n         \r\n      default:\r\n    \t alert(\"Unknown status: \"+status);\r\n         break;\r\n\r\n      }\r\n\r\n   signalstatus(status);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// str = SocialCalc.EditorGetStatuslineString(editor, status, arg, params)\r\n//\r\n// Assumes params is an object where it can use \"calculating\" and \"command\"\r\n// to keep track of state.\r\n// Returns string for status line.\r\n//\r\n\r\nSocialCalc.EditorGetStatuslineString = function(editor, status, arg, params) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var sstr, progress, coord, circ, r, c, cell, sum, ele;\r\n\r\n   progress = \"\";\r\n\r\n   switch (status) {\r\n      case \"moveecell\":\r\n      case \"rangechange\":\r\n      case \"startup\":\r\n         break;\r\n      case \"cmdstart\":\r\n         params.command = true;\r\n         document.body.style.cursor = \"progress\";\r\n         editor.griddiv.style.cursor = \"progress\";\r\n         progress = scc.s_statusline_executing;\r\n         break;\r\n      case \"cmdextension\":\r\n         progress = \"Command Extension: \"+arg;\r\n         break;\r\n      case \"cmdend\":\r\n         params.command = false;\r\n         break;\r\n      case \"schedrender\":\r\n         progress = scc.s_statusline_displaying;\r\n         break;\r\n      case \"renderdone\":\r\n         progress = \" \";\r\n         break;\r\n      case \"schedposcalc\":\r\n         progress = scc.s_statusline_displaying;\r\n         break;\r\n      case \"cmdendnorender\":\r\n      case \"doneposcalc\":\r\n         document.body.style.cursor = \"default\";\r\n         editor.griddiv.style.cursor = \"default\";\r\n         // eddy EditorGetStatuslineString {\r\n         // all updates done, So let future event clear the \"sent\" message in the status bar\r\n         if(params.emailing == \"sent\") {\r\n        \t progress = params.emailreponse;\r\n        \t params.emailreponse = \"\";\r\n        \t params.emailing = \"done\";\r\n         }\r\n         // } eddy EditorGetStatuslineString \r\n         break;\r\n         \r\n      case \"calcorder\":\r\n         progress = scc.s_statusline_ordering+Math.floor(100*arg.count/(arg.total||1))+\"%\";\r\n         break;\r\n      case \"calcstep\":\r\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%\";\r\n         break;\r\n      case \"calcloading\":\r\n         progress = scc.s_statusline_calculatingls+\": \"+arg.sheetname;\r\n         break;\r\n      case \"calcserverfunc\":\r\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%, \"+scc.s_statusline_doingserverfunc+arg.funcname+scc.s_statusline_incell+arg.coord;\r\n         break;\r\n      case \"calcstart\":\r\n         params.calculating = true;\r\n         document.body.style.cursor = \"progress\";\r\n         editor.griddiv.style.cursor = \"progress\"; // griddiv has an explicit cursor style\r\n         progress = scc.s_statusline_calcstart;\r\n         break;\r\n      case \"calccheckdone\":\r\n         break;\r\n      case \"calcfinished\":\r\n         params.calculating = false;\r\n         break;\r\n      // eddy EditorGetStatuslineString {\r\n      case \"emailing\":\r\n    \t params.emailing = \"sending\";\r\n    \t params.emailreponse =\"\";\r\n         break;\r\n      case \"confirmemailsent\":\r\n     \t params.emailing = \"sent\";\r\n     \t if(typeof params.emailreponse === 'undefined') params.emailreponse =\"\";\r\n     \t params.emailreponse += arg;\r\n         break;    \t  \r\n      // } eddy EditorGetStatuslineString \r\n         \r\n      default:\r\n         progress = status;\r\n         break;\r\n      }\r\n\r\n   // eddy EditorGetStatuslineString {\r\n   // if send email then update status bar with \"sending\" and then \"sent\"\r\n   if(params.emailing == \"sending\") {\r\n  \t progress += scc.s_statusline_sendemail;\r\n   }\r\n   if(params.emailing == \"sent\") {\r\n  \t progress += params.emailreponse;\r\n   }   \r\n   // } eddy EditorGetStatuslineString \r\n   \r\n   if (!progress && params.calculating) {\r\n      progress = scc.s_statusline_calculating;\r\n      }\r\n\r\n   // if there is a range, calculate sum (not during busy times)\r\n   if (!params.calculating && !params.command && !progress && editor.range.hasrange \r\n       && (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom)) {\r\n      sum = 0;\r\n      for (r=editor.range.top; r <= editor.range.bottom; r++) {\r\n         for (c=editor.range.left; c <= editor.range.right; c++) {\r\n            cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(c, r)];\r\n            if (!cell) continue;\r\n            if (cell.valuetype && cell.valuetype.charAt(0)==\"n\") {\r\n               sum += cell.datavalue-0;\r\n               }\r\n            }\r\n         }\r\n\r\n      sum = SocialCalc.FormatNumber.formatNumberWithFormat(sum, \"[,]General\", \"\");\r\n\r\n      coord = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n         SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      progress = coord + \" (\" + (editor.range.right-editor.range.left+1) + \"x\" + (editor.range.bottom-editor.range.top+1) +\r\n                 \") \"+scc.s_statusline_sum+\"=\" + sum + \" \" + progress;\r\n      }\r\n   sstr = (editor.ecell || {}).coord+\" &nbsp; \"+progress;\r\n\r\n   if (!params.calculating && editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\r\n      sstr += ' &nbsp; '+scc.s_statusline_recalcneeded;\r\n      }\r\n\r\n   circ = editor.context.sheetobj.attribs.circularreferencecell;\r\n   if (circ) {\r\n      circ = circ.replace(/\\|/, \" referenced by \");\r\n      sstr += ' &nbsp; '+scc.s_statusline_circref + circ + '</span>';\r\n      }\r\n   // eddy EditorGetStatuslineString {\r\n   sstr += \"\";\r\n   // } eddy EditorGetStatuslineString \r\n   return sstr;\r\n\r\n   }\r\n\r\n\r\n//\r\n// Mouse stuff\r\n//\r\n\r\nSocialCalc.EditorMouseInfo = {\r\n\r\n   // The registeredElements array is used to identify editor grid in which the mouse is doing things.\r\n\r\n   // One item for each active editor, each an object with:\r\n   //    .element, .editor\r\n\r\n   registeredElements: [],\r\n\r\n   editor: null, // editor being processed (between mousedown and mouseup)\r\n   element: null, // element being processed\r\n\r\n   ignore: false, // if true, mousedowns are ignored\r\n\r\n   mousedowncoord: \"\", // coord where mouse went down for drag range\r\n   mouselastcoord: \"\", // coord where mouse last was during drag\r\n   mouseresizecol: \"\", // col being resized\r\n   mouseresizeclientx: null, // where resize started\r\n   mouseresizedisplay: null // element tracking new size\r\n   }\r\n\r\n//\r\n// EditorMouseRegister(editor)\r\n//\r\n\r\nSocialCalc.EditorMouseRegister = function(editor) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var element = editor.fullgrid;\r\n   var i;\r\n\r\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\r\n      if (mouseinfo.registeredElements[i].editor == editor) {\r\n         if (mouseinfo.registeredElements[i].element == element) {\r\n            return; // already set - don't do it again\r\n            }\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (i<mouseinfo.registeredElements.length) {\r\n      mouseinfo.registeredElements[i].element = element;\r\n      }\r\n   else {\r\n      mouseinfo.registeredElements.push({element: element, editor: editor});\r\n      }\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\r\n      element.addEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\r\n      element.attachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\r\n      }\r\n   else { // don't handle this\r\n      throw \"Browser not supported\";\r\n      }\r\n\r\n   mouseinfo.ignore = false; // just in case\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// EditorMouseUnregister(editor)\r\n//\r\n\r\nSocialCalc.EditorMouseUnregister = function(editor) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var element = editor.fullgrid;\r\n   var i, oldelement;\r\n\r\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\r\n      if (mouseinfo.registeredElements[i].editor == editor) {\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (i<mouseinfo.registeredElements.length) {\r\n      oldelement = mouseinfo.registeredElements[i].element; // remove old handlers\r\n      if (oldelement.removeEventListener) { // DOM Level 2\r\n         oldelement.removeEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\r\n         oldelement.removeEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\r\n         }\r\n      else if (oldelement.detachEvent) { // IE\r\n         oldelement.detachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\r\n         oldelement.detachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\r\n         }\r\n      mouseinfo.registeredElements.splice(i, 1);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.StopPropagation = function(event) {\r\n    if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\r\n    else event.cancelBubble = true; // IE 5+\r\n    if (event.preventDefault) event.preventDefault(); // DOM Level 2\r\n    else event.returnValue = false; // IE 5+\r\n}\r\n\r\nSocialCalc.SetMouseMoveUp = function(move, up, element, event) {\r\n       // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", move, true); // capture everywhere\r\n      document.addEventListener(\"mouseup\", up, true); // capture everywhere\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.setCapture();\r\n      element.attachEvent(\"onmousemove\", move);\r\n      element.attachEvent(\"onmouseup\", up);\r\n      element.attachEvent(\"onlosecapture\", up);\r\n   }\r\n    SocialCalc.StopPropagation(event);\r\n}\r\n\r\nSocialCalc.RemoveMouseMoveUp = function(move, up, element, event) {\r\n    SocialCalc.StopPropagation(event);\r\n    if (document.removeEventListener) { // DOM Level 2\r\n\tdocument.removeEventListener(\"mousemove\", move, true);\r\n\tdocument.removeEventListener(\"mouseup\", up, true);\r\n    }\r\n    else if (element.detachEvent) { // IE\r\n\telement.detachEvent(\"onlosecapture\", up);\r\n\telement.detachEvent(\"onmouseup\", up);\r\n\telement.detachEvent(\"onmousemove\", move);\r\n\telement.releaseCapture();\r\n    }\r\n}\r\n\r\nSocialCalc.ProcessEditorMouseDown = function(e) {\r\n\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var target = ele; \r\n   if (target.nodeType == 3) target = target.parentNode; // defeat Safari bug\r\n     \r\n   var mobj;\r\n\r\n   if (mouseinfo.ignore) return; // ignore this\r\n\r\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\r\n      }\r\n   if (!mobj) {\r\n      mouseinfo.editor = null;\r\n      return; // not one of our elements\r\n      }\r\n\r\n   editor = mobj.editor;\r\n   mouseinfo.element = ele;\r\n   range = editor.range;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n\r\n   if (!result) return; // not on a cell or col header\r\n   mouseinfo.editor = editor; // remember for later\r\n\r\n    if (result.rowheader) {\r\n\tif (result.rowselect)  {\r\n\t    SocialCalc.ProcessEditorRowselectMouseDown(e, ele, result);\r\n\t} else {\r\n\t    SocialCalc.ProcessEditorRowsizeMouseDown(e, ele, result);\r\n\t}\r\n\treturn;\r\n    }\r\n\r\n    if (result.colheader) {\r\n\tif (result.colselect)  {\r\n\t    SocialCalc.ProcessEditorColselectMouseDown(e, ele, result);\r\n\t} else {\r\n\t    SocialCalc.ProcessEditorColsizeMouseDown(e, ele, result);\r\n\t}\r\n\treturn;\r\n    }\r\n\r\n   if (!result.coord) return; // not us\r\n\r\n   if (!range.hasrange) {\r\n      if (e.shiftKey)\r\n         editor.RangeAnchor();\r\n      }\r\n   coord = editor.MoveECell(result.coord);\r\n   // eddy ProcessEditorMouseDown {\r\n   if(SocialCalc._app == true) { // \"app\" wigets need to keep focus - needed because \"coord\" always equals A1 \r\n     SocialCalc.CmdGotFocus(true); // cell widgets need to keep focus\r\n     return;\r\n   }\r\n   \r\n   var clickedCell = editor.context.sheetobj.cells[coord];\r\n   if(clickedCell) {\r\n     if(clickedCell.valuetype.charAt(1) == 'i') { // IF cell contains ioWidget\r\n       var formula_name= clickedCell.valuetype.substring(2);\r\n       var widget_id = formula_name+'_'+coord;\r\n       if(target && widget_id == target.id) { // if widget was clicked (rather than cell containing widget) \r\n         var cell_widget=document.getElementById(widget_id);\r\n         SocialCalc.CmdGotFocus(cell_widget); // cell widgets need to keep focus \r\n       }\r\n\t\treturn; // let ioWidget keep the focus \r\n\t\t}\r\n\t }\r\n   // }\r\n\r\n   if (range.hasrange) {\r\n      if (e.shiftKey)\r\n         editor.RangeExtend();\r\n      else\r\n         editor.RangeRemove();\r\n      }\r\n\r\n   mouseinfo.mousedowncoord = coord; // remember if starting drag range select\r\n   mouseinfo.mouselastcoord = coord;\r\n\r\n   editor.EditorMouseRange(coord);\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n   if (editor.state!=\"start\" && editor.inputBox) editor.inputBox.element.focus();\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorMouseUp,\r\n\t\t\t      ele,\r\n\t\t\t      event);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.EditorMouseRange = function(editor, coord) {\r\n\r\n   var inputtext, wval;\r\n   var range = editor.range;\r\n\r\n   switch (editor.state) { // editing a cell - shouldn't get here if no inputBox\r\n      case \"input\":\r\n         inputtext = editor.inputBox.GetText();\r\n         wval = editor.workingvalues;\r\n         if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\r\n             (inputtext == \"=\")) {\r\n            wval.partialexpr = inputtext;\r\n            }\r\n\r\n         if (wval.partialexpr) { // if in pointing operation\r\n            if (coord) {\r\n               if (range.hasrange) {\r\n                  editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\r\n                     SocialCalc.crToCoord(range.right, range.bottom));\r\n                  }\r\n               else {\r\n                  editor.inputBox.SetText(wval.partialexpr + coord);\r\n                  }\r\n               }\r\n            }\r\n         else { // not in point -- done editing\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            editor.EditorSaveEdit();\r\n            editor.inputBox.DisplayCellContents(null);\r\n            }\r\n         break;\r\n\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         editor.cellhandles.ShowCellHandles(true);\r\n         editor.EditorSaveEdit();\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n      }\r\n   }\r\n\r\nSocialCalc.ProcessEditorMouseMove = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   if (mouseinfo.ignore) return; // ignore this\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\r\n\r\n   if (!result) return;\r\n\r\n   if (result && !result.coord) {\r\n      SocialCalc.SetDragAutoRepeat(editor, result);\r\n      return;\r\n      }\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result.coord) return;\r\n\r\n   if (result.coord!=mouseinfo.mouselastcoord) {\r\n      if (!e.shiftKey && !editor.range.hasrange) {\r\n         editor.RangeAnchor(mouseinfo.mousedowncoord);\r\n         }\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n   mouseinfo.mouselastcoord = result.coord;\r\n\r\n   editor.EditorMouseRange(result.coord);\r\n   SocialCalc.StopPropagation(event); \r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorMouseUp = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   if (mouseinfo.ignore) return; // ignore this\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result) return;\r\n\r\n   if (!result.coord) result.coord = editor.ecell.coord;\r\n\r\n   if (editor.range.hasrange) {\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n   else if (result.coord && result.coord!=mouseinfo.mousedowncoord) {\r\n      editor.RangeAnchor(mouseinfo.mousedowncoord);\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n\r\n   editor.EditorMouseRange(result.coord);\r\n   mouseinfo.editor = null;\r\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\r\n\t\t\t\t  SocialCalc.ProcessEditorMouseUp,\r\n\t\t\t\t  element,\r\n\t\t\t\t  event);\r\n   return false;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseDown = function(e, ele, result) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n\r\n   mouseinfo.mouseresizecolnum = result.coltoresize; // remember col being resized\r\n   mouseinfo.mouseresizecol = SocialCalc.rcColname(result.coltoresize);\r\n   mouseinfo.mousedownclientx = clientX;\r\n   mouseinfo.mousecoltounhide = result.coltounhide;\r\n\r\n   if (result.coltoresize) {\r\n      var sizedisplay = document.createElement(\"div\");\r\n      mouseinfo.mouseresizedisplay = sizedisplay;\r\n      sizedisplay.style.width = \"auto\";\r\n      sizedisplay.style.position = \"absolute\";\r\n      sizedisplay.style.zIndex = 100;\r\n      sizedisplay.style.top = editor.headposition.top+\"px\";\r\n      sizedisplay.style.left = editor.colpositions[result.coltoresize]+\"px\";\r\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\r\n        'border:1px dashed black;background-color:white;width:' +\r\n        (editor.context.colwidth[mouseinfo.mouseresizecolnum]-2) + 'px;\">&nbsp;</td>'+\r\n        '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n        editor.context.colwidth[mouseinfo.mouseresizecolnum] + '</div></td></tr></table>';\r\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\r\n\r\n      editor.toplevel.appendChild(sizedisplay);\r\n      }\r\n    SocialCalc.SetMouseMoveUp( SocialCalc.ProcessEditorColsizeMouseMove,\r\n\t\t\t       SocialCalc.ProcessEditorColsizeMouseUp,\r\n\t\t\t       editor.toplevel,\r\n\t\t\t       event);\r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseMove = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n\r\n   if (mouseinfo.mouseresizecolnum) {\r\n      var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n      var clientX = event.clientX - pos.left;\r\n\r\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\r\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\r\n\r\n      var sizedisplay = mouseinfo.mouseresizedisplay;\r\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[1].firstChild.innerHTML = newsize+\"\";\r\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[0].firstChild.style.width = (newsize-2)+\"px\";\r\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\r\n          'border:1px dashed black;background-color:white;width:' + (newsize-2) + 'px;\">&nbsp;</td>'+\r\n          '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n          newsize + '</div></td></tr></table>';\r\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\r\n      }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseUp = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   element = mouseinfo.element;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   SocialCalc.RemoveMouseMoveUp(\r\n       SocialCalc.ProcessEditorColsizeMouseMove,\r\n       SocialCalc.ProcessEditorColsizeMouseUp, \r\n       editor.toplevel,\r\n       event);\r\n\r\n   if (mouseinfo.mousecoltounhide) {\r\n      editor.EditorScheduleSheetCommands(\"set \"+SocialCalc.rcColname(mouseinfo.mousecoltounhide)+\" hide\", true, false);\r\n      /*\r\n      if (editor.ecell && editor.ecell.col == mouseinfo.mousecoltounhide+1) {\r\n         editor.MoveECell(SocialCalc.crToCoord(mouseinfo.mousecoltounhide, editor.ecell.row));\r\n         }*/\r\n      }\r\n   else if (mouseinfo.mouseresizecolnum) {\r\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\r\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\r\n\r\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizecol+\" width \"+newsize, true, false);\r\n\r\n      if (editor.timeout) window.clearTimeout(editor.timeout);\r\n      editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\r\n      }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.FinishColRowSize = function() {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return;\r\n\r\n   editor.toplevel.removeChild(mouseinfo.mouseresizedisplay);\r\n   mouseinfo.mouseresizedisplay = null;\r\n\r\n//   editor.FitToEditTable();\r\n//   editor.EditorRenderSheet();\r\n//   editor.SchedulePositionCalculations();\r\n\r\n   mouseinfo.editor = null;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowselectMouseDown = function(e, ele, result) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n    coord1 = SocialCalc.crToCoord(1, result.row)\r\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\r\n\t\t\t\t  result.row)\r\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\r\n\t\t\t\t  result.row)\r\n    editor.RangeAnchor(coord1);\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorRowselectMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n}\r\n\r\nSocialCalc.ProcessEditorRowselectMouseMove = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    if (!editor) return; // not us, ignore\r\n\r\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n    var clientX = event.clientX - pos.left;\r\n    var clientY = event.clientY - pos.top;\r\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\r\n\t\t\t\t  result.row)\r\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\r\n\t\t\t\t  result.row)\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorRowselectMouseUp = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    if (!editor) return; // not us, ignore\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\r\n\t\t\t\t SocialCalc.ProcessEditorRowselectMouseUp,\r\n\t\t\t\t editor.toplevel,\r\n\t\t\t\t e);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseDown = function(e, ele, result) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    coord1 = SocialCalc.crToCoord(result.col, 1)\r\n    coord2 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  sheet.LastRow())\r\n    coord3 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  editor.firstscrollingrow)\r\n    \r\n    editor.RangeAnchor(coord1);\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorColselectMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseMove = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    if (!editor) return; // not us, ignore\r\n\r\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n    var clientX = event.clientX - pos.left;\r\n    var clientY = event.clientY - pos.top;\r\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n    coord2 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  sheet.LastRow())\r\n    coord3 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  editor.firstscrollingrow)\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseUp = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    if (!editor) return; // not us, ignore\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\r\n\t\t\t\t SocialCalc.ProcessEditorColselectMouseUp,\r\n\t\t\t\t editor.toplevel,\r\n\t\t\t\t e);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseDown = function(e, ele, result) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n   var clientY = event.clientY - pos;\r\n\r\n   mouseinfo.mouseresizerownum = result.rowtoresize; // remember col being resized\r\n   mouseinfo.mouseresizerow = result.rowtoresize;\r\n   mouseinfo.mousedownclienty = clientY;\r\n   mouseinfo.mouserowtounhide = result.rowtounhide;\r\n\r\n  if (result.rowtoresize) {\r\n    var sizedisplay = document.createElement(\"div\");\r\n    mouseinfo.mouseresizedisplay = sizedisplay;\r\n    sizedisplay.style.width = editor.context.totalwidth+\"px\";\r\n    sizedisplay.style.height = editor.rowpositions[result.rowtoresize]+\"px\";\r\n    sizedisplay.style.position = \"absolute\";\r\n    sizedisplay.style.zIndex = 100;\r\n    sizedisplay.style.top = editor.rowpositions[result.rowtoresize]+\"px\";\r\n    sizedisplay.style.left = editor.headposition.left+\"px\";\r\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px' +\r\n      'border:1px dashed black;background-color:white;height:' +\r\n      (editor.context.rowheight[mouseinfo.mouseresizerownum]-2) + 'px;\">&nbsp;</td>'+\r\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n      editor.context.rowheight[mouseinfo.mouseresizerownum] + '</div></td></tr></table>';\r\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\r\n\r\n    editor.toplevel.appendChild(sizedisplay);\r\n  }\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowsizeMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorRowsizeMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n    return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseMove = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n\r\n  if (mouseinfo.mouseresizerownum) {\r\n    var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n    var clientY = event.clientY - pos;\r\n\r\n    var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\r\n    if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\r\n\r\n    var sizedisplay = mouseinfo.mouseresizedisplay;\r\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px;'+\r\n      'border:1px dashed black;background-color:white;height:' + (newsize-2) + 'px;\">&nbsp;</td>'+\r\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n      newsize + '</div></td></tr></table>';\r\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\r\n  }\r\n\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseUp = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   element = mouseinfo.element;\r\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n   var clientY = event.clientY - pos;\r\n   SocialCalc.RemoveMouseMoveUp(\r\n       SocialCalc.ProcessEditorRowsizeMouseMove,\r\n       SocialCalc.ProcessEditorRowsizeMouseUp,\r\n       editor.toplevel,\r\n       event);\r\n   if (mouseinfo.mouserowtounhide) {\r\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouserowtounhide+\" hide\", true, false);\r\n      }\r\n   else if (mouseinfo.mouseresizerownum) {\r\n     var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\r\n     if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\r\n     editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizerownum+\" height \"+newsize, true, false);\r\n\r\n     if (editor.timeout) window.clearTimeout(editor.timeout);\r\n     editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\r\n   }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n\r\n//\r\n// Handle auto-repeat of dragging the cursor into the borders of the sheet\r\n//\r\n\r\nSocialCalc.AutoRepeatInfo = {\r\n\r\n   timer: null, // timer object for repeating\r\n   mouseinfo: null, // result from SocialCalc.GridMousePosition\r\n   repeatinterval: 1000, // milliseconds to wait between repeats\r\n   editor: null, // editor object to use when it repeats\r\n   repeatcallback: null // used instead of default when repeating (e.g., for cellhandles)\r\n                        // called as: repeatcallback(newcoord, direction)\r\n\r\n};\r\n\r\n// Control auto-repeat. If mouseinfo==null, cancel.\r\n\r\nSocialCalc.SetDragAutoRepeat = function(editor, mouseinfo, callback) {\r\n\r\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\r\n   var coord, direction;\r\n\r\n   repeatinfo.repeatcallback = callback; // null in regular case\r\n\r\n   if (!mouseinfo) { // cancel\r\n      if (repeatinfo.timer) { // If was repeating, stop\r\n         window.clearTimeout(repeatinfo.timer); // cancel timer\r\n         repeatinfo.timer = null;\r\n         }\r\n      repeatinfo.mouseinfo = null;\r\n      return; // done\r\n      }\r\n\r\n   repeatinfo.editor = editor;\r\n\r\n   if (repeatinfo.mouseinfo) { // check for change while repeating\r\n      if (mouseinfo.rowheader || mouseinfo.rowfooter) {\r\n         if (mouseinfo.row != repeatinfo.mouseinfo.row) { // changed row while dragging sidewards\r\n            coord = SocialCalc.crToCoord(editor.ecell.col, mouseinfo.row); // change to it\r\n            if (repeatinfo.repeatcallback) {\r\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\r\n                  direction = \"left\";\r\n                  }\r\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\r\n                  direction = \"right\";\r\n                  }\r\n               else {\r\n                  direction = \"\";\r\n                  }\r\n               repeatinfo.repeatcallback(coord, direction);\r\n               }\r\n            else {\r\n               editor.MoveECell(coord);\r\n               editor.MoveECell(coord);\r\n               editor.RangeExtend();\r\n               editor.EditorMouseRange(coord);\r\n               }\r\n            }            \r\n         }\r\n      else if (mouseinfo.colheader || mouseinfo.colfooter) {\r\n         if (mouseinfo.col != repeatinfo.mouseinfo.col) { // changed col while dragging vertically\r\n            coord = SocialCalc.crToCoord(mouseinfo.col, editor.ecell.row); // change to it\r\n            if (repeatinfo.repeatcallback) {\r\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\r\n                  direction = \"left\";\r\n                  }\r\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\r\n                  direction = \"right\";\r\n                  }\r\n               else {\r\n                  direction = \"\";\r\n                  }\r\n               repeatinfo.repeatcallback(coord, direction);\r\n               }\r\n            else {\r\n               editor.MoveECell(coord);\r\n               editor.RangeExtend();\r\n               editor.EditorMouseRange(coord);\r\n               }\r\n            }            \r\n         }\r\n      }\r\n\r\n   repeatinfo.mouseinfo = mouseinfo;\r\n\r\n   if (mouseinfo.distance < 5) repeatinfo.repeatinterval = 333;\r\n   else if (mouseinfo.distance < 10) repeatinfo.repeatinterval = 250;\r\n   else if (mouseinfo.distance < 25) repeatinfo.repeatinterval = 100;\r\n   else if (mouseinfo.distance < 35) repeatinfo.repeatinterval = 75;\r\n   else { // too far - stop repeating\r\n      if (repeatinfo.timer) { // if repeating, cancel it\r\n         window.clearTimeout(repeatinfo.timer); // cancel timer\r\n         repeatinfo.timer = null;\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (!repeatinfo.timer) { // start if not already running\r\n      repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// DragAutoRepeat()\r\n//\r\n\r\nSocialCalc.DragAutoRepeat = function() {\r\n\r\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\r\n   var mouseinfo = repeatinfo.mouseinfo;\r\n\r\n   var direction, coord, cr;\r\n\r\n   if (mouseinfo.rowheader) direction = \"left\";\r\n   else if (mouseinfo.rowfooter) direction = \"right\";\r\n   else if (mouseinfo.colheader) direction = \"up\";\r\n   else if (mouseinfo.colfooter) direction = \"down\";\r\n\r\n   if (repeatinfo.repeatcallback) {\r\n      cr = SocialCalc.coordToCr(repeatinfo.editor.ecell.coord);\r\n      if (direction == \"left\" && cr.col > 1) cr.col--;\r\n      else if (direction == \"right\") cr.col++;\r\n      else if (direction == \"up\" && cr.row > 1) cr.row--;\r\n      else if (direction == \"down\") cr.row++;\r\n      coord = SocialCalc.crToCoord(cr.col, cr.row);\r\n      repeatinfo.repeatcallback(coord, direction);\r\n      }\r\n   else {\r\n      coord = repeatinfo.editor.MoveECellWithKey(\"[a\"+direction+\"]shifted\");\r\n      if (coord) repeatinfo.editor.EditorMouseRange(coord);\r\n      }\r\n\r\n   repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\r\n\r\n   }\r\n\r\n//\r\n// Handling Clicking\r\n//\r\n\r\nSocialCalc.ProcessEditorDblClick = function(e) {\r\n\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var mobj;\r\n\r\n   if (mouseinfo.ignore) return; // ignore this\r\n\r\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\r\n      }\r\n   if (!mobj) {\r\n      mouseinfo.editor = null;\r\n      return; // not one of our elements\r\n      }\r\n\r\n   editor = mobj.editor;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n   if (!result || !result.coord) return; // not within cell area - ignore\r\n\r\n   mouseinfo.editor = editor; // remember for later\r\n   mouseinfo.element = ele;\r\n   range = editor.range;\r\n\r\n   sheetobj = editor.context.sheetobj;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         SocialCalc.EditorOpenCellEdit(editor);\r\n         break;\r\n\r\n      case \"input\":\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorOpenCellEdit = function(editor) {\r\n\r\n   var wval;\r\n\r\n   if (!editor.ecell) return true; // no ecell\r\n   if (!editor.inputBox) return true; // no input box, so no editing (happens on noEdit)\r\n   if (editor.inputBox.element.disabled) return true; // multi-line: ignore\r\n   editor.inputBox.ShowInputBox(true);\r\n   editor.inputBox.Focus();\r\n   editor.inputBox.SetText(\"\");\r\n   editor.inputBox.DisplayCellContents();\r\n   editor.inputBox.Select(\"end\");\r\n   wval = editor.workingvalues;\r\n   wval.partialexpr = \"\";\r\n   wval.ecoord = editor.ecell.coord;\r\n   wval.erow = editor.ecell.row;\r\n   wval.ecol = editor.ecell.col;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorProcessKey = function(editor, ch, e) {\r\n\r\n   var result, cell, cellobj, valueinfo, fch, coord, inputtext, f;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var wval = editor.workingvalues;\r\n   var range = editor.range;\r\n\r\n   if (typeof ch != \"string\") ch = \"\";\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         if (e.shiftKey && ch.substr(0,2)==\"[a\") {\r\n            ch = ch + \"shifted\";\r\n            }\r\n         if (ch==\"[enter]\") ch = \"[adown]\";\r\n         if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n         if (ch.substr(0,2)==\"[a\" || ch.substr(0,3)==\"[pg\" || ch==\"[home]\") {\r\n            result = editor.MoveECellWithKey(ch);\r\n            return !result;\r\n            }\r\n         if (ch==\"[del]\" || ch==\"[backspace]\") {\r\n            if (!editor.noEdit && !editor.ECellReadonly()) {\r\n               editor.EditorApplySetCommandsToRange(\"empty\", \"\");\r\n               }\r\n            break;\r\n            }\r\n         if (ch==\"[esc]\") {\r\n            if (range.hasrange) {\r\n               editor.RangeRemove();\r\n               editor.MoveECell(range.anchorcoord);\r\n               for (f in editor.StatusCallback) {\r\n                  editor.StatusCallback[f].func(editor, \"specialkey\", ch, editor.StatusCallback[f].params);\r\n                  }\r\n               }\r\n            return false;\r\n            }\r\n\r\n         if (ch==\"[f2]\") {\r\n            if (editor.noEdit || editor.ECellReadonly()) return true;\r\n            SocialCalc.EditorOpenCellEdit(editor);\r\n            editor.state=\"inputboxdirect\"; // arrow keys move left and right, rather than select cells\r\n            return false;\r\n            }\r\n\r\n         if ((ch.length>1 && ch.substr(0,1)==\"[\") || ch.length==0) { // some control key\r\n            if (editor.ctrlkeyFunction && ch.length>0) {\r\n               return editor.ctrlkeyFunction(editor, ch);\r\n               }\r\n            else {\r\n               return true;\r\n               }\r\n            }\r\n         if (!editor.ecell) return true; // no ecell\r\n         if (!editor.inputBox) return true; // no inputBox so no editing\r\n         if (editor.ECellReadonly()) return true;\r\n         editor.inputBox.element.disabled = false; // make sure editable\r\n         editor.state = \"input\";\r\n         editor.inputBox.ShowInputBox(true);\r\n         editor.inputBox.Focus();\r\n         editor.inputBox.SetText(ch);\r\n         editor.inputBox.Select(\"end\");\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"input\":\r\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\r\n         if (editor.inputBox.skipOne) return false; // ignore a key already handled\r\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\" || (ch && ch.substr(0,2)==\"[a\")) {\r\n            if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\r\n                (inputtext == \"=\")) {\r\n               wval.partialexpr = inputtext;\r\n               }\r\n            if (wval.partialexpr) { // if in pointing operation\r\n               if (e.shiftKey && ch.substr(0,2)==\"[a\") {\r\n                  ch = ch + \"shifted\";\r\n                  }\r\n               coord = editor.MoveECellWithKey(ch);\r\n               if (coord) {\r\n                  if (range.hasrange) {\r\n                     editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\r\n                        SocialCalc.crToCoord(range.right, range.bottom));\r\n                     }\r\n                  else {\r\n                     editor.inputBox.SetText(wval.partialexpr + coord);\r\n                     }\r\n                  return false;\r\n                  }\r\n               }\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            if (ch != \"[esc]\") {\r\n               editor.EditorSaveEdit();\r\n               if (editor.ecell.coord != wval.ecoord) {\r\n                  editor.MoveECell(wval.ecoord);\r\n                  }\r\n               if (ch==\"[enter]\") ch = \"[adown]\";\r\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n               if (ch.substr(0,2)==\"[a\") {\r\n                  editor.MoveECellWithKey(ch);\r\n                  }\r\n               }\r\n            else {\r\n               editor.inputBox.DisplayCellContents();\r\n               editor.RangeRemove();\r\n               editor.MoveECell(wval.ecoord);\r\n               }\r\n            break;\r\n            }\r\n         if (wval.partialexpr && ch==\"[backspace]\") {\r\n            editor.inputBox.SetText(wval.partialexpr);\r\n            wval.partialexpr = \"\";\r\n            editor.RangeRemove();\r\n            editor.MoveECell(wval.ecoord);\r\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\r\n            return false;\r\n            }\r\n         if (ch==\"[f2]\") {\r\n           editor.state = \"inputboxdirect\"; \r\n           return false;\r\n           }\r\n         if (range.hasrange) {\r\n            editor.RangeRemove();\r\n            }\r\n         editor.MoveECell(wval.ecoord);\r\n         if (wval.partialexpr) {\r\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\r\n            wval.partialexpr = \"\"; // not pointing\r\n            }\r\n         return true;\r\n\r\n      case \"inputboxdirect\":\r\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\r\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\") {\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            if (ch == \"[esc]\") {\r\n               editor.inputBox.DisplayCellContents();\r\n               }\r\n            else {\r\n               editor.EditorSaveEdit();\r\n               if (editor.ecell.coord != wval.ecoord) {\r\n                  editor.MoveECell(wval.ecoord);\r\n                  }\r\n               if (ch==\"[enter]\") ch = \"[adown]\";\r\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n               if (ch.substr(0,2)==\"[a\") {\r\n                  editor.MoveECellWithKey(ch);\r\n                  }\r\n               }\r\n            break;\r\n            }\r\n         if (ch==\"[f2]\") { \r\n           editor.state = \"input\"; // arrow keys add range/coord to inputbox formula\r\n           return false;\r\n           }\r\n         return true;\r\n\r\n      case \"skip-and-start\":\r\n         editor.state = \"start\";\r\n         editor.cellhandles.ShowCellHandles(true);\r\n         return false;\r\n\r\n      default:\r\n         return true;\r\n      }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\nSocialCalc.EditorAddToInput = function(editor, str, prefix) {\r\n\r\n   var wval = editor.workingvalues;\r\n\r\n   if (editor.noEdit || editor.ECellReadonly()) return;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.state = \"input\";\r\n         editor.inputBox.ShowInputBox(true);\r\n         editor.inputBox.element.disabled = false; // make sure editable and overwrite old\r\n         editor.inputBox.Focus();\r\n         editor.inputBox.SetText((prefix||\"\")+str);\r\n         editor.inputBox.Select(\"end\");\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.focus();\r\n         if (wval.partialexpr) {\r\n            editor.inputBox.SetText(wval.partialexpr);\r\n            wval.partialexpr = \"\";\r\n            editor.RangeRemove();\r\n            editor.MoveECell(wval.ecoord);\r\n            }\r\n         editor.inputBox.SetText(editor.inputBox.GetText()+str);\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorDisplayCellContents = function(editor) {\r\n\r\n   if (editor.inputBox) editor.inputBox.DisplayCellContents();\r\n\r\n   }\r\n\r\nSocialCalc.EditorSaveEdit = function(editor, text) {\r\n\r\n   var result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var wval = editor.workingvalues;\r\n\r\n   type = \"text t\";\r\n   value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\r\n\r\n   oldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\r\n   if (value == oldvalue) { // no change\r\n      return;\r\n      }\r\n   fch = value.charAt(0);\r\n   if (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\r\n      type = \"formula\";\r\n      value = value.substring(1);\r\n      }\r\n   else if (fch==\"'\") {\r\n      type = \"text t\";\r\n      value = value.substring(1);\r\n      valueinfo = SocialCalc.DetermineValueType(value); // determine type again\r\n      if (valueinfo.type.charAt(0)==\"t\") {\r\n         type = \"text \"+valueinfo.type;\r\n         }\r\n      }\r\n   else if (value.length==0) {\r\n      type = \"empty\";\r\n      }\r\n   else {\r\n      valueinfo = SocialCalc.DetermineValueType(value);\r\n      if (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\r\n         type = \"value n\";\r\n         }\r\n      else if (valueinfo.type.charAt(0)==\"t\") {\r\n         type = \"text \"+valueinfo.type;\r\n         }\r\n      else if (valueinfo.type==\"\") {\r\n         type = \"text t\";\r\n         }\r\n      else {\r\n         type = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\r\n         }\r\n      }\r\n\r\n   if (type.charAt(0)==\"t\") { // text\r\n      value = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\r\n      }\r\n\r\n   cmdline = \"set \"+wval.ecoord+\" \"+type+\" \"+value;\r\n   editor.EditorScheduleSheetCommands(cmdline, true, false);\r\n   // eddy EditorSaveEdit {\r\n   if(typeof sheetobj.ioEventTree === 'undefined') return;\t\r\n   if(typeof sheetobj.ioParameterList === 'undefined') return;\r\n   if(typeof sheetobj.ioEventTree[wval.ecoord] !== 'undefined') {\r\n\t   SocialCalc.EditedTriggerCell(sheetobj.ioEventTree[wval.ecoord], wval.ecoord, editor, sheetobj);   \t\t\r\n   }\r\n   \t\t\r\n   // }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// Eddy EditedTriggerCell {\r\n\r\n\r\nSocialCalc.EditedTriggerCell  = function(actionFormulaCells, editedCellRef, editor, sheet) {\r\n \r\n\t for(var actionCellId in actionFormulaCells) {\r\n\t\t \r\n\t\t\tvar parameters = sheet.ioParameterList[actionCellId];\r\n            if(typeof parameters === 'undefined') continue;\t\r\n\t\t\t\r\n\t\t\tswitch(parameters.function_name) {\r\n\t\t\t\t  case \"EMAILONEDIT\" :\r\n\t\t\t\t  case \"EMAILONEDITIF\" :\r\n\t\t\t\t\t  cmdline = \"setemailparameters \"+actionCellId+ \" \" + editedCellRef;\r\n\t\t\t\t\t// hold off on commands until recalc done\r\n\t\t\t\t      editor.deferredEmailCommands.push({cmdstr: cmdline, saveundo: false});\r\n//\t\t\t\t\t  editor.EditorScheduleSheetCommands(cmdline, false, false);\r\n\t\t\t\t\t  break;\r\n\t\t\t}\r\n\t }\r\n\t\r\n}\t\r\n// } Eddy EditedTriggerCell\r\n\r\n\r\n\r\n\r\n\r\n\r\n//\r\n// SocialCalc.EditorApplySetCommandsToRange(editor, cmd)\r\n//\r\n// Takes ecell or range and does a \"set\" command with cmd.\r\n//\r\n\r\nSocialCalc.EditorApplySetCommandsToRange = function(editor, cmd) {\r\n\r\n   var cell, row, col, line, errortext;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var ecell = editor.ecell;\r\n   var range = editor.range;\r\n\r\n   if (range.hasrange) {\r\n      coord = SocialCalc.crToCoord(range.left, range.top)+\":\"+SocialCalc.crToCoord(range.right, range.bottom);\r\n      line = \"set \"+coord+\" \"+cmd;\r\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\r\n      }\r\n   else {\r\n      line = \"set \"+ecell.coord+\" \"+cmd;\r\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\r\n      }\r\n\r\n   editor.DisplayCellContents();\r\n\r\n   }\r\n\r\nSocialCalc.EditorProcessMouseWheel = function(event, delta, mousewheelinfo, wobj) {\r\n\r\n   if (wobj.functionobj.editor.busy) return; // ignore if busy\r\n\r\n   if (delta > 0) {\r\n      wobj.functionobj.editor.ScrollRelative(true, Math.floor(-delta * 1.5));\r\n      }\r\n   if (delta < 0) {\r\n      wobj.functionobj.editor.ScrollRelative(true, Math.ceil(-delta * 1.5));\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// GridMousePosition(editor, clientX, clientY)\r\n//\r\n// Returns an object with row and col numbers and coord (spans handled for coords),\r\n// and rowheader/colheader true if in header (where coord will be undefined).\r\n// If in colheader, will return coltoresize if on appropriate place in col header.\r\n// Also, there is rowfooter (on right) and colfooter (on bottom).\r\n// In row/col header/footer, returns \"distance\" as pixels over the edge.\r\n//\r\n\r\nSocialCalc.GridMousePosition = function(editor, clientX, clientY) { \r\n\r\n   var row, rowpane, col, colpane, rowtoresize, coltoresize;\r\n   var result = {};\r\n\r\n   for (row=1; row<editor.rowpositions.length; row++) {\r\n      if (!editor.rowheight[row]) continue; // not rendered yet -- may be above or below us\r\n      if (editor.rowpositions[row]+editor.rowheight[row]>clientY) {\r\n         break;\r\n         }\r\n      }\r\n   for (col=1; col<editor.colpositions.length; col++) {\r\n      if (!editor.colwidth[col]) continue;\r\n      if (editor.colpositions[col]+editor.colwidth[col]>clientX) {\r\n         break;\r\n         }\r\n      }\r\n\r\n   result.row = row;\r\n   result.col = col;\r\n\r\n   if (editor.headposition) {\r\n      if (clientX < editor.headposition.left && clientX >= editor.gridposition.left) {\r\n         result.rowheader = true;\r\n         result.distance = editor.headposition.left - clientX;\r\n         result.rowtoresize = false;\r\n         result.rowselect = false;\r\n\r\n         // resize bar\r\n         for (rowtoresize=1; rowtoresize<editor.rowpositions.length; rowtoresize++) {\r\n            if (!editor.rowheight[rowtoresize]) continue;\r\n            if (((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) - 3) <= clientY\r\n               && ((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) + 3) >= clientY) {\r\n               result.rowtoresize = rowtoresize;\r\n               break;\r\n            }\r\n         }\r\n\r\n         // Handle unhide row.\r\n         if (unhide = editor.context.rowunhidetop[row]) {\r\n           pos = SocialCalc.GetElementPosition(unhide);\r\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\r\n               && clientY >= (editor.rowpositions[row] + editor.rowheight[row] - unhide.offsetHeight)\r\n               && clientY < (editor.rowpositions[row] + editor.rowheight[row])) {\r\n             result.rowtounhide = row+1;\r\n           }\r\n         }\r\n         if (unhide = editor.context.rowunhidebottom[row]) {\r\n           pos = SocialCalc.GetElementPosition(unhide);\r\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\r\n               && clientY >= (editor.rowpositions[row])\r\n               && clientY < (editor.rowpositions[row] + unhide.offsetHeight)) {\r\n             result.rowtounhide = row-1;\r\n           }\r\n         }\r\n         for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n           if (result.rowtoresize >= editor.context.rowpanes[rowpane].first &&\r\n             result.rowtoresize <= editor.context.rowpanes[rowpane].last) { // visible column\r\n             return result;\r\n           }\r\n         }\r\n         delete result.rowtoresize;\r\n         result.rowselect = true;\r\n         return result;\r\n         }\r\n      else if (clientY < editor.headposition.top && clientY > editor.gridposition.top) { // > because of sizing row\r\n         result.colheader = true;\r\n         result.distance = editor.headposition.top - clientY;\r\n         result.coltoresize = false;\r\n\t result.colselect = false;\r\n\r\n         // resize bar\r\n         for (coltoresize=1; coltoresize<editor.colpositions.length; coltoresize++) {\r\n            if (!editor.colwidth[coltoresize]) continue;\r\n            if (((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) - 3) <= clientX\r\n               && ((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) + 3) >= clientX) {\r\n               result.coltoresize = coltoresize;\r\n               break;\r\n            }\r\n         }\r\n\r\n         // Handle unhide column.\r\n         if (unhide = editor.context.colunhideleft[col]) {\r\n            pos = SocialCalc.GetElementPosition(unhide);\r\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\r\n               result.coltounhide = col+1;\r\n               }\r\n            }\r\n         if (unhide = editor.context.colunhideright[col]) {\r\n            pos = SocialCalc.GetElementPosition(unhide);\r\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\r\n               result.coltounhide = col-1;\r\n               }\r\n            }\r\n\r\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n            if (result.coltoresize >= editor.context.colpanes[colpane].first &&\r\n                result.coltoresize <= editor.context.colpanes[colpane].last) { // visible column\r\n               return result;\r\n               }\r\n            }\r\n         delete result.coltoresize;\r\n         result.colselect = true;\r\n         return result;\r\n         }\r\n      else if (clientX >= editor.verticaltablecontrol.controlborder) {\r\n         result.rowfooter = true;\r\n         result.distance = clientX - editor.verticaltablecontrol.controlborder;\r\n         return result;\r\n         }\r\n      else if (clientY >= editor.horizontaltablecontrol.controlborder) {\r\n         result.colfooter = true;\r\n         result.distance = clientY - editor.horizontaltablecontrol.controlborder;\r\n         return result;\r\n         }\r\n      else if (clientX < editor.gridposition.left) {\r\n         result.rowheader = true;\r\n         result.distance = editor.headposition.left - clientX;\r\n         return result;\r\n         }\r\n      else if (clientY <= editor.gridposition.top) {\r\n         result.colheader = true;\r\n         result.distance = editor.headposition.top - clientY;\r\n         return result;\r\n         }\r\n      else {\r\n         result.coord = SocialCalc.crToCoord(result.col, result.row);\r\n         if (editor.context.cellskip[result.coord]) { // handle skipped cells\r\n            result.coord = editor.context.cellskip[result.coord];\r\n            }\r\n         return result;\r\n         }\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n//\r\n// GetEditorCellElement(editor, row, col)\r\n//\r\n// Returns an object with element, the table cell element in the DOM that corresponds to row and column,\r\n// as well as rowpane and colpane, the panes with the cell.\r\n// If no such element, then returns null;\r\n//\r\n\r\nSocialCalc.GetEditorCellElement = function(editor, row, col) {\r\n\r\n  var headerColOffset = 0;\r\n  var headerRowOffset = 0;\r\n   //Adjust for row/col headers\r\n   if (editor.context.showRCHeaders == false) {     \r\n     var headerColOffset = -1;\r\n     var headerRowOffset = -1;\r\n   }\r\n   var rowpane, colpane, c, coord;\r\n   var rowindex = 0;\r\n   var colindex = 0;\r\n\r\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n      if (row >= editor.context.rowpanes[rowpane].first && row <= editor.context.rowpanes[rowpane].last) {\r\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n            if (col >= editor.context.colpanes[colpane].first && col <= editor.context.colpanes[colpane].last) {\r\n               rowindex += row - editor.context.rowpanes[rowpane].first + 2;\r\n               for (c=editor.context.colpanes[colpane].first; c<=col; c++) {\r\n                  coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\r\n                  if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\r\n                     colindex++;\r\n                  }\r\n               return {\r\n                  element: editor.griddiv.firstChild.lastChild.childNodes[rowindex +headerRowOffset].childNodes[colindex + headerColOffset],\r\n                  rowpane: rowpane, colpane: colpane};\r\n               }\r\n            for (c=editor.context.colpanes[colpane].first; c<=editor.context.colpanes[colpane].last; c++) {\r\n               coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\r\n               if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\r\n                  colindex++;\r\n               }\r\n            colindex += 1;\r\n            }\r\n         }\r\n      rowindex += editor.context.rowpanes[rowpane].last - editor.context.rowpanes[rowpane].first + 1 + 1;\r\n      }\r\n\r\n   return null;\r\n}\r\n\r\n//\r\n// cellcoord = MoveECellWithKey(editor, ch)\r\n//\r\n// Processes an arrow key, etc., moving the edit cell.\r\n// If not a movement key, returns null.\r\n//\r\n\r\nSocialCalc.MoveECellWithKey = function(editor, ch) {\r\n\r\n   var coord, row, col, cell;\r\n   var shifted = false;\r\n   var delta = 1;\r\n\r\n   if (!editor.ecell) {\r\n      return null;\r\n      }\r\n\r\n   if (ch.slice(-7)==\"shifted\") {\r\n      ch = ch.slice(0,-7);\r\n      shifted = true;\r\n      }\r\n\r\n   row = editor.ecell.row;\r\n   col = editor.ecell.col;\r\n   cell = editor.context.sheetobj.cells[editor.ecell.coord];\r\n\r\n   switch (ch) {\r\n      case \"[adown]\":\r\n         row += (cell && cell.rowspan) || 1;\r\n         break;\r\n      case \"[aup]\":\r\n         row--;\r\n         delta = -1;\r\n         break;\r\n      case \"[pgdn]\":\r\n         row += editor.pageUpDnAmount - 1 + ((cell && cell.rowspan) || 1);\r\n         break;\r\n      case \"[pgup]\":\r\n         row -= editor.pageUpDnAmount;\r\n         delta = -1;\r\n         break;\r\n      case \"[aright]\":\r\n         col += (cell && cell.colspan) || 1;\r\n         break;\r\n      case \"[aleft]\":\r\n         col--;\r\n         delta = -1;\r\n         break;\r\n      case \"[home]\":\r\n         row = 1;\r\n         col = 1;\r\n         break;\r\n      default:\r\n         return null;\r\n      }\r\n\r\n   // Adjust against usermax col and row.\r\n   if (editor.context.sheetobj.attribs.usermaxcol) col = Math.min(editor.context.sheetobj.attribs.usermaxcol, col);\r\n   if (editor.context.sheetobj.attribs.usermaxrow) row = Math.min(editor.context.sheetobj.attribs.usermaxrow, row);\r\n\r\n   // Handle hidden column.\r\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n      col += delta;\r\n      if (col < 1) {\r\n         delta = -delta;\r\n         col = 1;\r\n         }\r\n      }\r\n   \r\n   // Handle hidden row.\r\n   while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n      row += delta;\r\n      if (row < 1) {\r\n         delta = -delta;\r\n         row = 1;\r\n         }\r\n      }\r\n   \r\n   if (!editor.range.hasrange) {\r\n      if (shifted)\r\n         editor.RangeAnchor();\r\n      }\r\n\r\n   coord = editor.MoveECell(SocialCalc.crToCoord(col, row));\r\n\r\n   if (editor.range.hasrange) {\r\n      if (shifted)\r\n         editor.RangeExtend();\r\n      else\r\n         editor.RangeRemove();\r\n      }\r\n\r\n   return coord;\r\n\r\n   }\r\n\r\n//\r\n// cellcoord = MoveECell(editor, newecell)\r\n//\r\n// Takes a coordinate and returns the new edit cell coordinate (which may be\r\n// different if newecell is covered by a span).\r\n//\r\n\r\nSocialCalc.MoveECell = function(editor, newcell) {\r\n\r\n   var cell, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   \r\n   // adjust against user max col/row\r\n   var ecell = SocialCalc.coordToCr(newcell);\r\n   if (editor.context.sheetobj.attribs.usermaxcol && ecell.col > editor.context.sheetobj.attribs.usermaxcol)\r\n      ecell.col = editor.context.sheetobj.attribs.usermaxcol;\r\n   if (editor.context.sheetobj.attribs.usermaxrow && ecell.row > editor.context.sheetobj.attribs.usermaxrow)\r\n      ecell.row = editor.context.sheetobj.attribs.usermaxrow;\r\n   newcell = SocialCalc.crToCoord(ecell.col, ecell.row);\r\n\r\n   if (editor.ecell) {\r\n      if (editor.ecell.coord==newcell) return newcell; // already there - don't do anything and don't tell anybody\r\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n      delete highlights[editor.ecell.coord];\r\n      if (editor.range2.hasrange &&\r\n        editor.ecell.row>=editor.range2.top && editor.ecell.row<=editor.range2.bottom &&\r\n        editor.ecell.col>=editor.range2.left && editor.ecell.col<=editor.range2.right) {\r\n         highlights[editor.ecell.coord] = \"range2\";\r\n         }\r\n      editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\r\n      editor.SetECellHeaders(\"\"); // set to regular col/rowname styles\r\n      if(editor.cellhandles) editor.cellhandles.ShowCellHandles(false); // only if row/col visible \r\n      }\r\n   newcell = editor.context.cellskip[newcell] || newcell;\r\n   editor.ecell = SocialCalc.coordToCr(newcell);\r\n   editor.ecell.coord = newcell;\r\n   cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n   // eddy MoveECell {\r\n   // }\r\n   highlights[newcell] = \"cursor\";\r\n\r\n   for (f in editor.MoveECellCallback) { // let others know\r\n      editor.MoveECellCallback[f](editor);\r\n      }\r\n\r\n   editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\r\n   editor.SetECellHeaders(\"selected\");\r\n\r\n   for (f in editor.StatusCallback) { // let status line, etc., know\r\n      editor.StatusCallback[f].func(editor, \"moveecell\", newcell, editor.StatusCallback[f].params);\r\n      }\r\n\r\n   if (editor.busy) {\r\n      editor.ensureecell = true; // wait for when not busy\r\n      }\r\n   else {\r\n      editor.ensureecell = false;\r\n      editor.EnsureECellVisible();\r\n      }\r\n\r\n   return newcell;\r\n\r\n   }\r\n\r\nSocialCalc.EnsureECellVisible = function(editor) {\r\n\r\n   var vamount = 0;\r\n   var hamount = 0;\r\n\r\n   if (editor.ecell.row > editor.lastnonscrollingrow) {\r\n      if (editor.ecell.row < editor.firstscrollingrow) {\r\n         vamount = editor.ecell.row - editor.firstscrollingrow - Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\r\n         }\r\n      else if (editor.ecell.row + 1 > editor.lastvisiblerow) {\r\n         vamount = editor.ecell.row - editor.lastvisiblerow + Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\r\n         }\r\n      }   \r\n   if (editor.ecell.col > editor.lastnonscrollingcol) {\r\n      if (editor.ecell.col < editor.firstscrollingcol) {\r\n         hamount = editor.ecell.col - editor.firstscrollingcol - Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\r\n         }\r\n      else if (editor.ecell.col + 1 > editor.lastvisiblecol) {\r\n        hamount = editor.ecell.col- editor.lastvisiblecol + Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\r\n         }\r\n      }\r\n\r\n   if (vamount!=0 || hamount!=0) {\r\n      editor.ScrollRelativeBoth(vamount, hamount);\r\n      }\r\n   else {\r\n      editor.cellhandles.ShowCellHandles(true);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.ReplaceCell = function(editor, cell, row, col) {\r\n\r\n   var newelement, a;\r\n   if (!cell) return;\r\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\r\n   if (newelement && cell.element) { // skip hidden cells\r\n      // Don't use a real element and replaceChild, which seems to have focus issues with IE, Firefox, and speed issues\r\n      cell.element.innerHTML = newelement.innerHTML;\r\n      cell.element.style.cssText = \"\";\r\n      cell.element.className = newelement.className;\r\n      for (a in newelement.style) {\r\n         if (newelement.style[a]!=\"cssText\")\r\n            cell.element.style[a] = newelement.style[a];\r\n         }\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.UpdateCellCSS = function(editor, cell, row, col) {\r\n\r\n   var newelement, a;\r\n   if (!cell) return;\r\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\r\n   if (newelement) {\r\n      cell.element.style.cssText = \"\";\r\n      cell.element.className = newelement.className;\r\n      for (a in newelement.style) {\r\n         if (newelement.style[a]!=\"cssText\")\r\n            cell.element.style[a] = newelement.style[a];\r\n         }\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.SetECellHeaders = function(editor, selected) {\r\n\r\n   // eddy SetECellHeaders {\r\n   if(editor.context.showRCHeaders === false) return;\r\n   // } SetECellHeaders\r\n   var ecell = editor.ecell;\r\n   var context = editor.context;\r\n\r\n   var rowpane, colpane, first, last;\r\n   var rowindex = 0;\r\n   var colindex = 0;\r\n   var headercell;\r\n\r\n   if (!ecell) return;\r\n\r\n   // Handle ecell on a hidden column/row.\r\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(ecell.col)] == \"yes\") {\r\n      ecell.col++;\r\n      }\r\n   while (context.sheetobj.rowattribs.hide[ecell.row] == \"yes\") {\r\n      ecell.row++;\r\n      }\r\n\r\n   ecell.coord = SocialCalc.crToCoord(ecell.col, ecell.row);\r\n\r\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\r\n      first = context.rowpanes[rowpane].first;\r\n      last = context.rowpanes[rowpane].last;\r\n      if (ecell.row >= first && ecell.row <= last) {\r\n         if (editor.fullgrid !== null) {\r\n            headercell = editor.fullgrid.childNodes[1].childNodes[2+rowindex+ecell.row-first].childNodes[0];\r\n            if (headercell) {\r\n               if (context.classnames) headercell.className=context.classnames[selected+\"rowname\"];\r\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"rowname\"];\r\n               headercell.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\r\n                                                     // considered top of row (and can't get <row> position in Safari)\r\n               }\r\n            }\r\n         }\r\n      rowindex += last - first + 1 + 1;\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      first = context.colpanes[colpane].first;\r\n      last = context.colpanes[colpane].last;\r\n      if (ecell.col >= first && ecell.col <= last) {\r\n         if (editor.fullgrid !== null) {\r\n            headercell = editor.fullgrid.childNodes[1].childNodes[1].childNodes[1+colindex+ecell.col-first];\r\n            if (headercell) {\r\n               if (context.classnames) headercell.className=context.classnames[selected+\"colname\"];\r\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"colname\"];\r\n               }\r\n            }\r\n         }\r\n      colindex += last - first + 1 + 1;\r\n      }\r\n   }\r\n\r\n//\r\n// ECellReadonly(editor, ecoord)\r\n//\r\n// Returns true if ecoord is readonly (or ecell if missing).\r\n//\r\n\r\nSocialCalc.ECellReadonly = function(editor, ecoord) {\r\n   \r\n   if (!ecoord && editor.ecell) {\r\n      ecoord = editor.ecell.coord; \r\n      }\r\n\r\n   if (!ecoord) return false;\r\n\r\n   var cell = editor.context.sheetobj.cells[ecoord];\r\n   return cell && cell.readonly;\r\n\r\n   }\r\n\r\n//\r\n// RangeAnchor(editor, ecoord)\r\n//\r\n// Sets the anchor of a range to ecoord (or ecell if missing).\r\n//\r\n\r\nSocialCalc.RangeAnchor = function(editor, ecoord) {\r\n\r\n   if (editor.range.hasrange) {\r\n      editor.RangeRemove();\r\n      }\r\n\r\n   editor.RangeExtend(ecoord);\r\n\r\n   }\r\n\r\n//\r\n// RangeExtend(editor, ecoord)\r\n//\r\n// Sets the other corner of the range to ecoord or, if missing, ecell.\r\n//\r\n\r\nSocialCalc.RangeExtend = function(editor, ecoord) {\r\n\r\n   var a, cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range = editor.range;\r\n   var range2 = editor.range2;\r\n\r\n   var ecell;\r\n   if (ecoord) {\r\n      ecell = SocialCalc.coordToCr(ecoord);\r\n      ecell.coord = ecoord;\r\n      }\r\n   else ecell = editor.ecell;\r\n\r\n   if (!ecell) return; // just in case\r\n\r\n   if (!range.hasrange) { // called without RangeAnchor...\r\n      range.anchorcoord = ecell.coord;\r\n      range.anchorrow = ecell.row;\r\n      range.top = ecell.row;\r\n      range.bottom = ecell.row;\r\n      range.anchorcol = ecell.col;\r\n      range.left = ecell.col;\r\n      range.right = ecell.col;\r\n      range.hasrange = true;\r\n      }\r\n\r\n   if (range.anchorrow < ecell.row) {\r\n      range.top = range.anchorrow;\r\n      range.bottom = ecell.row;\r\n      }\r\n   else {\r\n      range.top = ecell.row;\r\n      range.bottom = range.anchorrow;\r\n      }\r\n   if (range.anchorcol < ecell.col) {\r\n      range.left = range.anchorcol;\r\n      range.right = ecell.col;\r\n      }\r\n   else {\r\n      range.left = ecell.col;\r\n      range.right = range.anchorcol;\r\n      }\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range\":\r\n            highlights[coord] = \"unrange\";\r\n            break;\r\n         case \"range2\":\r\n            highlights[coord] = \"unrange2\";\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (row=range.top; row<=range.bottom; row++) {\r\n      for (col=range.left; col<=range.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"unrange\":\r\n               highlights[coord] = \"range\";\r\n               break;\r\n            case \"cursor\":\r\n               break;\r\n            case \"unrange2\":\r\n            default:\r\n               highlights[coord] = \"newrange\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\r\n      for (col=range2.left; col<=range2.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"unrange2\":\r\n               highlights[coord] = \"range2\";\r\n               break;\r\n            case \"range\":\r\n            case \"newrange\":\r\n            case \"cursor\":\r\n               break;\r\n            default:\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (coord in highlights) {\r\n\r\n      switch (highlights[coord]) {\r\n         case \"unrange\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"newrange\":\r\n            highlights[coord] = \"range\";\r\n            break;\r\n         case \"newrange2\":\r\n            highlights[coord] = \"range2\";\r\n            break;\r\n         case \"range\":\r\n         case \"range2\":\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n\r\n      }\r\n\r\n   for (f in editor.RangeChangeCallback) { // let others know\r\n      editor.RangeChangeCallback[f](editor);\r\n      }\r\n\r\n   // create range/coord string and do status callback\r\n\r\n   coord = SocialCalc.crToCoord(editor.range.left, editor.range.top);\r\n   if (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom) { // more than one cell\r\n      coord += \":\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   for (f in editor.StatusCallback) {\r\n      editor.StatusCallback[f].func(editor, \"rangechange\", coord, editor.StatusCallback[f].params);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// RangeRemove(editor)\r\n//\r\n// Turns off the range.\r\n//\r\n\r\nSocialCalc.RangeRemove = function(editor) {\r\n\r\n   var cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range = editor.range;\r\n   var range2 = editor.range2;\r\n\r\n   if (!range.hasrange && !range2.hasrange) return;\r\n\r\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\r\n      for (col=range2.left; col<=range2.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"range\":\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            case \"range2\":\r\n            case \"cursor\":\r\n               break;\r\n            default:\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"newrange2\":\r\n            highlights[coord] = \"range2\";\r\n            break;\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n      }\r\n\r\n   range.hasrange = false;\r\n\r\n   for (f in editor.RangeChangeCallback) { // let others know\r\n      editor.RangeChangeCallback[f](editor);\r\n      }\r\n\r\n   for (f in editor.StatusCallback) {\r\n      editor.StatusCallback[f].func(editor, \"rangechange\", \"\", editor.StatusCallback[f].params);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// Range2Remove(editor)\r\n//\r\n// Turns off the range2.\r\n//\r\n\r\nSocialCalc.Range2Remove = function(editor) {\r\n\r\n   var cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range2 = editor.range2;\r\n\r\n   if (!range2.hasrange) return;\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range2\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"range\":\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n      }\r\n\r\n   range2.hasrange = false;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// FitToEditTable(editor)\r\n//\r\n// Figure out (through column width declarations and approximation of pixels per row)\r\n// how many rendered rows and columns you need to be at least a little larger than\r\n// the editor's editing area.\r\n//\r\n\r\nSocialCalc.FitToEditTable = function(editor) {\r\n\r\n   var colnum, colname, colwidth, totalwidth, totalrows, rownum, rowpane, needed;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n\r\n   // Calculate column width data\r\n\r\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\r\n   for (colpane=0; colpane<context.colpanes.length-1; colpane++) { // Get width of all but last pane\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         colname=SocialCalc.rcColname(colnum);\r\n         if (sheetobj.colattribs.hide[colname] != \"yes\") {\r\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (colnum=context.colpanes[colpane].first; colnum<=10000; colnum++) { //!!! max for safety, but makes that col max!!!\r\n      colname=SocialCalc.rcColname(colnum);\r\n      if (sheetobj.colattribs.hide[colname] != \"yes\") {\r\n         colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n         if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n         totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n         }\r\n      if (totalwidth > editor.tablewidth) break;\r\n      }\r\n\r\n   context.colpanes[colpane].last = context.sheetobj.attribs.usermaxcol || colnum;\r\n\r\n   // Calculate row height data\r\n   \r\n   // find first visible row - Bug fix when many rows hidden - as PANEL formula hides many rows\r\n   var firstRow = context.rowpanes[0].first;\r\n   var lastRow = context.sheetobj.attribs.lastrow;\r\n   while(sheetobj.rowattribs.hide[firstRow] == \"yes\" && firstRow <lastRow) firstRow++;\r\n   context.rowpanes[0].first = firstRow;\r\n   \r\n   // count visible rows in pane(s)\r\n   totalrows=context.showRCHeaders ? 1 : 0;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) { // count all panes but last one\r\n      totalrows += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 1;\r\n      for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\r\n         if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n            totalrows--;\r\n            }\r\n         }\r\n      }\r\n\r\n   needed = editor.tableheight - totalrows * context.pixelsPerRow; // estimate amount needed\r\n\r\n   context.rowpanes[rowpane].last = context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].first + Math.floor(needed / context.pixelsPerRow) + 1;\r\n\r\n   }\r\n\r\n//\r\n// CalculateEditorPositions(editor)\r\n//\r\n// Calculate the screen positions and other values of various editing elements\r\n// These values change and need to be recomputed when the pane first/last or cell contents change,\r\n// as well as new column widths, etc.\r\n//\r\n// Note: Only call this after the grid has been rendered! You may have to wait for a timeout...\r\n//\r\n\r\nSocialCalc.CalculateEditorPositions = function(editor) {\r\n\r\n   var rowpane, colpane, i;\r\n\r\n   editor.gridposition = SocialCalc.GetElementPosition(editor.griddiv);\r\n   \r\n   var element = editor.griddiv.firstChild.lastChild.childNodes[1].childNodes[0]; // 2nd tr 1st td\r\n   editor.headposition = SocialCalc.GetElementPosition(element);\r\n   editor.headposition.left += element.offsetWidth;\r\n   editor.headposition.top += element.offsetHeight;\r\n\r\n   editor.rowpositions = [];\r\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n      editor.CalculateRowPositions(rowpane, editor.rowpositions, editor.rowheight);\r\n      }\r\n   for (i=0; i<editor.rowpositions.length; i++) {\r\n      if (editor.rowpositions[i]>editor.gridposition.top+editor.tableheight) break;\r\n      }\r\n   editor.lastvisiblerow = i-1;\r\n\r\n   editor.colpositions = [];\r\n   for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n      editor.CalculateColPositions(colpane, editor.colpositions, editor.colwidth);\r\n      }\r\n   for (i=0; i<editor.colpositions.length; i++) {\r\n      if (editor.colpositions[i]>editor.gridposition.left+editor.tablewidth) break;\r\n      }\r\n   editor.lastvisiblecol = i-1;\r\n\r\n   editor.firstscrollingrow = editor.context.rowpanes[editor.context.rowpanes.length-1].first;\r\n   while (editor.context.sheetobj.rowattribs.hide[editor.firstscrollingrow] == \"yes\") {\r\n      editor.firstscrollingrow++;\r\n      }\r\n   editor.firstscrollingrowtop = editor.rowpositions[editor.firstscrollingrow] || editor.headposition.top;\r\n   editor.lastnonscrollingrow = editor.context.rowpanes.length-1 > 0 ?\r\n         editor.context.rowpanes[editor.context.rowpanes.length-2].last : 0;\r\n   editor.firstscrollingcol = editor.context.colpanes[editor.context.colpanes.length-1].first;\r\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(editor.firstscrollingcol)] == \"yes\") {\r\n      editor.firstscrollingcol++;\r\n      }\r\n   editor.firstscrollingcolleft = editor.colpositions[editor.firstscrollingcol] || editor.headposition.left;\r\n   editor.lastnonscrollingcol = editor.context.colpanes.length-1 > 0 ?\r\n         editor.context.colpanes[editor.context.colpanes.length-2].last : 0;\r\n\r\n   // Now do the table controls\r\n\r\n   editor.verticaltablecontrol.ComputeTableControlPositions();\r\n   editor.horizontaltablecontrol.ComputeTableControlPositions();\r\n   }\r\n\r\n//\r\n// ScheduleRender(editor)\r\n//\r\n// Do a series of timeouts to render the sheet, wait for background layout and\r\n// rendering by the browser, and then update editor visuals, sliders, etc.\r\n//\r\n\r\nSocialCalc.ScheduleRender = function(editor) {\r\n   if(editor.ignoreRender == true) return; // formDataViewer is only used for \"ExecuteSheetCommand\" fumctions - so skip render \r\n   if (editor.timeout) window.clearTimeout(editor.timeout); // in case called more than once, just use latest\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedrender\", null, editor);\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoRenderStep(editor); }, 1);\r\n\r\n   }\r\n\r\n// DoRenderStep(editor)\r\n//\r\n\r\nSocialCalc.DoRenderStep = function(editor) {\r\n\r\n   editor.timeout = null;\r\n\r\n   editor.EditorRenderSheet();\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"renderdone\", null, editor);\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\r\n\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SchedulePositionCalculations(editor)\r\n//\r\n\r\nSocialCalc.SchedulePositionCalculations = function(editor) {\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\r\n\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\r\n\r\n   }\r\n\r\n// DoPositionCalculations(editor)\r\n//\r\n// Update editor visuals, sliders, etc.\r\n//\r\n// Note: Only call this after the DOM objects have been modified and rendered!\r\n//\r\n\r\nSocialCalc.DoPositionCalculations = function(editor) {\r\n\r\n   editor.timeout = null;\r\n\r\n   editor.CalculateEditorPositions();\r\n   editor.verticaltablecontrol.PositionTableControlElements();\r\n   editor.horizontaltablecontrol.PositionTableControlElements();\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"doneposcalc\", null, editor);\r\n\r\n   if (editor.ensureecell && editor.ecell && !editor.deferredCommands.length) { // don't do if deferred cmd to execute\r\n      editor.ensureecell = false;\r\n      editor.EnsureECellVisible(); // this could cause another redisplay\r\n      }\r\n\r\n   editor.cellhandles.ShowCellHandles(true);\r\n\r\n\r\n//!!! Need to now check to see if this positioned controls out of the editing area\r\n//!!! (such as when there is a large wrapped cell and it pushes the pane boundary too far down).\r\n\r\n   }\r\n\r\nSocialCalc.CalculateRowPositions = function(editor, panenum, positions, sizes) {\r\n\r\n   var toprow, rowpane, rownum, offset, trowobj, cellposition;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var tbodyobj;\r\n\r\n   // eddy CalculateRowPositions {\r\n//   if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\r\n   if (!context.showRCHeaders) return;\r\n   // } CalculateRowPositions\r\n   \r\n   tbodyobj=editor.fullgrid.lastChild;\r\n\r\n   // Calculate start of this pane as row in this table:\r\n\r\n   toprow = 2;\r\n   for (rowpane=0; rowpane<panenum; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   offset = 0;\r\n   for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\r\n      trowobj = tbodyobj.childNodes[toprow+offset];\r\n      offset++;\r\n      if (!trowobj) { continue; }\r\n\r\n      if (!positions[rownum]) {\r\n         positions[rownum] = trowobj.firstChild.offsetTop;\r\n         sizes[rownum] = trowobj.firstChild.offsetHeight;\r\n         }\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateColPositions = function(editor, panenum, positions, sizes) {\r\n\r\n   var leftcol, colpane, colnum, offset, trowobj, cellposition;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var tbodyobj;\r\n\r\n   // eddy CalculateColPositions {\r\n   // if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\r\n   if (!context.showRCHeaders) return;\r\n   // } CalculateColPositions\r\n\r\n   tbodyobj=editor.fullgrid.lastChild;\r\n\r\n   // Calculate start of this pane as column in this table:\r\n\r\n   leftcol = 1;\r\n   for (colpane=0; colpane<panenum; colpane++) {\r\n      leftcol += context.colpanes[colpane].last - context.colpanes[colpane].first + 2; // skip pane and spacing col\r\n      }\r\n\r\n   trowobj = tbodyobj.childNodes[1]; // get heading row, which has all columns\r\n   offset = 0;\r\n   for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n      cellposition = SocialCalc.GetElementPosition(trowobj.childNodes[leftcol+offset]);\r\n      if (!positions[colnum]) {\r\n         positions[colnum] = cellposition.left; // first one takes precedence\r\n         if (trowobj.childNodes[leftcol+offset]) {\r\n            sizes[colnum] = trowobj.childNodes[leftcol+offset].offsetWidth;\r\n            }\r\n         }\r\n      offset++;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// ScrollRelative(editor, vertical, amount)\r\n//\r\n// If vertical true, scrolls up(-)/down(+), else left(-)/right(+)\r\n\r\nSocialCalc.ScrollRelative = function(editor, vertical, amount) {\r\n\r\n   if (vertical) {\r\n      editor.ScrollRelativeBoth(amount, 0);\r\n      }\r\n   else {\r\n      editor.ScrollRelativeBoth(0, amount);\r\n      }\r\n   return;\r\n\r\n   }\r\n\r\n// ScrollRelativeBoth(editor, vamount, hamount)\r\n//\r\n// Does both with one render\r\n\r\nSocialCalc.ScrollRelativeBoth = function(editor, vamount, hamount) {\r\n\r\n   var context=editor.context;\r\n   var dv = vamount > 0 ? 1 : -1, dh = hamount > 0 ? 1 : -1;\r\n\r\n   var vplen=context.rowpanes.length;\r\n   var vlimit = vplen>1 ? context.rowpanes[vplen-2].last+1 : 1; // don't scroll past here\r\n   if (context.rowpanes[vplen-1].first+vamount < vlimit) { // limit amount\r\n      vamount = (-context.rowpanes[vplen-1].first) + vlimit;\r\n      }\r\n\r\n   var hplen=context.colpanes.length;\r\n   var hlimit = hplen>1 ? context.colpanes[hplen-2].last+1 : 1; // don't scroll past here\r\n   if (context.colpanes[hplen-1].first+hamount < hlimit) { // limit amount\r\n      hamount = (-context.colpanes[hplen-1].first) + hlimit;\r\n      }\r\n\r\n   // Handle hidden column by finding a next one that's not hidden.\r\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(context.colpanes[hplen-1].first+hamount)] == \"yes\") {\r\n      hamount += dh;\r\n      if (hamount < 1) {\r\n         hamount = 0;\r\n         break;\r\n         }\r\n      }\r\n\r\n   // Handle hidden row by finding a next one that's not hidden.\r\n   while (context.sheetobj.rowattribs.hide[context.rowpanes[vplen-1].first+vamount] == \"yes\") {\r\n      vamount += dv;\r\n      if (vamount < 1) {\r\n         vamount = 0;\r\n         break;\r\n         }\r\n      }\r\n\r\n   if ((vamount==1 || vamount==-1) && hamount==0) { // special case quick scrolls\r\n      if (vamount==1) {\r\n         editor.ScrollTableUpOneRow();\r\n         }\r\n      else {\r\n         editor.ScrollTableDownOneRow();\r\n         }\r\n      if (editor.ecell) editor.SetECellHeaders(\"selected\");\r\n      editor.SchedulePositionCalculations();\r\n      return;\r\n      }\r\n\r\n   // Do a gross move and render\r\n\r\n   if (vamount!=0 || hamount!=0) {\r\n      context.rowpanes[vplen-1].first += vamount;\r\n      context.rowpanes[vplen-1].last += vamount;\r\n      context.colpanes[hplen-1].first += hamount;\r\n      context.colpanes[hplen-1].last += hamount;\r\n      editor.LimitLastPanes();\r\n      editor.FitToEditTable();\r\n      editor.ScheduleRender();\r\n      }\r\n\r\n   }\r\n\r\n\r\n// PageRelative(editor, vertical, direction)\r\n//\r\n// If vertical true, pages up(direction is -)/down(+), else left(-)/right(+)\r\n\r\nSocialCalc.PageRelative = function(editor, vertical, direction) {\r\n\r\n   var context=editor.context;\r\n   var panes=vertical ? \"rowpanes\" : \"colpanes\";\r\n   var lastpane=context[panes][context[panes].length-1];\r\n   var lastvisible=vertical ? \"lastvisiblerow\" : \"lastvisiblecol\";\r\n   var sizearray=vertical ? editor.rowheight : editor.colwidth;\r\n   var defaultsize=vertical ? SocialCalc.Constants.defaultAssumedRowHeight : SocialCalc.Constants.defaultColWidth;\r\n   var size, newfirst, totalsize, current;\r\n\r\n   if (direction > 0) { // down/right\r\n      newfirst = editor[lastvisible];\r\n      if (newfirst == lastpane.first) newfirst += 1; // move at least one\r\n      }\r\n   else {\r\n      if (vertical) { // calculate amount to scroll\r\n         totalsize = editor.tableheight - (editor.firstscrollingrowtop - editor.gridposition.top);\r\n         }\r\n      else {\r\n         totalsize = editor.tablewidth - (editor.firstscrollingcolleft - editor.gridposition.left);\r\n         }\r\n      totalsize -= sizearray[editor[lastvisible]] > 0 ? sizearray[editor[lastvisible]] : defaultsize;\r\n\r\n      for (newfirst=lastpane.first-1; newfirst>0; newfirst--) {\r\n         size = sizearray[newfirst] > 0 ? sizearray[newfirst] : defaultsize;\r\n         if (totalsize < size) break;\r\n         totalsize -= size;\r\n         }\r\n\r\n      current = lastpane.first;\r\n      if (newfirst >= current) newfirst = current-1; // move at least 1\r\n      if (newfirst < 1) newfirst = 1;\r\n      }\r\n\r\n   lastpane.first = newfirst;\r\n   lastpane.last = newfirst+1;\r\n   editor.LimitLastPanes();\r\n   editor.FitToEditTable();\r\n   editor.ScheduleRender();\r\n\r\n   }\r\n\r\n// LimitLastPanes(editor)\r\n//\r\n// Makes sure that the \"first\" of the last panes isn't before the last of the previous pane\r\n//\r\n\r\nSocialCalc.LimitLastPanes = function(editor) {\r\n\r\n   var context=editor.context;\r\n   var plen;\r\n\r\n   plen = context.rowpanes.length;\r\n   if (plen>1 && context.rowpanes[plen-1].first <= context.rowpanes[plen-2].last)\r\n       context.rowpanes[plen-1].first = context.rowpanes[plen-2].last+1;\r\n   if (context.sheetobj.attribs.usermaxrow && context.rowpanes[plen-1].first > context.sheetobj.attribs.usermaxrow)\r\n       context.rowpanes[plen-1].first = context.sheetobj.attribs.usermaxrow;\r\n\r\n   plen = context.colpanes.length;\r\n   if (plen>1 && context.colpanes[plen-1].first <= context.colpanes[plen-2].last)\r\n       context.colpanes[plen-1].first = context.colpanes[plen-2].last+1;\r\n   if (context.sheetobj.attribs.usermaxcol && context.colpanes[plen-1].first > context.sheetobj.attribs.usermaxcol)\r\n       context.colpanes[plen-1].first = context.sheetobj.attribs.usermaxcol;\r\n\r\n   }\r\n\r\nSocialCalc.ScrollTableUpOneRow = function(editor) {\r\n\r\n   var toprow, rowpane, rownum, colnum, colpane, cell, oldrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\r\n   var rowneedsrefresh={};\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var tableobj=editor.fullgrid;\r\n\r\n   var tbodyobj;\r\n\r\n   tbodyobj=tableobj.lastChild;\r\n\r\n   toprow = context.showRCHeaders ? 2 : 1;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   // abort if scrolling beyond user max row\r\n   if (context.sheetobj.attribs.usermaxrow && (context.sheetobj.attribs.usermaxrow - context.rowpanes[rowpane].first < 1)) {\r\n      return tableobj;\r\n      }\r\n  \r\n   tbodyobj.removeChild(tbodyobj.childNodes[toprow]);\r\n\r\n   context.rowpanes[rowpane].first++;\r\n   context.rowpanes[rowpane].last++;\r\n   editor.FitToEditTable();\r\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\r\n\r\n   if (!context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].last != context.sheetobj.attribs.usermaxrow) {\r\n      newbottomrow = context.RenderRow(context.rowpanes[rowpane].last, rowpane);\r\n      tbodyobj.appendChild(newbottomrow);\r\n      }\r\n\r\n   // if scrolled off a row with starting rowspans, replace rows for the largest rowspan\r\n\r\n   maxrowspan = 1;\r\n   oldrownum=context.rowpanes[rowpane].first - 1;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, oldrownum);\r\n         if (context.cellskip[coord]) continue;\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\r\n         }\r\n      }\r\n\r\n   if (maxrowspan>1) {\r\n      for (rownum=1; rownum<maxrowspan; rownum++) {\r\n         if (rownum+oldrownum >= context.rowpanes[rowpane].last) break;\r\n         newrow=context.RenderRow(rownum+oldrownum, rowpane);\r\n         oldchild=tbodyobj.childNodes[toprow+rownum-1];\r\n         tbodyobj.replaceChild(newrow,oldchild);\r\n         }\r\n      }\r\n\r\n   // if added a row that includes rowspans from above, update the size of those to include new row\r\n\r\n   bottomrownum=context.rowpanes[rowpane].last;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\r\n         if (!coord) continue; // only look at spanned cells\r\n         rownum=context.coordToCR[coord].row-0;\r\n         if (rownum==context.rowpanes[rowpane].last ||\r\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\r\n         }\r\n      }\r\n\r\n   for (rownum in rowneedsrefresh) {\r\n      newrow=context.RenderRow(rownum, rowpane);\r\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\r\n      tbodyobj.replaceChild(newrow,oldchild);\r\n      }\r\n\r\n   return tableobj;\r\n   }\r\n\r\nSocialCalc.ScrollTableDownOneRow = function(editor) {\r\n\r\n   var toprow, rowpane, rownum, colnum, colpane, cell, newrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\r\n   var rowneedsrefresh={};\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var tableobj=editor.fullgrid;\r\n\r\n   var tbodyobj;\r\n\r\n   tbodyobj=tableobj.lastChild;\r\n\r\n   toprow = context.showRCHeaders ? 2 : 1;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   if (!context.sheetobj.attribs.usermaxrow) {\r\n      tbodyobj.removeChild(tbodyobj.childNodes[toprow+(context.rowpanes[rowpane].last-context.rowpanes[rowpane].first)]);\r\n      }\r\n\r\n   context.rowpanes[rowpane].first--;\r\n   context.rowpanes[rowpane].last--;\r\n   editor.FitToEditTable();\r\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\r\n\r\n   newrow = context.RenderRow(context.rowpanes[rowpane].first, rowpane);\r\n   tbodyobj.insertBefore(newrow, tbodyobj.childNodes[toprow]);\r\n\r\n   // if inserted a row with starting rowspans, replace rows for the largest rowspan\r\n\r\n   maxrowspan = 1;\r\n   newrownum=context.rowpanes[rowpane].first;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, newrownum);\r\n         if (context.cellskip[coord]) continue;\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\r\n         }\r\n      }\r\n\r\n   if (maxrowspan>1) {\r\n      for (rownum=1; rownum<maxrowspan; rownum++) {\r\n         if (rownum+newrownum > context.rowpanes[rowpane].last) break;\r\n         newrow=context.RenderRow(rownum+newrownum, rowpane);\r\n         oldchild=tbodyobj.childNodes[toprow+rownum];\r\n         tbodyobj.replaceChild(newrow,oldchild);\r\n         }\r\n      }\r\n\r\n   // if last row now includes rowspans or rowspans from above, update the size of those to remove deleted row\r\n\r\n   bottomrownum=context.rowpanes[rowpane].last;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, bottomrownum);\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) {\r\n            rowneedsrefresh[bottomrownum]=true; // need to update this row\r\n            continue;\r\n            }\r\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\r\n         if (!coord) continue; // only look at spanned cells\r\n         rownum=context.coordToCR[coord].row-0;\r\n         if (rownum==bottomrownum ||\r\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\r\n         }\r\n      }\r\n\r\n   for (rownum in rowneedsrefresh) {\r\n      newrow=context.RenderRow(rownum, rowpane);\r\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\r\n      tbodyobj.replaceChild(newrow,oldchild);\r\n      }\r\n\r\n   return tableobj;\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// InputBox class:\r\n//\r\n// This class deals with the text box for editing cell contents.\r\n// It mainly controls a user input box for typed content and is used to interact with\r\n// the keyboard code, etc.\r\n//\r\n// You can use this inside a formula bar control of some sort.\r\n// You create this after you have created a table editor object (but not necessarily \r\n// done the CreateTableEditor method).\r\n//\r\n// When the user starts typing text, or double-clicks on a cell, this object\r\n// comes into play.\r\n//\r\n// The element given when this is first constructed should be an input HTMLElement or\r\n// something that acts like one. Check the code here to see what is done to it.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.InputBox = function(element, editor) {\r\n\r\n   if (!element) return; // invoked without enough data to work\r\n\r\n   this.element = element; // the input element associated with this InputBox\r\n   this.editor = editor; // the TableEditor this belongs to\r\n   this.inputEcho = null;\r\n\r\n   editor.inputBox = this;\r\n\r\n   element.onmousedown = SocialCalc.InputBoxOnMouseDown;\r\n\r\n   editor.MoveECellCallback.formulabar = function(e){\r\n      if (e.state!=\"start\") return; // if not in normal keyboard mode don't replace formula bar\r\n      editor.inputBox.DisplayCellContents(e.ecell.coord);\r\n      };\r\n   }\r\n\r\n\r\n// Methods:\r\n\r\nSocialCalc.InputBox.prototype.DisplayCellContents = function(coord) {SocialCalc.InputBoxDisplayCellContents(this, coord);};\r\nSocialCalc.InputBox.prototype.ShowInputBox = function(show) {this.editor.inputEcho.ShowInputEcho(show);};\r\nSocialCalc.InputBox.prototype.GetText = function() {return this.element.value;};\r\nSocialCalc.InputBox.prototype.SetText = function(newtext) {\r\n   if (!this.element) return;\r\n   this.element.value=newtext;\r\n   this.editor.inputEcho.SetText(newtext+\"_\");\r\n   };\r\nSocialCalc.InputBox.prototype.Focus = function() {SocialCalc.InputBoxFocus(this);};\r\nSocialCalc.InputBox.prototype.Blur = function() {return this.element.blur();};\r\nSocialCalc.InputBox.prototype.Select = function(t) {\r\n   if (!this.element) return;\r\n   switch (t) {\r\n      case \"end\":\r\n         if (document.selection && document.selection.createRange) {\r\n            /* IE 4+ - Safer than setting .selectionEnd as it also works for Textareas. */\r\n            try {\r\n               var range = document.selection.createRange().duplicate();\r\n               range.moveToElementText(this.element);\r\n               range.collapse(false);\r\n               range.select();\r\n            }\r\n            catch (e) {\r\n               if (this.element.selectionStart!=undefined) {\r\n                  this.element.selectionStart=this.element.value.length;\r\n                  this.element.selectionEnd=this.element.value.length;\r\n               }\r\n            }\r\n         } else if (this.element.selectionStart!=undefined) {\r\n            this.element.selectionStart=this.element.value.length;\r\n            this.element.selectionEnd=this.element.value.length;\r\n         }\r\n         break;\r\n      }\r\n   };\r\n\r\n// Functions:\r\n\r\n//\r\n// SocialCalc.InputBoxDisplayCellContents(inputbox, coord)\r\n//\r\n// Sets input box to the contents of the specified cell (or ecell if null).\r\n//\r\n\r\nSocialCalc.InputBoxDisplayCellContents = function(inputbox, coord) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   if (!inputbox) return;\r\n   if (!coord) {\r\n     if (!inputbox.editor) return; // not initialized yet\r\n     if (!inputbox.editor.ecell) return; // not initialized yet\r\n     coord = inputbox.editor.ecell.coord;\r\n   }\r\n   var text = SocialCalc.GetCellContents(inputbox.editor.context.sheetobj, coord);\r\n   if (text.indexOf(\"\\n\")!=-1) {\r\n      text = scc.s_inputboxdisplaymultilinetext;\r\n      inputbox.element.disabled = true;\r\n      }\r\n   else if (inputbox.editor.ECellReadonly()) {\r\n      inputbox.element.disabled = true;\r\n      }\r\n   else {\r\n      inputbox.element.disabled = false;\r\n      }\r\n   inputbox.SetText(text);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.InputBoxFocus(inputbox)\r\n//\r\n// Call this to have the input box get the focus and respond to keystrokes\r\n// but still pass them off to SocialCalc.ProcessKey.\r\n//\r\n\r\nSocialCalc.InputBoxFocus = function(inputbox) {\r\n\r\n   if (!inputbox) return;\r\n   inputbox.element.focus();\r\n   var editor = inputbox.editor;\r\n   editor.state = \"input\";\r\n   var wval = editor.workingvalues;\r\n   wval.partialexpr = \"\";\r\n   wval.ecoord = editor.ecell.coord;\r\n   wval.erow = editor.ecell.row;\r\n   wval.ecol = editor.ecell.col;\r\n\r\n   };\r\n\r\n//\r\n// SocialCalc.InputBoxOnMouseDown(e)\r\n//\r\n// This is called when the input box gets the focus. It then responds to keystrokes\r\n// and pass them off to SocialCalc.ProcessKey, but in a different editing state.\r\n//\r\n\r\nSocialCalc.InputBoxOnMouseDown = function(e) {\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var wval = editor.workingvalues;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.state=\"inputboxdirect\";\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.inputEcho.ShowInputEcho(true);\r\n         break;\r\n\r\n      case \"input\":\r\n         wval.partialexpr = \"\"; // make sure not pointing\r\n         editor.MoveECell(wval.ecoord);\r\n         editor.state=\"inputboxdirect\";\r\n         SocialCalc.KeyboardFocus(); // may have come here from outside of grid\r\n         break;\r\n\r\n      case \"inputboxdirect\":\r\n         break;\r\n      }\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// InputEcho class:\r\n//\r\n// This object creates and controls an element that echos what's in the InputBox during editing\r\n// It is draggable.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.InputEcho = function(editor) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n   this.text = \"\"; // current value of what is displayed\r\n   this.interval = null; // timer handle\r\n\r\n   this.container = null; // element containing main echo as well as prompt line\r\n   this.main = null; // main echo area\r\n   this.prompt = null;\r\n   this.hint = null; // focus cell hint area\r\n\r\n   this.functionbox = null; // function chooser dialog\r\n\r\n   this.container = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.container, \"display:none;position:absolute;zIndex:10;\");\r\n\r\n   this.main = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoClass) this.main.className = scc.defaultInputEchoClass;\r\n   if (scc.defaultInputEchoStyle) SocialCalc.setStyles(this.main, scc.defaultInputEchoStyle);\r\n   this.main.innerHTML = \"&nbsp;\";\r\n\r\n   this.hint = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoHintClass) this.hint.className = scc.defaultInputEchoHintClass;\r\n   if (scc.defaultInputEchoHintStyle) SocialCalc.setStyles(this.hint, scc.defaultInputEchoHintStyle);\r\n   this.hint.innerHTML = \"\";\r\n\r\n   this.container.appendChild(this.hint);\r\n   this.container.appendChild(this.main);\r\n\r\n   this.prompt = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoPromptClass) this.prompt.className = scc.defaultInputEchoPromptClass;\r\n   if (scc.defaultInputEchoPromptStyle) SocialCalc.setStyles(this.prompt, scc.defaultInputEchoPromptStyle);\r\n   this.prompt.innerHTML = \"\";\r\n\r\n   this.container.appendChild(this.prompt);\r\n\r\n   SocialCalc.DragRegister(this.main, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: this.container},\r\n                  this.editor.toplevel);\r\n\r\n   editor.toplevel.appendChild(this.container);\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.InputEcho.prototype.ShowInputEcho = function(show) {return SocialCalc.ShowInputEcho(this, show);};\r\nSocialCalc.InputEcho.prototype.SetText = function(str) {return SocialCalc.SetInputEchoText(this, str);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.ShowInputEcho = function(inputecho, show) {\r\n\r\n   var cell, position;\r\n   var editor = inputecho.editor;\r\n\r\n   if (!editor) return;\r\n\r\n   if (show) {\r\n      editor.cellhandles.ShowCellHandles(false);\r\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n      if (cell) {\r\n         position = SocialCalc.GetElementPosition(cell.element);\r\n         inputecho.container.style.left = (position.left-1)+\"px\";\r\n         inputecho.container.style.top = (position.top-1)+\"px\";\r\n         }\r\n      inputecho.hint.innerHTML = editor.ecell.coord;\r\n      inputecho.container.style.display = \"block\";\r\n      if (inputecho.interval) window.clearInterval(inputecho.interval); // just in case\r\n      inputecho.interval = window.setInterval(SocialCalc.InputEchoHeartbeat, 50);\r\n      }\r\n   else {\r\n      if (inputecho.interval) window.clearInterval(inputecho.interval);\r\n      inputecho.container.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SetInputEchoText = function(inputecho, str) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var fname, fstr;\r\n   var newstr = SocialCalc.special_chars(str);\r\n   newstr = newstr.replace(/\\n/g,\"<br>\");\r\n\r\n   if (inputecho.text != newstr) {\r\n      inputecho.main.innerHTML = newstr;\r\n      inputecho.text = newstr;\r\n      }\r\n\r\n   var parts = str.match(/.*[\\+\\-\\*\\/\\&\\^\\<\\>\\=\\,\\(]([A-Za-z][A-Za-z][\\w\\.]*?)\\([^\\)]*$/);\r\n   if (str.charAt(0)==\"=\" && parts) {\r\n      fname = parts[1].toUpperCase();\r\n      if (SocialCalc.Formula.FunctionList[fname]) {\r\n         SocialCalc.Formula.FillFunctionInfo(); //  make sure filled\r\n         fstr = SocialCalc.special_chars(fname+\"(\"+SocialCalc.Formula.FunctionArgString(fname)+\")\");\r\n         }\r\n      else {\r\n         fstr = scc.ietUnknownFunction+fname;\r\n         }\r\n      if (inputecho.prompt.innerHTML != fstr) {\r\n         inputecho.prompt.innerHTML = fstr;\r\n         inputecho.prompt.style.display = \"block\";\r\n         }\r\n      }\r\n   else if (inputecho.prompt.style.display != \"none\") {\r\n      inputecho.prompt.innerHTML = \"\";\r\n      inputecho.prompt.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.InputEchoHeartbeat = function() {\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n   editor.inputEcho.SetText(editor.inputBox.GetText()+\"_\");\r\n\r\n   }\r\n\r\nSocialCalc.InputEchoMouseDown = function(e) {\r\n      var event = e || window.event;\r\n\r\n      var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n      if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n//      if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\r\n//      else event.cancelBubble = true; // IE 5+\r\n//      if (event.preventDefault) event.preventDefault(); // DOM Level 2\r\n//      else event.returnValue = false; // IE 5+\r\n\r\n      editor.inputBox.element.focus();\r\n\r\n//      return false;\r\n      };\r\n\r\n\r\n// *************************************\r\n//\r\n// CellHandles class:\r\n//\r\n// This object creates and controls the elements around the cursor cell for dragging, etc.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.CellHandles = function(editor) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var functions;\r\n\r\n   if (editor.noEdit) return; // leave us with nothing\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n\r\n   this.noCursorSuffix = false;\r\n\r\n   this.movedmouse = false; // used to detect no-op\r\n\r\n   this.draghandle = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.draghandle, \"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\");\r\n   this.draghandle.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.draghandle);\r\n   SocialCalc.AssignID(editor, this.draghandle, \"draghandle\");\r\n\r\n   var imagetype = \"png\";\r\n   if (navigator.userAgent.match(/MSIE 6\\.0/)) {\r\n      imagetype = \"gif\";\r\n      }\r\n\r\n   this.dragpalette = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.dragpalette, \"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;\"+\r\n      \"backgroundImage:url(\"+SocialCalc.Constants.defaultImagePrefix+\"drag-handles.\"+imagetype+\");\");\r\n   this.dragpalette.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.dragpalette);\r\n   SocialCalc.AssignID(editor, this.dragpalette, \"dragpalette\");\r\n\r\n   this.dragtooltip = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.dragtooltip, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\");\r\n   this.dragtooltip.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.dragtooltip);\r\n   SocialCalc.AssignID(editor, this.dragtooltip, \"dragtooltip\");\r\n\r\n   this.fillinghandle = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.fillinghandle, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\");\r\n   this.fillinghandle.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.fillinghandle);\r\n   SocialCalc.AssignID(editor, this.fillinghandle, \"fillinghandle\");\r\n\r\n   if (this.draghandle.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      this.draghandle.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\r\n      this.dragpalette.addEventListener(\"mousedown\", SocialCalc.CellHandlesMouseDown, false);\r\n      this.dragpalette.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\r\n      }\r\n   else if (this.draghandle.attachEvent) { // IE 5+\r\n      this.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\r\n      this.dragpalette.attachEvent(\"onmousedown\", SocialCalc.CellHandlesMouseDown);\r\n      this.dragpalette.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\r\n      }\r\n   else { // don't handle this\r\n      throw \"Browser not supported\";\r\n      }\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.CellHandles.prototype.ShowCellHandles = function(show, moveshow) {return SocialCalc.ShowCellHandles(this, show, moveshow);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.ShowCellHandles = function(cellhandles, show, moveshow) {\r\n\r\n   var cell, cell2, position, position2;\r\n   var editor = cellhandles.editor;\r\n   var doshow = false;\r\n   var row, col;\r\n   var colinc = 1, rowinc = 1;\r\n\r\n   if (!editor) return;\r\n   if (!editor.ecell) return;\r\n\r\n   do { // a block that can you can \"break\" out of easily\r\n\r\n      if (!show) break;\r\n\r\n      row = editor.ecell.row;\r\n      col = editor.ecell.col;\r\n\r\n      if (editor.state != \"start\") break;\r\n      if (row >= editor.lastvisiblerow) break;\r\n      if (col >= editor.lastvisiblecol) break;\r\n      if (row < editor.firstscrollingrow) break;\r\n      if (col < editor.firstscrollingcol) break;\r\n\r\n      // Go beyond one column if hidden.\r\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col+colinc)] == \"yes\") {\r\n         colinc++; \r\n         }     \r\n\r\n      // Go beyond one row if hidden.\r\n      while (editor.context.sheetobj.rowattribs.hide[row+rowinc] == \"yes\") {\r\n         rowinc++; \r\n         }     \r\n\r\n      // Check colspan and rowspan.\r\n      cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(col+colinc-1, row+rowinc-1)];\r\n      if (typeof cell != \"undefined\") {\r\n         colinc += (cell.colspan || 1) - 1;\r\n         rowinc += (cell.rowspan || 1) - 1;\r\n         }\r\n\r\n      if (editor.rowpositions[row+rowinc]+20>editor.horizontaltablecontrol.controlborder) {\r\n         break;\r\n         }\r\n      if (editor.rowpositions[row+rowinc]-10<editor.headposition.top) {\r\n         break;\r\n         }\r\n      if (editor.colpositions[col+colinc]+20>editor.verticaltablecontrol.controlborder) {\r\n         break;\r\n         }\r\n      if (editor.colpositions[col+colinc]-30<editor.headposition.left) {\r\n         break;\r\n         }\r\n\r\n      cellhandles.draghandle.style.left = (editor.colpositions[col+colinc]-1)+\"px\";\r\n      cellhandles.draghandle.style.top = (editor.rowpositions[row+rowinc]-1)+\"px\";\r\n      cellhandles.draghandle.style.display = \"block\";\r\n\r\n      if (moveshow) {\r\n         cellhandles.draghandle.style.display = \"none\";\r\n         cellhandles.dragpalette.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\r\n         cellhandles.dragpalette.style.top = (editor.rowpositions[row+rowinc]-45)+\"px\";\r\n         cellhandles.dragpalette.style.display = \"block\";\r\n         cellhandles.dragtooltip.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\r\n         cellhandles.dragtooltip.style.top = (editor.rowpositions[row+rowinc]+45)+\"px\";\r\n         cellhandles.dragtooltip.style.display = \"none\";\r\n         }\r\n\r\n      doshow = true;\r\n\r\n      }\r\n   while (false); // only do once\r\n\r\n   if (!doshow) {\r\n      cellhandles.draghandle.style.display = \"none\";\r\n      }\r\n   if (!moveshow) {\r\n      cellhandles.dragpalette.style.display = \"none\";\r\n      cellhandles.dragtooltip.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseMoveOnHandle = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var event = e || window.event;\r\n   var target = event.target || event.srcElement\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (!cellhandles.editor) return true; // no handles\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n\r\n   if (!editor.cellhandles.mouseDown) {\r\n      editor.cellhandles.ShowCellHandles(true, true); // show move handles, too\r\n\r\n      if (target == cellhandles.dragpalette) {\r\n         var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\r\n         if (whichhandle==0) { // off of active part of palette\r\n            SocialCalc.CellHandlesHoverTimeout();\r\n            return;\r\n            }\r\n         if (cellhandles.tooltipstimer) {\r\n            window.clearTimeout(cellhandles.tooltipstimer);\r\n            cellhandles.tooltipstimer = null;\r\n            }\r\n         cellhandles.tooltipswhichhandle = whichhandle;\r\n         cellhandles.tooltipstimer = window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout, 700);\r\n         }\r\n\r\n      if (cellhandles.timer) {\r\n         window.clearTimeout(cellhandles.timer);\r\n         cellhandles.timer = null;\r\n         }\r\n      cellhandles.timer = window.setTimeout(SocialCalc.CellHandlesHoverTimeout, 3000);\r\n   }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// whichsegment = SocialCalc.SegmentDivHit(segtable, divWithMouseHit, x, y)\r\n//\r\n// Takes segtable = [upperleft quadrant, upperright, bottomright, bottomleft]\r\n//  where each quadrant is either:\r\n//      0 = ignore hits here\r\n//      number = return this value\r\n//      array = a new segtable for this subquadrant\r\n//\r\n// Alternatively, segtable can be:\r\n//  [radius 1, radius 2] and it returns 0 if no hit,\r\n//  -1, -2, -3, -4 for inner quadrants, and +1...+4 for outer quadrants\r\n//\r\n\r\nSocialCalc.SegmentDivHit = function(segtable, divWithMouseHit, x, y) {\r\n\r\n   var width = divWithMouseHit.offsetWidth;\r\n   var height = divWithMouseHit.offsetHeight;\r\n   var left = divWithMouseHit.offsetLeft;\r\n   var top = divWithMouseHit.offsetTop;\r\n   var v = 0;\r\n   var table = segtable;\r\n   var len = Math.sqrt(Math.pow(x-left-(width/2.0-.5), 2)+Math.pow(y-top-(height/2.0-.5), 2));\r\n\r\n   if (table.length==2) { // type 2 segtable\r\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\r\n         if (len <= segtable[0]) v = -1;\r\n         else if (len <= segtable[1]) v = 1;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\r\n         if (len <= segtable[0]) v = -2;\r\n         else if (len <= segtable[1]) v = 2;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\r\n         if (len <= segtable[0]) v = -3;\r\n         else if (len <= segtable[1]) v = 3;\r\n         }\r\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\r\n         if (len <= segtable[0]) v = -4;\r\n         else if (len <= segtable[1]) v = 4;\r\n         }\r\n      return v;\r\n      }\r\n\r\n   while (true) {\r\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\r\n         quadrant += \"1\";\r\n         v = table[0];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         height = height/2;\r\n         continue;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\r\n         quadrant += \"2\";\r\n         v = table[1];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         left = left+width;\r\n         height = height/2;\r\n         continue;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\r\n         quadrant += \"3\";\r\n         v = table[2];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         left = left + width;\r\n         height = height/2;\r\n         top = top + height;\r\n         continue;\r\n         }\r\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\r\n         quadrant += \"4\";\r\n         v = table[3];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         height = height/2;\r\n         top = top + height;\r\n         continue;\r\n         }\r\n      return 0; // didn't match\r\n      }\r\n\r\n//addmsg((x-divWithMouseHit.offsetLeft)+\",\"+(y-divWithMouseHit.offsetTop)+\"=\"+quadrant+\" \"+v);\r\n   return v;\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesHoverTimeout = function() {\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (cellhandles.timer) {\r\n      window.clearTimeout(cellhandles.timer);\r\n      cellhandles.timer = null;\r\n      }\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n   editor.cellhandles.ShowCellHandles(true, false); // hide move handles\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesTooltipsTimeout = function() {\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n\r\n   var whichhandle = cellhandles.tooltipswhichhandle;\r\n   if (whichhandle==0) { // off of active part of palette\r\n      SocialCalc.CellHandlesHoverTimeout();\r\n      return;\r\n      }\r\n   if (whichhandle==-3) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillAllTooltip;\r\n      }\r\n   else if (whichhandle==3) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillContentsTooltip;\r\n      }\r\n   else if (whichhandle==-2) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteAllTooltip;\r\n      }\r\n   else if (whichhandle==-4) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertAllTooltip;\r\n      }\r\n   else if (whichhandle==2) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteContentsTooltip;\r\n      }\r\n   else if (whichhandle==4) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertContentsTooltip;\r\n      }\r\n   else {\r\n      cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\r\n      cellhandles.dragtooltip.style.display = \"none\";\r\n      return;\r\n      }\r\n\r\n   cellhandles.dragtooltip.style.display = \"block\";\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesMouseDown = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n   if (editor.busy) return; // don't do anything when busy (is this correct?)\r\n\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   cellhandles.movedmouse = false; // detect no-op\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n\r\n   if (cellhandles.timer) { // cancel timer\r\n      window.clearTimeout(cellhandles.timer);\r\n      cellhandles.timer = null;\r\n      }\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n   cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\r\n   cellhandles.dragtooltip.style.display = \"none\";\r\n\r\n   range = editor.range;\r\n \r\n   var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\r\n   if (whichhandle==1 || whichhandle==-1 || whichhandle==0) {\r\n      cellhandles.ShowCellHandles(true, false); // hide move handles\r\n      return;\r\n      }\r\n\r\n   mouseinfo.ignore = true; // stop other code from looking at the mouse\r\n\r\n   if (whichhandle==-3) {\r\n      cellhandles.dragtype = \"Fill\";\r\n//      mouseinfo.element = editor.cellhandles.fillhandle;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==3) {\r\n      cellhandles.dragtype = \"FillC\";\r\n//      mouseinfo.element = editor.cellhandles.fillhandle;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==-2) {\r\n      cellhandles.dragtype = \"Move\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle1;\r\n      cellhandles.noCursorSuffix = true;\r\n      }\r\n   else if (whichhandle==-4) {\r\n      cellhandles.dragtype = \"MoveI\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle2;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==2) {\r\n      cellhandles.dragtype = \"MoveC\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle1;\r\n      cellhandles.noCursorSuffix = true;\r\n      }\r\n   else if (whichhandle==4) {\r\n      cellhandles.dragtype = \"MoveIC\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle2;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n\r\n   cellhandles.filltype = null;\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n         if (!range.hasrange) {\r\n            editor.RangeAnchor();\r\n            }\r\n         editor.range2.top = editor.range.top;\r\n         editor.range2.right = editor.range.right;\r\n         editor.range2.bottom = editor.range.bottom;\r\n         editor.range2.left = editor.range.left;\r\n         editor.range2.hasrange = true;\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveI\":\r\n      case \"MoveC\":\r\n      case \"MoveIC\":\r\n         if (!range.hasrange) {\r\n            editor.RangeAnchor();\r\n            }\r\n         editor.range2.top = editor.range.top;\r\n         editor.range2.right = editor.range.right;\r\n         editor.range2.bottom = editor.range.bottom;\r\n         editor.range2.left = editor.range.left;\r\n         editor.range2.hasrange = true;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      default:\r\n         return; // not for us\r\n      }\r\n\r\n   cellhandles.fillinghandle.style.left = (clientX)+\"px\";\r\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\r\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\r\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\r\n   cellhandles.fillinghandle.style.display = \"block\";\r\n\r\n   cellhandles.ShowCellHandles(true, false); // hide move handles\r\n   cellhandles.mouseDown = true;\r\n\r\n   mouseinfo.editor = editor; // remember for later\r\n\r\n   coord = editor.ecell.coord; // start with cell with handles\r\n\r\n   cellhandles.startingcoord = coord;\r\n   cellhandles.startingX = clientX;\r\n   cellhandles.startingY = clientY;\r\n\r\n   mouseinfo.mouselastcoord = coord;\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMove, true); // capture everywhere\r\n      document.addEventListener(\"mouseup\", SocialCalc.CellHandlesMouseUp, true); // capture everywhere\r\n      }\r\n   else if (cellhandles.draghandle.attachEvent) { // IE 5+\r\n      cellhandles.draghandle.setCapture();\r\n      cellhandles.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMove);\r\n      cellhandles.draghandle.attachEvent(\"onmouseup\", SocialCalc.CellHandlesMouseUp);\r\n      cellhandles.draghandle.attachEvent(\"onlosecapture\", SocialCalc.CellHandlesMouseUp);\r\n     }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseMove = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n   var crstart, crend, cr, c, r;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\r\n\r\n   if (!result) return;\r\n\r\n   if (result && !result.coord) {\r\n      SocialCalc.SetDragAutoRepeat(editor, result, SocialCalc.CellHandlesDragAutoRepeat);\r\n      return;\r\n      }\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result.coord) return;\r\n\r\n   crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\r\n   crend = SocialCalc.coordToCr(result.coord);\r\n\r\n\r\n   cellhandles.movedmouse = true; // did move, so not no-op\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n\r\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\r\n            cellhandles.filltype = null;\r\n            cellhandles.startingX = clientX;\r\n            cellhandles.startingY = clientY;\r\n            }\r\n         else {\r\n            if (cellhandles.filltype) { // moving and have already determined filltype\r\n               if (cellhandles.filltype==\"Down\") { // coerse to that\r\n                  crend.col = crstart.col;\r\n                  if (crend.row < crstart.row) crend.row = crstart.row;\r\n                  }\r\n               else {\r\n                  crend.row = crstart.row;\r\n                  if (crend.col < crstart.col) crend.col = crstart.col;\r\n                  }\r\n               }\r\n            else {\r\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\r\n                  cellhandles.filltype = \"Down\";\r\n                  }\r\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\r\n                  cellhandles.filltype = \"Right\";\r\n                  }\r\n               crend.col = crstart.col; // until decide, leave it at start\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            c = editor.range2.right - editor.range2.left + result.col;\r\n            r = editor.range2.bottom - editor.range2.top + result.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\r\n            cellhandles.filltype = null;\r\n            cellhandles.startingX = clientX;\r\n            cellhandles.startingY = clientY;\r\n            }\r\n         else {\r\n            if (cellhandles.filltype) { // moving and have already determined filltype\r\n               if (cellhandles.filltype==\"Vertical\") { // coerse to that\r\n                  crend.col = editor.range2.left;\r\n                  if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\r\n                  }\r\n               else {\r\n                  crend.row = editor.range2.top;\r\n                  if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\r\n                  }\r\n               }\r\n            else {\r\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\r\n                  cellhandles.filltype = \"Vertical\";\r\n                  }\r\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\r\n                  cellhandles.filltype = \"Horizontal\";\r\n                  }\r\n               crend.col = crstart.col; // until decide, leave it at start\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            if (!cellhandles.filltype) { // no fill type\r\n               editor.RangeRemove();\r\n               }\r\n            else {\r\n               c = editor.range2.right - editor.range2.left + crend.col;\r\n               r = editor.range2.bottom - editor.range2.top + crend.row;\r\n               editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n               editor.RangeExtend();\r\n               }\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n\r\n   cellhandles.fillinghandle.style.left = clientX+\"px\";\r\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\r\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\r\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\r\n   cellhandles.fillinghandle.style.display = \"block\";\r\n\r\n   mouseinfo.mouselastcoord = result.coord;\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n   }\r\n\r\nSocialCalc.CellHandlesDragAutoRepeat = function(coord, direction) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   var crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\r\n   var crend = SocialCalc.coordToCr(coord);\r\n\r\n   var newcoord, c, r;\r\n\r\n   var vscroll = 0;\r\n   var hscroll = 0;\r\n\r\n   if (direction == \"left\") hscroll = -1;\r\n   else if (direction == \"right\") hscroll = 1;\r\n   else if (direction == \"up\") vscroll = -1;\r\n   else if (direction == \"down\") vscroll = 1;\r\n   editor.ScrollRelativeBoth(vscroll, hscroll);\r\n\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n         if (cellhandles.filltype) { // moving and have already determined filltype\r\n            if (cellhandles.filltype==\"Down\") { // coerse to that\r\n               crend.col = crstart.col;\r\n               if (crend.row < crstart.row) crend.row = crstart.row;\r\n               }\r\n            else {\r\n               crend.row = crstart.row;\r\n               if (crend.col < crstart.col) crend.col = crstart.col;\r\n               }\r\n            }\r\n         else {\r\n            crend.col = crstart.col; // until decide, leave it at start\r\n            crend.row = crstart.row;\r\n            }\r\n\r\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (newcoord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(coord);\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         if (coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(coord);\r\n            c = editor.range2.right - editor.range2.left + editor.ecell.col;\r\n            r = editor.range2.bottom - editor.range2.top + editor.ecell.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         if (cellhandles.filltype) { // moving and have already determined filltype\r\n            if (cellhandles.filltype==\"Vertical\") { // coerse to that\r\n               crend.col = editor.range2.left;\r\n               if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\r\n               }\r\n            else {\r\n               crend.row = editor.range2.top;\r\n               if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\r\n               }\r\n            }\r\n         else {\r\n            crend.col = crstart.col; // until decide, leave it at start\r\n            crend.row = crstart.row;\r\n            }\r\n\r\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (newcoord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(newcoord);\r\n            c = editor.range2.right - editor.range2.left + crend.col;\r\n            r = editor.range2.bottom - editor.range2.top + crend.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n   mouseinfo.mouselastcoord = newcoord;\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseUp = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval, cstr, cmdtype, cmdtype2;\r\n   var crstart, crend;\r\n   var sizec, sizer, deltac, deltar;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   element = mouseinfo.element;\r\n\r\n   mouseinfo.ignore = false;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   cellhandles.mouseDown = false;\r\n   cellhandles.noCursorSuffix = false;\r\n\r\n   cellhandles.fillinghandle.style.display = \"none\";\r\n\r\n   if (!result) result = {};\r\n   if (!result.coord) result.coord = editor.ecell.coord;\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"Move\":\r\n      case \"MoveI\":\r\n         cmdtype2 = \" all\";\r\n            break;\r\n      case \"FillC\":\r\n      case \"MoveC\":\r\n      case \"MoveIC\":\r\n         cmdtype2 = \" formulas\";\r\n         break;\r\n      }\r\n\r\n   if (!cellhandles.movedmouse) { // didn't move: just leave one cell selected\r\n      cellhandles.dragtype = \"Nothing\";\r\n      }\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Nothing\":\r\n         editor.Range2Remove();\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n\r\n         crstart = SocialCalc.coordToCr(cellhandles.startingcoord);\r\n         crend = SocialCalc.coordToCr(result.coord);\r\n         if (cellhandles.filltype) {\r\n            if (cellhandles.filltype==\"Down\") {\r\n               crend.col = crstart.col;\r\n               }\r\n            else {\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n\r\n         editor.MoveECell(result.coord);\r\n         editor.RangeExtend();\r\n\r\n         if (editor.cellhandles.filltype==\"Right\") {\r\n            cmdtype = \"right\";\r\n            }\r\n         else {\r\n            cmdtype = \"down\";\r\n            }\r\n         cstr = \"fill\"+cmdtype+\" \"+SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                   \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom)+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         editor.context.cursorsuffix = \"\";\r\n         cstr = \"movepaste \"+\r\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n                     +\" \"+editor.ecell.coord+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         editor.Range2Remove();\r\n\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         editor.context.cursorsuffix = \"\";\r\n         sizec = editor.range2.right - editor.range2.left;\r\n         sizer = editor.range2.bottom - editor.range2.top;\r\n         deltac = editor.ecell.col - editor.range2.left;\r\n         deltar = editor.ecell.row - editor.range2.top;\r\n         cstr = \"moveinsert \"+\r\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n                     +\" \"+editor.ecell.coord+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         editor.Range2Remove();\r\n         editor.RangeRemove();\r\n         if (editor.cellhandles.filltype==\" Horizontal\" && deltac > 0) {\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col-sizec-1, editor.ecell.row));\r\n            }\r\n         else if (editor.cellhandles.filltype==\" Vertical\" && deltar > 0) {\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col, editor.ecell.row-sizer-1));\r\n            }\r\n         editor.RangeAnchor(SocialCalc.crToCoord(editor.ecell.col+sizec, editor.ecell.row+sizer));\r\n         editor.RangeExtend();\r\n\r\n         break;\r\n\r\n      }\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.CellHandlesMouseMove,\r\n\t\t\t\t    SocialCalc.CellHandlesMouseUp,\r\n\t\t\t\t    cellhandles.draghandle,\r\n\t\t\t\t    event);\r\n   mouseinfo.editor = null;\r\n   return false;\r\n   }\r\n\r\n// *************************************\r\n//\r\n// TableControl class:\r\n//\r\n// This class deals with the horizontal and verical scrollbars and pane sliders.\r\n//\r\n// +--------------+\r\n// | Endcap       |\r\n// +- - - - - - - +\r\n// |              |\r\n// +--------------+\r\n// | Pane Slider  |\r\n// +--------------+\r\n// |              |\r\n// | Less Button  |\r\n// |              |\r\n// +--------------+\r\n// | Scroll Area  |\r\n// |              |\r\n// |              |\r\n// +--------------+\r\n// | Thumb        |\r\n// +--------------+\r\n// |              |\r\n// +--------------+\r\n// |              |\r\n// | More Button  |\r\n// |              |\r\n// +--------------+\r\n//\r\n// *************************************\r\n\r\nSocialCalc.TableControl = function(editor, vertical, size) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n\r\n   this.vertical = vertical; // true if vertical control, false if horizontal\r\n   this.size = size; // length in pixels\r\n\r\n   this.main = null; // main element containing all the others\r\n   this.endcap = null; // the area at the top/left between the end and the pane slider\r\n   this.paneslider = null; // the slider to adjust the pane split\r\n   this.lessbutton = null; // the top/left scroll button\r\n   this.morebutton = null; // the bottom/right scroll button\r\n   this.scrollarea = null; // the area between the scroll buttons\r\n   this.thumb = null; // the sliding thing in the scrollarea\r\n\r\n   // computed position values:\r\n\r\n   this.controlborder = null; // left or top screen position for vertical or horizontal control\r\n   this.endcapstart = null; // top or left screen position for vertical or horizontal control\r\n   this.panesliderstart = null;\r\n   this.lessbuttonstart = null;\r\n   this.morebuttonstart = null;\r\n   this.scrollareastart = null;\r\n   this.scrollareaend = null;\r\n   this.scrollareasize = null;\r\n   this.thumbpos = null;\r\n\r\n   // constants:\r\n\r\n   this.controlthickness = scc.defaultTableControlThickness; // other dimension of complete control in pixels\r\n   this.sliderthickness = scc.defaultTCSliderThickness;\r\n   this.buttonthickness = scc.defaultTCButtonThickness;\r\n   this.thumbthickness = scc.defaultTCThumbThickness;\r\n   this.minscrollingpanesize = this.buttonthickness+this.buttonthickness+this.thumbthickness+20; // the 20 is to leave a little space\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.TableControl.prototype.CreateTableControl = function() {return SocialCalc.CreateTableControl(this);};\r\nSocialCalc.TableControl.prototype.PositionTableControlElements = function() {SocialCalc.PositionTableControlElements(this);};\r\nSocialCalc.TableControl.prototype.ComputeTableControlPositions = function() {SocialCalc.ComputeTableControlPositions(this);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.CreateTableControl = function(control) {\r\n\r\n   var s, functions, params;\r\n   var AssignID = SocialCalc.AssignID;\r\n   var setStyles = SocialCalc.setStyles;\r\n   var scc = SocialCalc.Constants;\r\n   var TooltipRegister = function(element, etype, vh) {\r\n      if (scc[\"s_\"+etype+\"Tooltip\"+vh]) {\r\n         SocialCalc.TooltipRegister(element, scc[\"s_\"+etype+\"Tooltip\"+vh], null, control.editor.toplevel);\r\n         }\r\n      }\r\n\r\n   var imageprefix = control.editor.imageprefix;\r\n   var vh = control.vertical ? \"v\" : \"h\";\r\n\r\n   control.main = document.createElement(\"div\");\r\n   s = control.main.style;\r\n   s.height = (control.vertical ? control.size : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.size)+\"px\";\r\n   s.zIndex = 0;\r\n   setStyles(control.main, scc.TCmainStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"main-\"+vh+\".gif)\";\r\n   if (scc.TCmainClass) control.main.className = scc.TCmainClass;\r\n\r\n   control.main.style.display=\"none\"; // wait for layout\r\n\r\n   control.endcap = document.createElement(\"div\");\r\n   s = control.endcap.style;\r\n   s.height = control.controlthickness+\"px\";\r\n   s.width = control.controlthickness+\"px\";\r\n   s.zIndex = 1;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.endcap, scc.TCendcapStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"endcap-\"+vh+\".gif)\";\r\n   if (scc.TCendcapClass) control.endcap.className = scc.TCendcapClass;\r\n   AssignID(control.editor, control.endcap, \"endcap\"+vh);\r\n\r\n   control.main.appendChild(control.endcap);\r\n\r\n   control.paneslider = document.createElement(\"div\");\r\n   s = control.paneslider.style;\r\n   s.height = (control.vertical ? control.sliderthickness : control.controlthickness)+\"px\";\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.width = (control.vertical ? control.controlthickness : control.sliderthickness)+\"px\";\r\n   s.position = \"absolute\";\r\n   s[control.vertical?\"top\":\"left\"] = \"4px\";\r\n   s.zIndex = 3;\r\n   s.backgroundImage=\"url(\"+imageprefix+\"paneslider-\"+vh+\".gif)\";\r\n   if (scc.TCpanesliderClass) control.paneslider.className = scc.TCpanesliderClass;\r\n   AssignID(control.editor, control.paneslider, \"paneslider\"+vh);\r\n   TooltipRegister(control.paneslider, \"paneslider\", vh);\r\n\r\n   functions = {MouseDown:SocialCalc.TCPSDragFunctionStart,\r\n                    MouseMove: SocialCalc.TCPSDragFunctionMove,\r\n                    MouseUp: SocialCalc.TCPSDragFunctionStop,\r\n                    Disabled: function() {return control.editor.busy;}};\r\n\r\n   functions.control = control; // make sure this is there\r\n\r\n   // Drag pane slider - every thing but app view\r\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.paneslider, control.vertical, !control.vertical, functions, control.editor.toplevel);\r\n\r\n   control.main.appendChild(control.paneslider);\r\n\r\n   control.lessbutton = document.createElement(\"div\");\r\n   s = control.lessbutton.style;\r\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.lessbutton, scc.TClessbuttonStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"less-\"+vh+\"n.gif)\"\r\n   if (scc.TClessbuttonClass) control.lessbutton.className = scc.TClessbuttonClass;\r\n   AssignID(control.editor, control.lessbutton, \"lessbutton\"+vh);\r\n\r\n   params = {repeatwait:scc.TClessbuttonRepeatWait, repeatinterval:scc.TClessbuttonRepeatInterval,\r\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"n.gif);\",\r\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"d.gif);\",\r\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"h.gif);\"};\r\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\r\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\r\n                Disabled: function() {return control.editor.busy;}};\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.lessbutton, params, functions);\r\n\r\n   control.main.appendChild(control.lessbutton);\r\n\r\n   control.morebutton = document.createElement(\"div\");\r\n   s = control.morebutton.style;\r\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.morebutton, scc.TCmorebuttonStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"more-\"+vh+\"n.gif)\"\r\n   if (scc.TCmorebuttonClass) control.morebutton.className = scc.TCmorebuttonClass;\r\n   AssignID(control.editor, control.morebutton, \"morebutton\"+vh);\r\n\r\n   params = {repeatwait:scc.TCmorebuttonRepeatWait, repeatinterval:scc.TCmorebuttonRepeatInterval,\r\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"n.gif);\",\r\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"d.gif);\",\r\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"h.gif);\"};\r\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\r\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\r\n                Disabled: function() {return control.editor.busy;}};\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.morebutton, params, functions);\r\n\r\n   control.main.appendChild(control.morebutton);\r\n\r\n   control.scrollarea = document.createElement(\"div\");\r\n   s = control.scrollarea.style;\r\n   s.height = control.controlthickness+\"px\";\r\n   s.width = control.controlthickness+\"px\";\r\n   s.zIndex = 1;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.scrollarea, scc.TCscrollareaStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"scrollarea-\"+vh+\".gif)\";\r\n   if (scc.TCscrollareaClass) control.scrollarea.className = scc.TCscrollareaClass;\r\n   AssignID(control.editor, control.scrollarea, \"scrollarea\"+vh);\r\n\r\n   params = {repeatwait:scc.TCscrollareaRepeatWait, repeatinterval:scc.TCscrollareaRepeatWait};\r\n   functions = {MouseDown:SocialCalc.ScrollAreaClick, Repeat:SocialCalc.ScrollAreaClick,\r\n                Disabled: function() {return control.editor.busy;}};\r\n   functions.control = control;\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.scrollarea, params, functions);\r\n\r\n   control.main.appendChild(control.scrollarea);\r\n\r\n   control.thumb = document.createElement(\"div\");\r\n   s = control.thumb.style;\r\n   s.height =  (control.vertical ? control.thumbthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.thumbthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.thumb, scc.TCthumbStyle);\r\n   control.thumb.style.backgroundImage=\"url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\";\r\n   if (scc.TCthumbClass) control.thumb.className = scc.TCthumbClass;\r\n   AssignID(control.editor, control.thumb, \"thumb\"+vh);\r\n\r\n   functions = {MouseDown:SocialCalc.TCTDragFunctionStart,\r\n                MouseMove: SocialCalc.TCTDragFunctionMove,\r\n                MouseUp: SocialCalc.TCTDragFunctionStop,\r\n                Disabled: function() {return control.editor.busy;}};\r\n   functions.control = control; // make sure this is there\r\n   \r\n   // Drag pane slider - every thing but app view\r\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.thumb, control.vertical, !control.vertical, functions, control.editor.toplevel);\r\n\r\n   params = {normalstyle: \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\", name:\"Thumb\",\r\n             downstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"d.gif)\",\r\n             hoverstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"h.gif)\"};\r\n   SocialCalc.ButtonRegister(control.editor, control.thumb, params, null); // give it button-like visual behavior\r\n\r\n   control.main.appendChild(control.thumb);\r\n\r\n   return control.main;\r\n\r\n}\r\n\r\n//\r\n// ScrollAreaClick - Button function to process pageup/down clicks\r\n//\r\n\r\nSocialCalc.ScrollAreaClick = function(e, buttoninfo, bobj) {\r\n\r\n   var control = bobj.functionobj.control;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(control.editor.toplevel);\r\n   var clickpos = control.vertical ? buttoninfo.clientY-pos.top : buttoninfo.clientX-pos.left;\r\n   if (control.editor.busy) { // ignore if busy - wait for next repeat\r\n      return;\r\n      }\r\n   control.editor.PageRelative(control.vertical, clickpos > control.thumbpos ? 1 : -1);\r\n\r\n   return;\r\n\r\n}\r\n\r\n//\r\n// PositionTableControlElements\r\n//\r\n\r\nSocialCalc.PositionTableControlElements = function(control) {\r\n\r\n   var border, realend, thumbpos;\r\n\r\n   var editor = control.editor;\r\n\r\n   if (control.vertical) {\r\n      border = control.controlborder+\"px\";\r\n      control.endcap.style.top = control.endcapstart+\"px\";\r\n      control.endcap.style.left = border;\r\n      control.paneslider.style.top = control.panesliderstart+\"px\";\r\n      control.paneslider.style.left = border\r\n      control.lessbutton.style.top = control.lessbuttonstart+\"px\";\r\n      control.lessbutton.style.left = border;\r\n      control.morebutton.style.top = control.morebuttonstart+\"px\";\r\n      control.morebutton.style.left = border;\r\n      control.scrollarea.style.top = control.scrollareastart+\"px\";\r\n      control.scrollarea.style.left = border;\r\n      control.scrollarea.style.height = control.scrollareasize+\"px\";\r\n      realend = Math.max(editor.context.sheetobj.attribs.lastrow, editor.firstscrollingrow+1);\r\n      thumbpos = ((editor.firstscrollingrow-(editor.lastnonscrollingrow+1))*(control.scrollareasize-3*control.thumbthickness))/\r\n         (realend-(editor.lastnonscrollingrow+1))+control.scrollareastart-1;\r\n      thumbpos = Math.floor(thumbpos);\r\n      control.thumb.style.top = thumbpos+\"px\";\r\n      control.thumb.style.left = border;\r\n      }\r\n   else {\r\n      border = control.controlborder+\"px\";\r\n      control.endcap.style.left = control.endcapstart+\"px\";\r\n      control.endcap.style.top = border;\r\n      control.paneslider.style.left = control.panesliderstart+\"px\";\r\n      control.paneslider.style.top = border\r\n      control.lessbutton.style.left = control.lessbuttonstart+\"px\";\r\n      control.lessbutton.style.top = border;\r\n      control.morebutton.style.left = control.morebuttonstart+\"px\";\r\n      control.morebutton.style.top = border;\r\n      control.scrollarea.style.left = control.scrollareastart+\"px\";\r\n      control.scrollarea.style.top = border;\r\n      control.scrollarea.style.width = control.scrollareasize+\"px\";\r\n      realend = Math.max(editor.context.sheetobj.attribs.lastcol, editor.firstscrollingcol+1);\r\n      thumbpos = ((editor.firstscrollingcol-(editor.lastnonscrollingcol+1))*(control.scrollareasize-control.thumbthickness))/\r\n         (realend-editor.lastnonscrollingcol)+control.scrollareastart-1;\r\n      thumbpos = Math.floor(thumbpos);\r\n      control.thumb.style.left = thumbpos+\"px\";\r\n      control.thumb.style.top = border;\r\n      }\r\n   control.thumbpos = thumbpos;\r\n   control.main.style.display=\"block\";\r\n\r\n   }\r\n\r\n//\r\n// ComputeTableControlPositions\r\n//\r\n// This routine computes the screen positions and other values needed for laying out\r\n// the table control elements.\r\n//\r\n\r\nSocialCalc.ComputeTableControlPositions = function(control) {\r\n\r\n   var editor = control.editor;\r\n\r\n   if (!editor.gridposition || !editor.headposition) throw(\"Can't compute table control positions before editor positions\");\r\n\r\n   if (control.vertical) {\r\n      control.controlborder = editor.gridposition.left+editor.tablewidth; // border=left position\r\n      control.endcapstart = editor.gridposition.top; // start=top position\r\n      control.panesliderstart = editor.firstscrollingrowtop-control.sliderthickness;\r\n      control.lessbuttonstart = editor.firstscrollingrowtop-1;\r\n      control.morebuttonstart = editor.gridposition.top+editor.tableheight-control.buttonthickness;\r\n      control.scrollareastart = editor.firstscrollingrowtop-1+control.buttonthickness;\r\n      control.scrollareaend = control.morebuttonstart-1;\r\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\r\n      }\r\n   else {\r\n      control.controlborder = editor.gridposition.top+editor.tableheight; // border=top position\r\n      control.endcapstart = editor.gridposition.left; // start=left position\r\n      control.panesliderstart = editor.firstscrollingcolleft-control.sliderthickness;\r\n      control.lessbuttonstart = editor.firstscrollingcolleft-1;\r\n      control.morebuttonstart = editor.gridposition.left+editor.tablewidth-control.buttonthickness;\r\n      control.scrollareastart = editor.firstscrollingcolleft-1+control.buttonthickness;\r\n      control.scrollareaend = control.morebuttonstart-1;\r\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\r\n      }\r\n   }\r\n\r\n////// TCPS - TableControl Pan Slider methods\r\n\r\n//\r\n// TCPSDragFunctionStart(event, draginfo, dobj)\r\n//\r\n// TableControlPaneSlider function for starting drag\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var editor = dobj.functionobj.control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\r\n\r\n   draginfo.trackingline = document.createElement(\"div\");\r\n   draginfo.trackingline.style.height = dobj.vertical ? scc.TCPStrackinglineThickness :\r\n      (editor.tableheight-(editor.headposition.top-editor.gridposition.top))+\"px\";\r\n   draginfo.trackingline.style.width = dobj.vertical ? \r\n      (editor.tablewidth-(editor.headposition.left-editor.gridposition.left))+\"px\" : scc.TCPStrackinglineThickness;\r\n   draginfo.trackingline.style.backgroundImage=\"url(\"+editor.imageprefix+\"trackingline-\"+(dobj.vertical?\"v\":\"h\")+\".gif)\";;\r\n   if (scc.TCPStrackinglineClass) draginfo.trackingline.className = scc.TCPStrackinglineClass;\r\n   SocialCalc.setStyles(draginfo.trackingline, scc.TCPStrackinglineStyle);\r\n\r\n   if (dobj.vertical) {\r\n      row = SocialCalc.Lookup(draginfo.clientY+dobj.functionobj.control.sliderthickness, editor.rowpositions);\r\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\r\n      draginfo.trackingline.style.left = editor.headposition.left+\"px\";\r\n      draginfo.trackingline.id = 'trackingline-vertical';\r\n      if (editor.context.rowpanes.length-1) { // has 2 already\r\n         editor.context.SetRowPaneFirstLast(1, editor.context.rowpanes[0].last+1, editor.context.rowpanes[0].last+1);\r\n         editor.FitToEditTable();\r\n         editor.ScheduleRender();\r\n         }\r\n      }\r\n   else {\r\n      col = SocialCalc.Lookup(draginfo.clientX+dobj.functionobj.control.sliderthickness, editor.colpositions);\r\n      draginfo.trackingline.style.top = editor.headposition.top+\"px\";\r\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\r\n      draginfo.trackingline.id = 'trackingline-horizon';\r\n      if (editor.context.colpanes.length-1) { // has 2 already\r\n         editor.context.SetColPaneFirstLast(1, editor.context.colpanes[0].last+1, editor.context.colpanes[0].last+1);\r\n         editor.FitToEditTable();\r\n         editor.ScheduleRender();\r\n         }\r\n      }\r\n\r\n   editor.griddiv.appendChild(draginfo.trackingline);\r\n\r\n   }\r\n\r\n//\r\n// TCPSDragFunctionMove(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionMove = function(event, draginfo, dobj) {\r\n\r\n   var row, col, max, min;\r\n   var control = dobj.functionobj.control;\r\n   var sliderthickness = control.sliderthickness;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\r\n      if (draginfo.clientY > max) draginfo.clientY = max;\r\n      min = editor.headposition.top - sliderthickness - draginfo.offsetY;\r\n      if (draginfo.clientY < min) draginfo.clientY = min;\r\n\r\n      row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\r\n\r\n      // Handle hidden row.\r\n      while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n         row++;\r\n         }\r\n\r\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\r\n      }\r\n   else {\r\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\r\n      if (draginfo.clientX > max) draginfo.clientX = max;\r\n      min = editor.headposition.left - sliderthickness - draginfo.offsetX;\r\n      if (draginfo.clientX < min) draginfo.clientX = min;\r\n\r\n      col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\r\n\r\n      // Handle hidden column.\r\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n         col++;\r\n         }\r\n\r\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\r\n      }\r\n\r\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\r\n\r\n   }\r\n\r\n//\r\n// TCPSDragFunctionStop(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionStop = function(event, draginfo, dobj) {\r\n\r\n   var row, col, max, min, dc;\r\n   var control = dobj.functionobj.control;\r\n   var sliderthickness = control.sliderthickness;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\r\n     if (draginfo.clientY > max) draginfo.clientY = max;\r\n     min = editor.headposition.top - sliderthickness - draginfo.offsetY;\r\n     if (draginfo.clientY < min) draginfo.clientY = min;\r\n\r\n     row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\r\n     if (row>editor.context.sheetobj.attribs.lastrow) row=editor.context.sheetobj.attribs.lastrow; // can't extend sheet here\r\n\r\n     // Handle hidden row.\r\n     while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n       row++;\r\n     }\r\n\r\n\r\n     editor.EditorScheduleSheetCommands('pane row ' + row, true, false);\r\n   }\r\n   else {\r\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\r\n     if (draginfo.clientX > max) draginfo.clientX = max;\r\n     min = editor.headposition.left - sliderthickness - draginfo.offsetX;\r\n     if (draginfo.clientX < min) draginfo.clientX = min;\r\n\r\n     col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\r\n     if (col>editor.context.sheetobj.attribs.lastcol) col=editor.context.sheetobj.attribs.lastcol; // can't extend sheet here\r\n\r\n     // Handle hidden column.\r\n     while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n       col++;\r\n     }\r\n\r\n     editor.EditorScheduleSheetCommands('pane col ' + col, true, false);\r\n   }\r\n\r\n   }\r\n\r\n////// TCT - TableControl Thumb methods\r\n\r\n//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that\r\n//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to\r\n//!!!!       ComputeTableControlPositions calculations.\r\n\r\n//\r\n// TCTDragFunctionStart(event, draginfo, dobj)\r\n//\r\n// TableControlThumb function for starting drag\r\n//\r\n\r\nSocialCalc.TCTDragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var rowpane, colpane, row, col;\r\n\r\n   var control = dobj.functionobj.control;\r\n   var editor = control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\r\n\r\n   if (draginfo.thumbstatus) { // get rid of old one if mouseup was out of window\r\n      if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\r\n      if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\r\n      editor.toplevel.removeChild(draginfo.thumbstatus);\r\n      draginfo.thumbstatus = null;\r\n      }\r\n\r\n   draginfo.thumbstatus = document.createElement(\"div\");\r\n\r\n   if (dobj.vertical) {\r\n      if (scc.TCTDFSthumbstatusvClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatusvClass;\r\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatusvStyle);\r\n      draginfo.thumbstatus.style.top = (draginfo.clientY+scc.TCTDFStopOffsetv)+\"px\";\r\n      draginfo.thumbstatus.style.left = (control.controlborder-10-(editor.tablewidth/2))+\"px\";\r\n      draginfo.thumbstatus.style.width = (editor.tablewidth/2)+\"px\";\r\n\r\n      draginfo.thumbcontext = new SocialCalc.RenderContext(editor.context.sheetobj);\r\n      draginfo.thumbcontext.showGrid = true;\r\n      draginfo.thumbcontext.rowpanes = [{first: 1, last: 1}];\r\n      var pane = editor.context.colpanes[editor.context.colpanes.length-1];\r\n      draginfo.thumbcontext.colpanes = [{first: pane.first, last: pane.last}];\r\n      draginfo.thumbstatus.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td valign=\"top\" style=\"'+\r\n        scc.TCTDFSthumbstatusrownumStyle+'\" class=\"'+scc.TCTDFSthumbstatusrownumClass+\r\n        '\"><div>msg</div></td><td valign=\"top\"><div style=\"overflow:hidden;\">preview</div></td></tr></table>';\r\n      draginfo.thumbstatus.rowmsgele = draginfo.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;\r\n      draginfo.thumbstatus.rowpreviewele = draginfo.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;\r\n      editor.toplevel.appendChild(draginfo.thumbstatus);\r\n      SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, editor.firstscrollingrow || 1);\r\n      }\r\n   else {\r\n      if (scc.TCTDFSthumbstatushClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatushClass;\r\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatushStyle);\r\n      draginfo.thumbstatus.style.top = (control.controlborder+scc.TCTDFStopOffseth)+\"px\";\r\n      draginfo.thumbstatus.style.left = (draginfo.clientX+scc.TCTDFSleftOffseth)+\"px\";\r\n      editor.toplevel.appendChild(draginfo.thumbstatus);\r\n      draginfo.thumbstatus.innerHTML = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(editor.firstscrollingcol);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, row)\r\n//\r\n// Render partial row\r\n//\r\n\r\nSocialCalc.TCTDragFunctionRowSetStatus = function(draginfo, editor, row) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var msg = scc.s_TCTDFthumbstatusPrefixv+row+\" \";\r\n\r\n   draginfo.thumbstatus.rowmsgele.innerHTML = msg;\r\n\r\n   draginfo.thumbcontext.rowpanes = [{first: row, last: row}];\r\n   draginfo.thumbrowshown = row;\r\n\r\n   var ele = draginfo.thumbcontext.RenderSheet(draginfo.thumbstatus.rowpreviewele.firstChild, {type: \"html\"});\r\n\r\n   }\r\n\r\n\r\n//\r\n// TCTDragFunctionMove(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCTDragFunctionMove = function(event, draginfo, dobj) {\r\n\r\n   var first, msg;\r\n   var control = dobj.functionobj.control;\r\n   var thumbthickness = control.thumbthickness;\r\n   var editor = control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   if (dobj.vertical) {\r\n      if (draginfo.clientY > control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2)\r\n         draginfo.clientY = control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2;\r\n      if (draginfo.clientY < control.scrollareastart - draginfo.offsetY - 1)\r\n         draginfo.clientY = control.scrollareastart - draginfo.offsetY - 1;\r\n      draginfo.thumbstatus.style.top = draginfo.clientY+\"px\";\r\n\r\n      first =\r\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\r\n         + editor.lastnonscrollingrow + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\r\n//      msg = scc.s_TCTDFthumbstatusPrefixv+first;\r\n      if (first != draginfo.thumbrowshown) {\r\n         SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, first);\r\n         }\r\n      }\r\n   else {\r\n      if (draginfo.clientX > control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2)\r\n         draginfo.clientX = control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2;\r\n      if (draginfo.clientX < control.scrollareastart - draginfo.offsetX - 1)\r\n         draginfo.clientX = control.scrollareastart - draginfo.offsetX - 1;\r\n      draginfo.thumbstatus.style.left = draginfo.clientX+\"px\";\r\n\r\n      first =\r\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\r\n         + editor.lastnonscrollingcol + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\r\n      msg = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(first);\r\n      draginfo.thumbstatus.innerHTML = msg;\r\n      }\r\n\r\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\r\n\r\n   }\r\n\r\n//\r\n// TCTDragFunctionStop(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCTDragFunctionStop = function(event, draginfo, dobj) {\r\n\r\n   var first;\r\n   var control = dobj.functionobj.control;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n      first =\r\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\r\n         + editor.lastnonscrollingrow + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\r\n\r\n      editor.context.SetRowPaneFirstLast(editor.context.rowpanes.length-1, first, first+1);\r\n      }\r\n   else {\r\n      first =\r\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\r\n         + editor.lastnonscrollingcol + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\r\n\r\n      editor.context.SetColPaneFirstLast(editor.context.colpanes.length-1, first, first+1);\r\n      }\r\n\r\n   editor.FitToEditTable();\r\n\r\n   if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\r\n   if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\r\n   editor.toplevel.removeChild(draginfo.thumbstatus);\r\n   draginfo.thumbstatus = null;\r\n\r\n   editor.ScheduleRender();\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Dragging functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.DragInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one dragging operation can be active at a time.\r\n   // The registeredElements array is used to decide which item to drag.\r\n \r\n   // One item for each draggable thing, each an object with:\r\n   //    .element, .vertical, .horizontal, .functionobj, .parent\r\n\r\n   registeredElements: [],\r\n\r\n   // Items used during a drag\r\n\r\n   draggingElement: null, // item being processed (.element is the actual element)\r\n   startX: 0,\r\n   startY: 0,\r\n   startZ: 0,\r\n   clientX: 0, // modifyable version to restrict movement\r\n   clientY: 0,\r\n   offsetX: 0,\r\n   offsetY: 0,\r\n   relativeOffset: {left:0,top:0} // retrieved at drag start\r\n\r\n   }\r\n\r\n//\r\n// DragRegister(element, vertical, horizontal, functionobj, parent) - make element draggable\r\n//\r\n// The functionobj defaults to moving the element contrained only by vertical and horizontal settings.\r\n//\r\n\r\nSocialCalc.DragRegister = function(element, vertical, horizontal, functionobj, parent) {\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   if (!functionobj) {\r\n      functionobj = {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\r\n                     MouseUp: SocialCalc.DragFunctionPosition,\r\n                     Disabled: null};\r\n      }\r\n\r\n   draginfo.registeredElements.push(\r\n      {element: element, vertical: vertical, horizontal: horizontal, functionobj: functionobj, parent: parent}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// DragUnregister(element) - remove object from list\r\n//\r\n\r\nSocialCalc.DragUnregister = function(element) {\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   var i;\r\n\r\n   if (!element) return;\r\n\r\n   for (i=0; i<draginfo.registeredElements.length; i++) {\r\n      if (draginfo.registeredElements[i].element == element) {\r\n         draginfo.registeredElements.splice(i,1);\r\n         if (element.removeEventListener) { // DOM Level 2 -- Firefox, et al\r\n            element.removeEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\r\n            }\r\n         else { // IE 5+\r\n            element.detachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\r\n            }\r\n         return;\r\n         }\r\n      }\r\n\r\n   return; // ignore if not in list\r\n\r\n   }\r\n\r\n//\r\n// DragMouseDown(event)\r\n//\r\n\r\nSocialCalc.DragMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   var dobj = SocialCalc.LookupElement(e.target || e.srcElement, draginfo.registeredElements);\r\n   if (!dobj) return;\r\n\r\n   if (dobj && dobj.functionobj && dobj.functionobj.Disabled) {\r\n      if (dobj.functionobj.Disabled(e, draginfo, dobj)) {\r\n         return;\r\n         }\r\n      }\r\n\r\n   draginfo.draggingElement = dobj;\r\n   if (dobj.parent) {\r\n      draginfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(dobj.parent);\r\n      }\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n   draginfo.startX = draginfo.clientX;\r\n   draginfo.startY = draginfo.clientY;\r\n   draginfo.startZ = dobj.element.style.zIndex;\r\n   draginfo.offsetX = 0;\r\n   draginfo.offsetY = 0;\r\n\r\n   dobj.element.style.zIndex = \"100\";\r\n   SocialCalc.SetMouseMoveUp(SocialCalc.DragMouseMove,\r\n\t\t\t     SocialCalc.DragMouseUp,\r\n\t\t\t     dobj.element,\r\n\t\t\t     e);\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseDown) dobj.functionobj.MouseDown(e, draginfo, dobj);\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n//\r\n// DragMouseMove(event)\r\n//\r\n\r\nSocialCalc.DragMouseMove = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n   var dobj = draginfo.draggingElement;\r\n\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n   SocialCalc.StopPropagation(e);\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseMove) dobj.functionobj.MouseMove(e, draginfo, dobj);\r\n   return false;\r\n   }\r\n\r\n//\r\n// DragMouseUp(event)\r\n//\r\n\r\nSocialCalc.DragMouseUp = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n   var dobj = draginfo.draggingElement;\r\n\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n\r\n   dobj.element.style.zIndex = draginfo.startZ;\r\n\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseUp) dobj.functionobj.MouseUp(e, draginfo, dobj);\r\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.DragMouseMove,\r\n\t\t\t\tSocialCalc.DragMouseUp,\r\n\t\t\t\tdobj.element, e);\r\n   draginfo.draggingElement = null;\r\n   return false;\r\n   }\r\n\r\n//\r\n// DragFunctionStart(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.DragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var element = dobj.functionobj.positionobj || dobj.element;\r\n\r\n   draginfo.offsetY = parseInt(element.style.top) - draginfo.clientY;\r\n   draginfo.offsetX = parseInt(element.style.left) - draginfo.clientX;\r\n\r\n   }\r\n\r\n//\r\n// DragFunctionPosition(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.DragFunctionPosition = function(event, draginfo, dobj) {\r\n\r\n   var element = dobj.functionobj.positionobj || dobj.element;\r\n\r\n   if (dobj.vertical) element.style.top = (draginfo.clientY + draginfo.offsetY)+\"px\";\r\n   if (dobj.horizontal) element.style.left = (draginfo.clientX + draginfo.offsetX)+\"px\";\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Tooltip functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.TooltipInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one tooltip operation can be active at a time.\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each element with a tooltip, each an object with:\r\n   //    .element, .tiptext, .functionobj, .parent\r\n   // Currently .functionobj can only contain .offsetx and .offsety.\r\n   // If present they are used instead of the default ones.\r\n\r\n   registeredElements: [],\r\n\r\n   registered: false, // if true, an event handler has been registered for this functionality\r\n\r\n   // Items used during hover over an element\r\n\r\n   tooltipElement: null, // item being processed (.element is the actual element)\r\n   timer: null, // timer object waiting to see if holding over element\r\n   popupElement: null, // tooltip element being displayed\r\n   clientX: 0, // modifyable version to restrict movement\r\n   clientY: 0,\r\n   offsetX: SocialCalc.Constants.TooltipOffsetX, // modifyable version to allow positioning\r\n   offsetY: SocialCalc.Constants.TooltipOffsetY\r\n\r\n   }\r\n\r\n//\r\n// TooltipRegister(element, tiptext, functionobj, parent) - make element have a tooltip\r\n//\r\n\r\nSocialCalc.TooltipRegister = function(element, tiptext, functionobj, parent) {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n   tooltipinfo.registeredElements.push(\r\n      {element: element, tiptext: tiptext, functionobj: functionobj, parent: parent}\r\n      );\r\n\r\n   if (tooltipinfo.registered) return; // only need to add event listener once\r\n\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", SocialCalc.TooltipMouseMove, false);\r\n      }\r\n   else if (document.attachEvent) { // IE 5+\r\n      document.attachEvent(\"onmousemove\", SocialCalc.TooltipMouseMove);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   tooltipinfo.registered = true; // remember\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipMouseMove(event)\r\n//\r\n\r\nSocialCalc.TooltipMouseMove = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   tooltipinfo.clientX = e.clientX;\r\n   tooltipinfo.clientY = e.clientY;\r\n\r\n   var tobj = SocialCalc.LookupElement(e.target || e.srcElement, tooltipinfo.registeredElements);\r\n\r\n   if (tooltipinfo.timer) { // waiting to see if holding still: didn't hold still\r\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\r\n      tooltipinfo.timer = null;\r\n      }\r\n\r\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\r\n      SocialCalc.TooltipHide();\r\n      }\r\n\r\n   tooltipinfo.tooltipElement = tobj || null;\r\n\r\n   if (!tobj || SocialCalc.ButtonInfo.buttonDown) return; // if not an object with a tip or a \"button\" is down, ignore\r\n\r\n   tooltipinfo.timer = window.setTimeout(SocialCalc.TooltipWaitDone, 700);\r\n\r\n   if (tooltipinfo.tooltipElement.element.addEventListener) { // Register event for mouse down which cancels tooltip stuff\r\n      tooltipinfo.tooltipElement.element.addEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\r\n      }\r\n   else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE\r\n      tooltipinfo.tooltipElement.element.attachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipMouseDown(event)\r\n//\r\n\r\nSocialCalc.TooltipMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   if (tooltipinfo.timer) {\r\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\r\n      tooltipinfo.timer = null;\r\n      }\r\n\r\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\r\n      SocialCalc.TooltipHide();\r\n      }\r\n\r\n   if (tooltipinfo.tooltipElement) {\r\n      if (tooltipinfo.tooltipElement.element.removeEventListener) { // DOM Level 2 -- Firefox, et al\r\n         tooltipinfo.tooltipElement.element.removeEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\r\n         }\r\n      else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE 5+\r\n         tooltipinfo.tooltipElement.element.detachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\r\n         }\r\n      tooltipinfo.tooltipElement = null;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipDisplay(tobj)\r\n//\r\n\r\nSocialCalc.TooltipDisplay = function(tobj) {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n   var scc = SocialCalc.Constants;\r\n   var offsetX = (tobj.functionobj && ((typeof tobj.functionobj.offsetx) == \"number\")) ? \r\n      tobj.functionobj.offsetx : tooltipinfo.offsetX;\r\n   var offsetY = (tobj.functionobj && ((typeof tobj.functionobj.offsety) == \"number\")) ? \r\n      tobj.functionobj.offsety : tooltipinfo.offsetY;\r\n   var viewport = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(tobj.parent);\r\n\r\n   tooltipinfo.popupElement = document.createElement(\"div\");\r\n   if (scc.TDpopupElementClass) tooltipinfo.popupElement.className = scc.TDpopupElementClass;\r\n   SocialCalc.setStyles(tooltipinfo.popupElement, scc.TDpopupElementStyle);\r\n\r\n   tooltipinfo.popupElement.innerHTML = tobj.tiptext;\r\n\r\n   if (tooltipinfo.clientX > viewport.width/2) { // on right side of screen\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\r\n      tooltipinfo.popupElement.style.right = (pos.width - tooltipinfo.clientX + offsetX + pos.left)+\"px\";\r\n      }\r\n   else { // on left side of screen\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\r\n      tooltipinfo.popupElement.style.left = (tooltipinfo.clientX + offsetX - pos.left)+\"px\";\r\n      }\r\n\r\n   if (tooltipinfo.clientY < 50) { // make sure fits on screen if nothing above grid\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY - 50 + pos.top)+\"px\";\r\n      }\r\n\r\n   tobj.parent.appendChild(tooltipinfo.popupElement);\r\n\r\n   }\r\n\r\n//\r\n// TooltipHide()\r\n//\r\n\r\nSocialCalc.TooltipHide = function() {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   if (tooltipinfo.popupElement) {\r\n      tooltipinfo.popupElement.parentNode.removeChild(tooltipinfo.popupElement);\r\n      tooltipinfo.popupElement = null;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// TooltipWaitDone()\r\n//\r\n\r\nSocialCalc.TooltipWaitDone = function() {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   tooltipinfo.timer = null;\r\n\r\n   SocialCalc.TooltipDisplay(tooltipinfo.tooltipElement);\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Button functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.ButtonInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one button operation can be active at a time.\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each clickable element, each an object with:\r\n   //    .element, .normalstyle, .hoverstyle, .downstyle, .repeatinterval, .functionobj, .editor\r\n   //\r\n   // .functionobj is an object with optional function objects for:\r\n   //    mouseover, mouseout, mousedown, repeatinterval, mouseup, disabled\r\n\r\n   registeredElements: [],\r\n\r\n   // Items used during hover over an element, clicking, repeating, etc.\r\n\r\n   buttonElement: null, // item being processed, hover or down (.element is the actual element)\r\n   doingHover: false, // true if mouse is over one of our elements\r\n   buttonDown: false, // true if button down and buttonElement not null\r\n   timer: null, // timer object for repeating\r\n\r\n   // Used while processing an event\r\n\r\n   relativeOffset: null,\r\n   clientX: 0,\r\n   clientY: 0\r\n\r\n   }\r\n\r\n//\r\n// ButtonRegister(editor, element, paramobj, functionobj) - make element clickable\r\n//\r\n// The arguments (other than editor and element) may be null (meaning no change for style and no repeat)\r\n// The paramobj has the optional normalstyle, hoverstyle, downstyle, repeatwait, repeatinterval settings\r\n\r\nSocialCalc.ButtonRegister = function(editor, element, paramobj, functionobj) {\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   if (!paramobj) paramobj = {};\r\n\r\n   buttoninfo.registeredElements.push(\r\n      {name: paramobj.name, element: element, editor: editor,\r\n       normalstyle: paramobj.normalstyle, hoverstyle: paramobj.hoverstyle, downstyle: paramobj.downstyle,\r\n       repeatwait: paramobj.repeatwait, repeatinterval: paramobj.repeatinterval, functionobj: functionobj}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.ButtonMouseDown, false);\r\n      element.addEventListener(\"mouseover\", SocialCalc.ButtonMouseOver, false);\r\n      element.addEventListener(\"mouseout\", SocialCalc.ButtonMouseOut, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.ButtonMouseDown);\r\n      element.attachEvent(\"onmouseover\", SocialCalc.ButtonMouseOver);\r\n      element.attachEvent(\"onmouseout\", SocialCalc.ButtonMouseOut);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   return;\r\n   }\r\n\r\n//\r\n// ButtonMouseOver(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseOver = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (!bobj) return;\r\n\r\n   if (buttoninfo.buttonDown) {\r\n      if (buttoninfo.buttonElement==bobj) {\r\n         buttoninfo.doingHover = true; // keep track whether we are on the pressed button or not\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (buttoninfo.buttonElement &&\r\n          buttoninfo.buttonElement!=bobj && buttoninfo.doingHover) { // moved to a new one, undo hover there\r\n      SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\r\n      }\r\n\r\n   buttoninfo.buttonElement = bobj; // remember this one is hovering\r\n   buttoninfo.doingHover = true;\r\n\r\n   SocialCalc.setStyles(bobj.element, bobj.hoverstyle); // set style (if provided)\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOver) bobj.functionobj.MouseOver(e, buttoninfo, bobj);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseOut(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseOut = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   if (buttoninfo.buttonDown) {\r\n      buttoninfo.doingHover = false; // keep track of overs and outs\r\n      return;\r\n      }\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (buttoninfo.doingHover) { // if there was a hover, undo it\r\n      if (buttoninfo.buttonElement)\r\n         SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\r\n      buttoninfo.buttonElement = null;\r\n      buttoninfo.doingHover = false;\r\n      }\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOut) bobj.functionobj.MouseOut(e, buttoninfo, bobj);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseDown(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   var viewportinfo = SocialCalc.GetViewportInfo();\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (!bobj) return; // not one of our elements\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.Disabled) {\r\n      if (bobj.functionobj.Disabled(e, buttoninfo, bobj)) {\r\n         return;\r\n         }\r\n      }\r\n\r\n   buttoninfo.buttonElement = bobj;\r\n   buttoninfo.buttonDown = true;\r\n\r\n   SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.downstyle);\r\n\r\n   // Register event handler for mouse up\r\n\r\n   // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true); // capture everywhere\r\n      }\r\n   else if (bobj.element.attachEvent) { // IE 5+\r\n      bobj.element.setCapture();\r\n      bobj.element.attachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.attachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\r\n      }\r\n   SocialCalc.StopPropagation(e);\r\n   buttoninfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(bobj.editor.toplevel);\r\n   buttoninfo.clientX = e.clientX - buttoninfo.relativeOffset.left;\r\n   buttoninfo.clientY = e.clientY - buttoninfo.relativeOffset.top;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseDown) bobj.functionobj.MouseDown(e, buttoninfo, bobj);\r\n\r\n   if (bobj.repeatwait) { // if a repeat wait is set, then starting waiting for first repetition\r\n      buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatwait);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseUp(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseUp = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n   var bobj = buttoninfo.buttonElement;\r\n\r\n   if (buttoninfo.timer) { // if repeating, cancel it\r\n      window.clearTimeout(buttoninfo.timer); // cancel timer\r\n      buttoninfo.timer = null;\r\n      }\r\n\r\n   if (!buttoninfo.buttonDown) return; // already did this (e.g., in IE, releaseCapture fires losecapture)\r\n   SocialCalc.StopPropagation(e);\r\n   if (document.removeEventListener) { // DOM Level 2\r\n      document.removeEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true);\r\n      }\r\n   else if (document.detachEvent) { // IE\r\n      bobj.element.detachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.detachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.releaseCapture();\r\n      }\r\n\r\n   if (buttoninfo.buttonElement.downstyle) {\r\n      if (buttoninfo.doingHover)\r\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.hoverstyle);\r\n      else\r\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.normalstyle);\r\n      }\r\n\r\n   buttoninfo.buttonDown = false;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseUp) bobj.functionobj.MouseUp(e, buttoninfo, bobj);\r\n\r\n   }\r\n\r\n//\r\n// ButtonRepeat()\r\n//\r\n\r\nSocialCalc.ButtonRepeat = function() {\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n   var bobj = buttoninfo.buttonElement;\r\n\r\n   if (!bobj) return;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.Repeat) bobj.functionobj.Repeat(null, buttoninfo, bobj);\r\n\r\n   buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatinterval || 100);\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// MouseWheel functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.MouseWheelInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // The mousewheel only affects the one area the mouse pointer is over\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each element to respond to the mousewheel, each an object with:\r\n   //    .element, .functionobj\r\n\r\n   registeredElements: []\r\n\r\n   }\r\n\r\n//\r\n// MouseWheelRegister(element, functionobj) - make element respond to mousewheel\r\n//\r\n\r\nSocialCalc.MouseWheelRegister = function(element, functionobj) {\r\n\r\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\r\n\r\n   mousewheelinfo.registeredElements.push(\r\n      {element: element, functionobj: functionobj}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"DOMMouseScroll\", SocialCalc.ProcessMouseWheel, false);\r\n      element.addEventListener(\"mousewheel\", SocialCalc.ProcessMouseWheel, false); // Opera needs this\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousewheel\", SocialCalc.ProcessMouseWheel);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.ProcessMouseWheel = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var delta;\r\n\r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n\r\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var wobj;\r\n\r\n   for (wobj=null; !wobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      wobj = SocialCalc.LookupElement(ele, mousewheelinfo.registeredElements);\r\n      }\r\n   if (!wobj) return; // not one of our elements\r\n\r\n   if (event.wheelDelta) {\r\n      delta = event.wheelDelta/120;\r\n      }\r\n   else delta = -event.detail/3;\r\n   if (!delta) delta = 0;\r\n\r\n   if (wobj.functionobj && wobj.functionobj.WheelMove) wobj.functionobj.WheelMove(event, delta, mousewheelinfo, wobj);\r\n\r\n   if (event.preventDefault) event.preventDefault();\r\n   event.returnValue = false;\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Keyboard functions:\r\n//\r\n// For more information about keyboard handling, see: http://unixpapa.com/js/key.html\r\n//\r\n// *************************************\r\n\r\nSocialCalc.keyboardTables = {\r\n\r\n   specialKeysCommon: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   specialKeysIE: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysIE: {\r\n      67: \"[ctrl-c]\",\r\n      83: \"[ctrl-s]\",\r\n      86: \"[ctrl-v]\",\r\n      88: \"[ctrl-x]\",\r\n      90: \"[ctrl-z]\"\r\n      },\r\n\r\n   specialKeysOpera: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n      45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n      46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n      113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysOpera: {\r\n      67: \"[ctrl-c]\",\r\n      83: \"[ctrl-s]\",\r\n      86: \"[ctrl-v]\",\r\n      88: \"[ctrl-x]\",\r\n      90: \"[ctrl-z]\"\r\n      },\r\n\r\n   specialKeysSafari: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n      63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n      63277: \"[pgdn]\", 63237: \"[f2]\"\r\n      },\r\n\r\n   controlKeysSafari: {\r\n      99: \"[ctrl-c]\",\r\n      115: \"[ctrl-s]\",\r\n      118: \"[ctrl-v]\",\r\n      120: \"[ctrl-x]\",\r\n      122: \"[ctrl-z]\"\r\n      },\r\n\r\n   ignoreKeysSafari: {\r\n      63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n      63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n      },\r\n\r\n   specialKeysFirefox: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysFirefox: {\r\n      99: \"[ctrl-c]\",\r\n      115: \"[ctrl-s]\",\r\n      118: \"[ctrl-v]\",\r\n      120: \"[ctrl-x]\",\r\n      122: \"[ctrl-z]\"\r\n      },\r\n\r\n   ignoreKeysFirefox: {\r\n      16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n      91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n      117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n      144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n      }\r\n   }\r\n\r\nSocialCalc.Keyboard = {\r\n   areListener: false, // if true, we have been installed as a listener for keyboard events\r\n   focusTable: null, // the table editor object that gets keystrokes or null\r\n   passThru: null, // if not null, control element with focus to pass keyboard events to (has blur method), or \"true\"\r\n   didProcessKey: false, // did SocialCalc.ProcessKey in keydown\r\n   statusFromProcessKey: false, // the status from the keydown SocialCalc.ProcessKey\r\n   repeatingKeyPress: false, // some browsers (Opera, Gecko Mac) repeat special keys as KeyPress not KeyDown\r\n   chForProcessKey: \"\" // remember so can do repeat in those cases\r\n   };\r\n\r\nSocialCalc.KeyboardSetFocus = function(editor) {\r\n\r\n   SocialCalc.Keyboard.focusTable = editor;\r\n\r\n   if (!SocialCalc.Keyboard.areListener) {\r\n      document.onkeydown = SocialCalc.ProcessKeyDown;\r\n      document.onkeypress = SocialCalc.ProcessKeyPress;\r\n      SocialCalc.Keyboard.areListener = true;\r\n      }\r\n   if (SocialCalc.Keyboard.passThru) {\r\n      if (SocialCalc.Keyboard.passThru.blur) {\r\n         SocialCalc.Keyboard.passThru.blur();\r\n         }\r\n      SocialCalc.Keyboard.passThru = null;\r\n      }\r\n   window.focus();\r\n   }\r\n\r\nSocialCalc.KeyboardFocus = function() {\r\n\r\n   SocialCalc.Keyboard.passThru = null;\r\n   window.focus();\r\n\r\n   }\r\n\r\nSocialCalc.ProcessKeyDown = function(e) {\r\n\r\n   var kt = SocialCalc.keyboardTables;\r\n   kt.didProcessKey = false; // always start false\r\n   kt.statusFromProcessKey = false;\r\n   kt.repeatingKeyPress = false;\r\n\r\n   var ch=\"\";\r\n   var status=true;\r\n\r\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n\r\n   e = e || window.event;\r\n\r\n   if (e.which==undefined) { // IE\r\n      ch = kt.specialKeysCommon[e.keyCode];\r\n      if (!ch) {\r\n         if (e.ctrlKey) {\r\n            ch=kt.controlKeysIE[e.keyCode];\r\n            }\r\n         if (!ch)\r\n            return true;\r\n         }\r\n      status = SocialCalc.ProcessKey(ch, e);\r\n\r\n      if (!status) {\r\n         if (e.preventDefault) e.preventDefault();\r\n            e.returnValue = false;\r\n         }\r\n      }\r\n\r\n   else { \r\n      ch = kt.specialKeysCommon[e.keyCode];\r\n      if (!ch) {\r\n//         return true;\r\n         if (e.ctrlKey || e.metaKey) {\r\n            ch=kt.controlKeysIE[e.keyCode]; // this works here\r\n            }\r\n         if (!ch)\r\n            return true;\r\n         }\r\n\r\n      status = SocialCalc.ProcessKey(ch, e); // process the key\r\n      kt.didProcessKey = true; // remember what happened\r\n      kt.statusFromProcessKey = status;\r\n      kt.chForProcessKey = ch;\r\n      }\r\n\r\n   return status;\r\n\r\n   }\r\n\r\nSocialCalc.ProcessKeyPress = function(e) {\r\n\r\n   var kt = SocialCalc.keyboardTables;\r\n\r\n   var ch=\"\";\r\n\r\n   e = e || window.event;\r\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\r\n   \r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n   if (kt.didProcessKey) { // already processed this key\r\n      if (kt.repeatingKeyPress) {\r\n         return SocialCalc.ProcessKey(kt.chForProcessKey, e); // process the same key as on KeyDown\r\n         }\r\n      else {\r\n         kt.repeatingKeyPress = true; // see if get another KeyPress before KeyDown\r\n         return kt.statusFromProcessKey; // do what it said to do\r\n         }\r\n      }\r\n\r\n   if (e.which==undefined) { // IE\r\n      // Note: Esc and Enter will come through here, too, if not stopped at KeyDown\r\n      ch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\r\n      }\r\n\r\n   else { // not IE\r\n      if (!e.which)\r\n         return false; // ignore - special key\r\n      if (e.charCode==undefined) { // Opera\r\n         if (e.which!=0) { // character\r\n            if (e.which<32 || e.which==144) { // special char (144 is numlock)\r\n               ch = kt.specialKeysOpera[e.which];\r\n               if (ch) {\r\n                  return true;\r\n                  }\r\n               }\r\n            else {\r\n               if (e.ctrlKey) {\r\n                  ch=kt.controlKeysOpera[e.keyCode];\r\n                  }\r\n               else {\r\n                  ch = String.fromCharCode(e.which);\r\n                  }\r\n               }\r\n            }\r\n         else { // special char\r\n            return true;\r\n            }\r\n         }\r\n\r\n      else if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\r\n         return; // ignore\r\n         }\r\n\r\n      else if (e.keyCode==e.charCode) { // Safari\r\n         ch = kt.specialKeysSafari[e.keyCode];\r\n         if (!ch) {\r\n            if (kt.ignoreKeysSafari[e.keyCode]) // pass this through\r\n               return true;\r\n            if (e.metaKey) {\r\n               ch=kt.controlKeysSafari[e.keyCode];\r\n               }\r\n            else {\r\n               ch = String.fromCharCode(e.which);\r\n               }\r\n            }\r\n         }\r\n\r\n      else { // Firefox\r\n         if (kt.specialKeysFirefox[e.keyCode]) {\r\n            return true;\r\n            }\r\n         ch = String.fromCharCode(e.which);\r\n         if (e.ctrlKey || e.metaKey) {\r\n            ch = kt.controlKeysFirefox[e.which];\r\n            }\r\n         }\r\n      }\r\n\r\n   var status = SocialCalc.ProcessKey(ch, e);\r\n\r\n   if (!status) {\r\n      if (e.preventDefault) e.preventDefault();\r\n      e.returnValue = false;\r\n      }\r\n\r\n   return status;\r\n\r\n   }\r\n\r\n//\r\n// status = SocialCalc.ProcessKey(ch, e)\r\n//\r\n// Take a key representation as a character string and dispatch to appropriate routine\r\n//\r\n\r\nSocialCalc.ProcessKey = function (ch, e) {\r\n   var ft = SocialCalc.Keyboard.focusTable;\r\n   if (!ft) return true; // we're not handling it -- let browser do default\r\n   return ft.EditorProcessKey(ch, e);\r\n   }\r\n\r\n\r\n//\r\n/*\r\n// SocialCalc Number Formatting Library\r\n//\r\n// Part of the SocialCalc package.\r\n//\r\n// (c) Copyright 2008 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\r\n\r\nSocialCalc.FormatNumber = {};\r\n\r\nSocialCalc.FormatNumber.format_definitions = {}; // Parsed formats are stored here globally\r\n\r\n// Most constants that are often customized for localization are in the SocialCalc.Constants module.\r\n// If you use this module standalone, provide at least the \"FormatNumber\" values.\r\n//\r\n\r\n// The following values may be customized externally for further localization of the format definitions themselves,\r\n// but that would make them incompatible with other uses and is discouraged.\r\n//\r\n\r\nSocialCalc.FormatNumber.separatorchar = \",\";\r\nSocialCalc.FormatNumber.decimalchar = \".\";\r\nSocialCalc.FormatNumber.daynames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\r\nSocialCalc.FormatNumber.daynames3 = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\nSocialCalc.FormatNumber.monthnames3 = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\nSocialCalc.FormatNumber.monthnames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\r\n                                      \"October\", \"November\", \"December\"];\r\n\r\nSocialCalc.FormatNumber.allowedcolors =\r\n   {BLACK: \"#000000\", BLUE: \"#0000FF\", CYAN: \"#00FFFF\", GREEN: \"#00FF00\", MAGENTA: \"#FF00FF\",\r\n    RED: \"#FF0000\", WHITE: \"#FFFFFF\", YELLOW: \"#FFFF00\"};\r\n\r\nSocialCalc.FormatNumber.alloweddates =\r\n   {H: \"h]\", M: \"m]\", MM: \"mm]\", S: \"s]\", SS: \"ss]\"};\r\n\r\n// Other constants\r\n\r\nSocialCalc.FormatNumber.commands =\r\n   {copy: 1, color: 2, integer_placeholder: 3, fraction_placeholder: 4, decimal: 5,\r\n    currency: 6, general:7, separator: 8, date: 9, comparison: 10, section: 11, style: 12};\r\n\r\nSocialCalc.FormatNumber.datevalues = {julian_offset: 2415019, seconds_in_a_day: 24 * 60 * 60, seconds_in_an_hour: 60 * 60};\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var scfn = SocialCalc.FormatNumber;\r\n\r\n   var op, operandstr, fromend, cval, operandstrlc;\r\n   var startval, estartval;\r\n   var hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;\r\n   var minOK, mpos;\r\n   var result=\"\";\r\n   var thisformat;\r\n   var section, gotcomparison, compop, compval, cpos, oppos;\r\n   var sectioninfo;\r\n   var i, decimalscale, scaledvalue, strvalue, strparts, integervalue, fractionvalue;\r\n   var integerdigits2, integerpos, fractionpos, textcolor, textstyle, separatorchar, decimalchar;\r\n   var value; // working copy to change sign, etc.\r\n\r\n   if (typeof(rawvalue) == \"string\" && !rawvalue.length) return \"\";\r\n\r\n   value = rawvalue-0; // make sure a number\r\n   if (!isFinite(value)) {\r\n      if (typeof(rawvalue) == \"string\") { // if original was a string, try to format it\r\n         return scfn.formatTextWithFormat(rawvalue, format_string);\r\n         }\r\n      else {\r\n         return \"NaN\";\r\n         }\r\n      }\r\n   rawvalue = value;\r\n\r\n   var negativevalue = value < 0 ? 1 : 0; // determine sign, etc.\r\n   if (negativevalue) value = -value;\r\n   var zerovalue = value == 0 ? 1 : 0;\r\n\r\n   currency_char = currency_char || scc.FormatNumber_DefaultCurrency;\r\n\r\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\r\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\r\n\r\n   if (!thisformat) throw \"Format not parsed error!\";\r\n\r\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\r\n\r\n   if (thisformat.hascomparison) { // has comparisons - determine which section\r\n      section = 0; // set to which section we will use\r\n      gotcomparison = 0; // this section has no comparison\r\n      for (cpos=0; ;cpos++) { // scan for comparisons\r\n         op = thisformat.operators[cpos];\r\n         operandstr = thisformat.operands[cpos]; // get next operator and operand\r\n         if (!op) { // at end with no match\r\n            if (gotcomparison) { // if comparison but no match\r\n               format_string = \"General\"; // use default of General\r\n               scfn.parse_format_string(scfn.format_definitions, format_string);\r\n               thisformat = scfn.format_definitions[format_string];\r\n               section = 0;\r\n               }\r\n            break; // if no comparision, matches on this section\r\n            }\r\n         if (op == scfn.commands.section) { // end of section\r\n            if (!gotcomparison) { // no comparison, so it's a match\r\n               break;\r\n               }\r\n            gotcomparison = 0;\r\n            section++; // check out next one\r\n            continue;\r\n            }\r\n         if (op == scfn.commands.comparison) { // found a comparison - do we meet it?\r\n            i=operandstr.indexOf(\":\");\r\n            compop=operandstr.substring(0,i);\r\n            compval=operandstr.substring(i+1)-0;\r\n            if ((compop == \"<\" && rawvalue < compval) ||\r\n                (compop == \"<=\" && rawvalue <= compval) ||\r\n                (compop == \"=\" && rawvalue == compval) ||\r\n                (compop == \"<>\" && rawvalue != compval) ||\r\n                (compop == \">=\" && rawvalue >= compval) ||\r\n                (compop == \">\" && rawvalue > compval)) { // a match\r\n               break;\r\n               }\r\n            gotcomparison = 1;\r\n            }\r\n         }\r\n      }\r\n   else if (section > 0) { // more than one section (separated by \";\")\r\n      if (section == 1) { // two sections\r\n         if (negativevalue) {\r\n            negativevalue = 0; // sign will provided by section, not automatically\r\n            section = 1; // use second section for negative values\r\n            }\r\n         else {\r\n            section = 0; // use first for all others\r\n            }\r\n         }\r\n      else if (section == 2 || section == 3) { // three or four sections\r\n         if (negativevalue) {\r\n            negativevalue = 0; // sign will provided by section, not automatically\r\n            section = 1; // use second section for negative values\r\n            }\r\n         else if (zerovalue) {\r\n            section = 2; // use third section for zero values\r\n            }\r\n         else {\r\n            section = 0; // use first for positive\r\n            }\r\n         }\r\n      }\r\n\r\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\r\n\r\n   if (sectioninfo.commas > 0) { // scale by thousands\r\n      for (i=0; i<sectioninfo.commas; i++) {\r\n         value /= 1000;\r\n         }\r\n      }\r\n   if (sectioninfo.percent > 0) { // do percent scaling\r\n      for (i=0; i<sectioninfo.percent; i++) {\r\n         value *= 100;\r\n         }\r\n      }\r\n\r\n   decimalscale = 1; // cut down to required number of decimal digits\r\n   for (i=0; i<sectioninfo.fractiondigits; i++) {\r\n      decimalscale *= 10;\r\n      }\r\n   scaledvalue = Math.floor(value * decimalscale + 0.5);\r\n   scaledvalue = scaledvalue / decimalscale;\r\n\r\n   if (typeof scaledvalue != \"number\") return \"NaN\";\r\n   if (!isFinite(scaledvalue)) return \"NaN\";\r\n\r\n   strvalue = scaledvalue+\"\"; // convert to string (Number.toFixed doesn't do all we need)\r\n\r\n//   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits\r\n                                                         // and convert to string\r\n\r\n   if (scaledvalue == 0 && (sectioninfo.fractiondigits || sectioninfo.integerdigits)) {\r\n      negativevalue = 0; // no \"-0\" unless using multiple sections or General\r\n      }\r\n\r\n   if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\r\n      return rawvalue+\"\"; // Just return plain converted raw value\r\n      }\r\n\r\n   strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\r\n   if (!strparts) return \"NaN\"; // if not a number\r\n   integervalue = strparts[1];\r\n   if (!integervalue || integervalue==\"0\") integervalue=\"\";\r\n   fractionvalue = strparts[2];\r\n   if (!fractionvalue) fractionvalue = \"\";\r\n\r\n   if (sectioninfo.hasdate) { // there are date placeholders\r\n      if (rawvalue < 0) { // bad date\r\n         return \"??-???-??&nbsp;??:??:??\";\r\n         }\r\n      startval = (rawvalue-Math.floor(rawvalue)) * scfn.datevalues.seconds_in_a_day; // get date/time parts\r\n      estartval = rawvalue * scfn.datevalues.seconds_in_a_day; // do elapsed time version, too\r\n      hrs = Math.floor(startval / scfn.datevalues.seconds_in_an_hour);\r\n      ehrs = Math.floor(estartval / scfn.datevalues.seconds_in_an_hour);\r\n      startval = startval - hrs * scfn.datevalues.seconds_in_an_hour;\r\n      mins = Math.floor(startval / 60);\r\n      emins = Math.floor(estartval / 60);\r\n      secs = startval - mins * 60;\r\n      decimalscale = 1; // round appropriately depending if there is ss.0\r\n      for (i=0; i<sectioninfo.fractiondigits; i++) {\r\n         decimalscale *= 10;\r\n         }\r\n      secs = Math.floor(secs * decimalscale + 0.5);\r\n      secs = secs / decimalscale;\r\n      esecs = Math.floor(estartval * decimalscale + 0.5);\r\n      esecs = esecs / decimalscale;\r\n      if (secs >= 60) { // handle round up into next second, minute, etc.\r\n         secs = 0;\r\n         mins++; emins++;\r\n         if (mins >= 60) {\r\n            mins = 0;\r\n            hrs++; ehrs++;\r\n            if (hrs >= 24) {\r\n               hrs = 0;\r\n               rawvalue++;\r\n               }\r\n            }\r\n         }\r\n      fractionvalue = (secs-Math.floor(secs))+\"\"; // for \"hh:mm:ss.000\"\r\n      fractionvalue = fractionvalue.substring(2); // skip \"0.\"\r\n\r\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(rawvalue+scfn.datevalues.julian_offset));\r\n\r\n      minOK = 0; // says \"m\" can be minutes if true\r\n      mspos = sectioninfo.sectionstart; // m scan position in ops\r\n      for ( ; ; mspos++) { // scan for \"m\" and \"mm\" to see if any minutes fields, and am/pm\r\n         op = thisformat.operators[mspos];\r\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\r\n         if (!op) break; // don't go past end\r\n         if (op==scfn.commands.section) break;\r\n         if (op==scfn.commands.date) {\r\n            if ((operandstr.toLowerCase()==\"am/pm\" || operandstr.toLowerCase()==\"a/p\") && !ampmstr) {\r\n               if (hrs >= 12) {\r\n                  hrs -= 12;\r\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_pm1 : scc.s_FormatNumber_pm; // \"P\" : \"PM\";\r\n                  }\r\n               else {\r\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_am1 : scc.s_FormatNumber_am; // \"A\" : \"AM\";\r\n                  }\r\n               if (operandstr.indexOf(ampmstr)<0)\r\n                  ampmstr = ampmstr.toLowerCase(); // have case match case in format\r\n               }\r\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\r\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\r\n               }\r\n            if (operandstr.charAt(0)==\"h\") {\r\n               minOK = 1; // m following h or hh or [h] is minutes not months\r\n               }\r\n            else {\r\n               minOK = 0;\r\n               }\r\n            }\r\n         else if (op!=scfn.commands.copy) { // copying chars can be between h and m\r\n            minOK = 0;\r\n            }\r\n         }\r\n      minOK = 0;\r\n      for (--mspos; ; mspos--) { // scan other way for s after m\r\n         op = thisformat.operators[mspos];\r\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\r\n         if (!op) break; // don't go past end\r\n         if (op==scfn.commands.section) break;\r\n         if (op==scfn.commands.date) {\r\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\r\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\r\n               }\r\n            if (operandstr==\"ss\") {\r\n               minOK = 1; // m before ss is minutes not months\r\n               }\r\n            else {\r\n               minOK = 0;\r\n               }\r\n            }\r\n         else if (op!=scfn.commands.copy) { // copying chars can be between ss and m\r\n            minOK = 0;\r\n            }\r\n         }\r\n      }\r\n\r\n   integerdigits2 = 0; // init counters, etc.\r\n   integerpos = 0;\r\n   fractionpos = 0;\r\n   textcolor = \"\";\r\n   textstyle = \"\";\r\n   separatorchar = scc.FormatNumber_separatorchar;\r\n   if (separatorchar.indexOf(\" \")>=0) separatorchar = separatorchar.replace(/ /g, \"&nbsp;\");\r\n   decimalchar = scc.FormatNumber_decimalchar;\r\n   if (decimalchar.indexOf(\" \")>=0) decimalchar = decimalchar.replace(/ /g, \"&nbsp;\");\r\n\r\n   oppos = sectioninfo.sectionstart;\r\n\r\n   while (op = thisformat.operators[oppos]) { // execute format\r\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\r\n\r\n      if (op == scfn.commands.copy) { // put char in result\r\n         result += operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.color) { // set color\r\n         textcolor = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.style) { // set style\r\n         textstyle = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.integer_placeholder) { // insert number part\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         integerdigits2++;\r\n         if (integerdigits2 == 1) { // first one\r\n            if (integervalue.length > sectioninfo.integerdigits) { // see if integer wider than field\r\n               for (;integerpos < (integervalue.length - sectioninfo.integerdigits); integerpos++) {\r\n                  result += integervalue.charAt(integerpos);\r\n                  if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                     fromend = integervalue.length - integerpos - 1;\r\n                     if (fromend > 2 && fromend % 3 == 0) {\r\n                        result += separatorchar;\r\n                        }\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n         if (integervalue.length < sectioninfo.integerdigits\r\n             && integerdigits2 <= sectioninfo.integerdigits - integervalue.length) { // field is wider than value\r\n            if (operandstr == \"0\" || operandstr == \"?\") { // fill with appropriate characters\r\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\r\n               if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                  fromend = sectioninfo.integerdigits - integerdigits2;\r\n                  if (fromend > 2 && fromend % 3 == 0) {\r\n                     result += separatorchar;\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n         else { // normal integer digit - add it\r\n            result += integervalue.charAt(integerpos);\r\n            if (sectioninfo.thousandssep) { // see if this is a separator position\r\n               fromend = integervalue.length - integerpos - 1;\r\n               if (fromend > 2 && fromend % 3 == 0) {\r\n                  result += separatorchar;\r\n                  }\r\n               }\r\n            integerpos++;\r\n            }\r\n         }\r\n      else if (op == scfn.commands.fraction_placeholder) { // add fraction part of number\r\n         if (fractionpos >= fractionvalue.length) {\r\n            if (operandstr == \"0\" || operandstr == \"?\") {\r\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\r\n               }\r\n            }\r\n         else {\r\n            result += fractionvalue.charAt(fractionpos);\r\n            }\r\n         fractionpos++;\r\n         }\r\n\r\n      else if (op == scfn.commands.decimal) { // decimal point\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         result += decimalchar;\r\n         }\r\n\r\n      else if (op == scfn.commands.currency) { // currency symbol\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         result += operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.general) { // insert \"General\" conversion\r\n\r\n         // *** Cut down number of significant digits to avoid floating point artifacts:\r\n\r\n         if (value!=0) { // only if non-zero\r\n            var factor = Math.floor(Math.LOG10E * Math.log(value)); // get integer magnitude as a power of 10\r\n            factor = Math.pow(10, 13-factor); // turn into scaling factor\r\n            value = Math.floor(factor * value + 0.5)/factor; // scale positive value, round, undo scaling\r\n            if (!isFinite(value)) return \"NaN\";\r\n            }\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            }\r\n         strvalue = value+\"\"; // convert original value to string\r\n         if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\r\n            result += strvalue;\r\n            continue;\r\n            }\r\n         strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\r\n         integervalue = strparts[1];\r\n         if (!integervalue || integervalue==\"0\") integervalue=\"\";\r\n         fractionvalue = strparts[2];\r\n         if (!fractionvalue) fractionvalue = \"\";\r\n         integerpos = 0;\r\n         fractionpos = 0;\r\n         if (integervalue.length) {\r\n            for (;integerpos < integervalue.length; integerpos++) {\r\n               result += integervalue.charAt(integerpos);\r\n               if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                  fromend = integervalue.length - integerpos - 1;\r\n                  if (fromend > 2 && fromend % 3 == 0) {\r\n                     result += separatorchar;\r\n                     }\r\n                  }\r\n               }\r\n             }\r\n         else {\r\n            result += \"0\";\r\n            }\r\n         if (fractionvalue.length) {\r\n            result += decimalchar;\r\n            for (;fractionpos < fractionvalue.length; fractionpos++) {\r\n               result += fractionvalue.charAt(fractionpos);\r\n               }\r\n            }\r\n         }\r\n      else if (op==scfn.commands.date) { // date placeholder\r\n         operandstrlc = operandstr.toLowerCase();\r\n         if (operandstrlc==\"y\" || operandstrlc==\"yy\") {\r\n            result += (ymd.year+\"\").substring(2);\r\n            }\r\n         else if (operandstrlc==\"yyyy\") {\r\n            result += ymd.year+\"\";\r\n            }\r\n         else if (operandstrlc==\"d\") {\r\n            result += ymd.day+\"\";\r\n            }\r\n         else if (operandstrlc==\"dd\") {\r\n            cval = 1000 + ymd.day;\r\n            result += (cval+\"\").substr(2);\r\n            }\r\n         else if (operandstrlc==\"ddd\") {\r\n            cval = Math.floor(rawvalue+6) % 7;\r\n            result += scc.s_FormatNumber_daynames3[cval];\r\n            }\r\n         else if (operandstrlc==\"dddd\") {\r\n            cval = Math.floor(rawvalue+6) % 7;\r\n            result += scc.s_FormatNumber_daynames[cval];\r\n            }\r\n         else if (operandstrlc==\"m\") {\r\n            result += ymd.month+\"\";\r\n            }\r\n         else if (operandstrlc==\"mm\") {\r\n            cval = 1000 + ymd.month;\r\n            result += (cval+\"\").substr(2);\r\n            }\r\n         else if (operandstrlc==\"mmm\") {\r\n            result += scc.s_FormatNumber_monthnames3[ymd.month-1];\r\n            }\r\n         else if (operandstrlc==\"mmmm\") {\r\n            result += scc.s_FormatNumber_monthnames[ymd.month-1];\r\n            }\r\n         else if (operandstrlc==\"mmmmm\") {\r\n            result += scc.s_FormatNumber_monthnames[ymd.month-1].charAt(0);\r\n            }\r\n         else if (operandstrlc==\"h\") {\r\n            result += hrs+\"\";\r\n            }\r\n         else if (operandstrlc==\"h]\") {\r\n            result += ehrs+\"\";\r\n            }\r\n         else if (operandstrlc==\"mmin\") {\r\n            cval = (1000 + mins)+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"mm]\") {\r\n            if (emins < 100) {\r\n               cval = (1000 + emins)+\"\";\r\n               result += cval.substr(2);\r\n               }\r\n            else {\r\n               result += emins+\"\";\r\n               }\r\n            }\r\n         else if (operandstrlc==\"min\") {\r\n            result += mins+\"\";\r\n            }\r\n         else if (operandstrlc==\"m]\") {\r\n            result += emins+\"\";\r\n            }\r\n         else if (operandstrlc==\"hh\") {\r\n            cval = (1000 + hrs)+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"s\") {\r\n            cval = Math.floor(secs);\r\n            result += cval+\"\";\r\n            }\r\n         else if (operandstrlc==\"ss\") {\r\n            cval = (1000 + Math.floor(secs))+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"am/pm\" || operandstrlc==\"a/p\") {\r\n            result += ampmstr;\r\n            }\r\n         else if (operandstrlc==\"ss]\") {\r\n            if (esecs < 100) {\r\n               cval = (1000 + Math.floor(esecs))+\"\";\r\n               result += cval.substr(2);\r\n               }\r\n            else {\r\n               cval = Math.floor(esecs);\r\n               result += cval+\"\";\r\n               }\r\n            }\r\n         }\r\n      else if (op == scfn.commands.section) { // end of section\r\n         break;\r\n         }\r\n\r\n      else if (op == scfn.commands.comparison) { // ignore\r\n         continue;\r\n         }\r\n\r\n      else {\r\n         result += \"!! Parse error !!\";\r\n         }\r\n      }\r\n\r\n   if (textcolor) {\r\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\r\n      }\r\n   if (textstyle) {\r\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\r\n      }\r\n\r\n   return result;\r\n\r\n   };\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.FormatNumber.formatTextWithFormat = function(rawvalue, format_string)\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.formatTextWithFormat = function(rawvalue, format_string) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var scfn = SocialCalc.FormatNumber;\r\n   var value = rawvalue+\"\";\r\n   var result = \"\";\r\n   var section;\r\n   var sectioninfo;\r\n   var oppos;\r\n   var operandstr;\r\n   var textcolor = \"\";\r\n   var textstyle = \"\";\r\n\r\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\r\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\r\n\r\n   if (!thisformat) throw \"Format not parsed error!\";\r\n\r\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\r\n   if (section == 0) {\r\n      section = 0;\r\n      }\r\n   else if (section == 3) {\r\n      section = 3;\r\n      }\r\n   else {\r\n      return value;\r\n      }\r\n\r\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\r\n   oppos = sectioninfo.sectionstart;\r\n\r\n   while (op = thisformat.operators[oppos]) { // execute format\r\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\r\n\r\n      if (op == scfn.commands.copy) { // put char in result\r\n         if (operandstr == \"@\") {\r\n            result += value;\r\n            }\r\n         else {\r\n            result += operandstr.replace(/ /g, \"&nbsp;\");\r\n            }\r\n         }\r\n\r\n      else if (op == scfn.commands.color) { // set color\r\n         textcolor = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.style) { // set style\r\n         textstyle = operandstr;\r\n         }\r\n      }\r\n\r\n   if (textcolor) {\r\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\r\n      }\r\n   if (textstyle) {\r\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\r\n      }\r\n\r\n   return result;\r\n\r\n   };\r\n\r\n/* *******************\r\n\r\n SocialCalc.FormatNumber.parse_format_string(format_defs, format_string)\r\n\r\n Takes a format string (e.g., \"#,##0.00_);(#,##0.00)\") and fills in format_defs with the parsed info\r\n\r\n format_defs\r\n    [\"#,##0.0\"]->{} - elements in the hash are one hash for each format\r\n       .operators->[] - array of operators from parsing the format string (each a number)\r\n       .operands->[] - array of corresponding operators (each usually a string)\r\n       .sectioninfo->[] - one hash for each section of the format\r\n          .start\r\n          .integerdigits\r\n          .fractiondigits\r\n          .commas\r\n          .percent\r\n          .thousandssep\r\n          .hasdates\r\n       .hascomparison - true if any section has [<100], etc.\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.parse_format_string = function(format_defs, format_string) {\r\n\r\n   var scfn = SocialCalc.FormatNumber;\r\n\r\n   var thisformat, section, sectionfinfo;\r\n   var integerpart = 1; // start out in integer part\r\n   var lastwasinteger; // last char was an integer placeholder\r\n   var lastwasslash; // last char was a backslash - escaping following character\r\n   var lastwasasterisk; // repeat next char\r\n   var lastwasunderscore; // last char was _ which picks up following char for width\r\n   var inquote, quotestr; // processing a quoted string\r\n   var inbracket, bracketstr, bracketdata; // processing a bracketed string\r\n   var ingeneral, gpos; // checks for characters \"General\"\r\n   var ampmstr, part; // checks for characters \"A/P\" and \"AM/PM\"\r\n   var indate; // keeps track of date/time placeholders\r\n   var chpos; // character position being looked at\r\n   var ch; // character being looked at\r\n\r\n   if (format_defs[format_string]) return; // already defined - nothing to do\r\n\r\n   thisformat = {operators: [], operands: [], sectioninfo: [{}]}; // create info structure for this format\r\n   format_defs[format_string] = thisformat; // add to other format definitions\r\n\r\n   section = 0; // start with section 0\r\n   sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\r\n   sectioninfo.sectionstart = 0; // position in operands that starts this section\r\n   sectioninfo.integerdigits = 0; // number of integer-part placeholders\r\n   sectioninfo.fractiondigits = 0; // fraction placeholders\r\n   sectioninfo.commas = 0; // commas encountered, to handle scaling\r\n   sectioninfo.percent = 0; // times to scale by 100\r\n\r\n   for (chpos=0; chpos<format_string.length; chpos++) { // parse\r\n      ch = format_string.charAt(chpos); // get next char to examine\r\n      if (inquote) {\r\n         if (ch == '\"') {\r\n            inquote = 0;\r\n            thisformat.operators.push(scfn.commands.copy);\r\n            thisformat.operands.push(quotestr);\r\n            continue;\r\n            }\r\n         quotestr += ch;\r\n         continue;\r\n         }\r\n      if (inbracket) {\r\n         if (ch==']') {\r\n            inbracket = 0;\r\n            bracketdata=SocialCalc.FormatNumber.parse_format_bracket(bracketstr);\r\n            if (bracketdata.operator==scfn.commands.separator) {\r\n               sectioninfo.thousandssep = 1; // explicit [,]\r\n               continue;\r\n               }\r\n            if (bracketdata.operator==scfn.commands.date) {\r\n               sectioninfo.hasdate = 1;\r\n               }\r\n            if (bracketdata.operator==scfn.commands.comparison) {\r\n               thisformat.hascomparison = 1;\r\n               }\r\n            thisformat.operators.push(bracketdata.operator);\r\n            thisformat.operands.push(bracketdata.operand);\r\n            continue;\r\n            }\r\n         bracketstr += ch;\r\n         continue;\r\n         }\r\n      if (lastwasslash) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         lastwasslash=false;\r\n         continue;\r\n         }\r\n      if (lastwasasterisk) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch+ch+ch+ch+ch); // do 5 of them since no real tabs\r\n         lastwasasterisk=false;\r\n         continue;\r\n         }\r\n      if (lastwasunderscore) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(\"&nbsp;\");\r\n         lastwasunderscore=false;\r\n         continue;\r\n         }\r\n      if (ingeneral) {\r\n         if (\"general\".charAt(ingeneral)==ch.toLowerCase()) {\r\n            ingeneral++;\r\n            if (ingeneral == 7) {\r\n               thisformat.operators.push(scfn.commands.general);\r\n               thisformat.operands.push(ch);\r\n               ingeneral=0;\r\n               }\r\n            continue;\r\n            }\r\n         ingeneral = 0;\r\n         }\r\n      if (indate) { // last char was part of a date placeholder\r\n         if (indate.charAt(0)==ch) { // another of the same char\r\n            indate += ch; // accumulate it\r\n            continue;\r\n            }\r\n         thisformat.operators.push(scfn.commands.date); // something else, save date info\r\n         thisformat.operands.push(indate);\r\n         sectioninfo.hasdate=1;\r\n         indate = \"\";\r\n         }\r\n      if (ampmstr) {\r\n         ampmstr += ch;\r\n         part=ampmstr.toLowerCase();\r\n         if (part!=\"am/pm\".substring(0,part.length) && part!=\"a/p\".substring(0,part.length)) {\r\n            ampstr=\"\";\r\n            }\r\n         else if (part==\"am/pm\" || part==\"a/p\") {\r\n            thisformat.operators.push(scfn.commands.date);\r\n            thisformat.operands.push(ampmstr);\r\n            ampmstr = \"\";\r\n            }\r\n         continue;\r\n         }\r\n      if (ch==\"#\" || ch==\"0\" || ch==\"?\") { // placeholder\r\n         if (integerpart) {\r\n            sectioninfo.integerdigits++;\r\n            if (sectioninfo.commas) { // comma inside of integer placeholders\r\n               sectioninfo.thousandssep = 1; // any number is thousands separator\r\n               sectioninfo.commas = 0; // reset count of \"thousand\" factors\r\n               }\r\n            lastwasinteger = 1;\r\n            thisformat.operators.push(scfn.commands.integer_placeholder);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         else {\r\n            sectioninfo.fractiondigits++;\r\n            lastwasinteger = 1;\r\n            thisformat.operators.push(scfn.commands.fraction_placeholder);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         }\r\n      else if (ch==\".\") { // decimal point\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.decimal);\r\n         thisformat.operands.push(ch);\r\n         integerpart = 0;\r\n         }\r\n      else if (ch=='$') { // currency char\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.currency);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch==\",\") {\r\n         if (lastwasinteger) {\r\n            sectioninfo.commas++;\r\n            }\r\n         else {\r\n            thisformat.operators.push(scfn.commands.copy);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         }\r\n      else if (ch==\"%\") {\r\n         lastwasinteger = 0;\r\n         sectioninfo.percent++;\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch=='\"') {\r\n         lastwasinteger = 0;\r\n         inquote = 1;\r\n         quotestr = \"\";\r\n         }\r\n      else if (ch=='[') {\r\n         lastwasinteger = 0;\r\n         inbracket = 1;\r\n         bracketstr = \"\";\r\n         }\r\n      else if (ch=='\\\\') {\r\n         lastwasslash = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch=='*') {\r\n         lastwasasterisk = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch=='_') {\r\n         lastwasunderscore = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch==\";\") {\r\n         section++; // start next section\r\n         thisformat.sectioninfo[section] = {}; // create a new section\r\n         sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\r\n         sectioninfo.sectionstart = 1 + thisformat.operators.length; // remember where it starts\r\n         sectioninfo.integerdigits = 0; // number of integer-part placeholders\r\n         sectioninfo.fractiondigits = 0; // fraction placeholders\r\n         sectioninfo.commas = 0; // commas encountered, to handle scaling\r\n         sectioninfo.percent = 0; // times to scale by 100\r\n         integerpart = 1; // reset for new section\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.section);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch.toLowerCase()==\"g\") {\r\n         ingeneral = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch.toLowerCase()==\"a\") {\r\n         ampmstr = ch;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (\"dmyhHs\".indexOf(ch)>=0) {\r\n         indate = ch;\r\n         }\r\n      else {\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      }\r\n\r\n   if (indate) { // last char was part of unsaved date placeholder\r\n      thisformat.operators.push(scfn.commands.date);\r\n      thisformat.operands.push(indate);\r\n      sectioninfo.hasdate = 1;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n/* *******************\r\n\r\n bracketdata = SocialCalc.FormatNumber.parse_format_bracket(bracketstr)\r\n\r\n Takes a bracket contents (e.g., \"RED\", \">10\") and returns an operator and operand\r\n\r\n bracketdata->{}\r\n    .operator\r\n    .operand\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.parse_format_bracket = function(bracketstr) {\r\n\r\n   var scfn = SocialCalc.FormatNumber;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var bracketdata={};\r\n   var parts;\r\n\r\n   if (bracketstr.charAt(0)=='$') { // currency\r\n      bracketdata.operator = scfn.commands.currency;\r\n      parts=bracketstr.match(/^\\$(.+?)(\\-.+?){0,1}$/);\r\n      if (parts) {\r\n         bracketdata.operand = parts[1] || scc.FormatNumber_defaultCurrency || '$';\r\n         }\r\n      else {\r\n         bracketdata.operand = bracketstr.substring(1) || scc.FormatNumber_defaultCurrency || '$';\r\n         }\r\n      }\r\n   else if (bracketstr=='?$') {\r\n      bracketdata.operator = scfn.commands.currency;\r\n      bracketdata.operand = '[?$]';\r\n      }\r\n   else if (scfn.allowedcolors[bracketstr.toUpperCase()]) {\r\n      bracketdata.operator = scfn.commands.color;\r\n      bracketdata.operand = scfn.allowedcolors[bracketstr.toUpperCase()];\r\n      }\r\n   else if (parts=bracketstr.match(/^style=([^\"]*)$/)) { // [style=...]\r\n      bracketdata.operator = scfn.commands.style;\r\n      bracketdata.operand = parts[1];\r\n      }\r\n   else if (bracketstr==\",\") {\r\n      bracketdata.operator = scfn.commands.separator;\r\n      bracketdata.operand = bracketstr;\r\n      }\r\n   else if (scfn.alloweddates[bracketstr.toUpperCase()]) {\r\n      bracketdata.operator = scfn.commands.date;\r\n      bracketdata.operand = scfn.alloweddates[bracketstr.toUpperCase()];\r\n      }\r\n   else if (parts=bracketstr.match(/^[<>=]/)) { // comparison operator\r\n      parts=bracketstr.match(/^([<>=]+)(.+)$/); // split operator and value\r\n      bracketdata.operator = scfn.commands.comparison;\r\n      bracketdata.operand = parts[1]+\":\"+parts[2];\r\n      }\r\n   else { // unknown bracket\r\n      bracketdata.operator = scfn.commands.copy;\r\n      bracketdata.operand = \"[\"+bracketstr+\"]\";\r\n      }\r\n\r\n   return bracketdata;\r\n\r\n   }\r\n\r\n/* *******************\r\n\r\n juliandate = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, month, day)\r\n\r\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\r\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\r\n Translated from the FORTRAN\r\n\r\n      I= YEAR\r\n      J= MONTH\r\n      K= DAY\r\nC\r\n      JD= K-32075+1461*(I+4800+(J-14)/12)/4+367*(J-2-(J-14)/12*12)\r\n     2    /12-3*((I+4900+(J-14)/12)/100)/4\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.convert_date_gregorian_to_julian = function(year, month, day) {\r\n\r\n   var juliandate;\r\n\r\n   juliandate = day-32075+SocialCalc.intFunc(1461*(year+4800+SocialCalc.intFunc((month-14)/12))/4);\r\n   juliandate += SocialCalc.intFunc(367*(month-2-SocialCalc.intFunc((month-14)/12)*12)/12);\r\n   juliandate = juliandate - SocialCalc.intFunc(3*SocialCalc.intFunc((year+4900+SocialCalc.intFunc((month-14)/12))/100)/4);\r\n\r\n   return juliandate;\r\n\r\n   }\r\n\r\n\r\n/* *******************\r\n\r\n ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(juliandate)\r\n\r\n ymd->{}\r\n    .year\r\n    .month\r\n    .day\r\n\r\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\r\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\r\n Translated from the FORTRAN\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.convert_date_julian_to_gregorian = function(juliandate) {\r\n\r\n   var L, N, I, J, K;\r\n\r\n   L = juliandate+68569;\r\n   N = Math.floor(4*L/146097);\r\n   L = L-Math.floor((146097*N+3)/4);\r\n   I = Math.floor(4000*(L+1)/1461001);\r\n   L = L-Math.floor(1461*I/4)+31;\r\n   J = Math.floor(80*L/2447);\r\n   K = L-Math.floor(2447*J/80);\r\n   L = Math.floor(J/11);\r\n   J = J+2-12*L;\r\n   I = 100*(N-49)+I+L;\r\n\r\n   return {year:I, month:J, day:K};\r\n\r\n   }\r\n\r\nSocialCalc.intFunc = function(n) {\r\n   if (n < 0) {\r\n      return -Math.floor(-n);\r\n      }\r\n   else {\r\n      return Math.floor(n);\r\n      }\r\n   }\r\n\r\n//\r\n//\r\n/*\r\n// SocialCalc Spreadsheet Formula Library\r\n//\r\n// Part of the SocialCalc package\r\n//\r\n// (c) Copyright 2008 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\r\n                                     // In any case, requires SocialCalc.Constants.\r\n\r\nSocialCalc.Formula = {};\r\nSocialCalc.TriggerIoAction = {}; // eddy\r\n\r\n//\r\n// Formula constants for parsing:\r\n//\r\n\r\n   SocialCalc.Formula.ParseState = {num: 1, alpha: 2, coord: 3, string: 4, stringquote: 5, numexp1: 6, numexp2: 7, alphanumeric: 8, specialvalue:9};\r\n\r\n   SocialCalc.Formula.TokenType = {num: 1, coord: 2, op: 3, name: 4, error: 5, string: 6, space: 7};\r\n\r\n   SocialCalc.Formula.CharClass = {num: 1, numstart: 2, op: 3, eof: 4, alpha: 5, incoord: 6, error: 7, quote: 8, space: 9, specialstart: 10};\r\n \r\n   SocialCalc.Formula.CharClassTable = {\r\n      \" \": 9, \"!\": 3, '\"': 8, \"'\": 8, \"#\": 10, \"$\":6, \"%\":3, \"&\":3, \"(\": 3, \")\": 3, \"*\": 3, \"+\": 3, \",\": 3, \"-\": 3, \".\": 2, \"/\": 3,\r\n       \"0\": 1, \"1\": 1, \"2\": 1, \"3\": 1, \"4\": 1, \"5\": 1, \"6\": 1, \"7\": 1, \"8\": 1, \"9\": 1,\r\n       \":\": 3, \"<\": 3, \"=\": 3, \">\": 3,\r\n       \"A\": 5, \"B\": 5, \"C\": 5, \"D\": 5, \"E\": 5, \"F\": 5, \"G\": 5, \"H\": 5, \"I\": 5, \"J\": 5, \"K\": 5, \"L\": 5, \"M\": 5, \"N\": 5,\r\n       \"O\": 5, \"P\": 5, \"Q\": 5, \"R\": 5, \"S\": 5, \"T\": 5, \"U\": 5, \"V\": 5, \"W\": 5, \"X\": 5, \"Y\": 5, \"Z\": 5,\r\n       \"^\": 3, \"_\": 5,\r\n       \"a\": 5, \"b\": 5, \"c\": 5, \"d\": 5, \"e\": 5, \"f\": 5, \"g\": 5, \"h\": 5, \"i\": 5, \"j\": 5, \"k\": 5, \"l\": 5, \"m\": 5, \"n\": 5,\r\n       \"o\": 5, \"p\": 5, \"q\": 5, \"r\": 5, \"s\": 5, \"t\": 5, \"u\": 5, \"v\": 5, \"w\": 5, \"x\": 5, \"y\": 5, \"z\": 5\r\n       };\r\n\r\n   SocialCalc.Formula.UpperCaseTable = {\r\n       \"a\": \"A\", \"b\": \"B\", \"c\": \"C\", \"d\": \"D\", \"e\": \"E\", \"f\": \"F\", \"g\": \"G\", \"h\": \"H\", \"i\": \"I\", \"j\": \"J\", \"k\": \"K\", \"l\": \"L\", \"m\": \"M\",\r\n       \"n\": \"N\", \"o\": \"O\", \"p\": \"P\", \"q\": \"Q\", \"r\": \"R\", \"s\": \"S\", \"t\": \"T\", \"u\": \"U\", \"v\": \"V\", \"w\": \"W\", \"x\": \"X\", \"y\": \"Y\", \"z\": \"Z\",\r\n       \"A\": \"A\", \"B\": \"B\", \"C\": \"C\", \"D\": \"D\", \"E\": \"E\", \"F\": \"F\", \"G\": \"G\", \"H\": \"H\", \"I\": \"I\", \"J\": \"J\", \"K\": \"K\", \"L\": \"L\", \"M\": \"M\",\r\n       \"N\": \"N\", \"O\": \"O\", \"P\": \"P\", \"Q\": \"Q\", \"R\": \"R\", \"S\": \"S\", \"T\": \"T\", \"U\": \"U\", \"V\": \"V\", \"W\": \"W\", \"X\": \"X\", \"Y\": \"Y\", \"Z\": \"Z\"\r\n       }\r\n\r\n   SocialCalc.Formula.SpecialConstants = { // names that turn into constants for name lookup\r\n      \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\", \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\",\r\n      \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\r\n\r\n\r\n   // Operator Precedence table\r\n   //\r\n   // 1- !, 2- : ,, 3- M P, 4- %, 5- ^, 6- * /, 7- + -, 8- &, 9- < > = G(>=) L(<=) N(<>),\r\n   // Negative value means Right Associative\r\n\r\n   SocialCalc.Formula.TokenPrecedence = {\r\n      \"!\": 1,\r\n      \":\": 2, \",\": 2,\r\n      \"M\": -3, \"P\": -3,\r\n      \"%\": 4,\r\n      \"^\": 5,\r\n      \"*\": 6, \"/\": 6,\r\n      \"+\": 7, \"-\": 7,\r\n      \"&\": 8,\r\n      \"<\": 9, \">\": 9, \"G\": 9, \"L\": 9, \"N\": 9\r\n      };\r\n\r\n   // Convert one-char token text to input text:\r\n\r\n   SocialCalc.Formula.TokenOpExpansion = {'G': '>=', 'L': '<=', 'M': '-', 'N': '<>', 'P': '+'};\r\n\r\n   //\r\n   // Information about the resulting value types when doing operations on values (used by LookupResultType)\r\n   //\r\n   // Each object entry is an object with specific types with result type info as follows:\r\n   //\r\n   //    'type1a': '|type2a:resulta|type2b:resultb|...\r\n   //    Type of t* or n* matches any of those types not listed\r\n   //    Results may be a type or the numbers 1 or 2 specifying to return type1 or type2\r\n   \r\n\r\n   SocialCalc.Formula.TypeLookupTable = {\r\n       unaryminus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       unaryplus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       unarypercent: { 'n*': '|n:n%|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       plus: {\r\n                'n%': '|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nd': '|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nt': '|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'ndt': '|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'n$': '|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nl': '|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'n': '|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'b': '|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                't*': '|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|',\r\n                'n*': '|ni:1|e*:2|',\r\n                'e*': '|e*:1|n*:1|t*:1|b:1|'\r\n               },\r\n       concat: {\r\n                't': '|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|',\r\n                'th': '|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|',\r\n                'tw': '|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|',\r\n                'tl': '|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|',\r\n                't*': '|t*:t|e*:2|',\r\n                'e*': '|e*:1|n*:1|t*:1|'\r\n               },\r\n       oneargnumeric: { 'n*': '|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       twoargnumeric: { 'n*': '|n*:n|t*:e#VALUE!|e*:2|', 'e*': '|e*:1|n*:1|t*:1|', 't*': '|t*:e#VALUE!|n*:e#VALUE!|e*:2|'},\r\n       propagateerror: { 'n*': '|n*:2|e*:2|', 'e*': '|e*:2|', 't*': '|t*:2|e*:2|', 'b': '|b:2|e*:2|'}\r\n      };\r\n\r\n/* *******************\r\n\r\n parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(line)\r\n\r\n Parses a text string as if it was a spreadsheet formula\r\n\r\n This uses a simple state machine run on each character in turn.\r\n States remember whether a number is being gathered, etc.\r\n The result is parseinfo which is an array with one entry for each token:\r\n   parseinfo[i] = {\r\n     text: \"the characters making up the parsed token\",\r\n     type: the type of the token (a number),\r\n     opcode: a single character version of an operator suitable for use in the\r\n                  precedence table and distinguishing between unary and binary + and -.\r\n\r\n************************* */\r\n\r\nSocialCalc.Formula.ParseFormulaIntoTokens = function(line) {\r\n\r\n   var i, ch, cclass, haddecimal, last_token, last_token_type, last_token_text, t;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var parsestate = scf.ParseState;\r\n   var tokentype = scf.TokenType;\r\n   var charclass = scf.CharClass;\r\n   var charclasstable = scf.CharClassTable;\r\n   var uppercasetable = scf.UpperCaseTable; // much faster than toUpperCase function\r\n   var pushtoken = scf.ParsePushToken;\r\n   var coordregex = /^\\$?[A-Z]{1,2}\\$?[1-9]\\d*$/i;\r\n\r\n   var parseinfo = [];\r\n   var str = \"\";\r\n   var state = 0;\r\n   var haddecimal = false;\r\n\r\n  for (i=0; i<=line.length; i++) {\r\n      if (i<line.length) {\r\n         ch = line.charAt(i);\r\n         cclass = charclasstable[ch];\r\n         }\r\n      else {\r\n         ch = \"\";\r\n         cclass = charclass.eof;\r\n         }\r\n\r\n      if (state == parsestate.num) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.numstart && !haddecimal) {\r\n            haddecimal = true;\r\n            str += ch;\r\n            }\r\n         else if (ch == \"E\" || ch == \"e\") {\r\n            str += ch;\r\n            haddecimal = false;\r\n            state = parsestate.numexp1;\r\n            }\r\n         else { // end of number - save it\r\n            pushtoken(parseinfo, str, tokentype.num, 0);\r\n            haddecimal = false;\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.numexp1) {\r\n         if (cclass == parsestate.num) {\r\n            state = parsestate.numexp2;\r\n            }\r\n         else if ((ch == '+' || ch == '-') && (uppercasetable[str.charAt(str.length-1)] == 'E')) {\r\n            str += ch;\r\n            }\r\n         else if (ch == 'E' || ch == 'e') {\r\n            ;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrexponent, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.numexp2) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else { // end of number - save it\r\n            pushtoken(parseinfo, str, tokentype.num, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.alpha) {\r\n         if (cclass == charclass.num) {\r\n            state = parsestate.coord;\r\n            }\r\n         else if (cclass == charclass.alpha || ch == \".\") { // alpha may be letters, numbers, \"_\", or \".\"\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.incoord) {\r\n            state = parsestate.coord;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart\r\n                || cclass == charclass.space || cclass == charclass.eof) {\r\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.coord) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.incoord) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.alpha) {\r\n            state = parsestate.alphanumeric;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart ||\r\n                  cclass == charclass.eof || cclass == charclass.space) {\r\n            if (coordregex.test(str)) {\r\n               t = tokentype.coord;\r\n               }\r\n            else {\r\n               t = tokentype.name;\r\n               }\r\n            pushtoken(parseinfo, str.toUpperCase(), t, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n           }\r\n         }\r\n\r\n\r\n      if (state == parsestate.alphanumeric) {\r\n         if (cclass == charclass.num || cclass == charclass.alpha) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart\r\n                || cclass == charclass.space || cclass == charclass.eof) {\r\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.string) {\r\n         if (cclass == charclass.quote) {\r\n            state = parsestate.stringquote; // got quote in string: is it doubled (quote in string) or by itself (end of string)?\r\n            }\r\n         else if (cclass == charclass.eof) {\r\n            pushtoken(parseinfo, scc.s_parseerrstring, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            str += ch;\r\n            }\r\n         }\r\n      else if (state == parsestate.stringquote) { // note else if here\r\n         if (cclass == charclass.quote) {\r\n            str += ch;\r\n            state = parsestate.string; // double quote: add one then continue getting string\r\n            }\r\n         else { // something else -- end of string\r\n            pushtoken(parseinfo, str, tokentype.string, 0);\r\n            state = 0; // drop through to process\r\n            }\r\n         }\r\n\r\n      else if (state == parsestate.specialvalue) { // special values like #REF!\r\n         if (str.charAt(str.length-1) == \"!\") { // done - save value as a name\r\n            pushtoken(parseinfo, str, tokentype.name, 0);\r\n            state = 0; // drop through to process\r\n            }\r\n         else if (cclass == charclass.eof) {\r\n            pushtoken(parseinfo, scc.s_parseerrspecialvalue, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            str += ch;\r\n            }\r\n         }\r\n\r\n      if (state == 0) {\r\n         if (cclass == charclass.num) {\r\n            str = ch;\r\n            state = parsestate.num;\r\n            }\r\n         else if (cclass == charclass.numstart) {\r\n            str = ch;\r\n            haddecimal = true;\r\n            state = parsestate.num;\r\n            }\r\n         else if (cclass == charclass.alpha || cclass == charclass.incoord) {\r\n            str = ch;\r\n            state = parsestate.alpha;\r\n            }\r\n         else if (cclass == charclass.specialstart) {\r\n            str = ch;\r\n            state = parsestate.specialvalue;\r\n            }\r\n         else if (cclass == charclass.op) {\r\n            str = ch;\r\n            if (parseinfo.length>0) {\r\n               last_token = parseinfo[parseinfo.length-1];\r\n               last_token_type = last_token.type;\r\n               last_token_text = last_token.text;\r\n               if (last_token_type == charclass.op) {\r\n                  if (last_token_text == '<' || last_token_text == \">\") {\r\n                     str = last_token_text + str;\r\n                     parseinfo.pop();\r\n                     if (parseinfo.length>0) {\r\n                        last_token = parseinfo[parseinfo.length-1];\r\n                        last_token_type = last_token.type;\r\n                        last_token_text = last_token.text;\r\n                        }\r\n                     else {\r\n                        last_token_type = charclass.eof;\r\n                        last_token_text = \"EOF\";\r\n                        }\r\n                     }\r\n                  }\r\n               }\r\n            else {\r\n               last_token_type = charclass.eof;\r\n               last_token_text = \"EOF\";\r\n               }\r\n            t = tokentype.op;\r\n            if ((parseinfo.length == 0)\r\n                || (last_token_type == charclass.op && last_token_text != ')' && last_token_text != '%')) { // Unary operator\r\n               if (str == '-') { // M is unary minus\r\n                  str = \"M\";\r\n                  ch = \"M\";\r\n                  }\r\n               else if (str == '+') { // P is unary plus\r\n                  str = \"P\";\r\n                  ch = \"P\";\r\n                  }\r\n               else if (str == ')' && last_token_text == '(') { // null arg list OK\r\n                  ;\r\n                  }\r\n               else if (str != '(') { // binary-op open-paren OK, others no\r\n                  t = tokentype.error;\r\n                  str = scc.s_parseerrtwoops;\r\n                  }\r\n               }\r\n            else if (str.length > 1) {\r\n               if (str == '>=') { // G is >=\r\n                  str = \"G\";\r\n                  ch = \"G\";\r\n                  }\r\n               else if (str == '<=') { // L is <=\r\n                  str = \"L\";\r\n                  ch = \"L\";\r\n                  }\r\n               else if (str == '<>') { // N is <>\r\n                  str = \"N\";\r\n                  ch = \"N\";\r\n                  }\r\n               else {\r\n                  t = tokentype.error;\r\n                  str = scc.s_parseerrtwoops;\r\n                  }\r\n               }\r\n            pushtoken(parseinfo, str, t, ch);\r\n            state = 0;\r\n            }\r\n         else if (cclass == charclass.quote) { // starting a string\r\n            str = \"\";\r\n            state = parsestate.string;\r\n            }\r\n         else if (cclass == charclass.space) { // store so can reconstruct spacing\r\n            //pushtoken(parseinfo, \" \", tokentype.space, 0);\r\n            }\r\n         else if (cclass == charclass.eof) { // ignore -- needed to have extra loop to close out other things\r\n            }\r\n         else { // unknown class - such as unknown char\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            }\r\n         }\r\n      }\r\n\r\n   return parseinfo;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.ParsePushToken = function(parseinfo, ttext, ttype, topcode) {\r\n\r\n   parseinfo.push({text: ttext, type: ttype, opcode: topcode});\r\n\r\n   }\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, allowrangereturn)\r\n\r\n Does the calculation expressed in a parsed formula, returning a value, its type, and error info\r\n returns: {value: value, type: valuetype, error: errortext}.\r\n\r\n If allowrangereturn is present and true, can return a range (e.g., \"A1:A10\" - translated from \"A1|A10|\")\r\n\r\n************************* */\r\n\r\nSocialCalc.Formula.evaluate_parsed_formula = function(parseinfo, sheet, allowrangereturn) {\r\n\r\n   var result;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var tokentype = scf.TokenType;\r\n\r\n   var revpolish;\r\n   var parsestack = [];\r\n\r\n   var errortext = \"\";\r\n\r\n   revpolish = scf.ConvertInfixToPolish(parseinfo); // result is either an array or a string with error text\r\n\r\n   result = scf.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn);\r\n\r\n   return result;\r\n\r\n}\r\n\r\n//\r\n// revpolish = SocialCalc.Formula.ConvertInfixToPolish(parseinfo)\r\n//\r\n// Convert infix to reverse polish notation\r\n//\r\n// Returns revpolish array with a sequence of references to tokens by number if successful.\r\n// Errors return a string with the error.\r\n//\r\n// Based upon the algorithm shown in Wikipedia \"Reverse Polish notation\" article\r\n// and then enhanced for additional spreadsheet things\r\n//\r\n\r\nSocialCalc.Formula.ConvertInfixToPolish = function(parseinfo) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var tokentype = scf.TokenType;\r\n   var token_precedence = scf.TokenPrecedence;\r\n\r\n   var revpolish = [];\r\n   var parsestack = [];\r\n\r\n   var errortext = \"\";\r\n\r\n   var function_start = -1;\r\n\r\n   var i, pii, ttype, ttext, tprecedence, tstackprecedence;\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      pii = parseinfo[i];\r\n      ttype = pii.type;\r\n      ttext = pii.text;\r\n      if (ttype == tokentype.num || ttype == tokentype.coord || ttype == tokentype.string) {\r\n         revpolish.push(i);\r\n         }\r\n      else if (ttype == tokentype.name) {\r\n         parsestack.push(i);\r\n         revpolish.push(function_start);\r\n         }\r\n      else if (ttype == tokentype.space) { // ignore\r\n         continue;\r\n         }\r\n      else if (ttext == ',') {\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         if (parsestack.length == 0) { // no ( -- error\r\n            errortext = scc.s_parseerrmissingopenparen;\r\n            break;\r\n            }\r\n         }\r\n      else if (ttext == '(') {\r\n         parsestack.push(i);\r\n         }\r\n      else if (ttext == ')') {\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         if (parsestack.length == 0) { // no ( -- error\r\n            errortext = scc.s_parseerrcloseparennoopen;\r\n            break;\r\n            }\r\n         parsestack.pop();\r\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         }\r\n      else if (ttype == tokentype.op) {\r\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.op\r\n                && parseinfo[parsestack[parsestack.length-1]].text != '(') {\r\n            tprecedence = token_precedence[pii.opcode];\r\n            tstackprecedence = token_precedence[parseinfo[parsestack[parsestack.length-1]].opcode];\r\n            if (tprecedence >= 0 && tprecedence < tstackprecedence) {\r\n               break;\r\n               }\r\n            else if (tprecedence < 0) {\r\n               tprecedence = -tprecedence;\r\n               if (tstackprecedence < 0) tstackprecedence = -tstackprecedence;\r\n               if (tprecedence <= tstackprecedence) {\r\n                  break;\r\n                  }\r\n               }\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         parsestack.push(i);\r\n         }\r\n      else if (ttype == tokentype.error) {\r\n         errortext = ttext;\r\n         break;\r\n         }\r\n      else {\r\n         errortext = \"Internal error while processing parsed formula. \";\r\n         break;\r\n         }\r\n      }\r\n   while (parsestack.length>0) {\r\n      if (parseinfo[parsestack[parsestack.length-1]].text == '(') {\r\n         errortext = scc.s_parseerrmissingcloseparen;\r\n         break;\r\n         }\r\n      revpolish.push(parsestack.pop());\r\n      }\r\n\r\n   if (errortext) {\r\n      return errortext;\r\n      }\r\n\r\n   return revpolish;\r\n\r\n   }\r\n\r\n\r\n// DebugLog\r\n// display logged objects in the audit tab of the spreadsheet control\r\nif(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];\r\n\r\nSocialCalc.DebugLog = function(logObject) {\t\r\n//\tSocialCalc.debug_log.push(logObject);\r\n}\r\n\r\n\r\n//\r\n// result = SocialCalc.Formula.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn)\r\n//\r\n// Execute reverse polish representation of formula\r\n//\r\n// Operand values are objects in the operand array with a \"type\" and an optional \"value\".\r\n// Type can have these values (many are type and sub-type as two or more letters):\r\n//    \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"start\", \"eErrorType\", \"b\" (blank)\r\n// The value of a coord is in the form A57 or A57!sheetname\r\n// The value of a range is coord|coord|number where number starts at 0 and is\r\n// the offset of the next item to fetch if you are going through the range one by one\r\n// The number starts as a null string (\"A1|B3|\")\r\n//\r\n\r\nSocialCalc.Formula.EvaluatePolish = function(parseinfo, revpolish, sheet, allowrangereturn) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var tokentype = scf.TokenType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookup = scf.TypeLookupTable;\r\n   var operand_as_number = scf.OperandAsNumber;\r\n   var operand_as_text = scf.OperandAsText;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var operands_as_coord_on_sheet = scf.OperandsAsCoordOnSheet;\r\n   var format_number_for_display = SocialCalc.format_number_for_display || function(v, t, f) {return v+\"\";};\r\n\r\n   var errortext = \"\";\r\n   var function_start = -1;\r\n   var missingOperandError = {value: \"\", type: \"e#VALUE!\", error: scc.s_parseerrmissingoperand};\r\n\r\n   var operand = [];\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   var i, rii, prii, ttype, ttext, value1, value2, tostype, tostype2, resulttype, valuetype, cond, vmatch, smatch;\r\n\r\n   if (!parseinfo.length || (! (revpolish instanceof Array))) {\r\n      return ({value: \"\", type: \"e#VALUE!\", error: (typeof revpolish == \"string\" ? revpolish : \"\")});\r\n      }\r\n\r\n\t  \r\n\t  // eddy EvaluatePolish { \r\n    //    SocialCalc.DebugLog({ revpolish: revpolish});\r\n    //    SocialCalc.DebugLog({ revpolish: revpolish});\r\n\t  // }\r\n\r\n\t// eddy EvaluatePolish {\r\n\t\r\n\t// e.g parameterInfo: [ {'text':'E1','type':2,'opcode':0}, ... ] \r\n    var parameterInfo = [];\r\n    // }\t\r\n\t  \r\n\t  \r\n   for (i=0; i<revpolish.length; i++) {\r\n      rii = revpolish[i];\r\n      if (rii == function_start) { // Remember the start of a function argument list\r\n         PushOperand(\"start\", 0);\r\n         continue;\r\n         }\r\n\r\n      prii = parseinfo[rii];\r\n      ttype = prii.type;\r\n      ttext = prii.text;\r\n\t  // eddy EvaluatePolish {\r\n\t  parameterInfo.push(prii);\r\n\t  // }\r\n\t  \r\n      if (ttype == tokentype.num) {\r\n         PushOperand(\"n\", ttext-0);\r\n         }\r\n\r\n      else if (ttype == tokentype.coord) {\r\n         PushOperand(\"coord\", ttext);\r\n\t\t \r\n         }\r\n\r\n      else if (ttype == tokentype.string) {\r\n         PushOperand(\"t\", ttext);\r\n         }\r\n\r\n      else if (ttype == tokentype.op) {\r\n         if (operand.length <= 0) { // Nothing on the stack...\r\n            return missingOperandError;\r\n            break; // done\r\n            }\r\n\r\n         // Unary minus\r\n\r\n         if (ttext == 'M') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryminus);\r\n            PushOperand(resulttype, -value1.value);\r\n            }\r\n\r\n         // Unary plus\r\n\r\n         else if (ttext == 'P') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryplus);\r\n            PushOperand(resulttype, value1.value);\r\n            }\r\n\r\n         // Unary % - percent, left associative\r\n\r\n         else if (ttext == '%') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unarypercent);\r\n            PushOperand(resulttype, 0.01*value1.value);\r\n            }\r\n\r\n         // & - string concatenate\r\n\r\n         else if (ttext == '&') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value2 = operand_as_text(sheet, operand);\r\n            value1 = operand_as_text(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.concat);\r\n            PushOperand(resulttype, value1.value + value2.value);\r\n            }\r\n\r\n         // : - Range constructor\r\n\r\n         else if (ttext == ':') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value1 = scf.OperandsAsRangeOnSheet(sheet, operand); // get coords even if use name on other sheet\r\n            if (value1.error) { // not available\r\n               errortext = errortext || value1.error;\r\n               }\r\n            PushOperand(value1.type, value1.value); // push sheetname with range on that sheet\r\n            }\r\n\r\n         // ! - sheetname!coord\r\n\r\n         else if (ttext == '!') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value1 = operands_as_coord_on_sheet(sheet, operand); // get coord even if name on other sheet\r\n            if (value1.error) { // not available\r\n               errortext = errortext || value1.error;\r\n               }\r\n            PushOperand(value1.type, value1.value); // push sheetname with coord or range on that sheet\r\n            }\r\n\r\n         // Comparison operators: < L = G > N (< <= = >= > <>)\r\n\r\n         else if (ttext == \"<\" || ttext == \"L\" || ttext == \"=\" || ttext == \"G\" || ttext == \">\" || ttext == \"N\") {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               errortext = scc.s_parseerrmissingoperand; // remember error\r\n               break;\r\n               }\r\n            value2 = operand_value_and_type(sheet, operand);\r\n            value1 = operand_value_and_type(sheet, operand);\r\n            if (value1.type.charAt(0) == \"n\" && value2.type.charAt(0) == \"n\") { // compare two numbers\r\n               cond = 0;\r\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\r\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\r\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\r\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\r\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\r\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\r\n               PushOperand(\"nl\", cond);\r\n               }\r\n            else if (value1.type.charAt(0) == \"e\") { // error on left\r\n               PushOperand(value1.type, 0);\r\n               }               \r\n            else if (value2.type.charAt(0) == \"e\") { // error on right\r\n               PushOperand(value2.type, 0);\r\n               }               \r\n            else { // text maybe mixed with numbers or blank\r\n               tostype = value1.type.charAt(0);\r\n               tostype2 = value2.type.charAt(0);\r\n               if (tostype == \"n\") {\r\n                  value1.value = format_number_for_display(value1.value, \"n\", \"\");\r\n                  }\r\n               else if (tostype == \"b\") {\r\n                  value1.value = \"\";\r\n                  }\r\n               if (tostype2 == \"n\") {\r\n                  value2.value = format_number_for_display(value2.value, \"n\", \"\");\r\n                  }\r\n               else if (tostype2 == \"b\") {\r\n                  value2.value = \"\";\r\n                  }\r\n               cond = 0;\r\n               value1.value = value1.value.toLowerCase(); // ignore case\r\n               value2.value = value2.value.toLowerCase();\r\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\r\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\r\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\r\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\r\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\r\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\r\n               PushOperand(\"nl\", cond);\r\n               }\r\n            }\r\n\r\n         // Normal infix arithmethic operators: +, -. *, /, ^\r\n\r\n         else { // what's left are the normal infix arithmetic operators\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               errortext = scc.s_parseerrmissingoperand; // remember error\r\n               break;\r\n               }\r\n            if (ttext == '+') {\r\n               value2 = operand_value_and_type(sheet, operand);\r\n               value1 = operand_value_and_type(sheet, operand); // allow + to append style formula to widget\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value + value2.value);\r\n               } \r\n            else {\r\n              value2 = operand_as_number(sheet, operand);\r\n              value1 = operand_as_number(sheet, operand);              \r\n              }\r\n              \r\n            if (ttext == '-') {\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value - value2.value);\r\n               }\r\n            else if (ttext == '*') {\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value * value2.value);\r\n               }\r\n            else if (ttext == '/') {\r\n               if (value2.value != 0) {\r\n                  PushOperand(\"n\", value1.value / value2.value); // gives plain numeric result type\r\n                  }\r\n               else {\r\n                  PushOperand(\"e#DIV/0!\", 0);\r\n                  }\r\n               }\r\n            else if (ttext == '^') {\r\n               value1.value = Math.pow(value1.value, value2.value);\r\n               value1.type = \"n\"; // gives plain numeric result type\r\n               if (isNaN(value1.value)) {\r\n                  value1.value = 0;\r\n                  value1.type = \"e#NUM!\";\r\n                  }\r\n               PushOperand(value1.type, value1.value);\r\n               }\r\n            }\r\n         }\r\n\r\n      // function or name\r\n\r\n      else if (ttype == tokentype.name) {\r\n\t  \r\n//         errortext = scf.CalculateFunction(ttext, operand, sheet);\r\n         errortext = scf.CalculateFunction(ttext, operand, sheet, parseinfo.coord); // eddy also pass the cell id\r\n\t\t \r\n         if (errortext) break;\r\n\t\t \r\n\t\t \r\n         }\r\n\r\n\t\t \r\n      else {\r\n         errortext = scc.s_InternalError+\"Unknown token \"+ttype+\" (\"+ttext+\"). \";\r\n         break;\r\n         }\r\n      }\r\n\r\n   // look at final value and handle special cases\r\n\r\n   value = operand[0] ? operand[0].value : \"\";\r\n   tostype = operand[0] ? operand[0].type : \"\";\r\n\r\n   if (tostype == \"name\") { // name - expand it\r\n      value1 = SocialCalc.Formula.LookupName(sheet, value);\r\n      value = value1.value;\r\n      tostype = value1.type;\r\n      errortext = errortext || value1.error;\r\n      }\r\n\r\n   if (tostype == \"coord\") { // the value is a coord reference, get its value and type\r\n      value1 = operand_value_and_type(sheet, operand);\r\n      value = value1.value;\r\n      tostype = value1.type;\r\n      if (tostype == \"b\") {\r\n         tostype = \"n\";\r\n         value = 0;\r\n         }\r\n      }\r\n\r\n   if (operand.length > 1 && !errortext) { // something left - error\r\n      errortext += scc.s_parseerrerrorinformula;\r\n      }\r\n\r\n   // set return type\r\n\r\n   valuetype = tostype;\r\n\r\n   if (tostype.charAt(0) == \"e\") { // error value\r\n      errortext = errortext || tostype.substring(1) || scc.s_calcerrerrorvalueinformula;\r\n      }\r\n   else if (tostype == \"range\") {\r\n      vmatch = value.match(/^(.*)\\|(.*)\\|/);\r\n      smatch = vmatch[1].indexOf(\"!\");\r\n      if (smatch>=0) { // swap sheetname\r\n         vmatch[1] = vmatch[1].substring(smatch+1) + \"!\" + vmatch[1].substring(0, smatch).toUpperCase();\r\n         }\r\n      else {\r\n         vmatch[1] = vmatch[1].toUpperCase();\r\n         }\r\n      value = vmatch[1] + \":\" + vmatch[2].toUpperCase();\r\n      if (!allowrangereturn) {\r\n         errortext = scc.s_formularangeresult+\" \"+value;\r\n         }\r\n      }\r\n\r\n   if (errortext && valuetype.charAt(0) != \"e\") {\r\n      value = errortext;\r\n      valuetype = \"e\";\r\n     }\r\n\r\n   // look for overflow\r\n\r\n   if (valuetype.charAt(0) == \"n\" && (isNaN(value) || !isFinite(value))) {\r\n      value = 0;\r\n      valuetype = \"e#NUM!\";\r\n      errortext = isNaN(value) ? scc.s_calcerrnumericnan: scc.s_calcerrnumericoverflow;\r\n      }\r\n\r\n   return ({value: value, type: valuetype, error: errortext});\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# resulttype = SocialCalc.Formula.LookupResultType(type1, type2, typelookup);\r\n#\r\n# typelookup has values of the following form:\r\n#\r\n#    typelookup{\"typespec1\"} = \"|typespec2A:resultA|typespec2B:resultB|...\"\r\n#\r\n# First type1 is looked up. If no match, then the first letter (major type) of type1 plus \"*\" is looked up\r\n# resulttype is type1 if result is \"1\", type2 if result is \"2\", otherwise the value of result.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LookupResultType = function(type1, type2, typelookup) {\r\n\r\n   var pos1, pos2, result;\r\n\r\n   var table1 = typelookup[type1];\r\n\r\n   if (!table1) {\r\n      table1 = typelookup[type1.charAt(0)+'*'];\r\n      if (!table1) {\r\n         return \"e#VALUE! (internal error, missing LookupResultType \"+type1.charAt(0)+\"*)\"; // missing from table -- please add it\r\n         }\r\n      }\r\n   pos1 = table1.indexOf(\"|\"+type2+\":\");\r\n   if (pos1 >= 0) {\r\n      pos2 = table1.indexOf(\"|\", pos1+1);\r\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\r\n      result = table1.substring(pos1+type2.length+2, pos2);\r\n      if (result == \"1\") return type1;\r\n      if (result == \"2\") return type2;\r\n      return result;\r\n      }\r\n   pos1 = table1.indexOf(\"|\"+type2.charAt(0)+\"*:\");\r\n   if (pos1 >= 0) {\r\n      pos2 = table1.indexOf(\"|\", pos1+1);\r\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\r\n      result = table1.substring(pos1+4, pos2);\r\n      if (result == \"1\") return type1;\r\n      if (result == \"2\") return type2;\r\n      return result;\r\n      }\r\n   return \"e#VALUE!\";\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.TopOfStackValueAndType(sheet, operand)\r\n#\r\n# Returns top of stack value and type and then pops the stack.\r\n# The result is {value: value, type: type, error: \"only if bad error\"}\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.TopOfStackValueAndType = function(sheet, operand) {\r\n\r\n   var cellvtype, cell, pos, coordsheet;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   if (!stacklen) { // make sure something is there\r\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\r\n      return result;\r\n      }\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   if (result.type == \"name\") {\r\n      result = scf.LookupName(sheet, result.value);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# operandinfo = OperandAsNumber(sheet, operand)\r\n#\r\n# Uses operand_value_and_type to get top of stack and pops it.\r\n# Returns numeric value and type.\r\n# Text values are treated as 0 if they can't be converted somehow.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsNumber = function(sheet, operand) {\r\n\r\n   var t, valueinfo;\r\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\r\n\r\n   t = operandinfo.type.charAt(0);\r\n\r\n   if (t == \"n\") {\r\n      operandinfo.value = operandinfo.value-0;\r\n      }\r\n   else if (t == \"b\") { // blank cell\r\n      operandinfo.type = \"n\";\r\n      operandinfo.value = 0;\r\n      }\r\n   else if (t == \"e\") { // error\r\n      operandinfo.value = 0;\r\n      }\r\n   else {\r\n      valueinfo = SocialCalc.DetermineValueType ? SocialCalc.DetermineValueType(operandinfo.value) :\r\n                                                    {value: operandinfo.value-0, type: \"n\"}; // if without rest of SocialCalc\r\n      if (valueinfo.type.charAt(0) == \"n\") {\r\n         operandinfo.value = valueinfo.value-0;\r\n         operandinfo.type = valueinfo.type;\r\n         }\r\n      else {\r\n         operandinfo.value = 0;\r\n         operandinfo.type = valueinfo.type;\r\n         }\r\n      }\r\n\r\n   return operandinfo;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = OperandAsText(sheet, operand)\r\n#\r\n# Uses operand_value_and_type to get top of stack and pops it.\r\n# Returns text value, preserving sub-type.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsText = function(sheet, operand) {\r\n\r\n   var t, valueinfo;\r\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\r\n\r\n   t = operandinfo.type.charAt(0);\r\n\r\n   if (t ==  \"t\") { // any flavor of text returns as is\r\n      ;\r\n      }\r\n   else if (t == \"n\") {\r\n      operandinfo.value = SocialCalc.format_number_for_display ?\r\n                             SocialCalc.format_number_for_display(operandinfo.value, operandinfo.type, \"\") :\r\n                             operandinfo.value = operandinfo.value+\"\";\r\n      operandinfo.type = \"t\";\r\n      }\r\n   else if (t == \"b\") { // blank\r\n      operandinfo.value = \"\";\r\n      operandinfo.type = \"t\";\r\n      }\r\n   else if (t == \"e\") { // error\r\n      operandinfo.value = \"\";\r\n      }\r\n   else {\r\n      operand.value = operandinfo.value + \"\";\r\n      operand.type = \"t\";\r\n      }\r\n\r\n   return operandinfo;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandValueAndType(sheet, operand)\r\n#\r\n# Pops the top of stack and returns it, following a coord reference if necessary.\r\n# The result is {value: value, type: type, error: \"only if bad error\"}\r\n# Ranges are returned as if they were pushed onto the stack first coord first\r\n# Also sets type with \"t\", \"n\", \"th\", etc., as appropriate\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandValueAndType = function(sheet, operand) {\r\n\r\n   var cellvtype, cell, pos, coordsheet;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   if (!stacklen) { // make sure something is there\r\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\r\n      return result;\r\n      }\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   if (result.type == \"name\") {\r\n      result = scf.LookupName(sheet, result.value);\r\n      }\r\n\r\n   if (result.type == \"range\") {\r\n      result = scf.StepThroughRangeDown(operand, result.value);\r\n      }\r\n\r\n   if (result.type == \"coord\") { // value is a coord reference\r\n      coordsheet = sheet;\r\n      pos = result.value.indexOf(\"!\");\r\n      if (pos != -1) { // sheet reference\r\n         coordsheet = scf.FindInSheetCache(result.value.substring(pos+1)); // get other sheet\r\n         if (coordsheet == null) { // unavailable\r\n            result.type = \"e#REF!\";\r\n            result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+result.value.substring(pos+1);\r\n            result.value = 0;\r\n            return result;\r\n            }\r\n         result.value = result.value.substring(0, pos); // get coord part\r\n         }\r\n\r\n      if (coordsheet) {\r\n         cell = coordsheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\r\n         if (cell) {\r\n            cellvtype = cell.valuetype; // get type of value in the cell it points to\r\n            result.value = cell.datavalue;\r\n            }\r\n         else {\r\n            cellvtype = \"b\";\r\n            }\r\n         }\r\n      else {\r\n         cellvtype = \"e#N/A\";\r\n         result.value = 0;\r\n         }\r\n      result.type = cellvtype || \"b\";\r\n      if (result.type == \"b\") { // blank\r\n         result.value = 0;\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsCoord(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns coord value. All others are treated as an error.\r\n#\r\n*/\r\n\r\n\r\nSocialCalc.Formula.OperandAsCoord = function(sheet, operand) {\r\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"coord\");\r\n}\r\n\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsRange(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns coord value. All others are treated as an error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsRange = function(sheet, operand) {\r\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"range\");\r\n}\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsType(sheet, operand, operandtype)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns operandtype value. All others are treated as an error.\r\n#\r\n*/\r\nSocialCalc.Formula.OperandAsType = function(sheet, operand, operandtype) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n   if (result.type == \"name\") {\r\n      result = SocialCalc.Formula.LookupName(sheet, result.value);\r\n      }\r\n   if (result.type == operandtype) { // value is a coord reference\r\n      return result;\r\n      }\r\n   else {\r\n      result.value = SocialCalc.Constants.s_calcerrcellrefmissing;\r\n      result.type = \"e#REF!\";\r\n      return result;\r\n      }\r\n}\r\n\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandsAsCoordOnSheet(sheet, operand)\r\n#\r\n# Gets 2 at top of stack and pops them, treating them as sheetname!coord-or-name.\r\n# Returns stack-style coord value (coord!sheetname, or coord!sheetname|coord|) with\r\n# a type of coord or range. All others are treated as an error.\r\n# If sheetname not available, sets result.error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandsAsCoordOnSheet = function(sheet, operand) {\r\n\r\n   var sheetname, othersheet, pos1, pos2;\r\n   var value1 = {};\r\n   var result = {};\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var stacklen = operand.length;\r\n   value1.value = operand[stacklen-1].value; // get top of stack - coord or name\r\n   value1.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   sheetname = scf.OperandAsSheetName(sheet, operand); // get sheetname as text\r\n   othersheet = scf.FindInSheetCache(sheetname.value);\r\n   if (othersheet == null) { // unavailable\r\n      result.type = \"e#REF!\";\r\n      result.value = 0;\r\n      result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+sheetname.value;\r\n      return result;\r\n      }\r\n\r\n   if (value1.type == \"name\") {\r\n      value1 = scf.LookupName(othersheet, value1.value);\r\n      }\r\n   result.type = value1.type;\r\n   if (value1.type == \"coord\") { // value is a coord reference\r\n      result.value = value1.value + \"!\" + sheetname.value; // return in the format as used on stack\r\n      }\r\n   else if (value1.type == \"range\") { // value is a range reference\r\n      pos1 = value1.value.indexOf(\"|\");\r\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\r\n      result.value = value1.value.substring(0, pos1) + \"!\" + sheetname.value +\r\n                    \"|\" + value1.value.substring(pos1+1, pos2) + \"|\";\r\n      }\r\n   else if (value1.type.charAt(0)==\"e\") {\r\n      result.value = value1.value;\r\n      }\r\n   else {\r\n      result.error = SocialCalc.Constants.s_calcerrcellrefmissing;\r\n      result.type = \"e#REF!\";\r\n      result.value = 0;\r\n      }\r\n   return result;\r\n   \r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandsAsRangeOnSheet(sheet, operand)\r\n#\r\n# Gets 2 at top of stack and pops them, treating them as coord2-or-name:coord1.\r\n# Name is evaluated on sheet of coord1.\r\n# Returns result with \"value\" of stack-style range value (coord!sheetname|coord|) and\r\n# \"type\" of \"range\". All others are treated as an error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandsAsRangeOnSheet = function(sheet, operand) {\r\n\r\n   var value1, othersheet, pos1, pos2;\r\n   var value2 = {};\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var stacklen = operand.length;\r\n   value2.value = operand[stacklen-1].value; // get top of stack - coord or name for \"right\" side\r\n   value2.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   value1 = scf.OperandAsCoord(sheet, operand); // get \"left\" coord\r\n   if (value1.type != \"coord\") { // not a coord, which it must be\r\n      return {value: 0, type: \"e#REF!\"};\r\n      }\r\n\r\n   othersheet = sheet;\r\n   pos1 = value1.value.indexOf(\"!\");\r\n   if (pos1 != -1) { // sheet reference\r\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\r\n      if (pos2 < 0) pos2 = value1.value.length;\r\n      othersheet = scf.FindInSheetCache(value1.value.substring(pos1+1,pos2)); // get other sheet\r\n      if (othersheet == null) { // unavailable\r\n         return {value: 0, type: \"e#REF!\", errortext: scc.s_sheetunavailable+\" \"+value1.value.substring(pos1+1,pos2)};\r\n         }\r\n      }\r\n\r\n   if (value2.type == \"name\") { // coord:name is allowed, if name is just one cell\r\n      value2 = scf.LookupName(othersheet, value2.value, \"end\");\r\n      }\r\n\r\n   if (value2.type == \"coord\") { // value is a coord reference, so return the combined range\r\n      return {value: value1.value+\"|\"+value2.value+\"|\", type: \"range\"}; // return range in the format as used on stack\r\n      }\r\n   else { // bad form\r\n      return {value: scc.s_calcerrcellrefmissing, type: \"e#REF!\"};\r\n      }\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandAsSheetName(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns sheetname value. All others are treated as an error.\r\n# Accepts text, cell reference, and named value which is one of those two.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsSheetName = function(sheet, operand) {\r\n\r\n   var nvalue, cell;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n   if (result.type == \"name\") {\r\n      nvalue = SocialCalc.Formula.LookupName(sheet, result.value);\r\n      if (!nvalue.value) { // not a known name - return bare name as the name value\r\n         return result;\r\n         }\r\n      result.value = nvalue.value;\r\n      result.type = nvalue.type;\r\n      }\r\n   if (result.type == \"coord\") { // value is a coord reference, follow it to find sheet name\r\n      cell = sheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\r\n      if (cell) {\r\n         result.value = cell.datavalue;\r\n         result.type = cell.valuetype;\r\n         }\r\n      else {\r\n         result.value = \"\";\r\n         result.type = \"b\";\r\n         }\r\n      }\r\n   if (result.type.charAt(0) == \"t\") { // value is a string which could be a sheet name\r\n      return result;\r\n      }\r\n   else {\r\n      result.value = \"\";\r\n      result.error = SocialCalc.Constants.s_calcerrsheetnamemissing;\r\n      return result;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// value = SocialCalc.Formula.LookupName(sheet, name)\r\n//\r\n// Returns value and type of a named value\r\n// Names are case insensitive\r\n// Names may have a definition which is a coord (A1), a range (A1:B7), or a formula (=OFFSET(A1,0,0,5,1))\r\n// Note: The range must not have sheet names (\"!\") in them.\r\n//\r\n\r\nSocialCalc.Formula.LookupName = function(sheet, name, isEnd) {\r\n\r\n   var pos, specialc, parseinfo;\r\n   var names = sheet.names;\r\n   var value = {};\r\n   var startedwalk = false;\r\n\r\n   if (names[name.toUpperCase()]) { // is name defined?\r\n\r\n      value.value = names[name.toUpperCase()].definition; // yes\r\n\r\n      if (value.value.charAt(0) == \"=\") { // formula\r\n         if (!sheet.checknamecirc) { // are we possibly walking the name tree?\r\n            sheet.checknamecirc = {}; // not yet\r\n            startedwalk = true; // remember we are the reference that started it\r\n            }\r\n         else {\r\n            if (sheet.checknamecirc[name]) { // circular reference\r\n               value.type = \"e#NAME?\";\r\n               value.error = SocialCalc.Constants.s_circularnameref+' \"' + name + '\".';\r\n               return value;\r\n               }\r\n            }\r\n         sheet.checknamecirc[name] = true;\r\n\r\n         parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(value.value.substring(1));\r\n         value = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, 1); // parse formula, allowing range return\r\n\r\n         delete sheet.checknamecirc[name]; // done with us\r\n         if (startedwalk) {\r\n            delete sheet.checknamecirc; // done with walk\r\n            }\r\n\r\n         if (value.type != \"range\") {\r\n            return value;\r\n            }\r\n         }\r\n\r\n      pos = value.value.indexOf(\":\");\r\n      if (pos != -1) { // range\r\n         value.type = \"range\";\r\n         value.value = value.value.substring(0, pos) + \"|\" + value.value.substring(pos+1)+\"|\";\r\n         value.value = value.value.toUpperCase();\r\n         }\r\n      else {\r\n         value.type = \"coord\";\r\n         value.value = value.value.toUpperCase();\r\n         }\r\n      return value;\r\n      }\r\n   else if (specialc=SocialCalc.Formula.SpecialConstants[name.toUpperCase()]) { // special constant, like #REF!\r\n      pos = specialc.indexOf(\",\");\r\n      value.value = specialc.substring(0,pos)-0;\r\n      value.type = specialc.substring(pos+1);\r\n      return value;\r\n      }\r\n   else if (/^[a-zA-Z][a-zA-Z]?$/.test(name)) {\r\n      value.type = \"coord\";\r\n      value.value = name.toUpperCase() + (isEnd ? sheet.attribs.lastrow : 1);\r\n      return value;\r\n   }\r\n   else {\r\n      value.value = \"\";\r\n      value.type = \"e#NAME?\";\r\n      value.error = SocialCalc.Constants.s_calcerrunknownname+' \"'+name+'\"';\r\n      return value;\r\n      }\r\n   }\r\n\r\n/*\r\n#\r\n# coord = SocialCalc.Formula.StepThroughRangeDown(operand, rangevalue)\r\n#\r\n# Returns next coord in a range, keeping track on the operand stack\r\n# Goes from upper left across and down to bottom right.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.StepThroughRangeDown = function(operand, rangevalue) {\r\n\r\n   var value1, value2, sequence, pos1, pos2, sheet1, rp, c, r, count;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   pos1 = rangevalue.indexOf(\"|\");\r\n   pos2 = rangevalue.indexOf(\"|\", pos1+1);\r\n   value1 = rangevalue.substring(0, pos1);\r\n   value2 = rangevalue.substring(pos1+1, pos2);\r\n   sequence = rangevalue.substring(pos2+1) - 0;\r\n\r\n   pos1 = value1.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      sheet1 = value1.substring(pos1);\r\n      value1 = value1.substring(0, pos1);\r\n      }\r\n   else {\r\n      sheet1 = \"\";\r\n      }\r\n   pos1 = value2.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      value2 = value2.substring(0, pos1);\r\n      }\r\n\r\n   rp = scf.OrderRangeParts(value1, value2);\r\n   \r\n   count = 0;\r\n   for (r=rp.r1; r<=rp.r2; r++) {\r\n      for (c=rp.c1; c<=rp.c2; c++) {\r\n         count++;\r\n         if (count > sequence) {\r\n            if (r!=rp.r2 || c!=rp.c2) { // keep on stack until done\r\n               scf.PushOperand(operand, \"range\", value1+sheet1+\"|\"+value2+\"|\"+count);\r\n               }\r\n            return {value: SocialCalc.crToCoord(c, r)+sheet1, type: \"coord\"};\r\n            }\r\n         }\r\n      }\r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.DecodeRangeParts(sheetdata, range)\r\n#\r\n# Returns sheetdata for the sheet where the range is, as well as\r\n# the number of the first column in the range, the number of columns,\r\n# and equivalent row information:\r\n#\r\n# {sheetdata: sheet, sheetname: name-or-\"\", col1num: n, ncols: n, row1num: n, nrows: n}\r\n#\r\n# If any errors, a null result is returned.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DecodeRangeParts = function(sheetdata, range) {\r\n\r\n   var value1, value2, pos1, pos2, sheet1, coordsheetdata, rp;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   pos1 = range.indexOf(\"|\");\r\n   pos2 = range.indexOf(\"|\", pos1+1);\r\n   value1 = range.substring(0, pos1);\r\n   value2 = range.substring(pos1+1, pos2);\r\n\r\n   pos1 = value1.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      sheet1 = value1.substring(pos1+1);\r\n      value1 = value1.substring(0, pos1);\r\n      }\r\n   else {\r\n      sheet1 = \"\";\r\n      }\r\n   pos1 = value2.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      value2 = value2.substring(0, pos1);\r\n      }\r\n\r\n   coordsheetdata = sheetdata;\r\n   if (sheet1) { // sheet reference\r\n      coordsheetdata = scf.FindInSheetCache(sheet1);\r\n      if (coordsheetdata == null) { // unavailable\r\n         return null;\r\n         }\r\n      }\r\n\r\n   rp = scf.OrderRangeParts(value1, value2);\r\n\r\n   return {sheetdata: coordsheetdata, sheetname: sheet1, col1num: rp.c1, ncols: rp.c2-rp.c1+1, row1num: rp.r1, nrows: rp.r2-rp.r1+1}\r\n\r\n   }\r\n\r\n\r\n\r\n//*********************\r\n//\r\n// Function Handling\r\n//\r\n//*********************\r\n\r\n// List of functions -- Define after functions are defined\r\n//\r\n// SocialCalc.Formula.FunctionList[\"function_name\"] = [function_subroutine, number_of_arguments, arg_def, func_def, func_class, cell_html, io_parameters]\r\n//   function_subroutine takes arguments (fname, operand, foperand, sheet), returns\r\n//      errortext or null, pushing result on operand stack.\r\n//   number_of_arguments is:\r\n//      0 = no arguments\r\n//      >0 = exactly that many arguments\r\n//      <0 = that many arguments (abs value) or more\r\n//      100 = don't check\r\n//\r\n//   arg_def, if present, is the name of the element in SocialCalc.Formula.FunctionArgDefs.\r\n//   func_def, if present, is a string explaining the function. If not, looked up in SocialCalc.Constants.\r\n//   func_class, if present, is the comma-separated names of the elements in SocialCalc.Formula.FunctionClasses.\r\n//   cell_html, if present, is the HTML to display in the cell. will find and replace these <%=cell_reference%>, <%=displayvalue%> see SocialCalc.FormatValueForDisplay\r\n//   io_parameters, if present, \r\n//        \"ParameterList\" is used with =CopyValue() etc, used to collect parameters of the formula, for use trigger/action formulas, \r\n//        \"EventTree\" is used with =Button() etc, used to store trigger cell lookup table\r\n//        \"Input\" store copy of value in formdata sheet -- for input style GUI widgets - textbox/radio buttons etc - \r\n//        \"TimeTrigger\" like button, but triggers an action at a time,  rather than on click\r\n//\r\n// To add a function, just add it to this object.\r\n\r\n   if (!SocialCalc.Formula.FunctionList) { // make sure it is defined (could have been in another module)\r\n      SocialCalc.Formula.FunctionList = {};\r\n      }\r\n\r\n   // FunctionClasses[classname] = {name: full-name-string, items: [sorted list of function names]};\r\n   // filled in by SocialCalc.Formula.FillFunctionInfo\r\n\r\n   SocialCalc.Formula.FunctionClasses = null; // start null to say needs filling in\r\n\r\n   // FunctionArgDef[argname] = explicit-string-for-arg-list;\r\n   // filled in by SocialCalc.Formula.FillFunctionInfo\r\n\r\n   SocialCalc.Formula.FunctionArgDefs = {};\r\n\r\n\r\n   \r\n\r\n/*\r\n#\r\n# SocialCalc.Formula.StoreIoEventFormula(function_name, coord, operand_reverse, sheet, io_parameters)\r\n# \r\n# store forumla parameters of io event formulas\r\n#\r\n# enable lookup of ioForumalas when a trigger formula is activated \r\n# store formula details in sheet.ioEventTree  and sheet.ioParameterList \r\n#\r\n*/\r\n// eddy StoreIoEventFormula\r\nSocialCalc.Formula.StoreIoEventFormula = function(function_name, coord, operand_reverse, sheet, io_parameters) {\r\n\tvar operand = [];\r\n\tSocialCalc.Formula.Clone(operand,operand_reverse);\r\n    operand.reverse(); // normal parameter order\r\n    if(operand.length == 0) return;\r\n\t\r\n\t\r\n\r\n  if(typeof sheet.ioEventTree === 'undefined') sheet.ioEventTree = {};\t// action formulas - e.g. COPYVALUE, COPYFORMULA  - these action formulas are triggered by a trigger formula \r\n  if(typeof sheet.ioParameterList === 'undefined') sheet.ioParameterList = {}; // widget parameters - e.g. BUTTON, TEXTBOX - this is updated when the widget state changes\r\n  if(typeof sheet.ioTimeTriggerList === 'undefined') sheet.ioTimeTriggerList = {}; // \r\n  if(typeof sheet.radioGroupList === 'undefined') sheet.radioGroupList = {}; // \r\n\r\n  // store parameters of each action formulas \r\n  if(typeof sheet.ioParameterList[coord] === 'undefined') sheet.ioParameterList[coord] = {};\r\n  sheet.ioParameterList[coord] = operand;\r\n  sheet.ioParameterList[coord].function_name = function_name;\r\n  \r\n  // add radio buttons to list - so radio group can be updated\r\n//  if(function_name == \"RADIOBUTTON\") {\r\n//    \r\n//    if(operand.length > 1) {\r\n//      if (sheet.radioGroupList[]) {\r\n//        sheet.radioGroup.push()\r\n//      } else {\r\n//        \r\n//      } \r\n//    }\r\n//  }\r\n\r\n  \r\n  // send trigger times to server if changed\r\n  if(io_parameters == \"TimeTrigger\") { // timer trigger formula exists   \r\n    // function to push cell time into array\r\n    var PushTriggerTime = function(list, coordA1, sheetData) {\r\n      var cell = sheetData.cells[coordA1];   \r\n      if (typeof cell !== 'undefined' && cell.valuetype.charAt(0) == \"n\") { // if not blank and is number\r\n        list.push(cell.datavalue);\r\n      }\r\n    };\r\n\r\n    var triggerTimeCellId = SocialCalc.Formula.PlainCoord(operand[0].value); // strip dollar signs\r\n    \r\n    var currentTriggerTimeList = [];\r\n    \r\n    if(operand[0].type == \"range\" )  {      \r\n      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerTimeCellId);\r\n      for (var i=0; i<rangeinfo.ncols; i++) {\r\n        for (var j=0; j<rangeinfo.nrows; j++) {\r\n          var cellCoord = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n          PushTriggerTime(currentTriggerTimeList, cellCoord, sheet);\r\n        }\r\n      }\r\n    }\r\n    \r\n    if(operand[0].type == \"coord\" ) {      \r\n      PushTriggerTime(currentTriggerTimeList, triggerTimeCellId, sheet);\r\n    }\r\n    \r\n    if (operand[0].type.charAt(0) == \"n\") {\r\n      currentTriggerTimeList.push(operand[0].value);      \r\n    }\r\n\r\n    // if time triggers changed then set changed times in ioTimeTrigger and schedule      \r\n    if(typeof sheet.ioTimeTriggerList[coord] === 'undefined' || SocialCalc.Formula.ArrayValuesEqual(sheet.ioTimeTriggerList[coord], currentTriggerTimeList) == false) {\r\n      // set the time+cell in ioTimeTrigger\r\n      sheet.ioTimeTriggerList[coord] = currentTriggerTimeList;\r\n      // schedule the set Time Trigger // sheet.ScheduleSheetCommands('...    \r\n      var timeZoneOffsetMins = (new Date()).getTimezoneOffset();\r\n      var start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1      \r\n      var triggerUTCTimeList = []; /// EPOCH in Mins - Mins since 1/1/1970 GMT\r\n      for(var index = 0; index < currentTriggerTimeList.length; ++index) triggerUTCTimeList[index] = Math.floor(((currentTriggerTimeList[index] - start_1_1_1970 ) *24 * 60) + timeZoneOffsetMins);\r\n      sheet.ScheduleSheetCommands('settimetrigger '+coord+' '+triggerUTCTimeList.toString());       \r\n    }\r\n  }\r\n  \r\n\t// store trigger lookup table\r\n  if(io_parameters == \"EventTree\"\t&& (operand[0].type == \"coord\" || operand[0].type == \"range\")) { // trigger cell exists   \r\n  \t// create a list of action formulas for each trigger cell  \r\n    var triggerCellId = operand[0].value.replace(/\\$/g,''); // strip dollar signs\r\n    var PushTriggerCord = function(list, index, v) {\r\n        if(typeof list[index] === 'undefined') list[index] = {};\r\n        list[index][v] = v;\r\n    };\r\n\r\n\r\n    if(operand[0].type == \"range\" )  {      \r\n\t      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerCellId);\r\n      for (var i=0; i<rangeinfo.ncols; i++) {\r\n         for (var j=0; j<rangeinfo.nrows; j++) {\r\n            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n                          PushTriggerCord(sheet.ioEventTree, cellcr, coord); \r\n                          \r\n         }\r\n      }\r\n    }\r\n    if(operand[0].type == \"coord\" ) {\r\n        PushTriggerCord(sheet.ioEventTree, triggerCellId, coord); \r\n    }                \r\n  }\r\n\r\n  \r\n  //IF GUI widget is \"Input\"\r\n  if(io_parameters == \"Input\" ) {\r\n    var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n          ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n          : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n    \r\n    if(formDataViewer != null && formDataViewer.loaded == true) {\r\n      \r\n      // IF formFields  not loaded - load formFields  \r\n      if( formDataViewer.formFields == null) SocialCalc.Formula.LoadFormFields();\r\n      //  get formFieldName\r\n      var formFieldName = (function_name+coord).toLowerCase();\r\n      //  if formFieldName not in formFields  \r\n      var sheetCmd = null;\r\n      if(formDataViewer.formFields[formFieldName] == null) {\r\n        //    store formFieldName of gui input widget \r\n        //    add formFieldName  to formFields  \r\n        var col = formDataViewer.formFields[formFieldName] = formDataViewer.formFieldsLength++ + 2;\r\n        //    add formFieldName to next empty cell (starting with B1)\r\n        var headerCoord = SocialCalc.crToCoord(col, 1);\r\n        sheetCmd = \"set \"+headerCoord+\" text t \"+SocialCalc.encodeForSave(function_name.toLowerCase()+coord);\r\n      }\r\n      if(operand[0].type.charAt(0) == \"t\" || operand[0].type.charAt(0) == \"n\") {       \r\n        var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\r\n        if(formDataViewer.sheet.cells[valueCoord] == null ||  formDataViewer.sheet.cells[valueCoord].datavalue != operand[0].value) {\r\n          var sheetCmdTwo = \"set \"+valueCoord+\" text t \"+SocialCalc.encodeForSave(operand[0].value);\r\n          if (sheetCmd != null) sheetCmd = sheetCmd + \"\\n\" + sheetCmdTwo; else sheetCmd = sheetCmdTwo;        \r\n        }\r\n  \r\n      }\r\n      if (sheetCmd != null) formDataViewer.sheet.ScheduleSheetCommands(sheetCmd, false);    \r\n    }    \r\n  }    \r\n        \r\n\r\n\t//SocialCalc.DebugLog({ ioEventTree: sheet.ioEventTree});\r\n\t//SocialCalc.DebugLog({ ioParameterList: sheet.ioParameterList});\r\n}   \r\n   \r\n\r\n/**\r\n * ArrayValuesEqual\r\n * \r\n * Warning - nested vales are NOT tested.\r\n * returns true if both arrays contain the same values\r\n */    \r\nSocialCalc.Formula.ArrayValuesEqual = function(a, b) {\r\n  var i = a.length;\r\n  if (i != b.length) return false;\r\n  while (i--) {\r\n      if (a[i] !== b[i]) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nSocialCalc.Formula.Clone =   function(destination, source) {\r\n        for (var property in source) {\r\n            if (typeof source[property] === \"object\" && source[property] !== null && destination[property]) { \r\n                SocialCalc.Formula.Clone(destination[property], source[property]);\r\n            } else {\r\n                destination[property] = source[property];\r\n            }\r\n        }\r\n    };   \r\n\r\n/**\r\n * LoadFormFields\r\n * \r\n * Load the fieldNames of the form \r\n *  Cell A1 contains \"FieldName:\" and cells B1 to n contain field names\r\n *  Cell A2 contains \"Pending\" - pending data row. The pending row is moved to row 3 by inseting a new row 2 onSubmit \r\n *  Put the fieldNames into an array for fast lookup and position information\r\n */    \r\n    \r\nSocialCalc.Formula.LoadFormFields =   function() {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n    ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n    : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n\r\n  formDataViewer.formFields = {};\r\n\r\n  \r\n  //IF cell A1 is blank - Adds \"FieldName:\" to A1\r\n  if(formDataViewer.sheet.cells.A1 == null ) {\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A1 text t \"+SocialCalc.encodeForSave(\"FieldName:\"), false);       \r\n  }\r\n  \r\n  if(formDataViewer.sheet.cells.A2 == null ) {\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A2 text t \"+SocialCalc.encodeForSave(\"Pending:\"), false);       \r\n  }\r\n\r\n  \r\n  //  For each cell in row 1, from B1 to 1st blank cell\r\n  var col = 2;\r\n  while(true) {\r\n    var coord = SocialCalc.crToCoord(col, 1);\r\n    var cell=formDataViewer.sheet.cells[coord];\r\n    if (!cell) break;\r\n    //    Put cell value into formFields  \r\n    formDataViewer.formFields[cell.datavalue.toLowerCase()] = col;\r\n    col ++;\r\n  }\r\n  formDataViewer.formFieldsLength = col -2;\r\n\r\n}    \r\n   \r\n/*\r\n#\r\n# errortext = SocialCalc.Formula.CalculateFunction(fname, operand, sheet)\r\n#\r\n# Dispatches for function fname.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CalculateFunction = function(fname, operand, sheet, coord) {\r\n\r\n   var fobj, foperand, ffunc, argnum, ttext;\r\n   var scf = SocialCalc.Formula;\r\n   var ok = 1;\r\n   var errortext = \"\";\r\n\r\n   fobj = scf.FunctionList[fname];\r\n\r\n   if (fobj) {\r\n   \r\n\r\n      foperand = [];\r\n      ffunc = fobj[0];\r\n      argnum = fobj[1];\r\n      scf.CopyFunctionArgs(operand, foperand);\r\n\r\n\t  // eddy CalculateFunction {\r\n   if(fobj[6] && fobj[6] != \"\") {\t  \r\n\t   SocialCalc.DebugLog(\"action:\"+fname);\t\t\r\n\t\t scf.StoreIoEventFormula(fname, coord, foperand, sheet, fobj[6]);\r\n\t\t\r\n\t  }\r\n\t  // }\r\n\t  \r\n      if (argnum != 100) {\r\n         if (argnum < 0) {\r\n            if (foperand.length < -argnum) {\r\n               errortext = scf.FunctionArgsError(fname, operand);\r\n               return errortext;\r\n               }\r\n            }\r\n         else {\r\n            if (foperand.length != argnum) {\r\n               errortext = scf.FunctionArgsError(fname, operand);\r\n               return errortext;\r\n               }\r\n            }\r\n         }\r\n\r\n\t\t \r\n\t  \r\n      errortext = ffunc(fname, operand, foperand, sheet, coord);\r\n      }\r\n\r\n   else {\r\n         ttext = fname;\r\n\r\n         if (operand.length && operand[operand.length-1].type == \"start\") { // no arguments - name or zero arg function\r\n            operand.pop();\r\n            scf.PushOperand(operand, \"name\", ttext);\r\n            }\r\n\r\n         else {\r\n            errortext = SocialCalc.Constants.s_sheetfuncunknownfunction+\" \" + ttext +\". \";\r\n            }\r\n      }\r\n\r\n   return errortext;\r\n\r\n}\r\n\r\n//\r\n// SocialCalc.Formula.PushOperand(operand, t, v)\r\n//\r\n// Pushes the type and value onto the operand stack\r\n//\r\n\r\nSocialCalc.Formula.PushOperand = function(operand, t, v) {\r\n\r\n   operand.push({type: t, value: v});\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Formula.CopyFunctionArgs(operand, foperand)\r\n//\r\n// Pops operands from operand and pushes on foperand up to function start\r\n// reversing order in the process.\r\n//\r\n\r\nSocialCalc.Formula.CopyFunctionArgs = function(operand, foperand) {\r\n\r\n   var fobj, foperand, ffunc, argnum;\r\n   var scf = SocialCalc.Formula;\r\n   var ok = 1;\r\n   var errortext = null;\r\n\r\n   while (operand.length>0 && operand[operand.length-1].type != \"start\") { // get each arg\r\n      foperand.push(operand.pop()); // copy it\r\n      }\r\n   operand.pop(); // get rid of \"start\"\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// errortext = SocialCalc.Formula.FunctionArgsError(fname, operand)\r\n//\r\n// Pushes appropriate error on operand stack and returns errortext, including fname\r\n//\r\n\r\nSocialCalc.Formula.FunctionArgsError = function(fname, operand) {\r\n\r\n   var errortext = SocialCalc.Constants.s_calcerrincorrectargstofunction+\" \" + fname + \". \";\r\n   SocialCalc.Formula.PushOperand(operand, \"e#VALUE!\", errortext);\r\n\r\n   return errortext;\r\n\r\n   }\r\n\r\n\r\n//\r\n// errortext = SocialCalc.Formula.FunctionSpecificError(fname, operand, errortype, errortext)\r\n//\r\n// Pushes specified error and text on operand stack.\r\n//\r\n\r\nSocialCalc.Formula.FunctionSpecificError = function(fname, operand, errortype, errortext) {\r\n\r\n   SocialCalc.Formula.PushOperand(operand, errortype, errortext);\r\n\r\n   return errortext;\r\n\r\n   }\r\n\r\n//\r\n// haserror = SocialCalc.Formula.CheckForErrorValue(operand, v)\r\n//\r\n// If v.type is an error, push it on operand stack and return true, otherwise return false.\r\n//\r\n\r\nSocialCalc.Formula.CheckForErrorValue = function(operand, v) {\r\n\r\n   if (v.type.charAt(0) == \"e\") {\r\n      operand.push(v);\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n\r\n   }\r\n\r\n/////////////////////////\r\n//\r\n// FUNCTION INFORMATION ROUTINES\r\n//\r\n\r\n//\r\n// SocialCalc.Formula.FillFunctionInfo()\r\n//\r\n// Goes through function definitions and fills out FunctionArgDefs and FunctionClasses.\r\n// Execute this after any changes to SocialCalc.Constants but before UI is used.\r\n//\r\n\r\nSocialCalc.Formula.FillFunctionInfo = function() {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var fname, f, classes, cname, i;\r\n\r\n   if (scf.FunctionClasses) { // only do once\r\n      return;\r\n      }\r\n\r\n   for (fname in scf.FunctionList) {\r\n      f = scf.FunctionList[fname];\r\n      if (f[2]) { // has an arg def\r\n         scf.FunctionArgDefs[f[2]] = scc[\"s_farg_\"+f[2]] || \"\"; // get it from constants\r\n         }\r\n      if (!f[3]) { // no text def, see if in constants\r\n         if (scc[\"s_fdef_\"+fname]) {\r\n            scf.FunctionList[fname][3] = scc[\"s_fdef_\"+fname];\r\n            }\r\n         }\r\n      }\r\n\r\n   scf.FunctionClasses = {};\r\n \r\n   for (i=0; i<scc.function_classlist.length; i++) {\r\n      cname = scc.function_classlist[i];\r\n      scf.FunctionClasses[cname] = {name: scc[\"s_fclass_\"+cname], items: []};\r\n      }\r\n\r\n   for (fname in scf.FunctionList) {\r\n      f = scf.FunctionList[fname];\r\n      classes = f[4] ? f[4].split(\",\") : []; // get classes\r\n      classes.push(\"all\");\r\n      for (i=0; i<classes.length; i++) {\r\n         cname = classes[i];\r\n         scf.FunctionClasses[cname].items.push(fname);\r\n         }\r\n      }\r\n   for (cname in scf.FunctionClasses) {\r\n      scf.FunctionClasses[cname].items.sort();\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// str = SocialCalc.Formula.FunctionArgString(fname)\r\n//\r\n// Returns a string representing the arguments to function fname.\r\n//\r\n\r\nSocialCalc.Formula.FunctionArgString = function(fname) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var fdata = scf.FunctionList[fname];\r\n   var nargs, i, str;\r\n\r\n   var adef = fdata[2];\r\n\r\n   if (!adef) {\r\n      nargs = fdata[1];\r\n      if (nargs == 0) {\r\n         adef = \" \";\r\n         }\r\n      else if (nargs > 0) {\r\n         str = \"v1\";\r\n         for (i=2; i<=nargs; i++) {\r\n            str += \", v\"+i;\r\n            }\r\n         return str;\r\n         }\r\n      else if (nargs < 0) {\r\n         str = \"v1\";\r\n         for (i=2; i<-nargs; i++) {\r\n            str += \", v\"+i;\r\n            }\r\n         return str+\", ...\";\r\n         }\r\n      else {\r\n         return \"nargs: \"+nargs;\r\n         }\r\n      }\r\n\r\n   str = scf.FunctionArgDefs[adef] || adef;\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\n/////////////////////////\r\n//\r\n// FUNCTION DEFINITIONS\r\n//\r\n// The standard function definitions follow.\r\n//\r\n// Note that some need SocialCalc.DetermineValueType to be defined.\r\n//\r\n\r\n/*\r\n#\r\n# AVERAGE(v1,c1:c2,...)\r\n# CONCAT(value_or_range,...)\r\n# CONCATENATE(value_or_range,...)\r\n# COUNT(v1,c1:c2,...)\r\n# COUNTA(v1,c1:c2,...)\r\n# COUNTBLANK(v1,c1:c2,...)\r\n# MAX(v1,c1:c2,...)\r\n# MIN(v1,c1:c2,...)\r\n# PRODUCT(v1,c1:c2,...)\r\n# STDEV(v1,c1:c2,...)\r\n# STDEVP(v1,c1:c2,...)\r\n# SUM(v1,c1:c2,...)\r\n# VAR(v1,c1:c2,...)\r\n# VARP(v1,c1:c2,...)\r\n#\r\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\r\n# If this routine is changed, check the dseries_functions, too.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SeriesFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, t, v1;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n\r\n   var concat = \"\";\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n   var counta = 0;\r\n   var countblank = 0;\r\n   var product = 1;\r\n   var maxval;\r\n   var minval;\r\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\r\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\r\n\r\n   while (foperand.length > 0) {\r\n      value1 = operand_value_and_type(sheet, foperand);\r\n      t = value1.type.charAt(0);\r\n      if (t == \"n\") count += 1;\r\n      if (t != \"b\") counta += 1;\r\n      if (t == \"b\") countblank += 1;\r\n      if (t != \"e\" && t != \"b\") concat = concat + value1.value;\r\n\r\n      if (t == \"n\") {\r\n         v1 = value1.value-0; // get it as a number\r\n         sum += v1;\r\n         product *= v1;\r\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\r\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\r\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\r\n            mk1 = v1;\r\n            sk1 = 0;\r\n            }\r\n         else { // Accumulate S sub 1 through n as per Knuth noted above\r\n            mk = mk1 + (v1 - mk1) / count;\r\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\r\n            sk1 = sk;\r\n            mk1 = mk;\r\n            }\r\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\r\n         }\r\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value1.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   switch (fname) {\r\n      case \"CONCAT\":\r\n      case \"CONCATENATE\":\r\n        PushOperand(\"t\", concat);\r\n        break;\r\n\r\n      case \"SUM\":\r\n         PushOperand(resulttypesum, sum);\r\n         break;\r\n\r\n      case \"PRODUCT\": // may handle cases with text differently than some other spreadsheets\r\n         PushOperand(resulttypesum, product);\r\n         break;\r\n\r\n      case \"MIN\":\r\n         PushOperand(resulttypesum, minval || 0);\r\n         break;\r\n\r\n      case \"MAX\":\r\n         PushOperand(resulttypesum, maxval || 0);\r\n         break;\r\n\r\n      case \"COUNT\":\r\n         PushOperand(\"n\", count);\r\n         break;\r\n\r\n      case \"COUNTA\":\r\n         PushOperand(\"n\", counta);\r\n         break;\r\n\r\n      case \"COUNTBLANK\":\r\n         PushOperand(\"n\", countblank);\r\n         break;\r\n\r\n      case \"AVERAGE\":\r\n         if (count > 0) {\r\n            PushOperand(resulttypesum, sum/count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"STDEV\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"STDEVP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"VAR\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / (count - 1));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"VARP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"AVERAGE\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"CONCAT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"text\"];\r\nSocialCalc.Formula.FunctionList[\"CONCATENATE\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"text\"];\r\nSocialCalc.Formula.FunctionList[\"COUNT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"COUNTA\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"COUNTBLANK\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"MAX\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"MIN\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"PRODUCT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"STDEV\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"STDEVP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"SUM\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"VAR\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"VARP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\n\r\n/*\r\n#\r\n# SUMPRODUCT(range1, range2, ...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SumProductFunction = function(fname, operand, foperand, sheet) {\r\n  \r\n   var range, products = [], sum = 0;\r\n   var scf = SocialCalc.Formula;\r\n   var ncols = 0, nrows = 0;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   while (foperand.length > 0) {\r\n      range = scf.TopOfStackValueAndType(sheet, foperand);\r\n      if (range.type != \"range\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      rangeinfo = scf.DecodeRangeParts(sheet, range.value);\r\n      if (!ncols) ncols = rangeinfo.ncols;\r\n      else if (ncols != rangeinfo.ncols) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (!nrows) nrows = rangeinfo.nrows;\r\n      else if (nrows != rangeinfo.nrows) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      for (i=0; i<rangeinfo.ncols; i++) {\r\n         for (j=0; j<rangeinfo.nrows; j++) {\r\n            k = i * rangeinfo.nrows + j;\r\n            cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n            cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\r\n            value = cell.valuetype == \"n\" ? cell.datavalue : 0;\r\n            products[k] = ((typeof products[k] !== 'undefined')? products[k] : 1) * value;\r\n            }\r\n         }\r\n      }\r\n   for (i=0; i<products.length; i++) {\r\n      sum += products[i];\r\n      }\r\n   PushOperand(\"n\", sum);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SUMPRODUCT\"] = [SocialCalc.Formula.SumProductFunction, -1, \"rangen\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# DAVERAGE(databaserange, fieldname, criteriarange)\r\n# DCOUNT(databaserange, fieldname, criteriarange)\r\n# DCOUNTA(databaserange, fieldname, criteriarange)\r\n# DGET(databaserange, fieldname, criteriarange)\r\n# DMAX(databaserange, fieldname, criteriarange)\r\n# DMIN(databaserange, fieldname, criteriarange)\r\n# DPRODUCT(databaserange, fieldname, criteriarange)\r\n# DSTDEV(databaserange, fieldname, criteriarange)\r\n# DSTDEVP(databaserange, fieldname, criteriarange)\r\n# DSUM(databaserange, fieldname, criteriarange)\r\n# DVAR(databaserange, fieldname, criteriarange)\r\n# DVARP(databaserange, fieldname, criteriarange)\r\n#\r\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\r\n# If this routine is changed, check the series_functions, too.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DSeriesFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, tostype, cr, dbrange, fieldname, criteriarange, dbinfo, criteriainfo;\r\n   var fieldasnum, targetcol, i, j, k, cell, criteriafieldnums;\r\n   var testok, criteriacr, criteria, testcol, testcr;\r\n   var t;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   var value1 = {};\r\n\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n   var counta = 0;\r\n   var countblank = 0;\r\n   var countmatches = 0;   \r\n   var product = 1;\r\n   var maxval;\r\n   var minval;\r\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\r\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\r\n\r\n   dbrange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\r\n   fieldname = scf.OperandValueAndType(sheet, foperand); // get a value\r\n   criteriarange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\r\n\r\n   if (dbrange.type != \"range\" || criteriarange.type != \"range\") {\r\n      return scf.FunctionArgsError(fname, operand);\r\n      }\r\n\r\n   dbinfo = scf.DecodeRangeParts(sheet, dbrange.value);\r\n   criteriainfo = scf.DecodeRangeParts(sheet, criteriarange.value);\r\n\r\n   fieldasnum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, fieldname.value, fieldname.type);\r\n   if (fieldasnum <= 0) {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n\r\n   targetcol = dbinfo.col1num + fieldasnum - 1;\r\n   criteriafieldnums = [];\r\n\r\n   for (i=0; i<criteriainfo.ncols; i++) { // get criteria field colnums\r\n      cell = criteriainfo.sheetdata.GetAssuredCell(SocialCalc.crToCoord(criteriainfo.col1num + i, criteriainfo.row1num));\r\n      criterianum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, cell.datavalue, cell.valuetype);\r\n      if (criterianum <= 0) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      criteriafieldnums.push(dbinfo.col1num + criterianum - 1);\r\n      }\r\n\r\n   for (i=1; i<dbinfo.nrows; i++) { // go through each row of the database\r\n      testok = false;\r\nCRITERIAROW:\r\n      for (j=1; j<criteriainfo.nrows; j++) { // go through each criteria row\r\n         for (k=0; k<criteriainfo.ncols; k++) { // look at each column\r\n            criteriacr = SocialCalc.crToCoord(criteriainfo.col1num + k, criteriainfo.row1num + j); // where criteria is\r\n            cell = criteriainfo.sheetdata.GetAssuredCell(criteriacr);\r\n            criteria = cell.datavalue;\r\n            if (typeof criteria == \"string\" && criteria.length == 0) continue; // blank items are OK\r\n            testcol = criteriafieldnums[k];\r\n            testcr = SocialCalc.crToCoord(testcol, dbinfo.row1num + i); // cell to check\r\n            cell = dbinfo.sheetdata.GetAssuredCell(testcr); // get cell to check from dbinfo sheet\r\n            if (!scf.TestCriteria(cell.datavalue, cell.valuetype || \"b\", criteria)) {\r\n               continue CRITERIAROW; // does not meet criteria - check next row\r\n               }\r\n            }\r\n         testok = true; // met all the criteria\r\n         break CRITERIAROW;\r\n         }\r\n      if (!testok) {\r\n         continue;\r\n         }\r\n\r\n      cr = SocialCalc.crToCoord(targetcol, dbinfo.row1num + i); // get cell of this row to do the function on\r\n      cell = dbinfo.sheetdata.GetAssuredCell(cr);\r\n\r\n      value1.value = cell.datavalue;\r\n      value1.type = cell.valuetype;\r\n      t = value1.type.charAt(0);\r\n      countmatches += 1;\r\n      if (t == \"n\") count += 1;\r\n      if (t != \"b\") counta += 1;\r\n      if (t == \"b\") countblank += 1;\r\n\r\n      if (t == \"n\") {\r\n         v1 = value1.value-0; // get it as a number\r\n         sum += v1;\r\n         product *= v1;\r\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\r\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\r\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\r\n            mk1 = v1;\r\n            sk1 = 0;\r\n            }\r\n         else { // Accumulate S sub 1 through n as per Knuth noted above\r\n            mk = mk1 + (v1 - mk1) / count;\r\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\r\n            sk1 = sk;\r\n            mk1 = mk;\r\n            }\r\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\r\n         }\r\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value1.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   switch (fname) {\r\n      case \"DSUM\":\r\n         PushOperand(resulttypesum, sum);\r\n         break;\r\n\r\n      case \"DPRODUCT\": // may handle cases with text differently than some other spreadsheets\r\n         PushOperand(resulttypesum, product);\r\n         break;\r\n\r\n      case \"DMIN\":\r\n         PushOperand(resulttypesum, minval || 0);\r\n         break;\r\n\r\n      case \"DMAX\":\r\n         PushOperand(resulttypesum, maxval || 0);\r\n         break;\r\n\r\n      case \"DCOUNT\":\r\n         PushOperand(\"n\", count);\r\n         break;\r\n\r\n      case \"DCOUNTA\":\r\n         PushOperand(\"n\", counta);\r\n         break;\r\n\r\n      case \"DAVERAGE\":\r\n         if (count > 0) {\r\n            PushOperand(resulttypesum, sum/count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DSTDEV\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DSTDEVP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DVAR\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / (count - 1));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DVARP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DGET\":\r\n         if (countmatches == 1) {\r\n            PushOperand(value1.type, value1.value);\r\n            }\r\n         else if (countmatches == 0) {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            }\r\n         else {\r\n            PushOperand(\"e#NUM!\", 0);\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\nSocialCalc.Formula.FunctionList[\"DAVERAGE\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DCOUNT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DCOUNTA\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DGET\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DMAX\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DMIN\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DPRODUCT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSTDEV\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSTDEVP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSUM\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DVAR\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DVARP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# colnum = SocialCalc.Formula.FieldToColnum(sheet, col1num, ncols, row1num, fieldname, fieldtype)\r\n#\r\n# If fieldname is a number, uses it, otherwise looks up string in cells in row to find field number\r\n#\r\n# If not found, returns 0.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.FieldToColnum = function(sheet, col1num, ncols, row1num, fieldname, fieldtype) {\r\n\r\n   var colnum, cell, value;\r\n\r\n   if (fieldtype.charAt(0) == \"n\") { // number - return it if legal\r\n      colnum = fieldname - 0; // make sure a number\r\n      if (colnum <= 0 || colnum > ncols) {\r\n         return 0;\r\n         }\r\n      return Math.floor(colnum);\r\n      }\r\n\r\n   if (fieldtype.charAt(0) != \"t\") { // must be text otherwise\r\n      return 0;\r\n      }\r\n\r\n   fieldname = fieldname ? fieldname.toLowerCase() : \"\";\r\n\r\n   for (colnum=0; colnum < ncols; colnum++) { // look through column headers for a match\r\n      cell = sheet.GetAssuredCell(SocialCalc.crToCoord(col1num+colnum, row1num));\r\n      value = cell.datavalue;\r\n      value = (value+\"\").toLowerCase(); // ignore case\r\n      if (value == fieldname) { // match\r\n         return colnum+1;\r\n         }         \r\n      }\r\n   return 0; // looked at all and no match\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# HLOOKUP(value, range, row, [rangelookup])\r\n# VLOOKUP(value, range, col, [rangelookup])\r\n# MATCH(value, range, [rangelookup])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LookupFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var lookupvalue, range, offset, rangelookup, offsetvalue, rangeinfo;\r\n   var c, r, cincr, rincr, previousOK, csave, rsave, cell, value, valuetype, cr, lookupvalue;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   lookupvalue = operand_value_and_type(sheet, foperand);\r\n   if (typeof lookupvalue.value == \"string\") {\r\n      lookupvalue.value = lookupvalue.value.toLowerCase();\r\n      }\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand);\r\n\r\n   rangelookup = 1; // default to true or 1\r\n   if (fname == \"MATCH\") {\r\n      if (foperand.length) {\r\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\r\n         if (rangelookup.type.charAt(0) != \"n\") {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         rangelookup = rangelookup.value - 0;\r\n         }\r\n      }\r\n   else {\r\n      offsetvalue = scf.OperandAsNumber(sheet, foperand);\r\n      if (offsetvalue.type.charAt(0) != \"n\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      offsetvalue = Math.floor(offsetvalue.value);\r\n      if (foperand.length) {\r\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\r\n         if (rangelookup.type.charAt(0) != \"n\") {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         rangelookup = rangelookup.value ? 1 : 0; // convert to 1 or 0\r\n         }\r\n      }\r\n   lookupvalue.type = lookupvalue.type.charAt(0); // only deal with general type\r\n   if (lookupvalue.type == \"n\") { // if number, make sure a number\r\n      lookupvalue.value = lookupvalue.value - 0;\r\n      }\r\n\r\n   if (range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   rangeinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\r\n   if (!rangeinfo) {\r\n      PushOperand(\"e#REF!\", 0);\r\n      return;\r\n      }\r\n\r\n   c = 0;\r\n   r = 0;\r\n   cincr = 0;\r\n   rincr = 0;\r\n   if (fname == \"HLOOKUP\") {\r\n      cincr = 1;\r\n      if (offsetvalue > rangeinfo.nrows) {\r\n         PushOperand(\"e#REF!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (fname == \"VLOOKUP\") {\r\n      rincr = 1;\r\n      if (offsetvalue > rangeinfo.ncols) {\r\n         PushOperand(\"e#REF!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (fname == \"MATCH\") {\r\n      if (rangeinfo.ncols > 1) {\r\n         if (rangeinfo.nrows > 1) {\r\n            PushOperand(\"e#N/A\", 0);\r\n            return;\r\n            }\r\n         cincr = 1;\r\n         }\r\n      else {\r\n         rincr = 1;\r\n         }\r\n      }\r\n   else {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   if (offsetvalue < 1 && fname != \"MATCH\") {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return 0;\r\n      }\r\n\r\n   previousOK; // if 1, previous test was <. If 2, also this one wasn't\r\n\r\n   while (1) {\r\n      cr = SocialCalc.crToCoord(rangeinfo.col1num + c, rangeinfo.row1num + r);\r\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\r\n      value = cell.datavalue;\r\n      valuetype = cell.valuetype ? cell.valuetype.charAt(0) : \"b\"; // only deal with general types\r\n      if (valuetype == \"n\") {\r\n         value = value - 0; // make sure number\r\n         }\r\n      if (rangelookup) { // rangelookup type 1 or -1: look for within brackets for matches\r\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            if ((rangelookup > 0 && lookupvalue.value > value)\r\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\r\n               previousOK = 1;\r\n               csave = c; // remember col and row of last OK\r\n               rsave = r;\r\n               }\r\n            else if (previousOK) { // last one was OK, this one isn't\r\n               previousOK = 2;\r\n               break;\r\n               }\r\n            }\r\n\r\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\r\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            if ((rangelookup > 0 && lookupvalue.value > value)\r\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\r\n               previousOK = 1;\r\n               csave = c;\r\n               rsave = r;\r\n               }\r\n            else if (previousOK) { // last one was OK, this one isn't\r\n               previousOK = 2;\r\n               break;\r\n               }\r\n            }\r\n         }\r\n      else { // exact value matches\r\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            }\r\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\r\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            }\r\n         }\r\n\r\n      r += rincr;\r\n      c += cincr;\r\n      if (r >= rangeinfo.nrows || c >= rangeinfo.ncols) { // end of range to check, no exact match\r\n         if (previousOK) { // at least one could have been OK\r\n            previousOK = 2;\r\n            break;\r\n            }\r\n         PushOperand(\"e#N/A\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (previousOK == 2) { // back to last OK\r\n      r = rsave;\r\n      c = csave;\r\n      }\r\n\r\n   if (fname == \"MATCH\") {\r\n      value = c + r + 1; // only one may be <> 0\r\n      valuetype = \"n\";\r\n      }\r\n   else {\r\n      cr = SocialCalc.crToCoord(rangeinfo.col1num+c+(fname == \"VLOOKUP\" ? offsetvalue-1 : 0), rangeinfo.row1num+r+(fname == \"HLOOKUP\" ? offsetvalue-1 : 0));\r\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\r\n      value = cell.datavalue;\r\n      valuetype = cell.valuetype;\r\n      }\r\n   PushOperand(valuetype, value);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"HLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"hlookup\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"MATCH\"] = [SocialCalc.Formula.LookupFunctions, -2, \"match\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"VLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"vlookup\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# INDEX(range, rownum, colnum)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IndexFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var range, sheetname, indexinfo, rowindex, colindex, result, resulttype;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range\r\n   if (range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   indexinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\r\n   if (indexinfo.sheetname) {\r\n      sheetname = \"!\" + indexinfo.sheetname;\r\n      }\r\n   else {\r\n      sheetname = \"\";\r\n      }\r\n\r\n   rowindex = {value:0};\r\n   colindex = {value:0};\r\n\r\n   if (foperand.length) { // look for row number\r\n      rowindex = scf.OperandAsNumber(sheet, foperand);\r\n      if (rowindex.type.charAt(0) != \"n\" || rowindex.value < 0) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (foperand.length) { // look for col number\r\n         colindex = scf.OperandAsNumber(sheet, foperand);\r\n         if (colindex.type.charAt(0) != \"n\" || colindex.value < 0) {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         }\r\n      else { // col number missing\r\n         if (indexinfo.nrows == 1) { // if only one row, then rowindex is really colindex\r\n            colindex.value = rowindex.value;\r\n            rowindex.value = 0;\r\n            }\r\n         }\r\n      }\r\n\r\n   if (rowindex.value > indexinfo.nrows || colindex.value > indexinfo.ncols) {\r\n      PushOperand(\"e#REF!\", 0);\r\n      return;\r\n      }\r\n\r\n   if (rowindex.value == 0) {\r\n      if (colindex.value == 0) {\r\n         if (indexinfo.nrows == 1 && indexinfo.ncols == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+indexinfo.nrows-1) + \r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      else {\r\n         if (indexinfo.nrows == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+indexinfo.nrows-1) +\r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      }\r\n   else {\r\n      if (colindex.value == 0) {\r\n         if (indexinfo.ncols == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+rowindex.value-1) +\r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      else {\r\n         result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+rowindex.value-1) + sheetname;\r\n         resulttype = \"coord\";\r\n         }\r\n      }\r\n\r\n   PushOperand(resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"INDEX\"] = [SocialCalc.Formula.IndexFunction, -1, \"index\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# COUNTIF(c1:c2,\"criteria\")\r\n# SUMIF(c1:c2,\"criteria\",[range2])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CountifSumifFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var range, criteria, sumrange, f2operand, result, resulttype, value1, value2;\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range or coord\r\n   criteria = scf.OperandAsText(sheet, foperand); // get criteria\r\n   if (fname == \"SUMIF\") {\r\n      if (foperand.length == 1) { // three arg form of SUMIF\r\n         sumrange = scf.TopOfStackValueAndType(sheet, foperand);\r\n         }\r\n      else if (foperand.length == 0) { // two arg form\r\n         sumrange = {value: range.value, type: range.type};\r\n         }\r\n      else {\r\n         scf.FunctionArgsError(fname, operand);\r\n         return 0;\r\n         }\r\n      }\r\n   else {\r\n      sumrange = {value: range.value, type: range.type};\r\n      }\r\n\r\n   if (criteria.type.charAt(0) == \"n\") {\r\n      criteria.value = criteria.value + \"\"; // make text\r\n      }\r\n   else if (criteria.type.charAt(0) == \"e\") { // error\r\n      criteria.value = null;\r\n      }\r\n   else if (criteria.type.charAt(0) == \"b\") { // blank here is undefined\r\n      criteria.value = null;\r\n      }\r\n\r\n   if (range.type != \"coord\" && range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   if (fname == \"SUMIF\" && sumrange.type != \"coord\" && sumrange.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   foperand.push(range);\r\n   f2operand = []; // to allow for 3 arg form\r\n   f2operand.push(sumrange);\r\n\r\n   while (foperand.length) {\r\n      value1 = operand_value_and_type(sheet, foperand);\r\n      value2 = operand_value_and_type(sheet, f2operand);\r\n      if (!scf.TestCriteria(value1.value, value1.type, criteria.value)) {\r\n         continue;\r\n         }\r\n\r\n      count += 1;\r\n\r\n      if (value2.type.charAt(0) == \"n\") {\r\n         sum += value2.value-0;\r\n         resulttypesum = lookup_result_type(value2.type, resulttypesum || value2.type, typelookupplus);\r\n         }\r\n      else if (value2.type.charAt(0) == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value2.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   if (fname == \"SUMIF\") {\r\n      PushOperand(resulttypesum, sum);\r\n      }\r\n   else if (fname == \"COUNTIF\") {\r\n      PushOperand(\"n\", count);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"COUNTIF\"] = [SocialCalc.Formula.CountifSumifFunctions, 2, \"rangec\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"SUMIF\"] = [SocialCalc.Formula.CountifSumifFunctions, -2, \"sumif\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# IF(cond,truevalue,falsevalue)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IfFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var cond, t;\r\n\r\n   cond = SocialCalc.Formula.OperandValueAndType(sheet, foperand);\r\n   t = cond.type.charAt(0);\r\n   if (t != \"n\" && t != \"b\") {\r\n      operand.push({type: \"e#VALUE!\", value: 0});\r\n      return;\r\n      }\r\n\r\n   var op1, op2;\r\n\r\n   op1 = foperand.pop();\r\n   if (foperand.length == 1) {\r\n      op2 = foperand.pop();\r\n      }\r\n   else if (foperand.length == 0) {\r\n      op2 = {type: \"n\", value: 0};\r\n      }\r\n   else {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return;\r\n   }\r\n\r\n   operand.push(cond.value ? op1 : op2);\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"IF\"] = [SocialCalc.Formula.IfFunction, -2, \"iffunc\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# DATE(year,month,day)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DateFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var year = scf.OperandAsNumber(sheet, foperand);\r\n   var month = scf.OperandAsNumber(sheet, foperand);\r\n   var day = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(year.type, month.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, day.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      result = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(\r\n                  Math.floor(year.value), Math.floor(month.value), Math.floor(day.value)\r\n                  ) - SocialCalc.FormatNumber.datevalues.julian_offset;\r\n      resulttype = \"nd\";\r\n      }\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DATE\"] = [SocialCalc.Formula.DateFunction, 3, \"date\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# TIME(hour,minute,second)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.TimeFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var hours = scf.OperandAsNumber(sheet, foperand);\r\n   var minutes = scf.OperandAsNumber(sheet, foperand);\r\n   var seconds = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(hours.type, minutes.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, seconds.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      result = ((hours.value * 60 * 60) + (minutes.value * 60) + seconds.value) / (24*60*60);\r\n      resulttype = \"nt\";\r\n      }\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"TIME\"] = [SocialCalc.Formula.TimeFunction, 3, \"hms\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# DAY(date)\r\n# MONTH(date)\r\n# YEAR(date)\r\n# WEEKDAY(date, [type])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DMYFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var ymd, dtype, doffset;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n\r\n   var datevalue = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(datevalue.type, datevalue.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(\r\n               Math.floor(datevalue.value + SocialCalc.FormatNumber.datevalues.julian_offset));\r\n      switch (fname) {\r\n         case \"DAY\":\r\n            result = ymd.day;\r\n            break;\r\n\r\n         case \"MONTH\":\r\n            result = ymd.month;\r\n            break;\r\n\r\n         case \"YEAR\":\r\n            result = ymd.year;\r\n            break;\r\n\r\n         case \"WEEKDAY\":\r\n            dtype = {value: 1};\r\n            if (foperand.length) { // get type if present\r\n               dtype = scf.OperandAsNumber(sheet, foperand);\r\n               if (dtype.type.charAt(0) != \"n\" || dtype.value < 1 || dtype.value > 3) {\r\n                  scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n                  return;\r\n                  }\r\n               if (foperand.length) { // extra args\r\n                  scf.FunctionArgsError(fname, operand);\r\n                  return;\r\n                  }\r\n               }\r\n            doffset = 6;\r\n            if (dtype.value > 1) {\r\n               doffset -= 1;\r\n               }\r\n            result = Math.floor(datevalue.value+doffset) % 7 + (dtype.value < 3 ? 1 : 0);\r\n            break;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DAY\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"MONTH\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"YEAR\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"WEEKDAY\"] = [SocialCalc.Formula.DMYFunctions, -1, \"weekday\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# HOUR(datetime)\r\n# MINUTE(datetime)\r\n# SECOND(datetime)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.HMSFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var hours, minutes, seconds, fraction;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n\r\n   var datetime = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(datetime.type, datetime.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      if (datetime.value < 0) {\r\n         scf.PushOperand(operand, \"e#NUM!\", 0); // must be non-negative\r\n         return;\r\n         }\r\n      fraction = datetime.value - Math.floor(datetime.value); // fraction of a day\r\n      fraction *= 24;\r\n      hours = Math.floor(fraction);\r\n      fraction -= Math.floor(fraction);\r\n      fraction *= 60;\r\n      minutes = Math.floor(fraction);\r\n      fraction -= Math.floor(fraction);\r\n      fraction *= 60;\r\n      seconds = Math.floor(fraction + (datetime.value >= 0 ? 0.5: -0.5));\r\n      if (fname == \"HOUR\") {\r\n         result = hours;\r\n         }\r\n      else if (fname == \"MINUTE\") {\r\n         result = minutes;\r\n         }\r\n      else if (fname == \"SECOND\") {\r\n         result = seconds;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"HOUR\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"MINUTE\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"SECOND\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# EXACT(v1,v2)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ExactFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"nl\";\r\n\r\n   var value1 = scf.OperandValueAndType(sheet, foperand);\r\n   var v1type = value1.type.charAt(0);\r\n   var value2 = scf.OperandValueAndType(sheet, foperand);\r\n   var v2type = value2.type.charAt(0);\r\n\r\n   if (v1type == \"t\") {\r\n      if (v2type == \"t\") {\r\n         result = value1.value == value2.value ? 1 : 0;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = value1.value.length ? 0 : 1;\r\n         }\r\n      else if (v2type == \"n\") {\r\n         result = value1.value == value2.value+\"\" ? 1 : 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"n\") {\r\n      if (v2type == \"n\") {\r\n         result = value1.value-0 == value2.value-0 ? 1 : 0;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = 0;\r\n         }\r\n      else if (v2type == \"t\") {\r\n         result = value1.value+\"\" == value2.value ? 1 : 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"b\") {\r\n      if (v2type == \"t\") {\r\n         result = value2.value.length ? 0 : 1;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = 1;\r\n         }\r\n      else if (v2type == \"n\") {\r\n         result = 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"e\") {\r\n      result = value1.value;\r\n      resulttype = value1.type;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"EXACT\"] = [SocialCalc.Formula.ExactFunction, 2, \"\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# FIND(key,string,[start])\r\n# LEFT(string,[length])\r\n# LEN(string)\r\n# LOWER(string)\r\n# MID(string,start,length)\r\n# PROPER(string)\r\n# REPLACE(string,start,length,new)\r\n# REPT(string,count)\r\n# RIGHT(string,[length])\r\n# SUBSTITUTE(string,old,new,[which])\r\n# TRIM(string)\r\n# HEXCODE(string)\r\n# UPPER(string)\r\n#\r\n*/\r\n\r\n// SocialCalc.Formula.ArgList has an array for each function, one entry for each possible arg (up to max).\r\n// Min args are specified in SocialCalc.Formula.FunctionList.\r\n// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\r\n// Text values are manipulated as UTF-8, converting from and back to byte strings\r\n\r\nSocialCalc.Formula.ArgList = {\r\n                FIND: [1, 1, 0],\r\n                LEFT: [1, 0],\r\n                LEN: [1],\r\n                LOWER: [1],\r\n                MID: [1, 0, 0],\r\n                PROPER: [1],\r\n                REPLACE: [1, 0, 0, 1],\r\n                REPT: [1, 0],\r\n                RIGHT: [1, 0],\r\n                SUBSTITUTE: [1, 1, 1, 0],\r\n                TRIM: [1],\r\n                HEXCODE: [1],\r\n                UPPER: [1]\r\n               };\r\n\r\nSocialCalc.Formula.StringFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var i, value, offset, len, start, count;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var numargs = foperand.length;\r\n   var argdef = scf.ArgList[fname];\r\n   var operand_value = [];\r\n   var operand_type = [];\r\n\r\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\r\n      if (i > argdef.length) { // too many args\r\n         scf.FunctionArgsError(fname, operand);\r\n         return;\r\n         }\r\n      if (argdef[i-1] == 0) {\r\n         value = scf.OperandAsNumber(sheet, foperand);\r\n         }\r\n      else if (argdef[i-1] == 1) {\r\n         value = scf.OperandAsText(sheet, foperand);\r\n         }\r\n      else if (argdef[i-1] == -1) {\r\n         value = scf.OperandValueAndType(sheet, foperand);\r\n         }\r\n      operand_value[i] = value.value;\r\n      operand_type[i] = value.type;\r\n      if (value.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, value.type, result);\r\n         return;\r\n         }\r\n      }\r\n\r\n   switch (fname) {\r\n      case \"FIND\":\r\n         offset = operand_type[3] ? operand_value[3]-1 : 0;\r\n         if (offset < 0) {\r\n            result = \"Start is before string\"; // !! not displayed, no need to translate\r\n            }\r\n         else {\r\n            result = operand_value[2].indexOf(operand_value[1], offset); // (null string matches first char)\r\n            if (result >= 0) {\r\n               result += 1;\r\n               resulttype = \"n\";\r\n               }\r\n            else {\r\n               result = \"Not found\"; // !! not displayed, error is e#VALUE!\r\n               }\r\n            }\r\n         break;\r\n\r\n      case \"LEFT\":\r\n         len = operand_type[2] ? operand_value[2]-0 : 1;\r\n         if (len < 0) {\r\n            result = \"Negative length\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(0, len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"LEN\":\r\n         result = operand_value[1].length;\r\n         resulttype = \"n\";\r\n         break;\r\n\r\n      case \"LOWER\":\r\n         result = operand_value[1].toLowerCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"MID\":\r\n         start = operand_value[2]-0;\r\n         len = operand_value[3]-0;\r\n         if (len < 1 || start < 1) {\r\n            result = \"Bad arguments\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(start-1, start+len-1);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"PROPER\":\r\n         result = operand_value[1].replace(/\\b\\w+\\b/g, function(word) {\r\n                     return word.substring(0,1).toUpperCase() + \r\n                        word.substring(1);\r\n                     }); // uppercase first character of words (see JavaScript, Flanagan, 5th edition, page 704)\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"REPLACE\":\r\n         start = operand_value[2]-0;\r\n         len = operand_value[3]-0;\r\n         if (len < 0 || start < 1) {\r\n            result = \"Bad arguments\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(0, start-1) + operand_value[4] + \r\n               operand_value[1].substring(start-1+len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"REPT\":\r\n         count = operand_value[2]-0;\r\n         if (count < 0) {\r\n            result = \"Negative count\";\r\n            }\r\n         else {\r\n            result = \"\";\r\n            for (; count > 0; count--) {\r\n               result += operand_value[1];\r\n               }\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"RIGHT\":\r\n         len = operand_type[2] ? operand_value[2]-0 : 1;\r\n         if (len < 0) {\r\n            result = \"Negative length\";\r\n            }\r\n         else {\r\n            result = operand_value[1].slice(-len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"SUBSTITUTE\":\r\n         fulltext = operand_value[1];\r\n         oldtext = operand_value[2];\r\n         newtext = operand_value[3];\r\n         if (operand_value[4] != null) {\r\n            which = operand_value[4]-0;\r\n            if (which <= 0) {\r\n               result = \"Non-positive instance number\";\r\n               break;\r\n               }\r\n            }\r\n         else {\r\n            which = 0;\r\n            }\r\n         count = 0;\r\n         oldpos = 0;\r\n         result = \"\";\r\n         while (true) {\r\n            pos = fulltext.indexOf(oldtext, oldpos);\r\n            if (pos >= 0) {\r\n               count++; //!!!!!! old test just in case: if (count>1000) {alert(pos); break;}\r\n               result += fulltext.substring(oldpos, pos);\r\n               if (which==0) {\r\n                  result += newtext; // substitute\r\n                  }\r\n               else if (which==count) {\r\n                  result += newtext + fulltext.substring(pos+oldtext.length);\r\n                  break;\r\n                  }\r\n               else {\r\n                  result += oldtext; // leave as was\r\n                  }\r\n               oldpos = pos + oldtext.length;\r\n               }\r\n            else { // no more\r\n               result += fulltext.substring(oldpos);\r\n               break;\r\n               }\r\n            }\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"TRIM\":\r\n         result = operand_value[1];\r\n         result = result.replace(/^ */, \"\");\r\n         result = result.replace(/ *$/, \"\");\r\n         result = result.replace(/ +/g, \" \");\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"HEXCODE\":\r\n         result = String(operand_value[1]);\r\n         var code = result.charCodeAt(0);\r\n         if (0xD800 <= code && code <= 0xDBFF) {\r\n             var next = result.charCodeAt(1);\r\n             if (0xDC00 <= next && next <= 0xDFFF) {\r\n                 code = ((code - 0xD800) * 0x400) + (next - 0xDC00) + 0x10000;\r\n             }\r\n         }\r\n         result = code.toString(16).toUpperCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"UPPER\":\r\n         result = operand_value[1].toUpperCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"FIND\"] = [SocialCalc.Formula.StringFunctions, -2, \"find\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LEFT\"] = [SocialCalc.Formula.StringFunctions, -2, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LEN\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LOWER\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"MID\"] = [SocialCalc.Formula.StringFunctions, 3, \"mid\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"PROPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"REPLACE\"] = [SocialCalc.Formula.StringFunctions, 4, \"replace\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"REPT\"] = [SocialCalc.Formula.StringFunctions, 2, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"RIGHT\"] = [SocialCalc.Formula.StringFunctions, -1, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"SUBSTITUTE\"] = [SocialCalc.Formula.StringFunctions, -3, \"subs\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"TRIM\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"HEXCODE\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"UPPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# is_functions:\r\n#\r\n# ISBLANK(value)\r\n# ISERR(value)\r\n# ISERROR(value)\r\n# ISLOGICAL(value)\r\n# ISNA(value)\r\n# ISNONTEXT(value)\r\n# ISNUMBER(value)\r\n# ISTEXT(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IsFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"nl\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var t = value.type.charAt(0);\r\n\r\n   switch (fname) {\r\n\r\n      case \"ISBLANK\":\r\n         result = value.type == \"b\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISERR\":\r\n         result = t == \"e\" ? (value.type == \"e#N/A\" ? 0 : 1) : 0;\r\n         break;\r\n\r\n      case \"ISERROR\":\r\n         result = t == \"e\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISLOGICAL\":\r\n         result = value.type == \"nl\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISNA\":\r\n         result = value.type == \"e#N/A\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISNONTEXT\":\r\n         result = t == \"t\" ? 0 : 1;\r\n         break;\r\n\r\n      case \"ISNUMBER\":\r\n         result = t == \"n\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISTEXT\":\r\n         result = t == \"t\" ? 1 : 0;\r\n         break;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"ISBLANK\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISERR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISERROR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISLOGICAL\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNA\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNONTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNUMBER\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# ntv_functions:\r\n#\r\n# N(value)\r\n# T(value)\r\n# VALUE(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NTVFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var t = value.type.charAt(0);\r\n\r\n   switch (fname) {\r\n\r\n      case \"N\":\r\n         result = t == \"n\" ? value.value-0 : 0;\r\n         resulttype = \"n\";\r\n         break;\r\n\r\n      case \"T\":\r\n         result = t == \"t\" ? value.value+\"\" : \"\";\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"VALUE\":\r\n         if (t == \"n\" || t == \"b\") {\r\n            result = value.value || 0;\r\n            resulttype = \"n\";\r\n            }\r\n         else if (t == \"t\") {\r\n            value = SocialCalc.DetermineValueType(value.value);\r\n            if (value.type.charAt(0) != \"n\") {\r\n               result = 0;\r\n               resulttype = \"e#VALUE!\";\r\n               }\r\n            else {\r\n               result = value.value-0;\r\n               resulttype = \"n\";\r\n               }\r\n            }\r\n         break;\r\n      }\r\n\r\n   if (t == \"e\") { // error trumps\r\n      resulttype = value.type;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"N\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"T\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"VALUE\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# ABS(value)\r\n# ACOS(value)\r\n# ASIN(value)\r\n# ATAN(value)\r\n# COS(value)\r\n# DEGREES(value)\r\n# EVEN(value)\r\n# EXP(value)\r\n# FACT(value)\r\n# INT(value)\r\n# LN(value)\r\n# LOG10(value)\r\n# ODD(value)\r\n# RADIANS(value)\r\n# SIN(value)\r\n# SQRT(value)\r\n# TAN(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.Math1Functions = function(fname, operand, foperand, sheet) {\r\n\r\n   var v1, value, f;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   v1 = scf.OperandAsNumber(sheet, foperand);\r\n   value = v1.value;\r\n   result.type = scf.LookupResultType(v1.type, v1.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (result.type == \"n\") {\r\n      switch (fname) {\r\n         case \"ABS\":\r\n            value = Math.abs(value);\r\n            break;\r\n\r\n         case \"ACOS\":\r\n            if (value >= -1 && value <= 1) {\r\n               value = Math.acos(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"ASIN\":\r\n            if (value >= -1 && value <= 1) {\r\n               value = Math.asin(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"ATAN\":\r\n            value = Math.atan(value);\r\n            break;\r\n\r\n         case \"COS\":\r\n            value = Math.cos(value);\r\n            break;\r\n\r\n         case \"DEGREES\":\r\n            value = value * 180/Math.PI;\r\n            break;\r\n\r\n         case \"EVEN\":\r\n            value = value < 0 ? -value : value;\r\n            if (value != Math.floor(value)) {\r\n               value = Math.floor(value + 1) + (Math.floor(value + 1) % 2);\r\n               }\r\n            else { // integer\r\n               value = value + (value % 2);\r\n               }\r\n            if (v1.value < 0) value = -value;\r\n            break;\r\n\r\n         case \"EXP\":\r\n            value = Math.exp(value);\r\n            break;\r\n\r\n         case \"FACT\":\r\n            f = 1;\r\n            value = Math.floor(value);\r\n            for (;value>0;value--) {\r\n               f *= value;\r\n               }\r\n            value = f;\r\n            break;\r\n\r\n         case \"INT\":\r\n            value = Math.floor(value); // spreadsheet INT is floor(), not int()\r\n            break;\r\n\r\n         case \"LN\":\r\n            if (value <= 0) {\r\n               result.type = \"e#NUM!\";\r\n               result.error = SocialCalc.Constants.s_sheetfunclnarg;\r\n               }\r\n            value = Math.log(value);\r\n            break;\r\n\r\n         case \"LOG10\":\r\n            if (value <= 0) {\r\n               result.type = \"e#NUM!\";\r\n               result.error = SocialCalc.Constants.s_sheetfunclog10arg;\r\n               }\r\n            value = Math.log(value)/Math.log(10);\r\n            break;\r\n\r\n         case \"ODD\":\r\n            value = value < 0 ? -value : value;\r\n            if (value != Math.floor(value)) {\r\n               value = Math.floor(value + 1) + (1 - (Math.floor(value + 1) % 2));\r\n               }\r\n            else { // integer\r\n               value = value + (1 - (value % 2));\r\n               }\r\n            if (v1.value < 0) value = -value;\r\n            break;\r\n\r\n         case \"RADIANS\":\r\n            value = value * Math.PI/180;\r\n            break;\r\n\r\n         case \"SIN\":\r\n            value = Math.sin(value);\r\n            break;\r\n\r\n         case \"SQRT\":\r\n            if (value >= 0) {\r\n               value = Math.sqrt(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"TAN\":\r\n            if (Math.cos(value) != 0) {\r\n               value = Math.tan(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n         }\r\n      }\r\n\r\n   result.value = value;\r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"ABS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ACOS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ASIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ATAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"COS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"DEGREES\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"EVEN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"EXP\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"FACT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"INT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"LN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"LOG10\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ODD\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"RADIANS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"SIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"SQRT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\n\r\n\r\n/*\r\n#\r\n# ATAN2(x, y)\r\n# MOD(a, b)\r\n# POWER(a, b)\r\n# TRUNC(value, precision)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.Math2Functions = function(fname, operand, foperand, sheet) {\r\n\r\n   var xval, yval, value, quotient, decimalscale, i;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   xval = scf.OperandAsNumber(sheet, foperand);\r\n   yval = scf.OperandAsNumber(sheet, foperand);\r\n   value = 0;\r\n   result.type = scf.LookupResultType(xval.type, yval.type, scf.TypeLookupTable.twoargnumeric);\r\n\r\n   if (result.type == \"n\") {\r\n      switch (fname) {\r\n         case \"ATAN2\":\r\n            if (xval.value == 0 && yval.value == 0) {\r\n               result.type = \"e#DIV/0!\";\r\n               }\r\n            else {\r\n               result.value = Math.atan2(yval.value, xval.value);\r\n               }\r\n            break;\r\n\r\n         case \"POWER\":\r\n            result.value = Math.pow(xval.value, yval.value);\r\n            if (isNaN(result.value)) {\r\n               result.value = 0;\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"MOD\": // en.wikipedia.org/wiki/Modulo_operation, etc.\r\n            if (yval.value == 0) {\r\n               result.type = \"e#DIV/0!\";\r\n               }\r\n            else {\r\n               quotient = xval.value/yval.value;\r\n               quotient = Math.floor(quotient);\r\n               result.value = xval.value - (quotient * yval.value);\r\n               }\r\n            break;\r\n\r\n         case \"TRUNC\":\r\n            decimalscale = 1; // cut down to required number of decimal digits\r\n            if (yval.value >= 0) {\r\n               yval.value = Math.floor(yval.value);\r\n               for (i=0; i<yval.value; i++) {\r\n                  decimalscale *= 10;\r\n                  }\r\n               result.value = Math.floor(Math.abs(xval.value) * decimalscale) / decimalscale;\r\n               }\r\n            else if (yval.value < 0) {\r\n               yval.value = Math.floor(-yval.value);\r\n               for (i=0; i<yval.value; i++) {\r\n                  decimalscale *= 10;\r\n                  }\r\n               result.value = Math.floor(Math.abs(xval.value) / decimalscale) * decimalscale;\r\n               }\r\n            if (xval.value < 0) {\r\n               result.value = -result.value;\r\n               }\r\n            }\r\n         }\r\n \r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"ATAN2\"] = [SocialCalc.Formula.Math2Functions, 2, \"xy\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"MOD\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"POWER\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TRUNC\"] = [SocialCalc.Formula.Math2Functions, 2, \"valpre\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# LOG(value,[base])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LogFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value, value2;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   result.value = 0;\r\n\r\n   value = scf.OperandAsNumber(sheet, foperand);\r\n   result.type = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\r\n   if (foperand.length == 1) {\r\n      value2 = scf.OperandAsNumber(sheet, foperand);\r\n      if (value2.type.charAt(0) != \"n\" || value2.value <= 0) {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogsecondarg);\r\n         return 0;\r\n         }\r\n      }\r\n   else if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   else {\r\n      value2 = {value: Math.E, type: \"n\"};\r\n      }\r\n\r\n   if (result.type == \"n\") {\r\n      if (value.value <= 0) {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogfirstarg);\r\n         return 0;\r\n         }\r\n      result.value = Math.log(value.value)/Math.log(value2.value);\r\n      }\r\n\r\n   operand.push(result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"LOG\"] = [SocialCalc.Formula.LogFunction, -1, \"log\", \"\", \"math\"];\r\n\r\n\r\n/*\r\n#\r\n# ROUND(value,[precision])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.RoundFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value2, decimalscale, scaledvalue, i;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (foperand.length == 1) {\r\n      value2 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value2.type.charAt(0) != \"n\") {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncroundsecondarg);\r\n         return 0;\r\n         }\r\n      }\r\n   else if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   else {\r\n      value2 = {value: 0, type: \"n\"}; // if no second arg, assume 0 for simple round\r\n      }\r\n\r\n   if (resulttype == \"n\") {\r\n      value2.value = value2.value-0;\r\n      if (value2.value == 0) {\r\n         result = Math.round(value.value);\r\n         }\r\n      else if (value2.value > 0) {\r\n         decimalscale = 1; // cut down to required number of decimal digits\r\n         value2.value = Math.floor(value2.value);\r\n         for (i=0; i<value2.value; i++) {\r\n            decimalscale *= 10;\r\n            }\r\n         scaledvalue = Math.round(value.value * decimalscale);\r\n         result = scaledvalue / decimalscale;\r\n         }\r\n      else if (value2.value < 0) {\r\n         decimalscale = 1; // cut down to required number of decimal digits\r\n         value2.value = Math.floor(-value2.value);\r\n         for (i=0; i<value2.value; i++) {\r\n            decimalscale *= 10;\r\n            }\r\n         scaledvalue = Math.round(value.value / decimalscale);\r\n         result = scaledvalue * decimalscale;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"ROUND\"] = [SocialCalc.Formula.RoundFunction, -1, \"vp\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# CEILING(value, [significance])\r\n# FLOOR(value, [significance])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CeilingFloorFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var val, sig, t;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   val = scf.OperandValueAndType(sheet, foperand);\r\n   t = val.type.charAt(0);\r\n   if (t != \"n\") {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n   if (val.value == 0) {\r\n      PushOperand(\"n\", 0);\r\n      return;\r\n      }\r\n\r\n   if (foperand.length == 1) {\r\n      sig = scf.OperandValueAndType(sheet, foperand);\r\n      t = val.type.charAt(0);\r\n      if (t != \"n\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (foperand.length == 0) {\r\n      sig = {type: \"n\", value: val.value > 0 ? 1 : -1};\r\n      }\r\n   else {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n   if (sig.value == 0) {\r\n      PushOperand(\"n\", 0);\r\n      return;\r\n      }\r\n   if (sig.value * val.value < 0) {\r\n      PushOperand(\"e#NUM!\", 0);\r\n      return;\r\n      }\r\n\r\n   switch (fname) {\r\n      case \"CEILING\":\r\n         PushOperand(\"n\", Math.ceil(val.value / sig.value) * sig.value);\r\n         break;\r\n      case \"FLOOR\":\r\n         PushOperand(\"n\", Math.floor(val.value / sig.value) * sig.value);\r\n         break;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"CEILING\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"FLOOR\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# AND(v1,c1:c2,...)\r\n# OR(v1,c1:c2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.AndOrFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, result;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var resulttype = \"\";\r\n\r\n   if (fname == \"AND\") {\r\n      result = 1;\r\n      }\r\n   else if (fname == \"OR\") {\r\n      result = 0;\r\n      }\r\n\r\n   while (foperand.length) {\r\n      value1 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         value1.value = value1.value-0;\r\n         if (fname == \"AND\") {\r\n            result = value1.value != 0 ? result : 0;\r\n            }\r\n         else if (fname == \"OR\") {\r\n            result = value1.value != 0 ? 1 : result;\r\n            }\r\n         resulttype = scf.LookupResultType(value1.type, resulttype || \"nl\", scf.TypeLookupTable.propagateerror);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\" && resulttype.charAt(0) != \"e\") {\r\n         resulttype = value1.type;\r\n         }\r\n      }\r\n   if (resulttype.length < 1) {\r\n      resulttype = \"e#VALUE!\";\r\n      result = 0;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"AND\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"OR\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# NOT(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NotFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.propagateerror);\r\n\r\n   if (value.type.charAt(0) == \"n\" || value.type == \"b\") {\r\n      result = value.value-0 != 0 ? 0 : 1; // do the \"not\" operation\r\n      resulttype = \"nl\";\r\n      }\r\n   else if (value.type.charAt(0) == \"t\") {\r\n      resulttype = \"e#VALUE!\";\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"NOT\"] = [SocialCalc.Formula.NotFunction, 1, \"v\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# CHOOSE(index,value1,value2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ChooseFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, count, value1;\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cindex = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (cindex.type.charAt(0) != \"n\") {\r\n      cindex.value = 0;\r\n      }\r\n   cindex.value = Math.floor(cindex.value);\r\n\r\n   count = 0;\r\n   while (foperand.length) {\r\n      value1 = scf.TopOfStackValueAndType(sheet, foperand);\r\n      count += 1;\r\n      if (cindex.value == count) {\r\n         result = value1.value;\r\n         resulttype = value1.type;\r\n         break;\r\n         }\r\n      }\r\n   if (resulttype) { // found something\r\n      scf.PushOperand(operand, resulttype, result);\r\n      }\r\n   else {\r\n      scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"CHOOSE\"] = [SocialCalc.Formula.ChooseFunction, -2, \"choose\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# COLUMNS(c1:c2)\r\n# ROWS(c1:c2)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ColumnsRowsFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, rangeinfo;\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var value1 = scf.TopOfStackValueAndType(sheet, foperand);\r\n\r\n   if (value1.type == \"coord\") {\r\n      result = 1;\r\n      resulttype = \"n\";\r\n      }\r\n\r\n   else if (value1.type == \"range\") {\r\n      rangeinfo = scf.DecodeRangeParts(sheet, value1.value);\r\n      if (fname == \"COLUMNS\") {\r\n         result = rangeinfo.ncols;\r\n         }\r\n      else if (fname == \"ROWS\") {\r\n         result = rangeinfo.nrows;\r\n         }\r\n      resulttype = \"n\";\r\n      }\r\n   else {\r\n      result = 0;\r\n      resulttype = \"e#VALUE!\";\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"COLUMNS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"ROWS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\r\n\r\n\r\n/*\r\n#\r\n# FALSE()\r\n# NA()\r\n# NOW()\r\n# PI()\r\n# TODAY()\r\n# TRUE()\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ZeroArgFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var startval, tzoffset, start_1_1_1970, seconds_in_a_day, nowdays;\r\n   var result = {value: 0};\r\n   \r\n   switch (fname) {\r\n      case \"FALSE\":\r\n         result.type = \"nl\";\r\n         result.value = 0;\r\n         break;\r\n\r\n      case \"NA\":\r\n         result.type = \"e#N/A\";\r\n         break;\r\n\r\n      case \"NOW\":\r\n         startval = new Date();\r\n         tzoffset = startval.getTimezoneOffset();\r\n         startval = startval.getTime() / 1000; // convert to seconds\r\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\r\n         seconds_in_a_day = 24 * 60 * 60;\r\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\r\n         result.value = nowdays;\r\n         result.type = \"ndt\";\r\n         SocialCalc.Formula.FreshnessInfo.volatile.NOW = true; // remember\r\n         break;\r\n\r\n      case \"PI\":\r\n         result.type = \"n\";\r\n         result.value = Math.PI;\r\n         break;\r\n\r\n      case \"TODAY\":\r\n         startval = new Date();\r\n         tzoffset = startval.getTimezoneOffset();\r\n         startval = startval.getTime() / 1000; // convert to seconds\r\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\r\n         seconds_in_a_day = 24 * 60 * 60;\r\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\r\n         result.value = Math.floor(nowdays);\r\n         result.type = \"nd\";\r\n         SocialCalc.Formula.FreshnessInfo.volatile.TODAY = true; // remember\r\n         break;\r\n\r\n      case \"TRUE\":\r\n         result.type = \"nl\";\r\n         result.value = 1;\r\n         break;\r\n\r\n      }\r\n\r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n}\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"FALSE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"NA\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"NOW\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"PI\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TODAY\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"TRUE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\n\r\n//\r\n// * * * * * FINANCIAL FUNCTIONS * * * * *\r\n//\r\n\r\n/*\r\n#\r\n# DDB(cost,salvage,lifetime,period,[method])\r\n#\r\n# Depreciation, method defaults to 2 for double-declining balance\r\n# See: http://en.wikipedia.org/wiki/Depreciation\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DDBFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var method, depreciation, accumulateddepreciation, i;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n   var period = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n   if (scf.CheckForErrorValue(operand, period)) return;\r\n\r\n   if (lifetime.value < 1) {\r\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncddblife);\r\n      return 0;\r\n      }\r\n\r\n   method = {value: 2, type: \"n\"};\r\n   if (foperand.length > 0 ) {\r\n      method = scf.OperandAsNumber(sheet, foperand);\r\n      }\r\n   if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   if (scf.CheckForErrorValue(operand, method)) return;\r\n\r\n   depreciation = 0; // calculated for each period\r\n   accumulateddepreciation = 0; // accumulated by adding each period's\r\n\r\n   for (i=1; i<=period.value-0 && i<=lifetime.value; i++) { // calculate for each period based on net from previous\r\n      depreciation = (cost.value - accumulateddepreciation) * (method.value / lifetime.value);\r\n      if (cost.value - accumulateddepreciation - depreciation < salvage.value) { // don't go lower than salvage value\r\n         depreciation = cost.value - accumulateddepreciation - salvage.value;\r\n         }\r\n      accumulateddepreciation += depreciation;\r\n      }\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DDB\"] = [SocialCalc.Formula.DDBFunction, -4, \"ddb\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# SLN(cost,salvage,lifetime)\r\n#\r\n# Depreciation for each period by straight-line method\r\n# See: http://en.wikipedia.org/wiki/Depreciation\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SLNFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var depreciation;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n\r\n   if (lifetime.value < 1) {\r\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncslnlife);\r\n      return 0;\r\n      }\r\n\r\n   depreciation = (cost.value - salvage.value) / lifetime.value;\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SLN\"] = [SocialCalc.Formula.SLNFunction, 3, \"csl\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# SYD(cost,salvage,lifetime,period)\r\n#\r\n# Depreciation by Sum of Year's Digits method\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SYDFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var depreciation, sumperiods;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n   var period = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n   if (scf.CheckForErrorValue(operand, period)) return;\r\n\r\n   if (lifetime.value < 1 || period.value <= 0) {\r\n      scf.PushOperand(operand, \"e#NUM!\", 0);\r\n      return 0;\r\n      }\r\n\r\n   sumperiods = ((lifetime.value + 1) * lifetime.value)/2; // add up 1 through lifetime\r\n   depreciation = (cost.value - salvage.value) * (lifetime.value - period.value + 1) / sumperiods; // calc depreciation\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SYD\"] = [SocialCalc.Formula.SYDFunction, 4, \"cslp\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# FV(rate, n, payment, [pv, [paytype]])\r\n# NPER(rate, payment, pv, [fv, [paytype]])\r\n# PMT(rate, n, pv, [fv, [paytype]])\r\n# PV(rate, n, payment, [fv, [paytype]])\r\n# RATE(n, payment, pv, [fv, [paytype, [guess]]])\r\n#\r\n# Following the Open Document Format formula specification:\r\n#\r\n#    PV = - Fv - (Payment * Nper) [if rate equals 0]\r\n#    Pv*(1+Rate)^Nper + Payment * (1 + Rate*PaymentType) * ( (1+Rate)^nper -1)/Rate + Fv = 0\r\n#\r\n# For each function, the formulas are solved for the appropriate value (transformed using\r\n# basic algebra).\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.InterestFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, result, dval, eval, fval;\r\n   var pv, fv, rate, n, payment, paytype, guess, part1, part2, part3, part4, part5;\r\n   var olddelta, maxloop, tries, deltaepsilon, rate, oldrate, m;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var aval = scf.OperandAsNumber(sheet, foperand);\r\n   var bval = scf.OperandAsNumber(sheet, foperand);\r\n   var cval = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   resulttype = scf.LookupResultType(aval.type, bval.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, cval.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (foperand.length) { // optional arguments\r\n      dval = scf.OperandAsNumber(sheet, foperand);\r\n      resulttype = scf.LookupResultType(resulttype, dval.type, scf.TypeLookupTable.twoargnumeric);\r\n      if (foperand.length) { // optional arguments\r\n         eval = scf.OperandAsNumber(sheet, foperand);\r\n         resulttype = scf.LookupResultType(resulttype, eval.type, scf.TypeLookupTable.twoargnumeric);\r\n         if (foperand.length) { // optional arguments\r\n            if (fname != \"RATE\") { // only rate has 6 possible args\r\n               scf.FunctionArgsError(fname, operand);\r\n               return 0;\r\n               }\r\n            fval = scf.OperandAsNumber(sheet, foperand);\r\n            resulttype = scf.LookupResultType(resulttype, fval.type, scf.TypeLookupTable.twoargnumeric);\r\n            }\r\n         }\r\n      }\r\n\r\n   if (resulttype == \"n\") {\r\n      switch (fname) {\r\n         case \"FV\": // FV(rate, n, payment, [pv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            payment = cval.value;\r\n            pv = dval!=null ? dval.value : 0; // get value if present, or use default\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == 0) { // simple calculation if no interest\r\n               fv = -pv - (payment * n);\r\n               }\r\n            else {\r\n               fv = -(pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\r\n               }\r\n            result = fv;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n         case \"NPER\": // NPER(rate, payment, pv, [fv, [paytype]])\r\n            rate = aval.value;\r\n            payment = bval.value;\r\n            pv = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == 0) { // simple calculation if no interest\r\n               if (payment == 0) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               n = (pv + fv)/(-payment);\r\n               }\r\n            else {\r\n               part1 = payment * (1 + rate * paytype) / rate;\r\n               part2 = pv + part1;\r\n               if (part2 == 0 || rate <= -1) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               part3 = (part1 - fv) / part2;\r\n               if (part3 <= 0) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               part4 = Math.log(part3);\r\n               part5 = Math.log(1 + rate); // rate > -1\r\n               n = part4/part5;\r\n               }\r\n            result = n;\r\n            resulttype = 'n';\r\n            break;\r\n\r\n         case \"PMT\": // PMT(rate, n, pv, [fv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            pv = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (n == 0) {\r\n               scf.PushOperand(operand, \"e#NUM!\", 0);\r\n               return;\r\n               }\r\n            else if (rate == 0) { // simple calculation if no interest\r\n               payment = (fv - pv)/n;\r\n               }\r\n            else {\r\n               payment = (0 - fv - pv*Math.pow(1+rate,n))/((1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\r\n               }\r\n            result = payment;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n         case \"PV\": // PV(rate, n, payment, [fv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            payment = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == -1) {\r\n               scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n               return;\r\n               }\r\n            else if (rate == 0) { // simple calculation if no interest\r\n               pv = -fv - (payment * n);\r\n               }\r\n            else {\r\n               pv = (-fv - payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate)/(Math.pow(1+rate,n));\r\n               }\r\n            result = pv;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n            case \"RATE\": // RATE(n, payment, pv, [fv, [paytype, [guess]]])\r\n               n = aval.value;\r\n               payment = bval.value;\r\n               pv = cval.value;\r\n               fv = dval!=null ? dval.value : 0;\r\n               paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n               guess = fval!=null ? fval.value : 0.1;\r\n\r\n               // rate is calculated by repeated approximations\r\n               // The deltas are used to calculate new guesses\r\n\r\n               maxloop = 100;\r\n               tries = 0;\r\n               delta = 1;\r\n               epsilon = 0.0000001; // this is close enough\r\n               rate = guess || 0.00000001; // zero is not allowed\r\n               while ((delta >= 0 ? delta : -delta) > epsilon && (rate != oldrate)) {\r\n                  delta = fv + pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate;\r\n                  if (olddelta!=null) {\r\n                     m = (delta - olddelta)/(rate - oldrate) || .001; // get slope (not zero)\r\n                     oldrate = rate;\r\n                     rate = rate - delta / m; // look for zero crossing\r\n                     olddelta = delta;\r\n                     }\r\n                  else { // first time - no old values\r\n                     oldrate = rate;\r\n                     rate = 1.1 * rate;\r\n                     olddelta = delta;\r\n                     }\r\n                  tries++;\r\n                  if (tries >= maxloop) { // didn't converge yet\r\n                     scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                     return;\r\n                     }\r\n                  }\r\n               result = rate;\r\n               resulttype = 'n%';\r\n               break;\r\n         }\r\n      }\r\n \r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"FV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"fv\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"NPER\"] = [SocialCalc.Formula.InterestFunctions, -3, \"nper\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"PMT\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pmt\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"PV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pv\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"RATE\"] = [SocialCalc.Formula.InterestFunctions, -3, \"rate\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# NPV(rate,v1,v2,c1:c2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NPVFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttypenpv, rate, sum, factor, value1;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var rate = scf.OperandAsNumber(sheet, foperand);\r\n   if (scf.CheckForErrorValue(operand, rate)) return;\r\n\r\n   sum = 0;\r\n   resulttypenpv = \"n\";\r\n   factor = 1;\r\n\r\n   while (foperand.length) {\r\n      value1 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         factor *= (1 + rate.value);\r\n         if (factor == 0) {\r\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n            return;\r\n            }\r\n         sum += value1.value / factor;\r\n         resulttypenpv = scf.LookupResultType(value1.type, resulttypenpv || value1.type, scf.TypeLookupTable.plus);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\" && resulttypenpv.charAt(0) != \"e\") {\r\n         resulttypenpv = value1.type;\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (resulttypenpv.charAt(0) == \"n\") {\r\n      resulttypenpv = 'n$';\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttypenpv, sum);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"NPV\"] = [SocialCalc.Formula.NPVFunction, -2, \"npv\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# IRR(c1:c2,[guess])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IRRFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, guess, oldsum, maxloop, tries, epsilon, rate, oldrate, m, sum, factor, i;\r\n   var rangeoperand = [];\r\n   var cashflows = [];\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   rangeoperand.push(foperand.pop()); // first operand is a range\r\n\r\n   while (rangeoperand.length) { // get values from range so we can do iterative approximations\r\n      value1 = scf.OperandValueAndType(sheet, rangeoperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         cashflows.push(value1.value);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (!cashflows.length) {\r\n      scf.PushOperand(operand, \"e#NUM!\", 0);\r\n      return;\r\n      }\r\n\r\n   guess = {value: 0};\r\n\r\n   if (foperand.length) { // guess is provided\r\n      guess = scf.OperandAsNumber(sheet, foperand);\r\n      if (guess.type.charAt(0) != \"n\" && guess.type.charAt(0) != \"b\") {\r\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (foperand.length) { // should be no more args\r\n         scf.FunctionArgsError(fname, operand);\r\n         return;\r\n         }\r\n      }\r\n\r\n   guess.value = guess.value || 0.1;\r\n\r\n   // rate is calculated by repeated approximations\r\n   // The deltas are used to calculate new guesses\r\n\r\n   maxloop = 20;\r\n   tries = 0;\r\n   epsilon = 0.0000001; // this is close enough\r\n   rate = guess.value;\r\n   sum = 1;\r\n\r\n   while ((sum >= 0 ? sum : -sum) > epsilon && (rate != oldrate)) {\r\n      sum = 0;\r\n      factor = 1;\r\n      for (i=0; i<cashflows.length; i++) {\r\n         factor *= (1 + rate);\r\n         if (factor == 0) {\r\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n            return;\r\n            }\r\n         sum += cashflows[i] / factor;\r\n         }\r\n\r\n      if (oldsum!=null) {\r\n         m = (sum - oldsum)/(rate - oldrate); // get slope\r\n         oldrate = rate;\r\n         rate = rate - sum / m; // look for zero crossing\r\n         oldsum = sum;\r\n         }\r\n      else { // first time - no old values\r\n         oldrate = rate;\r\n         rate = 1.1 * rate;\r\n         oldsum = sum;\r\n         }\r\n      tries++;\r\n      if (tries >= maxloop) { // didn't converge yet\r\n         scf.PushOperand(operand, \"e#NUM!\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, 'n%', rate);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"IRR\"] = [SocialCalc.Formula.IRRFunction, -1, \"irr\", \"\", \"financial\"];\r\n\r\n\r\n\r\n// -----------------------------------------\r\n// eddy  BUTTON COPYVALUE COPYFORMULA {\r\n// -----------------------------------------\r\n\r\n/*\r\n#\r\n# BUTTON(string) // \r\n# IMAGEBUTTON(string) \r\n# TEXTBOX(string) // \r\n# AUTOCOMPLETE(string, range)\r\n# SELECT(string, range [,size [,multiple]])\r\n# CHECKBOX(string) // \r\n# RADIOBUTTON(string,groupname)\r\n# COPYVALUE(range, destinationCell, value_or_range) // \r\n# COPYFORMULA(range, destinationCell, formula_range)) // \r\n# INSERT(trigger_cell, destination_range [,formula_range,value_range,formula_range, ...])\r\n# DELETEIF(trigger_cell, criteria , test_range) \r\n# COMMAND(trigger_cell, commands)\r\n# COMMANDIF(trigger_cell, condition, commands) \r\n# PANEL(indices_or_csv, panel1_range [, panel2_range , ...])  \r\n# SPLASH(splash_panel_range)  // shows splash screen (range) - shows while loading dependant sheets from server  \r\n# STYLE(css)  \r\n#\r\n*/\r\n\r\n\r\nSocialCalc.Formula.IoFunctions = function(fname, operand, foperand, sheet, coord) {\r\n\r\n  \r\n// ArgList has an array for each function, one entry for each possible arg (up to max).\r\n// Min args are specified in SocialCalc.Formula.FunctionList.\r\n// Minus values are repeated parameters\r\n//  -1 to -15  - repeated parameters\r\n//  -1 - [number, ...]  - e.g. [2,-1,-2]  means (text, [number, text, number, text, ... ] - repeated parameters\r\n//  1 - number \r\n//  2 - text \r\n//  3 - text | number \r\n//  4 - coord \r\n//  5 - coord | number \r\n//  6 - coord | text \r\n//  7 - coord | text | number \r\n//  8 - range \r\n//  9 - range | number \r\n//  10 - range | text 11 - range | text | number \r\n//  12 - range | coord \r\n//  13 - range | coord | number \r\n//  14 - range | coord | text \r\n//  15 - range | coord | text | number \r\n\r\n\r\n\r\n   var argList = {\r\n\t\t\t\t BUTTON: [2]\r\n        ,IMAGEBUTTON: [2]\r\n   \t\t\t,EMAIL: [14, 14, 14, 14]\r\n\t\t\t\t,EMAILIF: [13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILONEDIT: [14, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILAT: [13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILONEDITIF: [14, 13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILATIF: [13, 13, 14, 14, 14, 14]\r\n        ,SUBMIT: [2]\r\n        ,TEXTBOX: [2]\r\n        ,AUTOCOMPLETE: [2, 14]\r\n        ,SELECT: [2, 14, 1, 1]   // # SELECT(string, range [,size [,multiple]])\r\n        ,CHECKBOX: [3]\r\n        ,RADIOBUTTON: [2, 2]\r\n\t\t\t\t,COPYVALUE: [4, 12, 15]\r\n\t\t\t\t,COPYFORMULA: [4, 12, 12]\r\n        ,INSERT: [4, 8, -12, -15]  // change code to allow unlimited \r\n        ,DELETEIF: [4,7,8]\r\n        ,COMMAND: [4, 14]\r\n        ,COMMANDIF: [4, 13, 14]\r\n        ,PANEL:[15, -12] // # PANEL(indices_or_csv, panel1_range [, panel2_range , ...])  \r\n        ,SPLASH:[12]  // SPLASH(splash_panel_range)  // shows splash screen (range)\r\n        ,STYLE:[6] // # STYLE(css)  \r\n   };\r\n   \r\n   var i, parameter, offset, len, start, count;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var numargs = foperand.length;\r\n   var argdef = argList[fname];\r\n   var operand_value = [];\r\n   var operand_type = [];\r\n\r\n   var repeatCount = -1;  // number of repeated parameters\r\n   var repeatIndex;  // index of begining of repeated parameters\r\n   var wantedType;\r\n   \r\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\r\n      //   IF started repeat parameters section \r\n      if(repeatCount != -1) {\r\n        //     SET typeWanted = get type - adjust for repeted parameters\r\n        wantedType = Math.abs(argdef[ repeatIndex + (( (i-1) - repeatIndex) % repeatCount) ]);\r\n      } else {\r\n        \r\n        if (i > argdef.length) { // too many args\r\n          scf.FunctionArgsError(fname, operand);\r\n          return;\r\n          }\r\n        \r\n        //     typeWanted = type wanted list [ parameterIndex ]\r\n        wantedType = argdef[i-1];\r\n        \r\n        //     IF typeWanted < 0 && repeatCount == -1\r\n        if(wantedType < 0 ) {\r\n          //       SET repeatCount = wanted list length - parameterIndex\r\n          repeatCount = argdef.length - (i-1);\r\n          //       SET repeatIndex =  parameterIndex\r\n          repeatIndex = (i-1);\r\n          //       wantedType = Math.abs(wantedType )          \r\n          wantedType = Math.abs(wantedType );\r\n        }  //     END IF\r\n      \r\n      } //   END IF\r\n\r\n      if(wantedType == 1) { // 1 - number\r\n        parameter = scf.OperandAsNumber(sheet, foperand);\r\n        \r\n      } else if(wantedType == 2) { // 2 - text \r\n        parameter = scf.OperandAsText(sheet, foperand);\r\n      } else if(wantedType == 3) { // 3 - text | number \r\n        parameter = scf.OperandValueAndType(sheet, foperand);\r\n      } else { //  typeWanted > 3  && < 16  - else invalid        \r\n        //        SET parameterType = type\r\n        var parameterType = foperand[foperand.length -1].type; // param is end of stack\r\n        \r\n        //        SET validType = false  \r\n        var validParameterType = false;\r\n        \r\n        //        IF type = number && wanted type == number || type = text && wanted type == text THEN\r\n        //                  1 - number  2 - text \r\n        if( (parameterType.charAt(0) == \"n\" && (wantedType & 1) != 0) || (parameterType.charAt(0) == \"t\" && (wantedType & 2) != 0)) {\r\n          //           valid\r\n          validParameterType = true;\r\n          //           get number type and value \r\n          parameter = scf.OperandValueAndType(sheet, foperand);\r\n        }  //        END IF\r\n        \r\n        //        IF type = coord && wanted type == coord THEN\r\n        if( parameterType == \"coord\" && (wantedType & 4) != 0) {  //  4 - coord \r\n          //          valid\r\n          validParameterType = true;\r\n          parameter = scf.OperandAsCoord(sheet, foperand);\r\n          parameter.value = SocialCalc.Formula.PlainCoord(parameter.value); // remove absolute reference\r\n        } //        END IF\r\n        //        IF type = range && wanted type == range THEN\r\n        if( parameterType == \"range\" && (wantedType & 8) != 0) { // 8 - range \r\n          //           valid\r\n          validParameterType = true;\r\n          // get range\r\n          parameter = scf.OperandAsRange(sheet, foperand);          \r\n          parameter.value = SocialCalc.Formula.PlainCoord(parameter.value);  // remove absolute reference\r\n        } //        END IF\r\n        \r\n        //        IF invalid param type\r\n        if(validParameterType == false) {\r\n          scf.FunctionArgsError(fname, operand);\r\n          return;          \r\n        }  //        END IF\r\n        \r\n      }\r\n      \r\n      \r\n      // value or range, e.g. \"C9|C11\"\r\n      operand_value[i] = parameter.value;\r\n      // type e.g. \"t\", \"range\"\r\n      operand_type[i] = parameter.type;\r\n      if (parameter.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, parameter.type, result);\r\n         return;\r\n      }\r\n   }\r\n\r\n   \r\n   switch (fname) {\r\n     case \"STYLE\":  \r\n       var parameters = sheet.ioParameterList[coord];\r\n       if(parameters) {\r\n         var css = SocialCalc.Formula.getStandardizedList(sheet, {value: operand_value[1], type: operand_type[1]});\r\n         if(css.length > 0 ) {\r\n           parameters.css = css[0];\r\n           parameters.cssParameter = (operand_type[1] == \"t\") ? '\"'+operand_value[1]+'\"' : operand_value[1];\r\n         }\r\n         result = \"\"; // ensure return value does not get changed by style - will add this empty string to number or string\r\n         resulttype = \"ni\"; // important - allows widgets to keep type - use: TEXTBOX(\"\")+STYLE(css)  - must add style to widget \r\n       }\r\n       break;\r\n     case \"SELECT\":  // # SELECT(string, range [,size [,multiple]])\r\n         var parameters = sheet.ioParameterList[coord];\r\n         var optionSource = SocialCalc.Formula.getStandardizedList(sheet, parameters[1]);\r\n         \r\n         parameters.html = [];        \r\n         parameters.html[0] = (operand_value[4] == true) ? \"multiple\" : \"\"\r\n         parameters.html[1] = (operand_value[3]) ? \"\"+operand_value[3] : \"1\"\r\n         if(optionSource.length > 0 ) {\r\n           var options = \"<option>\" + optionSource.join(\"</option><option>\") + \"</option>\";\r\n           var optionRegExp = new RegExp(\"<option>\"+operand_value[1],'');\r\n           parameters.html[2] = options.replace(optionRegExp, \"<option selected>\"+operand_value[1] ); // select default, if any\r\n         }\r\n         result = operand_value[1];\r\n         resulttype = \"ti\"+fname;\r\n         break;\r\n     case \"SUBMIT\":\r\n       result = \"Submit\";\r\n     case \"BUTTON\":\r\n     case \"IMAGEBUTTON\":\r\n     case \"TEXTBOX\":\r\n     case \"AUTOCOMPLETE\":\r\n         if (numargs>0) result = operand_value[1];\r\n         resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (BUTTON,IMAGEBUTTON,TEXTBOX,AUTOCOMPLETE, SELECT) \r\n         break;\r\n\r\n      case \"EMAIL\":\r\n      case \"EMAILIF\":\r\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (,) \r\n          result = \"Send\";\r\n          break;\r\n      case \"EMAILONEDIT\":\r\n      case \"EMAILONEDITIF\":\r\n//    \t  sheet.editEventCells === 'undefined') return;\t\r\n//    \t  if(typeof sheet.ioParameterList === 'undefined') return;\r\n\r\n    \t  \r\n      case \"EMAILAT\":\r\n      case \"EMAILATIF\":\r\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (,) \r\n          result = \"Send Now\";\r\n          break;\r\n\t\t \r\n      case \"CHECKBOX\":\r\n      case \"RADIOBUTTON\":\r\n\t     if(operand_type[1].charAt(0) == 't') {\r\n\t\t\tresult = (operand_value[1].toUpperCase() == 'TRUE') ? 1 : 0;\r\n\t\t\t} else {\r\n\t\t\tresult = (operand_value[1] == 0) ? 0 : 1;\r\n\t\t\t}\r\n\t\t//result = \"true\"; \r\n         resulttype = \"ni\"+fname; // (n)umber value with (i)nterface (CHECKBOX, RADIOBUTTON)\r\n\r\n         break;\r\n\t\t \r\n\t\t \r\n      case \"COPYVALUE\":\r\n      case \"COPYFORMULA\":\r\n      case \"INSERT\":\r\n      case \"DELETEIF\":\r\n      case \"COMMAND\":\r\n      case \"COMMANDIF\":\r\n         var cell = sheet.cells[operand_value[1]];\r\n         if(typeof cell === 'undefined') break; // invalid trigger cell, return error\r\n         result = cell.datavalue; // get trigger cell value\r\n         \r\n         result = String(result).split(\"/\");  // Clean up - if image button trigger then show only image name \r\n         result = result[result.length-1]; \r\n         resulttype = \"t\";\r\n         break;\r\n      case \"PANEL\":\r\n      case \"SPLASH\":\r\n        \r\n        //  - code to show/hide panel\r\n        //  --- get list of panels to show - \"showindex_or_csv\" \r\n        //  --- get param details \r\n        var showindices;\r\n        var firstPanelIndex = 2;\r\n        if(fname == \"SPLASH\") {\r\n          result = \"SPLASH:\"+ operand_value[1]; \r\n          resulttype = \"t\";\r\n          if (sheet.splashdone == true) break; // show splash scree onload, then skip\r\n          sheet.splashdone = true;\r\n          firstPanelIndex = 1;\r\n          showindices = [0]; // show panel at param 0 of splash formula\r\n          \r\n        } else {\r\n          // panel formula\r\n          showindices = SocialCalc.Formula.getStandardizedList(sheet, {value: operand_value[1], type: operand_type[1]});\r\n          result = fname+\":\"+ showindices; \r\n        }\r\n        //  --- SET list of showrows TO empty\r\n        //  --- SET list of showcols TO empty\r\n        resulttype = \"t\";\r\n        if(SocialCalc._app) { // panel only works in live app\r\n          var showrows = [], showcols = [];\r\n          //  --- FOR each panel to show\r\n          for (var parameterIndex = firstPanelIndex; parameterIndex < operand_value.length; ++parameterIndex) { \r\n            // show panel if its index is in the showindices list \r\n            var showPanelFound = false;\r\n            for(var showIndex in showindices ) { \r\n              if (showindices[showIndex] == parameterIndex-1) {\r\n                showPanelFound = true;\r\n                break;\r\n              }\r\n            }\r\n            if(showPanelFound === false) continue;\r\n            \r\n          \r\n            //  ----- get panel range rows & cols only\r\n            var panelCoordData = SocialCalc.Formula.getStandardizedCoords(sheet, {value: operand_value[parameterIndex], type: operand_type[parameterIndex]});\r\n            //  ----- FOR each row/col -- create function to do the loop\r\n            for (var i=0; i<panelCoordData.ncols; i++) {\r\n              //  ------- set showrows/col row/col to true\r\n              showcols[panelCoordData.col1num + i] = true;\r\n            }  //  ----- END FOR                        \r\n            for (var j=0; j<panelCoordData.nrows; j++) {\r\n              //  ------- set showrows/col row/col to true\r\n              showrows[panelCoordData.row1num + j] = true;\r\n            }\r\n          }   //  --- END FOR\r\n          \r\n          var spreadsheet =  window.spreadsheet;\r\n          if (spreadsheet == null) spreadsheet = window.ss\r\n\r\n          var forceRender = false;\r\n          var lastShowDimension = 0;\r\n          var showGridDimension =  function(sheet, lastIndex, sheetHideList, showList, getIndexOf) {\r\n            //  --- hide all rows/col    up to sheet.attribs.lastrow/col         \r\n            //  --- FOR each row/col -- create function to do the loop          \r\n            for(var arrayIndex = 1; arrayIndex <= lastIndex; arrayIndex ++ ) { // start at col/row 1\r\n              //  ----- IF row hide/show state need updating\r\n              var sheetHideIndex = getIndexOf(arrayIndex); // gets col name if col\r\n              if(typeof sheetHideList[sheetHideIndex] == 'undefined') { \r\n                // row/col is visible\r\n                if(showList[arrayIndex] !== true) { // if hide\r\n                  //  ------- SET the row state  \r\n                  sheetHideList[sheetHideIndex] =\"yes\";                \r\n                  //  ------- SET repaint flag\r\n                  forceRender = true;\r\n                } else {lastShowDimension = arrayIndex;}\r\n              } else {\r\n                // row/col is hidden \r\n                if(showList[arrayIndex] === true) { // if show \r\n                  //  ------- SET the row state  \r\n                  delete sheetHideList[sheetHideIndex];                \r\n                  //  ------- SET repaint flag\r\n                  forceRender = true;\r\n                  lastShowDimension = arrayIndex;\r\n                }\r\n              }              \r\n              \r\n            }            \r\n          };\r\n\r\n          \r\n          var getRowIndex = function(row) { return row };\r\n          showGridDimension(sheet,  sheet.attribs.lastrow,  sheet.rowattribs.hide, showrows, getRowIndex);\r\n          lastShowDimension = 0;\r\n          showGridDimension(sheet,  sheet.attribs.lastcol,  sheet.colattribs.hide, showcols, SocialCalc.rcColname );\r\n          // control width of html - for mobile app - as better to use native scroll rather than SocialCalc scroll bar - colpanes[length].last = usermaxcol - see FitToEditTable\r\n          sheet.attribs.usermaxcol = lastShowDimension;\r\n          \r\n          if(forceRender) {\r\n            sheet.renderneeded = true;\r\n            sheet.widgetsClean = false; //  force widgets to repaint - update cell reference in widget HTML    \r\n            spreadsheet.editor.context.rowpanes[0].first = 1; // reset scroll bar to first row  \r\n            spreadsheet.editor.context.CalculateColWidthData();\r\n            \r\n            spreadsheet.width = spreadsheet.editor.context.totalwidth;\r\n            spreadsheet.height = 2500;\r\n            spreadsheet.editor.ResizeTableEditor(spreadsheet.editor.context.totalwidth,2500);  // 2500 is page height constant - fix issue with mobile device - Used constant because could not see an easy way to pre-calculate height \r\n          }\r\n          \r\n        }\r\n         \r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\n\r\n\r\nSocialCalc.Formula.FunctionList[\"BUTTON\"] = [SocialCalc.Formula.IoFunctions, 1, \"label\", \"\", \"gui\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\\\"><%=formated_value%></button>\" , \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"IMAGEBUTTON\"] = [SocialCalc.Formula.IoFunctions, 1, \"imageurl\", \"\", \"gui\", \"<input type='image' src='<%=display_value%>' alt='Submit' onclick=\\\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\\\">\", \"ParameterList\"  ];\r\nSocialCalc.Formula.FunctionList[\"EMAIL\"] = [SocialCalc.Formula.IoFunctions, -3, \"to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILIF\"] = [SocialCalc.Formula.IoFunctions, -4, \"condition_range, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILONEDIT\"] = [SocialCalc.Formula.IoFunctions, -4, \"editRange, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"EMAILAT\"] = [SocialCalc.Formula.IoFunctions, -4, \"datetime_value, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILONEDITIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"editRange, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILATIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"datetime_value, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\r\nSocialCalc.Formula.FunctionList[\"SUBMIT\"] = [SocialCalc.Formula.IoFunctions, 100, \"[label]\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"TEXTBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\\\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\\\" value='<%=display_value%>' >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"AUTOCOMPLETE\"] = [SocialCalc.Formula.IoFunctions, 2, \"value, range or csv_text\", \"\", \"gui\", \"<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\\\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\\\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"SELECT\"] = [SocialCalc.Formula.IoFunctions, -2, \"value, range or csv_text [,size]\", \"\", \"gui\", \"<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\\\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\\\" <%=html0_value%>><%=html2_value%></select>\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"CHECKBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\\\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\\\" >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"RADIOBUTTON\"] = [SocialCalc.Formula.IoFunctions, 2, \"value, groupname\", \"\", \"gui\", \"<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\\\"SocialCalc.CmdGotFocus(null);\\\" onclick=\\\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\\\" >\", \"Input\" ];\r\n\r\nSocialCalc.Formula.FunctionList[\"COPYVALUE\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, destinationCell, value_or_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COPYFORMULA\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, destinationCell, formula_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"INSERT\"] = [SocialCalc.Formula.IoFunctions, -2, \"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"DELETEIF\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, criteria , test_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COMMAND\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, commands\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COMMANDIF\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, conditions, commands\", \"\", \"action\", \"\", \"EventTree\"];\r\n\r\nSocialCalc.Formula.FunctionList[\"PANEL\"] = [SocialCalc.Formula.IoFunctions, -1, \"showindices_range_or_csv, panel1_range [, panel2_range , ...]\", \"\", \"gui\", \"\"];\r\nSocialCalc.Formula.FunctionList[\"SPLASH\"] = [SocialCalc.Formula.IoFunctions, -1, \"splash_panel_range\", \"\", \"gui\", \"\"];\r\n\r\nSocialCalc.Formula.FunctionList[\"STYLE\"] = [SocialCalc.Formula.IoFunctions, -1, \"css\", \"\", \"gui\", \"\"];\r\n\r\n// on enter input box refresh the auto complete list\r\nSocialCalc.TriggerIoAction.AddAutocomplete = function(triggerCellId) {\r\n  var spreadsheet =  window.spreadsheet;\r\n  if (spreadsheet == null) spreadsheet = window.ss\r\n  var sheet = spreadsheet.sheet;\r\n  var scf = SocialCalc.Formula; \r\n  \r\n  var parameters = sheet.ioParameterList[triggerCellId];\r\n  if(typeof parameters === 'undefined') return;\r\n  \r\n  var autocompleteSource = SocialCalc.Formula.getStandardizedList(sheet, parameters[1])\r\n\r\n  //Overrides the default autocomplete filter function to search only from the beginning of the string\r\n  $.ui.autocomplete.filter = function (array, term) {\r\n    // * RegEx Unit Test - https://regex101.com/r/kO6eC4/1\r\n    var matcher = new RegExp(\"\\\\b\" + $.ui.autocomplete.escapeRegex(term), \"i\");\r\n    return $.grep(array, function (value) {\r\n        return matcher.test(value.label || value.value || value);\r\n    });\r\n  };\r\n\r\n  \r\n  $(\"#AUTOCOMPLETE_\"+triggerCellId).autocomplete({\r\n    source: autocompleteSource,\r\n    minLength: 1,\r\n    autoFocus: true,\r\n    select: function(event, ui) {\r\n      $(this).val(ui.item.label);\r\n      SocialCalc.TriggerIoAction.AutoComplete(triggerCellId);\r\n    },\r\n    change: function (event, ui) {\r\n      if (ui.item === null) {\r\n          $(this).val('');\r\n      }\r\n      SocialCalc.TriggerIoAction.AutoComplete(triggerCellId);\r\n    }\r\n  });  \r\n}\r\n// Event triggered, e.g. button/imagebutton clicked. - call linked action formulas \r\n// eddy TriggerIoAction {\r\nSocialCalc.TriggerIoAction.Button = function(triggerCellId) {\r\n var spreadsheet =  window.spreadsheet;\r\n if (spreadsheet == null) spreadsheet = window.ss\r\n var sheet = spreadsheet.sheet;\r\n var scf = SocialCalc.Formula; \r\n //spreadsheet.editor.EditorScheduleSheetCommands('set A2 value n 10',  true, false);\r\n \r\n //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \r\n \r\n if(typeof sheet.ioEventTree === 'undefined') return;\t\r\n if(typeof sheet.ioParameterList === 'undefined') return;\r\n if( sheet.ioEventTree[triggerCellId] === 'undefined' ) return;\r\n \r\n for(var actionCellId in sheet.ioEventTree[triggerCellId]) {\r\n \r\n\tvar parameters = sheet.ioParameterList[actionCellId];\r\n\tvar conditionsParameter = null;\r\n\t\r\n\tswitch(parameters.function_name) {\r\n\t  \r\n\t  case \"COPYVALUE\" :\t    \r\n\t    var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]);\r\n\r\n      // get row and col of dest cell\r\n   \t  var destcr = SocialCalc.coordToCr(parameters[1].value);\r\n   \t  \r\n   \t  var sheetCommandList = SocialCalc.TriggerIoAction.CopyValueToRange(parameterdata, destcr);\r\n   \t  spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);   \t  \r\n   \t \r\n\t    break;\r\n\t  case \"COPYFORMULA\" : \r\n      var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]);\r\n\r\n      // get row and col of dest cell\r\n      var destcr = SocialCalc.coordToCr(parameters[1].value);\r\n      \r\n      var sheetCommandList = SocialCalc.TriggerIoAction.CopyFormulaToRange(parameterdata, destcr);\r\n        \r\n      spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);\r\n      break;\r\n    case \"INSERT\" :  \r\n      //       # INSERT(trigger_cell, destination_range ,formula_range,value_range,formula_range, ...) // \r\n      //       insertrow A1      \r\n      //       insertcol A1\r\n      var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // destination_range\r\n      if(parameterdata.type != \"range\") break; // invalid insert, requires range\r\n      var insertCommand;\r\n      var colOffset, rowOffset;\r\n      if (parameterdata.ncols > 1) {  // insert column\r\n        colOffset = 1;\r\n        rowOffset = 0;\r\n        insertCommand = \"insertcol\";\r\n      }\r\n      if (parameterdata.nrows > 1) {  // insert row\r\n        colOffset = 0;\r\n        rowOffset = 1;\r\n        insertCommand = \"insertrow\";\r\n      }\r\n      var insertcellCoord = parameterdata.cellcoord[colOffset][rowOffset];\r\n      var sheetCommandList = insertCommand + \" \" + insertcellCoord;\r\n      var destcr = SocialCalc.coordToCr(insertcellCoord);\r\n      var sourceDataIndex = 2; \r\n      while(sourceDataIndex < parameters.length ) {\r\n        \r\n        if(parameters[sourceDataIndex].type == \"range\" || parameters[sourceDataIndex].type == \"coord\" || sourceDataIndex % 2 == 1) {\r\n          copyCellRange = SocialCalc.Formula.getStandardizedValues(sheet, parameters[sourceDataIndex]); // formulas to insert\r\n          \r\n          if (sourceDataIndex % 2 == 0) {\r\n            sheetCommandList = sheetCommandList + \"\\n\" + SocialCalc.TriggerIoAction.CopyFormulaToRange(copyCellRange, destcr);\r\n          } else {\r\n            sheetCommandList = sheetCommandList + \"\\n\" + SocialCalc.TriggerIoAction.CopyValueToRange(copyCellRange, destcr);            \r\n          }\r\n          if (parameterdata.nrows > 1) destcr.col += copyCellRange.ncols;\r\n          if (parameterdata.ncols > 1) destcr.row += copyCellRange.nrows;\r\n          \r\n        }        \r\n        sourceDataIndex ++;\r\n        \r\n      }\r\n      spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n      \r\n   \t\t break;\r\n    case \"DELETEIF\" :  //     # DELETEIF(trigger_cell, criteria , test_range) // \r\n      var criteriaParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // criteria \r\n      var testRangeParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]); // test_range - ignore first and last, as it would produce ref error\r\n\r\n      // set command list to empty\r\n      var sheetCommandList = \"\";\r\n\r\n      var colOffset, rowOffset, deleteCommand;\r\n      if (testRangeParameter.ncols > 1 && testRangeParameter.nrows > 1) return; // error invalid range, only one cell wide/high\r\n      if (testRangeParameter.ncols > 1) {  // delete column\r\n        colOffset = 1;\r\n        rowOffset = 0;\r\n        deleteCommand = \"deletecol\";\r\n      }\r\n      if (testRangeParameter.nrows > 1) {  // delete row\r\n        colOffset = 0;\r\n        rowOffset = 1;\r\n        deleteCommand = \"deleterow\";\r\n      }\r\n      \r\n      var criteriaValue = criteriaParameter.celldata[0][0].datavalue;\r\n      // FOR each source cell\r\n      for (var i=(testRangeParameter.ncols - colOffset) - 1; i>=colOffset; i--) {  // ignore first and last cell, as it would produce ref error\r\n        for (var j=(testRangeParameter.nrows - rowOffset) -1 ; j>=rowOffset; j--) {\r\n          \r\n          // IF after first source cell THEN  add new line to command list\r\n      \r\n          var cell = testRangeParameter.celldata[i][j];\r\n          if(SocialCalc.Formula.TestCriteria(cell.datavalue, cell.valuetype, criteriaValue) == true) {\r\n            if (sheetCommandList != \"\" ) sheetCommandList = sheetCommandList + \"\\n\";\r\n            sheetCommandList = sheetCommandList + deleteCommand + \" \" + testRangeParameter.cellcoord[i][j]; // Note cell.coord becomes invalid when row/coll are inserted/deleted\r\n          }\r\n        }\r\n      }\r\n      \r\n      if (sheetCommandList != \"\" ) spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n      \r\n      break;\r\n    case \"COMMANDIF\" :  //    # COMMANDIF(trigger_cell, condition, commands) \r\n      conditionsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // commands \r\n\r\n      \r\n    case \"COMMAND\" :  // COMMAND(trigger_cell, commands) \r\n      var commandsParameter;\r\n      // set command list to empty\r\n      var sheetCommandList = \"\";\r\n      if( conditionsParameter != null) {\r\n        var commandsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]); // commands \r\n        if (conditionsParameter.ncols != commandsParameter.ncols || conditionsParameter.nrows != commandsParameter.nrows) break;\r\n      } else {\r\n        commandsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // commands         \r\n      }\r\n      \r\n      for (var i=0; i<commandsParameter.ncols; i++) {\r\n        for (var j=0; j<commandsParameter.nrows; j++) {\r\n\r\n          if( conditionsParameter != null) {\r\n            var conditionCell = conditionsParameter.celldata[i][j];\r\n            if(conditionCell.datavalue == false) continue;\r\n          }\r\n          if (sheetCommandList != \"\" ) sheetCommandList = sheetCommandList + \"\\n\";\r\n          var cellCommand = commandsParameter.celldata[i][j];  \r\n          sheetCommandList = sheetCommandList + cellCommand.datavalue.toString().trim();\r\n          \r\n        }\r\n      }\r\n      if (sheetCommandList != \"\" ) spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n\r\n      break;\r\n      \r\n  }\r\n\r\n } \r\n\r\n}\r\n\r\n\r\n/******************************\r\n * CopyFormulaToRange\r\n *   copy a range of cells to a destination. Copy the formulas, adjusting any cell references\r\n * \r\n * @destcr col and row - destcr = { col:n, row:n }\r\n * @sourceData  range data - datatype of param must match getStandardizedParameter() return type\r\n * @return commands to execute to do the copy.  - String of sheet commands, \\n between each command -  \r\n *   \r\n ******************************/\r\n\r\n/*\r\n * set B8 text t william              ... coord: \"B8\",  datavalue: \"william\",     datatype: \"t\", formula: \"\",          valuetype: \"t\"\r\n * set B10 constant nd 41307 2013/2/2 ... coord: \"B10\", datavalue: 41307,         datatype: \"c\", formula: \"2013/2/2\",  valuetype: \"nd\"\r\n * set B11 value n 1                  ... coord: \"B11\", datavalue: 1,             datatype: \"v\", formula: \"\",          valuetype: \"n\"\r\n *\r\n * set B7 formula \"test\"&B3   ... coord: \"B7\",  datavalue: \"testwilliam\", datatype: \"f\", formula: \"\"test\"&B3\", valuetype: \"t\"\r\n * set C8 formula B8       ... coord: \"C8\",  datavalue: \"william\",     datatype: \"f\", formula: \"B8\",        valuetype: \"t\"\r\n * set C10 formula B10     ... coord: \"C10\", datavalue: 41307,         datatype: \"f\", formula: \"B10\",       valuetype: \"nd\"\r\n * set C11 formula B11     ... coord: \"C11\", datavalue: 1,             datatype: \"f\", formula: \"B11\",       valuetype: \"n\"\r\n *  set B3  formula TEXTBOX(\"\")             ... coord: \"B3\", datavalue: \"william\", datatype: \"f\", formula: \"TEXTBOX(\"william\")\", valuetype: \"tiTEXTBOX\"\r\n */\r\n\r\nSocialCalc.TriggerIoAction.CopyFormulaToRange = function(formulaData, destcr) {\r\n\r\n  // set command list to empty\r\n  var sheetCommandList = \"\";\r\n  var sheetCommand;\r\n  \r\n  // FOR each source cell\r\n  for (var i=0; i<formulaData.ncols; i++) {\r\n    for (var j=0; j<formulaData.nrows; j++) {\r\n  \r\n      var cell = formulaData.celldata[i][j];\r\n      // destination cell coord\r\n      var destCellCoord = SocialCalc.crToCoord(destcr.col + i, destcr.row + j);\r\n  \r\n  \r\n      // IF after first source cell THEN  add new line to command list\r\n      if (i != 0 || j != 0 ) sheetCommandList = sheetCommandList + \"\\n\";\r\n  \r\n  \r\n      if (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\r\n        var cellDataType = cell.datatype;\r\n        var cellValueType = cell.valuetype;     \r\n        var cellDataValue = cell.datavalue;   \r\n        var cellFormula = cell.formula;\r\n        \r\n        if(cellDataType == 'f') {\r\n          cellFormula = SocialCalc.OffsetFormulaCoords(cellFormula, destcr.col -  formulaData.col1num, destcr.row -  formulaData.row1num);\r\n          cellDataValue = \"\";\r\n          cellValueType = \"\";  \r\n        } else { \r\n          if(cellDataType != \"c\") cellFormula = \"\";  // clear text and number types   but not constant type like date/time      \r\n        }\r\n        \r\n        sheetCommand = 'set '+destCellCoord+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + cellFormula;            \r\n      } else { \r\n        sheetCommand = 'set '+destCellCoord+ ' empty';        \r\n      }          \r\n      sheetCommandList += sheetCommand.trim();\r\n    }\r\n  }\r\n\r\n  return sheetCommandList;\r\n\r\n}\r\n\r\n/******************************\r\n * CopyValueToRange\r\n *   copy a range of cells to a destination. Copy only the values\r\n * \r\n * @destcr col and row - destcr = { col:n, row:n }\r\n * @sourceData  range data - datatype of param must match getStandardizedParameter() return type\r\n * @return commands to execute to do the copy.  - String of sheet commands, \\n between each command -  \r\n *   \r\n ******************************/\r\nSocialCalc.TriggerIoAction.CopyValueToRange = function(sourceData, destcr) {\r\n\r\n\r\n    //----------------------\r\n    // set command list to empty\r\n    var sheetCommandList = \"\";\r\n    var sheetCommand;\r\n    \r\n    // FOR each source cell\r\n    for (var i=0; i<sourceData.ncols; i++) {\r\n      for (var j=0; j<sourceData.nrows; j++) {\r\n    \r\n        var cell = sourceData.celldata[i][j];\r\n        // destination cell coord\r\n        var destCellCoord = SocialCalc.crToCoord(destcr.col + i, destcr.row + j);\r\n    \r\n    \r\n        // IF after first source cell THEN  add new line to command list\r\n        if (i != 0 || j != 0 ) sheetCommandList = sheetCommandList + \"\\n\";\r\n    \r\n    \r\n        // copyvalue to set command\r\n        // take the cell from copyvalue source and convert it to a set command to set the destination\r\n        // e.g. set D3 text t push me \r\n        // e.g. set D3 value v 10   \r\n        // e.g. set D5 constant n% 0.1 10%\r\n        // e.g. set D6 constant nd 41922 10/10/2014\r\n        if (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\r\n          var cellDataType = cell.datatype;\r\n          var cellValueType = cell.valuetype;     \r\n          var cellDataValue = cell.datavalue;   \r\n          var cellFormula = cell.formula;\r\n          \r\n          if(cellDataType == 'f') {\r\n            cellFormula = \"\";\r\n            cellDataType = cellValueType;\r\n            if(cellValueType != \"n\" && cellValueType.charAt(0) != \"t\") {\r\n              cellDataType = \"c\"; // for Date type etc \r\n              cellFormula = cell.displaystring;\r\n            }\r\n            if(cellValueType.charAt(0) == \"t\") cellDataType = \"t\";          \r\n          } else {\r\n            if(cellDataType != \"c\") cellFormula = \"\";  // clear text and number types   but not constant type like date/time      \r\n          }\r\n          \r\n    \r\n          sheetCommand = 'set '+destCellCoord+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + cellFormula;\r\n          \r\n      } else { \r\n        sheetCommand = 'set '+destCellCoord+ ' empty';        \r\n      }\r\n      sheetCommandList += sheetCommand.trim();\r\n    }\r\n  }\r\n  \r\n  return sheetCommandList;  \r\n\r\n}\r\n//----------------------\r\n\r\n\r\n// optionalTriggerCellId - edited cell - used by EMAILONEDIT and EMAILONEDITIF\r\n//onClick=EMAIL \r\nSocialCalc.TriggerIoAction.Email = function(emailFormulaCellId, optionalTriggerCellId) {\r\n     optionalTriggerCellId = typeof optionalTriggerCellId !== 'undefined' ? optionalTriggerCellId : null;\r\n\t var scf = SocialCalc.Formula;\t\r\n\t var spreadsheet =  window.spreadsheet;\r\n\t if (spreadsheet == null) spreadsheet = window.ss\r\n\r\n\t var sheet = spreadsheet.sheet;\r\n\t var cell = sheet.cells[emailFormulaCellId];\r\n\t \r\n\t if(typeof sheet.ioParameterList === 'undefined') return;\r\n\t \r\n\t var parameters = sheet.ioParameterList[emailFormulaCellId];\r\n   if(typeof parameters === 'undefined') return;\r\n   //var debugLog = \"debug TriggerIoAction.Email\\n\"; //eddy\r\n\r\n\t //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \r\n\t // grab array for TO, SUBJECT and BODY \r\n\t var parameterValues = [];\r\n\t var parameterCellRefs = []; // OnEdit uses to workout what row/col was edited\r\n\t var maxRangeSize = 1;\r\n\t for(var index=0; index < parameters.length; index ++) {\r\n\t\t if(parameters[index].type.charAt(0) == 't') {\r\n\t\t\t parameterValues[index] = [String(parameters[index].value).replace(/ /g, \"%20\")];\r\n\t\t }\r\n\t\t if(parameters[index].type == 'coord') {\r\n\t\t\t parameterValues[index] = [String(sheet.GetAssuredCell(parameters[index].value).datavalue).replace(/ /g, \"%20\")];\r\n\r\n\t\t }\r\n\t\t if(parameters[index].type == 'range') {\r\n\t\t      var rangeinfo = scf.DecodeRangeParts(sheet, parameters[index].value);\r\n\t\t      parameterValues[index] = [];\r\n\t\t      parameterCellRefs[index] = [];\r\n\t\t      var rangeSizeCounter = 0;\r\n\t\t      for (var i=0; i<rangeinfo.ncols; i++) {\r\n\t\t         for (var j=0; j<rangeinfo.nrows; j++) {\r\n\r\n\t\t            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n\t\t            var cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\r\n\t\t            parameterValues[index].push(cell.datavalue.toString().replace(/ /g, \"%20\"));\r\n\t\t            parameterCellRefs[index].push(cellcr);\r\n\t\t            rangeSizeCounter++;\r\n\t\t         }\r\n\t\t      }\r\n\t\t      if(rangeSizeCounter > maxRangeSize) maxRangeSize = rangeSizeCounter;\t\t\t \r\n\t\t }\r\n\t }\r\n\r\n\t \r\n    var conditionIndex = -1; // check if email formula is conditional, -1 = not conditional \r\n    var toAddressParamOffset = 0;\r\n    switch (parameters.function_name) {\r\n\r\n      case \"EMAILIF\":\r\n    \t  conditionIndex = 0;\r\n      case \"EMAILAT\":\r\n      case \"EMAILONEDIT\":\r\n    \t  toAddressParamOffset = 1;\r\n    \t  break;\r\n      case \"EMAILONEDITIF\":\r\n      case \"EMAILATIF\":\r\n       \t  conditionIndex = 1;\r\n    \t  toAddressParamOffset = 2;\r\n    \t  break;\r\n    \t  \r\n      case \"EMAIL\":\r\n    \t  break;\r\n    }\t \r\n\r\n    \r\n    switch (parameters.function_name) {\r\n        case \"EMAILONEDIT\":\r\n        case \"EMAILONEDITIF\":\r\n\t       if(optionalTriggerCellId && parameters[0].type == 'coord' && parameters[0].value == optionalTriggerCellId ) optionalTriggerCellId = null;\r\n\t       break;\r\n\t   default :\r\n\t\t   optionalTriggerCellId = null;\r\n    }\r\n\r\n     var setStatusBarMessage = false;\r\n\r\n   var emailContentsList = [];\r\n\r\n\t for(var rangeIndex = maxRangeSize -1; rangeIndex > -1; rangeIndex-- ) {\r\n\t\t \r\n\t\t // if email formula is conditional && condition is false then skip \r\n\t\t if(conditionIndex != -1) {\r\n\t\t\t var conditionRangeIndex = (rangeIndex >= parameterValues[conditionIndex].length) ? 0 : rangeIndex;\r\n\t\t\t if(parameterValues[conditionIndex][conditionRangeIndex] == false) continue;\t\t\t \r\n\t\t }\r\n\r\n\t\t if(optionalTriggerCellId && optionalTriggerCellId != parameterCellRefs[0][rangeIndex]) continue;\r\n\t\t // send: to, subject, body to server \t\t \r\n\t\t var toaddressRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset].length) ? 0 : rangeIndex;\r\n\t\t var subjectsRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+1].length) ? 0 : rangeIndex;\r\n\t\t var bodyRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+2].length) ? 0 : rangeIndex;\r\n\t\t \r\n\t\t var emailContents = parameterValues[toAddressParamOffset][toaddressRangeIndex]+' '+parameterValues[toAddressParamOffset+1][subjectsRangeIndex]+' '+parameterValues[toAddressParamOffset+2][bodyRangeIndex];\r\n\t\t setStatusBarMessage = true;\r\n\t\t sheet.ScheduleSheetCommands('sendemail '+emailContents,  false); \r\n\t\t // cron job email - ignores ScheduleSheetCommands so send via return value\r\n\t\t emailContentsList.push([parameterValues[toAddressParamOffset][toaddressRangeIndex], parameterValues[toAddressParamOffset+1][subjectsRangeIndex], parameterValues[toAddressParamOffset+2][bodyRangeIndex]]);\r\n\t\t //debugLog = debugLog + \"emailContents \"+emailContents+\"\\n\"; //eddy\r\n\t\t \r\n\t }\r\n\t //console.log( \"log formula1.js Email\");\r\n\t // update status bar to indicate email is being sent\r\n\t if(setStatusBarMessage) SocialCalc.EditorSheetStatusCallback(null, \"emailing\", null, spreadsheet.editor);\t \r\n   return emailContentsList; // cron job email\r\n\r\n}\r\n\r\n/*\r\n * creates command on form: submitform \\rtimestamp\\rB2value\\rC2value ...\r\n */\r\n\r\nSocialCalc.TriggerIoAction.Submit = function(triggerCellId) {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n  ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n  : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n\r\n  if(formDataViewer != null && formDataViewer.loaded == true) {\r\n\r\n    var spreadsheet =  window.spreadsheet;\r\n    if (spreadsheet == null) spreadsheet = window.ss\r\n    var sheet = spreadsheet.sheet;\r\n    \r\n    \r\n    var date = new Date();\r\n    var formDataValues = \"\"+date.getFullYear()  + \"-\" + (date.getMonth() +1 )    + \"-\" +  date.getDate() \r\n       + \" \" +  date.getHours()     + \":\" +  date.getMinutes()     + \":\" +  date.getSeconds();\r\n    \r\n    for(var colIndex = 2; colIndex <= formDataViewer.formFieldsLength +1 ; colIndex++) {\r\n      var valueCoord = SocialCalc.crToCoord(colIndex, 2);\r\n      formDataValues += \"\\r\" + formDataViewer.sheet.cells[valueCoord].datavalue;\r\n    }  \r\n    \r\n    sheet.ScheduleSheetCommands('submitform \\r'+formDataValues,  false);\r\n  }\r\n}\r\n\r\n//onChange=select tag (combobox) \r\nSocialCalc.TriggerIoAction.SelectList = function(selectListCellId) {\r\n  var getHTMLselectListCellValue = function( selectListWidget ) { return selectListWidget.value; };\r\n  var function_name = \"SELECT\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, selectListCellId, getHTMLselectListCellValue );\r\n}\r\n\r\n//onKeyUp=AutoComplete\r\nSocialCalc.TriggerIoAction.AutoComplete = function(autoCompleteCellId) {\r\n  var getHTMLAutoCompleteCellValue = function( autoCompleteWidget ) { return autoCompleteWidget.value; };\r\n  var function_name = \"AUTOCOMPLETE\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, autoCompleteCellId, getHTMLAutoCompleteCellValue );\r\n}\r\n\r\n// onKeyUp=TextBox \r\nSocialCalc.TriggerIoAction.TextBox = function(textBoxCellId) {\r\n  var getHTMLTextBoxCellValue = function( textBoxWidget ) { return textBoxWidget.value; };\r\n  var function_name = \"TEXTBOX\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, textBoxCellId, getHTMLTextBoxCellValue );\r\n}\r\n\r\n//onKeyUp=CheckBox \r\nSocialCalc.TriggerIoAction.CheckBox = function(checkBoxCellId) {\r\n  var getHTMLCheckBoxCellValue = function( checkBoxWidget ) { return (checkBoxWidget.checked ? \"TRUE\" : \"FALSE\") };\r\n  var function_name = \"CHECKBOX\"\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, checkBoxCellId, getHTMLCheckBoxCellValue );\r\n}\r\n\r\n//Radio Button state changed\r\n// onclick when selected\r\n// update true/false in formula param\r\nSocialCalc.TriggerIoAction.RadioButton = function(radioButtonGroupName) {\r\n  var getHTMLRadioButtonValue = function( radioButtonWidget ) { return (radioButtonWidget.checked ? \"TRUE\" : \"FALSE\") };\r\n  var function_name = \"RADIOBUTTON\"\r\n  // for each radio button in group\r\n  $('input[name=\"'+radioButtonGroupName+'\"]').each(function () {\r\n     SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name,  $(this).attr('id').replace(/RADIOBUTTON_/,''), getHTMLRadioButtonValue );\r\n  });\r\n}\r\n\r\n\r\nSocialCalc.TriggerIoAction.updateInputWidgetFormula = function(function_name, widgetCellId, getHTMLWidgetCellValue ) {\r\n\r\n var spreadsheet =  window.spreadsheet;\r\n if (spreadsheet == null) spreadsheet = window.ss\r\n var sheet = spreadsheet.sheet;\r\n var cell = sheet.cells[widgetCellId];\r\n var parameters = sheet.ioParameterList[widgetCellId];\r\n if(typeof parameters === 'undefined') return;\r\n \r\n var cell_widget=document.getElementById(function_name+'_'+widgetCellId);\r\n var inputValue = getHTMLWidgetCellValue(cell_widget);\r\n inputValue = SocialCalc.encodeForSave(inputValue);\r\n\r\n var sheetCommand = 'set '+widgetCellId+ ' formula '+ function_name+'(\"' +inputValue+'\"';\r\n for(var paramIndex = 1; paramIndex < parameters.length; paramIndex++) {\r\n   if(parameters[paramIndex].type.charAt(0) == 'n') {\r\n     sheetCommand += ',' + parameters[paramIndex].value;\r\n   }\r\n   if(parameters[paramIndex].type.charAt(0) == 't') {\r\n     sheetCommand += ',\"' + parameters[paramIndex].value + '\"';\r\n   }\r\n   if(parameters[paramIndex].type == 'range') {\r\n     // convert:     E5!TO0DB4GSXZJ3|E8|   -> TO0DB4GSXZJ3!E5:E8\r\n     // convert:     E5|E8|   -> E5:E8\r\n     \r\n     // * RegEx Unit Test **  https://regex101.com/r/zF1dA8/1\r\n     sheetCommand += ',' + parameters[paramIndex].value.toString().replace(/(\\$?[A-Z]+\\$?[0-9]+)([!]?)([^|]*)[|](\\$?[A-Z]+\\$?[0-9]+)[|]/i,\"$3$2$1:$4\"); ;\r\n   }\r\n   if(parameters[paramIndex].type == 'coord') {\r\n     sheetCommand += ',' + parameters[paramIndex].value;\r\n   }   \r\n }\r\n\r\n   // for(var parseIndex = 3; parseIndex < cell.parseinfo.length -1; parseIndex++) {\r\n//   if(cell.parseinfo[parseIndex].type == 6)   sheetCommand += '\"' + cell.parseinfo[parseIndex].text + '\"';\r\n//   else sheetCommand +=  cell.parseinfo[parseIndex].text ;\r\n// }\r\n sheetCommand += ')';\r\n // add style formula if css has been added\r\n if(parameters.cssParameter) {\r\n   sheetCommand += \"+style(\"+  parameters.cssParameter+ \")\"; \r\n }\r\n //SocialCalc.CmdGotFocus(cell_widget);\r\n\r\n spreadsheet.editor.EditorScheduleSheetCommands(sheetCommand,  true, false);\r\n \r\n SocialCalc.TriggerIoAction.UpdateFormDataSheet(function_name, widgetCellId, inputValue);\r\n}\r\n\r\n// On edit of Form Input widget - Update form data sheet \r\nSocialCalc.TriggerIoAction.UpdateFormDataSheet = function(function_name, formCellId, inputValue) {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n       ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n       : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer; \r\n  if (formDataViewer == null) return;\r\n\r\n  var formFieldName = (function_name+formCellId).toLowerCase();\r\n  if(formDataViewer.formFields[formFieldName] != null) {       \r\n    var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set \"+valueCoord+\" text t \"+inputValue, false);    \r\n  }\r\n}\r\n\r\n\r\n\r\n//getStandardizedValues(parameterData)  \r\n// gets cell data of range/coord OR param value as cell data - also get coord data as cell.coord is invalid when rows deleted\r\n// CALL getProcessedParameter  with request for values \r\nSocialCalc.Formula.getStandardizedValues = function(sheet, parameterData) {\r\n  return SocialCalc.Formula.getStandardizedParameter(sheet, parameterData, true, true);\r\n}  \r\n\r\n\r\n// getStandardizedCoords(parameterData)  // gets coord(s) of range/coord\r\n// CALL getProcessedParameter  with request for coord info\r\nSocialCalc.Formula.getStandardizedCoords = function(sheet, parameterData) {\r\n  return SocialCalc.Formula.getStandardizedParameter(sheet, parameterData, true, false);\r\n}  \r\n\r\n/***************\r\n * getStandardizedList\r\n * @sheet spreadsheet sheet\r\n * @listParameter csv or array or single value - convert into single array\r\n * @return array of values - one dimension\r\n ****************/\r\nSocialCalc.Formula.getStandardizedList = function(sheet, listParameter) {\r\n  \r\n  var listValues = [];\r\n  var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, listParameter);\r\n  \r\n  if(parameterdata.ncols == 1 && parameterdata.nrows == 1) {\r\n    listValues = String(parameterdata.celldata[0][0].datavalue).split(',');\r\n  } else {\r\n    for (var i=0; i<parameterdata.ncols; i++) {\r\n      for (var j=0; j<parameterdata.nrows; j++) {\r\n         var cell = parameterdata.celldata[i][j];\r\n         listValues.push(cell.datavalue.toString());\r\n      }\r\n   }    \r\n  }\r\n  return listValues;\r\n}\r\n\r\n/**************************\r\n * getStandardizedParameter(parameterData, includeCellCoord, includeCellData)\r\n *\r\n * Convert formula parameter to standard data structure and return it.\r\n * \r\n * Formula parameters can be value/string/coord/range\r\n * value/string: convert to celldata:  [[coord:A1, datatype:t/c/v/f, valuetype:t/nd/n/b, datavalue:string/value , formula:\"test\"&B3]] \r\n * coord/range: get celldata from cell\r\n * \r\n *  return:\r\n ******  data structure returned\r\n  { \r\n     value:A1:B2/A1/string/value,\r\n     type:range/coord/t/n/b/eErrorType,\r\n     celldata: [][] = {coord:invalid, datatype:t/c/v/f, valuetype:t/nd/n/b, datavalue:string/value , formula:\"sum(A1)\"},  // coord is invalid after insert/delete row/col\r\n     cellcoord: [][] = A1,   // if requested\r\n     ncols:n,\r\n     nrows:n\r\n     col1num:n\r\n     row1num:n\r\n   }\r\n\r\n *\r\n * ------------------- type ----------------- \r\n * From docs for SocialCalc.Formula.EvaluatePolish  \r\n * type: can have these values (many are type and sub-type as two or more letters):\r\n *   \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"eErrorType\", \"b\" (blank) - removed: \"start\"\r\n * valuetype: is set to type if the parameter is constant and not a cell reference\r\n * ------------------------------------------\r\n *\r\n *\r\n *******************************/\r\nSocialCalc.Formula.getStandardizedParameter = function(sheet, parameterData, includeCellCoord, includeCellData) {\r\n  \r\n  //SET result = {}\r\n  //SET store param values in result (.value .type)\r\n  var result = { type: parameterData.type, value:parameterData.value};\r\n  if(includeCellData) result.celldata = [];\r\n           \r\n  //IF parameter is not a cell reference i.e.  type is: \"tw\", \"th\", \"t\", \"n\", \"nt\"  THEN    \r\n  if(parameterData.type != 'coord' && parameterData.type != 'range') {\r\n    // Setup dummy cell reference information\r\n    // SET rows and cols to 1 cell   \r\n    result.ncols = 1;\r\n    result.nrows = 1;\r\n    result.col1num = 1;\r\n    result.row1num = 1;\r\n    \r\n    // IF requested: cell coord value THEN\r\n    if(includeCellCoord) {\r\n      // SET coord to default empty value - \r\n      result.cellcoord = null; \r\n    } // END IF\r\n    \r\n    // IF requested: cell data  THEN\r\n    if(includeCellData) {\r\n      // SET data values to dummy cell data using parameter \r\n      // result.celldata = [[ \r\n      //   coord to default null value - as illegal request\r\n      //   datatype  - t/v  - const can only have 2 value types\r\n      //   valuetype (n/b/e/t)  - set to same as parameterData.type - check date/time types don't cause issue\r\n      //   datavalue set to parameterData.type \r\n      //   formula set to empty -  because not range/coord\r\n      // ] ] \r\n      result.celldata[0] = [];\r\n      var constantDatatype = (parameterData.type==\"n\") ? \"v\" : ((parameterData.type==\"t\") ? parameterData.type : \"c\");\r\n      result.celldata[0][0] = {coord:null,datatype:constantDatatype,valuetype: parameterData.type,datavalue:parameterData.value };\r\n    } // END IF\r\n    \r\n  } else {\r\n    // param type is \"coord\" or \"range\" \r\n\r\n    var scf = SocialCalc.Formula; \r\n    \r\n    var sourcerangeinfo;\r\n    if(parameterData.type == 'coord') { \r\n      var sourceCoord = SocialCalc.Formula.PlainCoord(parameterData.value);\r\n      sourcerangeinfo = scf.DecodeRangeParts(sheet, sourceCoord + \"|\"+ sourceCoord +\"|\" );\r\n    }\r\n    \r\n    if(parameterData.type == 'range') {\r\n      sourcerangeinfo = scf.DecodeRangeParts(sheet, parameterData.value);\r\n    }\r\n    \r\n    // if coords requested,  init coord array\r\n    if(includeCellCoord) result.cellcoord = []; \r\n    \r\n    for (var i=0; i<sourcerangeinfo.ncols; i++) {\r\n        for (var j=0; j<sourcerangeinfo.nrows; j++) {\r\n          var cellcoord = SocialCalc.crToCoord(sourcerangeinfo.col1num + i, sourcerangeinfo.row1num + j);\r\n           // IF requested: cell coord value THEN\r\n          if(includeCellCoord) {           \r\n             // SET coord in array to coord of cell\r\n            if(typeof result.cellcoord[i] === 'undefined') result.cellcoord[i] = [];            \r\n            result.cellcoord[i][j] = cellcoord;            \r\n          } // END IF\r\n\r\n          // IF requested: cell data  THEN\r\n          if(includeCellData) {\r\n          \r\n            // SET get cell from sheet and store values \r\n            if(typeof result.celldata[i] === 'undefined') result.celldata[i] = [];                        \r\n            var cell = sourcerangeinfo.sheetdata.GetAssuredCell(cellcoord);\r\n            result.celldata[i][j] = cell; \r\n          } // END IF\r\n        }\r\n    }\r\n    // SET rows and cols to range - i.e. sourcerangeinfo -   ncols:n,       nrows:n       col1num:n      row1num:n\r\n    result.ncols = sourcerangeinfo.ncols;\r\n    result.nrows = sourcerangeinfo.nrows;\r\n    result.col1num = sourcerangeinfo.col1num;\r\n    result.row1num = sourcerangeinfo.row1num;\r\n    \r\n  }  //END IF\r\n    \r\n  //RETURN \r\n  return result;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// -----------------------------------------\r\n// }\r\n// -----------------------------------------\r\n\r\n\r\n\r\n\r\n//\r\n// SHEET CACHE\r\n//\r\n\r\nSocialCalc.Formula.SheetCache = {\r\n\r\n   // Sheet data: Attributes are each sheet in the cache with values of an object with:\r\n   //\r\n   //    sheet: sheet-obj (or null, meaning not found)\r\n   //    recalcstate: constants.asloaded = as loaded\r\n   //                 constants.recalcing = being recalced now\r\n   //                 constants.recalcdone = recalc done\r\n   //    name: name of sheet (in case just have object and don't know name)\r\n   //\r\n\r\n   sheets: {},\r\n\r\n   // Waiting for loading:\r\n   // If sheet is not in cache, this is set to the sheetname being loaded\r\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\r\n   // Reset to null before restarting.\r\n\r\n   waitingForLoading: null,\r\n\r\n   // Constants to use for setting sheets[*].recalcstate:\r\n\r\n   constants: {asloaded: 0, recalcing: 1, recalcdone: 2},\r\n\r\n   loadsheet: null // (deprecated - use SocialCalc.RecalcInfo.LoadSheet)\r\n\r\n   };\r\n\r\n//\r\n// othersheet = SocialCalc.Formula.FindInSheetCache(sheetname)\r\n//\r\n// Returns a SocialCalc.Sheet object corresponding to string sheetname\r\n// or null if the sheet is not available or in error.\r\n//\r\n// Each sheet is loaded only once and then stored in a cache.\r\n// Loading is handled elsewhere, e.g., in the recalc loop.\r\n//\r\n\r\nSocialCalc.Formula.FindInSheetCache = function(sheetname) {\r\n\r\n   var str;\r\n   var sfsc = SocialCalc.Formula.SheetCache;\r\n\r\n   var nsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname); // normalize different versions\r\n\r\n   if (sfsc.sheets[nsheetname]) { // a sheet by that name is in the cache already\r\n      return sfsc.sheets[nsheetname].sheet; // return it.\r\n      }\r\n\r\n   if (sfsc.waitingForLoading) { // waiting already - only queue up one\r\n      return null; // return not found\r\n      }\r\n\r\n   if (sfsc.loadsheet) { // Deprecated old format synchronous callback\r\nalert(\"Using SocialCalc.Formula.SheetCache.loadsheet - deprecated\");\r\n      return SocialCalc.Formula.AddSheetToCache(nsheetname, sfsc.loadsheet(nsheetname));\r\n      }\r\n\r\n   sfsc.waitingForLoading = nsheetname; // let recalc loop know that we have a sheet to load\r\n\r\n   return null; // return not found\r\n\r\n   }\r\n\r\n//\r\n// newsheet = SocialCalc.Formula.AddSheetToCache(sheetname, str, live)\r\n//\r\n// Adds a new sheet to the sheet cache.\r\n// Returns the sheet object filled out with the str (a saved sheet).\r\n//\r\n\r\nSocialCalc.Formula.AddSheetToCache = function(sheetname, str, live) {\r\n\r\n   var newsheet = null;\r\n   var sfsc = SocialCalc.Formula.SheetCache;\r\n   var sfscc = sfsc.constants;\r\n   var newsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname);\r\n\r\n   if (str) {\r\n      newsheet = new SocialCalc.Sheet();\r\n      newsheet.ParseSheetSave(str);\r\n      }\r\n\r\n   sfsc.sheets[newsheetname] = {sheet: newsheet, recalcstate: sfscc.asloaded, name: newsheetname};\r\n\r\n   SocialCalc.Formula.FreshnessInfo.sheets[newsheetname] = (typeof(live) == \"undefined\" || live === false);\r\n\r\n   return newsheet;\r\n\r\n   }\r\n\r\n//\r\n// nsheet = SocialCalc.Formula.NormalizeSheetName(sheetname)\r\n//\r\n\r\nSocialCalc.Formula.NormalizeSheetName = function(sheetname) {\r\n\r\n   if (SocialCalc.Callbacks.NormalizeSheetName) {\r\n      return SocialCalc.Callbacks.NormalizeSheetName(sheetname);\r\n      }\r\n   else {\r\n      return sheetname.toLowerCase();\r\n      }\r\n   }\r\n\r\n//\r\n// REMOTE FUNCTION INFO\r\n//\r\n\r\nSocialCalc.Formula.RemoteFunctionInfo = {\r\n\r\n   // Waiting for server:\r\n   // If waiting for an XHR response from the server, this is set to some non-blank status text\r\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\r\n   // Reset to null before restarting.\r\n\r\n   waitingForServer: null\r\n\r\n   };\r\n\r\n//\r\n// FRESHNESS INFO\r\n//\r\n// This information is generated during recalc.\r\n// It may be used to help determine when the recalc data in a spreadsheet\r\n// may be out of date.\r\n// For example, it may be used to display a message like:\r\n// \"Dependent on sheet 'FOO' which was updated more recently than this printout\"\r\n\r\nSocialCalc.Formula.FreshnessInfo = {\r\n\r\n   // For each external sheet referenced successfully an attribute of that name with value true to keep the sheet cached.\r\n   // Value false means the sheet is reloaded at each recalc.\r\n\r\n   sheets: {},\r\n\r\n   // For each volatile function that is called an attribute of that name with value true.\r\n\r\n   volatile: {},\r\n\r\n   // Set to false when started and true when recalc completes\r\n\r\n   recalc_completed: false\r\n\r\n   };\r\n\r\nSocialCalc.Formula.FreshnessInfoReset = function() {\r\n\r\n   var scffi = SocialCalc.Formula.FreshnessInfo;\r\n   var scfsc = SocialCalc.Formula.SheetCache;\r\n\r\n   // Loop through sheets freshness, deleting cached sheets that should be reloaded.\r\n\r\n   for (var sheet in scffi.sheets) {\r\n      if (scffi.sheets[sheet] === false) {\r\n         delete scfsc.sheets[sheet];\r\n         }\r\n      }\r\n   \r\n   // Reset freshness info.\r\n\r\n   scffi.sheets = {};\r\n   scffi.volatile = {};\r\n   scffi.recalc_completed = false;\r\n\r\n   }\r\n\r\n//\r\n// MISC ROUTINES\r\n//\r\n\r\n//\r\n// result = SocialCalc.Formula.PlainCoord(coord)\r\n//\r\n// Returns: coord without any $'s\r\n//\r\n\r\nSocialCalc.Formula.PlainCoord = function(coord) {\r\n\r\n   if (coord.indexOf(\"$\") == -1) return coord;\r\n\r\n   return coord.replace(/\\$/g, \"\"); // remove any $'s\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.Formula.OrderRangeParts(coord1, coord2)\r\n//\r\n// Returns: {c1: col, r1: row, c2: col, r2 = row} with c1/r1 upper left\r\n//\r\n\r\nSocialCalc.Formula.OrderRangeParts = function(coord1, coord2) {\r\n\r\n   var cr1, cr2;\r\n   var result = {};\r\n\r\n   cr1 = SocialCalc.coordToCr(coord1);\r\n   cr2 = SocialCalc.coordToCr(coord2);\r\n   if (cr1.col > cr2.col) { result.c1 = cr2.col; result.c2 = cr1.col; }\r\n   else { result.c1 = cr1.col; result.c2 = cr2.col; }\r\n   if (cr1.row > cr2.row) { result.r1 = cr2.row; result.r2 = cr1.row; }\r\n   else { result.r1 = cr1.row; result.r2 = cr2.row; }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// cond = SocialCalc.Formula.TestCriteria(value, type, criteria)\r\n//\r\n// Determines whether a value/type meets the criteria.\r\n// A criteria can be a numeric value, text beginning with <, <=, =, >=, >, <>, text by itself is start of text to match.\r\n// Used by a variety of functions, including the \"D\" functions (DSUM, etc.).\r\n//\r\n// Returns true or false\r\n//\r\n\r\nSocialCalc.Formula.TestCriteria = function(value, type, criteria) {\r\n\r\n   var comparitor, basestring, basevalue, cond, testvalue;\r\n\r\n   if (criteria == null) { // undefined (e.g., error value) is always false\r\n      return false;\r\n      }\r\n\r\n   criteria = criteria + \"\";\r\n   comparitor = criteria.charAt(0); // look for comparitor\r\n   if (comparitor == \"=\" || comparitor == \"<\" || comparitor == \">\") {\r\n      basestring = criteria.substring(1);\r\n      }\r\n   else {\r\n      // check for '*' or '?' in search string - wildcard\r\n      if (criteria.search(/([^~]\\*|^\\*)/) != -1 || criteria.search(/([^~]\\?|^\\?)/) != -1) {\r\n         comparitor = \"regex\";\r\n         if (criteria == \"*\") {\r\n            // \"*\" means cell contains 'anything'\r\n            basestring = \".+\";\r\n         } else {\r\n             // convert Excel syntax to regex syntax. * -> .*    ? -> .?    ~* -> \\*    ~? -> \\?\r\n             // there are no negative lookbehinds in Javascript. Reverse the string and do negative lookaheads on ~? and ~*\r\n             basestring = criteria.split(\"\").reverse().join(\"\");\r\n             basestring = basestring.replace(/\\?(?=[^~])|\\?$/g, \"?.\").replace(/\\?~/g, \"?\\\\\").replace(/\\*(?=[^~])|\\*$/g, \"*.\").replace(/\\*~/, \"*\\\\\");\r\n             basestring = basestring.split(\"\").reverse().join(\"\");\r\n         }\r\n         basestring = \"^\" + basestring + \"$\";\r\n      } else {\r\n          comparitor = criteria.substring(0,2);\r\n          if (comparitor == \"<=\" || comparitor == \"<>\" || comparitor == \">=\") {\r\n             basestring = criteria.substring(2);\r\n          } else {\r\n             comparitor = \"none\";\r\n             basestring = criteria;\r\n          }\r\n      }\r\n   }\r\n\r\n   basevalue = SocialCalc.DetermineValueType(basestring); // get type of value being compared\r\n   if (!basevalue.type) { // no criteria base value given\r\n      if (comparitor == \"none\") { // blank criteria matches nothing\r\n         return false;\r\n         }\r\n      if (type.charAt(0) == \"b\") { // comparing to empty cell\r\n         if (comparitor == \"=\") { // empty equals empty\r\n            return true;\r\n            }\r\n         }\r\n      else {\r\n         if (comparitor == \"<>\") { // \"something\" does not equal empty\r\n            return true;\r\n            }\r\n         }\r\n      return false; // otherwise false\r\n      }\r\n\r\n   cond = false;\r\n\r\n   if (basevalue.type.charAt(0) == \"n\" && type.charAt(0) == \"t\") { // criteria is number, but value is text\r\n      testvalue = SocialCalc.DetermineValueType(value);\r\n      if (testvalue.type.charAt(0) == \"n\") { // could be number - make it one\r\n         value = testvalue.value;\r\n         type = testvalue.type;\r\n         }\r\n      }\r\n\r\n   if (type.charAt(0) == \"n\" && basevalue.type.charAt(0) == \"n\") { // compare two numbers\r\n      value = value - 0; // make sure numbers\r\n      basevalue.value = basevalue.value - 0;\r\n      switch (comparitor) {\r\n         case \"<\":\r\n            cond = value < basevalue.value;\r\n            break;\r\n\r\n         case \"<=\":\r\n            cond = value <= basevalue.value;\r\n            break;\r\n\r\n         case \"=\":\r\n         case \"none\":\r\n            cond = value == basevalue.value;\r\n            break;\r\n\r\n         case \">=\":\r\n            cond = value >= basevalue.value;\r\n            break;\r\n\r\n         case \">\":\r\n            cond = value > basevalue.value;\r\n            break;\r\n\r\n         case \"<>\":\r\n            cond = value != basevalue.value;\r\n            break;\r\n         }\r\n      }\r\n\r\n   else if (type.charAt(0) == \"e\") { // error on left\r\n      cond = false;\r\n      }\r\n\r\n   else if (basevalue.type.charAt(0) == \"e\") { // error on right\r\n      cond = false;\r\n      }\r\n\r\n   else { // text, maybe mixed with number or blank\r\n      if (type.charAt(0) == \"n\") {\r\n         value = SocialCalc.format_number_for_display(value, \"n\", \"\");\r\n         }\r\n      if (basevalue.type.charAt(0) == \"n\") {\r\n         return false; // if number and didn't match already, isn't a match\r\n         }\r\n\r\n      value = value ? value.toLowerCase() : \"\";\r\n      basevalue.value = basevalue.value ? basevalue.value.toLowerCase() : \"\";\r\n\r\n      switch (comparitor) {\r\n         case \"<\":\r\n            cond = value < basevalue.value;\r\n            break;\r\n\r\n         case \"<=\":\r\n            cond = value <= basevalue.value;\r\n            break;\r\n\r\n         case \"=\":\r\n            cond = value == basevalue.value;\r\n            break;\r\n\r\n         case \"none\":\r\n            cond = value.substring(0, basevalue.value.length) == basevalue.value;\r\n            break;\r\n\r\n         case \">=\":\r\n            cond = value >= basevalue.value;\r\n            break;\r\n\r\n         case \">\":\r\n            cond = value > basevalue.value;\r\n            break;\r\n\r\n         case \"<>\":\r\n            cond = value != basevalue.value;\r\n            break;\r\n\r\n         case \"regex\":\r\n            try {\r\n              cond = value.search(new RegExp(basevalue.value)) != -1;\r\n            } catch(e) {\r\n              cond = false; // regex invalid (e.g., error value) is always false\r\n            }\r\n            break;\r\n         }\r\n      }\r\n\r\n   return cond;\r\n\r\n   }\r\n//\r\n/*\r\n// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js\r\n//\r\n// (c) Copyright 2009 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n//\r\n*/\r\n\r\n   var SocialCalc; // All values are stored in the master SocialCalc object\r\n   if (!SocialCalc) {\r\n      SocialCalc = {};\r\n      }\r\n\r\n   // The main Popup data -- there is only one set\r\n\r\n   SocialCalc.Popup = {};\r\n\r\n   // Routines and values for each type of control, indexed by type name\r\n   // The value for each is an object constructed as follows:\r\n   //\r\n   //    Create = function(type, id, attribs)\r\n   //    Initialize = function(type, id, data)\r\n   //    SetValue = function(type, id, value)\r\n   //    GetValue = function(type, id) returns value\r\n   //    SetDisabled = function(type, id, t/f)\r\n   //    Show = function(type, id)\r\n   //    Hide = function(type, id)\r\n   //    Cancel = function(type, id)\r\n   //    Reset = function(type)\r\n   //\r\n   //    data = object to hold type-specific data\r\n   //\r\n\r\n   SocialCalc.Popup.Types = {};\r\n\r\n   // Definitions for each individual control, indexed by id\r\n   // The value for each is an object constructed as follows:\r\n   //\r\n   //    type: type name of the control\r\n   //    value: current value of the control (usually a string, but can depend on type)\r\n   //    data: object with type-specific items\r\n   //\r\n\r\n   SocialCalc.Popup.Controls = {};\r\n\r\n   // System-wide values of currently active control\r\n   //\r\n   //    id: id of current control or null\r\n   //\r\n\r\n   SocialCalc.Popup.Current = {};\r\n\r\n   // Override this for localization\r\n\r\n   SocialCalc.Popup.LocalizeString = function(str) {return str;};\r\n\r\n\r\n// * * * * * * * * * * * * * * * *\r\n//\r\n// GENERAL ROUTINES\r\n//\r\n// * * * * * * * * * * * * * * * *\r\n\r\n//\r\n// SocialCalc.Popup.Create(type, id, attribs)\r\n//\r\n// Creates a control of type \"type\" as the children of document element \"id\" using \"attribs\"\r\n//\r\n\r\nSocialCalc.Popup.Create = function(type, id, attribs) {\r\n\r\n   var pt = SocialCalc.Popup.Types[type];\r\n   if (pt && pt.Create) {\r\n      pt.Create(type, id, attribs);\r\n      }\r\n\r\n   SocialCalc.Popup.imagePrefix = SocialCalc.Constants.defaultImagePrefix; // image prefix\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.SetValue(id, value)\r\n//\r\n// Sets the value of control.\r\n//\r\n\r\nSocialCalc.Popup.SetValue = function(id, value) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n   var pt = spt[type];\r\n   var spcdata = spc[id].data;\r\n\r\n   if (pt && pt.Create) {\r\n      pt.SetValue(type, id, value);\r\n      if (spcdata.attribs && spcdata.attribs.changedcallback) {\r\n         spcdata.attribs.changedcallback(spcdata.attribs, id, value);\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.SetDisabled(id, disabled)\r\n//\r\n// Sets whether the control is disabled (true) or not (false).\r\n//\r\n\r\nSocialCalc.Popup.SetDisabled = function(id, disabled) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Create) {\r\n      if (sp.Current.id && id == sp.Current.id) {\r\n         pt.Hide(type, sp.Current.id);\r\n         sp.Current.id = null;\r\n         }\r\n      pt.SetDisabled(type, id, disabled);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.GetValue(id)\r\n//\r\n// Returns the value of control.\r\n//\r\n\r\nSocialCalc.Popup.GetValue = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Create) {\r\n      return pt.GetValue(type, id);\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Initialize(id, data)\r\n//\r\n// Gives \"data\" to the appropriate initialization code.\r\n//\r\n\r\nSocialCalc.Popup.Initialize = function(id, data) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Initialize) {\r\n      pt.Initialize(type, id, data);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Reset(type)\r\n//\r\n// Resets Popup, such as when turning to page.\r\n//\r\n\r\nSocialCalc.Popup.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (spt[type].Reset) spt[type].Reset(type);\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.CClick(id)\r\n//\r\n// Should be called when the user clicks on a control to do the popup\r\n//\r\n\r\nSocialCalc.Popup.CClick = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   if (spc[id].data && spc[id].data.disabled) return;\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n\r\n   if (sp.Current.id) {\r\n      spt[spc[sp.Current.id].type].Hide(type, sp.Current.id);\r\n      if (id == sp.Current.id) { // same one - done\r\n         sp.Current.id = null;\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (pt && pt.Show) {\r\n      pt.Show(type, id);\r\n      }\r\n\r\n   sp.Current.id = id;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Close()\r\n//\r\n// Used to close any open popup.\r\n//\r\n\r\nSocialCalc.Popup.Close = function() {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!sp.Current.id) return;\r\n\r\n   sp.CClick(sp.Current.id);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Popup.Cancel()\r\n//\r\n// Closes Popup and restores old value\r\n//\r\n\r\nSocialCalc.Popup.Cancel = function() {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!sp.Current.id) return;\r\n\r\n   var type = spc[sp.Current.id].type;\r\n\r\n   var pt = spt[type];\r\n\r\n   pt.Cancel(type, sp.Current.id);\r\n\r\n   sp.Current.id = null;\r\n\r\n   }\r\n\r\n//\r\n// ele = SocialCalc.Popup.CreatePopupDiv(id, attribs)\r\n//\r\n// Utility function to create the main popup div of width attribs.width.\r\n// If attribs.title, create one with that text, and optionally attribs.moveable.\r\n//\r\n\r\nSocialCalc.Popup.CreatePopupDiv = function(id, attribs) {\r\n\r\n   var pos, ele;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.style.position = \"absolute\";\r\n\r\n   pos = SocialCalc.GetElementPosition(spcdata.mainele);\r\n\r\n   main.style.top = (pos.top+spcdata.mainele.offsetHeight)+\"px\";\r\n   main.style.left = pos.left+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   if (attribs.width) {\r\n      main.style.width = attribs.width;\r\n      }\r\n\r\n   spcdata.mainele.appendChild(main);\r\n\r\n   if (attribs.title) {\r\n      main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n         '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+attribs.title+'</td>'+\r\n         '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.Popup.Cancel();\">&nbsp;X&nbsp;</td></tr></table>';\r\n\r\n      if (attribs.moveable) {\r\n         spcdata.dragregistered = main.firstChild.firstChild.firstChild.firstChild;\r\n         SocialCalc.DragRegister(spcdata.dragregistered, true, true, \r\n                    {MouseDown: SocialCalc.DragFunctionStart, \r\n                     MouseMove: SocialCalc.DragFunctionPosition,\r\n                     MouseUp: SocialCalc.DragFunctionPosition,\r\n                     Disabled: null, positionobj: main},\r\n                     spcdata.mainele);\r\n         }\r\n      }\r\n\r\n   return main;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Popup.EnsurePosition(id, container)\r\n//\r\n// Utility function to make sure popup is positioned completely within container (both element objects)\r\n// and appropriate with respect to the main element controlling the popup.\r\n//\r\n\r\nSocialCalc.Popup.EnsurePosition = function(id, container) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var main = spcdata.mainele.firstChild;\r\n   if (!main) {alert(\"No main popup element firstChild.\");return};\r\n   var popup = spcdata.popupele;\r\n\r\n   function GetLayoutValues(ele) {\r\n      var r = SocialCalc.GetElementPosition(ele);\r\n      r.height = ele.offsetHeight;\r\n      r.width = ele.offsetWidth;\r\n      r.bottom = r.top+r.height;\r\n      r.right = r.left+r.width;\r\n      return r;\r\n      }\r\n\r\n   var p = GetLayoutValues(popup);\r\n   var c = GetLayoutValues(container);\r\n   var m = GetLayoutValues(main);\r\n   var t = 0; // type of placement\r\n//addmsg(\"popup t/r/b/l/h/w= \"+p.top+\"/\"+p.right+\"/\"+p.bottom+\"/\"+p.left+\"/\"+p.height+\"/\"+p.width);\r\n//addmsg(\"container t/r/b/l/h/w= \"+c.top+\"/\"+c.right+\"/\"+c.bottom+\"/\"+c.left+\"/\"+c.height+\"/\"+c.width);\r\n//addmsg(\"main t/r/b/l/h/w= \"+m.top+\"/\"+m.right+\"/\"+m.bottom+\"/\"+m.left+\"/\"+m.height+\"/\"+m.width);\r\n\r\n   // Check various layout cases in priority order\r\n\r\n   if (m.bottom+p.height < c.bottom && m.left+p.width < c.right) { // normal case: room on bottom and right\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = m.left + \"px\";\r\n      t = 1;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && m.left+p.width < c.right) { // room on top and right\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = m.left + \"px\";\r\n      t = 2;\r\n      }\r\n\r\n   else if (m.bottom+p.height < c.bottom && m.right-p.width > c.left) { // room on bottom and left\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = (m.right-p.width) + \"px\";\r\n      t = 3;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && m.right-p.width > c.left) { // room on top and left\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = (m.right-p.width) + \"px\";\r\n      t = 4;\r\n      }\r\n\r\n   else if (m.bottom+p.height < c.bottom && p.width < c.width) { // room on bottom and middle\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\r\n      t = 5;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && p.width < c.width) { // room on top and middle\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\r\n      t = 6;\r\n      }\r\n\r\n   else if (p.height < c.height && m.right+p.width < c.right) { // room on middle and right\r\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\r\n      popup.style.left = m.right + \"px\";\r\n      t = 7;\r\n      }\r\n\r\n   else if (p.height < c.height && m.left-p.width > c.left) { // room on middle and left\r\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\r\n      popup.style.left = (m.left-p.width) + \"px\";\r\n      t = 8;\r\n      }\r\n\r\n   else { // nothing works, so leave as it is\r\n      }\r\n//addmsg(\"Popup layout \"+t);\r\n\r\n}\r\n\r\n//\r\n// ele = SocialCalc.Popup.DestroyPopupDiv(ele, dragregistered)\r\n//\r\n// Utility function to get rid of the main popup div.\r\n//\r\n\r\nSocialCalc.Popup.DestroyPopupDiv = function(ele, dragregistered) {\r\n\r\n   if (!ele) return;\r\n\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(dragregistered); // OK to do this even if not registered\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// Color Utility Functions\r\n//\r\n\r\nSocialCalc.Popup.RGBToHex = function(val) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (val==\"\") {\r\n      return \"000000\";\r\n      }\r\n   var rgbvals = val.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);\r\n   if (rgbvals) {\r\n      return sp.ToHex(rgbvals[1])+sp.ToHex(rgbvals[2])+sp.ToHex(rgbvals[3]);\r\n      }\r\n   else {\r\n      return \"000000\";\r\n      }\r\n   }\r\n\r\nSocialCalc.Popup.HexDigits=\"0123456789ABCDEF\";\r\n\r\nSocialCalc.Popup.ToHex = function(num) {\r\n   var sp = SocialCalc.Popup;\r\n   var first=Math.floor(num / 16);\r\n   var second=num % 16;\r\n   return sp.HexDigits.charAt(first)+sp.HexDigits.charAt(second);\r\n   }\r\n\r\nSocialCalc.Popup.FromHex = function(str) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var first = sp.HexDigits.indexOf(str.charAt(0).toUpperCase());\r\n   var second = sp.HexDigits.indexOf(str.charAt(1).toUpperCase());\r\n   return ((first>=0)?first:0)*16+((second>=0)?second:0);\r\n   }\r\n\r\nSocialCalc.Popup.HexToRGB = function(val) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   return \"rgb(\"+sp.FromHex(val.substring(1,3))+\",\"+sp.FromHex(val.substring(3,5))+\",\"+sp.FromHex(val.substring(5,7))+\")\";\r\n\r\n   }\r\n\r\nSocialCalc.Popup.makeRGB = function(r, g, b) {\r\n   return \"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\";\r\n   }\r\n\r\nSocialCalc.Popup.splitRGB = function(rgb) {\r\n   var parts = rgb.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)\\D/);\r\n   if (!parts) {\r\n      return {r:0, g:0, b:0};\r\n      }\r\n   else {\r\n      return {r: parts[1]-0, g: parts[2]-0, b: parts[3]-0};\r\n      }\r\n   }\r\n\r\n// * * * * * * * * * * * * * * * *\r\n//\r\n// ROUTINES FOR EACH TYPE\r\n//\r\n// * * * * * * * * * * * * * * * *\r\n\r\n//\r\n// List\r\n//\r\n// type: List\r\n// value: value of control,\r\n// display: \"value to display\",\r\n// custom: true if custom value,\r\n// disabled: t/f,\r\n// attribs: {\r\n//    title: \"popup title string\",\r\n//    moveable: t/f,\r\n//    width: optional width, e.g., \"100px\",\r\n//    ensureWithin: optional element object to ensure popup fits within if possible\r\n//    changedcallback: optional function(attribs, id, newvalue),\r\n//    ...\r\n//    }\r\n// data: {\r\n//    ncols: calculated number of columns\r\n//    options: [\r\n//       {o: option-name, v: value-to-return,\r\n//        a: {option attribs} // optional: {skip: true, custom: true, cancel: true, newcol: true}\r\n//       },\r\n//       ...]\r\n//    }\r\n//\r\n// popupele: gets popup element object when created\r\n// contentele: gets element created with all the content\r\n// listdiv: gets div with list of items\r\n// customele: gets input element with custom value\r\n// dragregistered: gets element, if any, registered as draggable\r\n//\r\n\r\nSocialCalc.Popup.Types.List = {};\r\n\r\nSocialCalc.Popup.Types.List.Create = function(type, id, attribs) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\r\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\r\n   spc[id] = spcid;\r\n   var spcdata = spcid.data;\r\n\r\n   spcdata.attribs = attribs || {};\r\n\r\n   var ele = document.getElementById(id);\r\n   if (!ele) {alert(\"Missing element \"+id); return;}\r\n\r\n   spcdata.mainele = ele;\r\n\r\n   ele.innerHTML = '<input style=\"cursor:pointer;width:100px;font-size:smaller;\" onfocus=\"this.blur();\" onclick=\"SocialCalc.Popup.CClick(\\''+id+'\\');\" value=\"\">';\r\n\r\n   spcdata.options = []; // set to nothing - use Initialize to fill\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.List.SetValue = function(type, id, value) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.value = value;\r\n   spcdata.custom = false;\r\n\r\n   for (i=0; i<spcdata.options.length; i++) {\r\n      o = spcdata.options[i];\r\n      if (o.a) {\r\n         if (o.a.skip || o.a.custom || o.a.cancel) {\r\n            continue;\r\n            }\r\n         }\r\n      if (o.v == spcdata.value) { // matches value\r\n         spcdata.display = o.o;\r\n         break;\r\n         }\r\n      }\r\n   if (i==spcdata.options.length) { // none found\r\n      spcdata.display = \"Custom\";\r\n      spcdata.custom = true;\r\n      }\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.value = spcdata.display;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.SetDisabled = function(type, id, disabled) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.disabled = disabled;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = disabled;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.GetValue = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   return spcdata.value;\r\n\r\n   }\r\n\r\n\r\n// data is: {value: initial value, attribs: {attribs stuff}, options: [{o: option-name, v: value-to-return, a: optional-attribs}, ...]}\r\n\r\nSocialCalc.Popup.Types.List.Initialize = function(type, id, data) {\r\n\r\n   var a;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   for (a in data.attribs) {\r\n      spcdata.attribs[a] = data.attribs[a];\r\n      }\r\n\r\n   spcdata.options = data ? data.options : [];\r\n\r\n   if (data.value) { // if has a value, set to it\r\n      sp.SetValue(id, data.value);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\r\n      spt[type].Hide(type, sp.Current.id);\r\n      sp.Current.id = null;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.Show = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = \"\";\r\n\r\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\r\n\r\n   if (spcdata.custom) {\r\n      str = SocialCalc.Popup.Types.List.MakeCustom(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n\r\n      spcdata.customele = ele.firstChild.firstChild.childNodes[1];\r\n      spcdata.listdiv = null;\r\n      spcdata.contentele = ele;\r\n      }\r\n   else {\r\n      str = SocialCalc.Popup.Types.List.MakeList(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\r\n\r\n      spcdata.customele = null;\r\n      spcdata.listdiv = ele.firstChild;\r\n      spcdata.contentele = ele;\r\n      }\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = true;\r\n      }\r\n\r\n   spcdata.popupele.appendChild(ele);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MakeList = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>';\r\n   var td = '<td style=\"vertical-align:top;\">';\r\n\r\n   str += td;\r\n\r\n   spcdata.ncols = 1;\r\n\r\n   for (i=0; i<spcdata.options.length; i++) {\r\n      o = spcdata.options[i];\r\n      if (o.a) {\r\n         if ( o.a.newcol) {\r\n            str += '</td>'+td+\"&nbsp;&nbsp;&nbsp;&nbsp;\"+'</td>'+td;\r\n            spcdata.ncols += 1;\r\n            continue;\r\n            }\r\n         if (o.a.skip) {\r\n            str += '<div style=\"font-size:x-small;white-space:nowrap;\">'+o.o+'</div>';\r\n            continue;\r\n            }\r\n         }\r\n      if (o.v == spcdata.value && !(o.a && (o.a.custom || o.a.cancel))) { // matches value\r\n         bg = \"background-color:#DDF;\";\r\n         }\r\n      else {\r\n         bg = \"\";\r\n         }\r\n      str += '<div style=\"font-size:x-small;white-space:nowrap;'+bg+'\" onclick=\"SocialCalc.Popup.Types.List.ItemClicked(\\''+id+'\\',\\''+i+'\\');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove(\\''+id+'\\',this);\">'+o.o+'</div>';\r\n      }\r\n\r\n   str += \"</td></tr></table>\";\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MakeCustom = function(type, id) {\r\n\r\n   var SPLoc = SocialCalc.Popup.LocalizeString;\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var style = 'style=\"font-size:smaller;\"';\r\n\r\n   var str = \"\";\r\n\r\n   var val = spcdata.value;\r\n   val = SocialCalc.special_chars(val);\r\n\r\n   str = '<div style=\"white-space:nowrap;\"><br>'+\r\n         '<input id=\"customvalue\" value=\"'+val+'\"><br><br>'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomOK(\\''+id+'\\');return false;\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"List\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomToList(\\''+id+'\\');\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Cancel\")+'\" onclick=\"SocialCalc.Popup.Close();\">'+\r\n         '<br></div>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.ItemClicked = function(id, num) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var a = spcdata.options[num].a;\r\n\r\n   if (a && a.custom) {\r\n      oele = spcdata.contentele;\r\n      str = SocialCalc.Popup.Types.List.MakeCustom(\"List\", id);\r\n      nele = document.createElement(\"div\");\r\n      nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n      spcdata.customele = nele.firstChild.firstChild.childNodes[1];\r\n      spcdata.listdiv = null;\r\n      spcdata.contentele = nele;\r\n      spcdata.popupele.replaceChild(nele, oele);\r\n      if (spcdata.attribs.ensureWithin) {\r\n         SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (a && a.cancel) {\r\n      SocialCalc.Popup.Close();\r\n      return;\r\n      }\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.options[num].v);\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.CustomToList = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   oele = spcdata.contentele;\r\n   str = SocialCalc.Popup.Types.List.MakeList(\"List\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\r\n   spcdata.customele = null;\r\n   spcdata.listdiv = nele.firstChild;\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n   \r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.customele.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MouseMove = function(id, ele) {\r\n\r\n   var col, i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var list = spcdata.listdiv;\r\n\r\n   if (!list) return;\r\n\r\n   var rowele = list.firstChild.firstChild.firstChild; // div.table.tbody.tr\r\n\r\n   for (col=0; col<spcdata.ncols; col++) {\r\n      for (i=0; i<rowele.childNodes[col*2].childNodes.length; i++) {\r\n         rowele.childNodes[col*2].childNodes[i].style.backgroundColor = \"#FFF\";\r\n         }\r\n      }\r\n\r\n   ele.style.backgroundColor = \"#DDF\";\r\n   \r\n   }\r\n\r\nSocialCalc.Popup.Types.List.Hide = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\r\n   spcdata.popupele = null;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = false;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.List.Cancel = function(type, id) {\r\n\r\n   SocialCalc.Popup.Types.List.Hide(type, id);\r\n\r\n   }\r\n\r\n\r\n//\r\n// ColorChooser\r\n//\r\n// type: ColorChooser\r\n// value: value of control as \"rgb(r,g,b)\" or \"\" if default,\r\n// oldvalue: starting value to reset to on close,\r\n// display: \"value to display\" as hex color value,\r\n// custom: true if custom value,\r\n// disabled: t/f,\r\n// attribs: {\r\n//    title: \"popup title string\",\r\n//    moveable: t/f,\r\n//    width: optional width, e.g., \"100px\", of popup chooser\r\n//    ensureWithin: optional element object to ensure popup fits within if possible\r\n//    sampleWidth: optional width, e.g., \"20px\",\r\n//    sampleHeight: optional height, e.g., \"20px\",\r\n//    backgroundImage: optional background image for sample (transparent where want to show current color), e.g., \"colorbg.gif\"\r\n//    backgroundImageDefault: optional background image for sample when default (transparent shows white)\r\n//    backgroundImageDisabled: optional background image for sample when disabled (transparent shows gray)\r\n//    changedcallback: optional function(attribs, id, newvalue),\r\n//    ...\r\n//    }\r\n// data: {\r\n//    }\r\n//\r\n// popupele: gets popup element object when created\r\n// contentele: gets element created with all the content\r\n// customele: gets input element with custom value\r\n//\r\n\r\nSocialCalc.Popup.Types.ColorChooser = {};\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Create = function(type, id, attribs) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\r\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\r\n   spc[id] = spcid;\r\n   var spcdata = spcid.data;\r\n\r\n   spcdata.attribs = attribs || {};\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.value = \"\";\r\n\r\n   var ele = document.getElementById(id);\r\n   if (!ele) {alert(\"Missing element \"+id); return;}\r\n\r\n   spcdata.mainele = ele;\r\n\r\n   ele.innerHTML = '<div style=\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+\r\n                   (spca.sampleWidth || '15px')+';height:'+(spca.sampleHeight || '15px')+\r\n                   ';\" onclick=\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\''+id+'\\');\">&nbsp;</div>';\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetValue = function(type, id, value) {\r\n\r\n   var i, img, pos;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.value = value;\r\n   spcdata.custom = false;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      if (spcdata.value) {\r\n         spcdata.mainele.firstChild.style.backgroundColor = spcdata.value;\r\n         if (spca.backgroundImage) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImage+\")\";\r\n            }\r\n         else {\r\n            img = \"\";\r\n            }\r\n         pos = \"center center\";\r\n         }\r\n      else {\r\n         spcdata.mainele.firstChild.style.backgroundColor = \"#FFF\";\r\n         if (spca.backgroundImageDefault) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDefault+\")\";\r\n            pos = \"center center\";\r\n            }\r\n         else {\r\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n            pos = \"left top\";\r\n            }\r\n         }\r\n      spcdata.mainele.firstChild.style.backgroundPosition = pos;\r\n      spcdata.mainele.firstChild.style.backgroundImage = img;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetDisabled = function(type, id, disabled) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.disabled = disabled;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      if (disabled) {\r\n         spcdata.mainele.firstChild.style.backgroundColor = \"#DDD\";\r\n         if (spca.backgroundImageDisabled) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDisabled+\")\";\r\n            pos = \"center center\";\r\n            }\r\n         else {\r\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n            pos = \"left top\";\r\n            }\r\n         spcdata.mainele.firstChild.style.backgroundPosition = pos;\r\n         spcdata.mainele.firstChild.style.backgroundImage = img;\r\n         }\r\n      else {\r\n         sp.SetValue(id, spcdata.value);\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.GetValue = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   return spcdata.value;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Initialize = function(type, id, data) {\r\n\r\n   var a;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   for (a in data.attribs) {\r\n      spcdata.attribs[a] = data.attribs[a];\r\n      }\r\n\r\n   if (data.value) { // if has a value, set to it\r\n      sp.SetValue(id, data.value);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\r\n      spt[type].Hide(type, sp.Current.id);\r\n      sp.Current.id = null;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Show = function(type, id) {\r\n\r\n   var i, ele, mainele;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = \"\";\r\n\r\n   spcdata.oldvalue = spcdata.value; // remember starting value\r\n\r\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\r\n\r\n   if (spcdata.custom) {\r\n      str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n\r\n      spcdata.customele = ele.firstChild.firstChild.childNodes[2];\r\n      spcdata.contentele = ele;\r\n      }\r\n   else {\r\n      mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.style.padding = \"3px\";\r\n      ele.style.backgroundColor = \"#CCC\";\r\n      ele.appendChild(mainele);\r\n\r\n      spcdata.customele = null;\r\n      spcdata.contentele = ele;\r\n      }\r\n\r\n   spcdata.popupele.appendChild(ele);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.MakeCustom = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var SPLoc = sp.LocalizeString;\r\n\r\n   var style = 'style=\"font-size:smaller;\"';\r\n\r\n   var str = \"\";\r\n\r\n   str = '<div style=\"white-space:nowrap;\"><br>'+\r\n         '#<input id=\"customvalue\" style=\"width:75px;\" value=\"'+spcdata.value+'\"><br><br>'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\''+id+'\\');return false;\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Grid\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\''+id+'\\');\">'+\r\n         '<br></div>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.ItemClicked = function(id, num) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomToList = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.SetValue(id, spcdata.customele.value);\r\n\r\n   sp.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Hide = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\r\n   spcdata.popupele = null;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Cancel = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.SetValue(id, spcdata.oldvalue); // reset to old value\r\n\r\n   SocialCalc.Popup.Types.ColorChooser.Hide(type, id);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CreateGrid = function (type, id) {\r\n\r\n   var ele, pos, row, rowele, col, g;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var SPLoc = sp.LocalizeString;\r\n   var spcdata = spc[id].data;\r\n   spcdata.grid = {};\r\n   var grid = spcdata.grid;\r\n\r\n   var mainele = document.createElement(\"div\");\r\n\r\n   ele = document.createElement(\"table\");\r\n   ele.cellSpacing = 0;\r\n   ele.cellPadding = 0;\r\n   ele.style.width = \"100px\";\r\n   grid.table = ele;\r\n\r\n   ele = document.createElement(\"tbody\");\r\n   grid.table.appendChild(ele);\r\n   grid.tbody = ele;\r\n\r\n   for (row=0; row<16; row++) {\r\n      rowele = document.createElement(\"tr\");\r\n      for (col=0; col<5; col++) {\r\n         g = {};\r\n         grid[row+\",\"+col] = g;\r\n         ele = document.createElement(\"td\");\r\n         ele.style.fontSize = \"1px\";\r\n         ele.innerHTML = \"&nbsp;\";\r\n         ele.style.height = \"10px\";\r\n         if (col<=1) {\r\n            ele.style.width = \"17px\";\r\n            ele.style.borderRight = \"3px solid white\";\r\n            }\r\n         else {\r\n            ele.style.width = \"20px\";\r\n            ele.style.backgroundRepeat = \"no-repeat\";\r\n            }\r\n         rowele.appendChild(ele);\r\n         g.ele = ele;\r\n         }\r\n      grid.tbody.appendChild(rowele);\r\n      }\r\n   mainele.appendChild(grid.table);\r\n\r\n   ele = document.createElement(\"div\");\r\n   ele.style.marginTop = \"3px\";\r\n   ele.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '<td style=\"width:17px;background-color:#FFF;background-image:url('+sp.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\" title=\"'+SPLoc(\"Default\")+'\">&nbsp;</td>'+\r\n      '<td style=\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\" title=\"'+SPLoc(\"Custom\")+'\">#</td>'+\r\n      '<td style=\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\">'+SPLoc(\"OK\")+'</td>'+\r\n      '</tr></table>';\r\n   grid.defaultbox = ele.firstChild.firstChild.firstChild.childNodes[0];\r\n   grid.defaultbox.onclick = spt.ColorChooser.DefaultClicked;\r\n   grid.custom = ele.firstChild.firstChild.firstChild.childNodes[1];\r\n   grid.custom.onclick = spt.ColorChooser.CustomClicked;\r\n   grid.msg = ele.firstChild.firstChild.firstChild.childNodes[2];\r\n   grid.msg.onclick = spt.ColorChooser.CloseOK;\r\n   mainele.appendChild(ele);\r\n\r\n   grid.table.onmousedown = spt.ColorChooser.GridMouseDown;\r\n\r\n   spt.ColorChooser.DetermineColors(id);\r\n   spt.ColorChooser.SetColors(id);\r\n\r\n   return mainele;\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.gridToG = function(grid, row, col) {\r\n\r\n   return grid[row+\",\"+col];\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.DetermineColors = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   var col, row;\r\n   var rgb = sp.splitRGB(spcdata.value);\r\n   var color;\r\n\r\n   col = 2;\r\n   row = 16-Math.floor((rgb.r+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),0,0);\r\n      }\r\n\r\n   col = 3;\r\n   row = 16-Math.floor((rgb.g+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,17*(15-row),0);\r\n      }\r\n\r\n   col = 4;\r\n   row = 16-Math.floor((rgb.b+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,0,17*(15-row));\r\n      }\r\n\r\n   col = 1;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),17*(15-row),17*(15-row));\r\n      }\r\n\r\n   col = 0;\r\n   var steps = [0, 68, 153, 204, 255];\r\n   var commonrgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"];\r\n   var x;\r\n   for (row=0; row<16; row++) {\r\n      x = commonrgb[row];\r\n      sptc.gridToG(grid,row,col).rgb = \"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetColors = function(id) {\r\n\r\n   var row, col, g, ele, rgb;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   for (row=0; row<16; row++) {\r\n      for (col=0; col<5; col++) {\r\n         g = sptc.gridToG(grid,row, col);\r\n         g.ele.style.backgroundColor = g.rgb;\r\n         g.ele.title = sp.RGBToHex(g.rgb);\r\n         if (grid[\"selectedrow\"+col]==row) {\r\n            g.ele.style.backgroundImage = \"url(\"+sp.imagePrefix+\"chooserarrow.gif)\";\r\n            }\r\n         else {\r\n            g.ele.style.backgroundImage = \"\";\r\n            }\r\n         }\r\n      }\r\n\r\n   sp.SetValue(id, spcdata.value);\r\n\r\n   grid.msg.style.backgroundColor = spcdata.value;\r\n   rgb = sp.splitRGB(spcdata.value || \"rgb(255,255,255)\");\r\n   if (rgb.r+rgb.g+rgb.b < 220) {\r\n      grid.msg.style.color = \"#FFF\";\r\n      }\r\n   else {\r\n      grid.msg.style.color = \"#000\";\r\n      }\r\n   if (!spcdata.value) { // default\r\n      grid.msg.style.backgroundColor = \"#FFF\";\r\n      grid.msg.style.backgroundImage = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n      grid.msg.title = \"Default\";\r\n      }\r\n   else {\r\n      grid.msg.style.backgroundImage = \"\";\r\n      grid.msg.title = sp.RGBToHex(spcdata.value);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.GridMouseDown = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   switch (event.type) {\r\n      case \"mousedown\":\r\n         grid.mousedown = true;\r\n         break;\r\n      case \"mouseup\":\r\n         grid.mousedown = false;\r\n         break;\r\n      case \"mousemove\":\r\n         if (!grid.mousedown) {\r\n            return;\r\n            }\r\n         break;\r\n      }\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spcdata.mainele);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   var gpos = SocialCalc.GetElementPositionWithScroll(grid.table);\r\n   gpos.left -= pos.left;\r\n   gpos.top -= pos.top\r\n   var row = Math.floor((clientY-gpos.top-2)/10); // -2 is to split the diff btw IE & FF\r\n   row = row < 0 ? 0 : row;\r\n   var col = Math.floor((clientX-gpos.left)/20);\r\n   row = row < 0 ? 0 : (row > 15 ? 15 : row);\r\n   col = col < 0 ? 0 : (col > 4 ? 4 : col);\r\n   var color = sptc.gridToG(grid,row,col).ele.style.backgroundColor;\r\n   var newrgb = sp.splitRGB(color);\r\n   var oldrgb = sp.splitRGB(spcdata.value);\r\n\r\n   switch (col) {\r\n      case 2:\r\n         spcdata.value = sp.makeRGB(newrgb.r, oldrgb.g, oldrgb.b);\r\n         break;\r\n      case 3:\r\n         spcdata.value = sp.makeRGB(oldrgb.r, newrgb.g, oldrgb.b);\r\n         break;\r\n      case 4:\r\n         spcdata.value = sp.makeRGB(oldrgb.r, oldrgb.g, newrgb.b);\r\n         break;\r\n      case 0:\r\n      case 1:\r\n         spcdata.value = color;\r\n      }\r\n\r\n   sptc.DetermineColors(id);\r\n   sptc.SetColors(id);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.ControlClicked = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var cid = sp.Current.id;\r\n   if (!cid || id != cid) {\r\n      sp.CClick(id);\r\n      return;\r\n      }\r\n\r\n   sptc.CloseOK();\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.DefaultClicked = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.value = \"\";\r\n   SocialCalc.Popup.SetValue(id, spcdata.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomClicked = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   var oele, str, nele;\r\n\r\n   oele = spcdata.contentele;\r\n   str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(\"ColorChooser\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n   spcdata.customele = nele.firstChild.firstChild.childNodes[2];\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n\r\n   spcdata.customele.value = sp.RGBToHex(spcdata.value);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomToGrid = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\r\n\r\n   var oele, mainele, nele;\r\n\r\n   oele = spcdata.contentele;\r\n   mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(\"ColorChooser\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.style.padding = \"3px\";\r\n   nele.style.backgroundColor = \"#CCC\";\r\n   nele.appendChild(mainele);\r\n   spcdata.customele = null;\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n   \r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CloseOK = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n\r\n   }\r\n\r\n//\r\n// SocialCalcSpreadsheetControl\r\n//\r\n/*\r\n// The code module of the SocialCalc package that lets you embed a spreadsheet\r\n// control with toolbar, etc., into a web page.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript SpreadsheetControl.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) {\r\n      alert(\"Main SocialCalc code module needed\");\r\n      SocialCalc = {};\r\n      }\r\n   if (!SocialCalc.TableEditor) {\r\n      alert(\"SocialCalc TableEditor code module needed\");\r\n      }\r\n\r\n// *************************************\r\n//\r\n// SpreadsheetControl class:\r\n//\r\n// *************************************\r\n\r\n// Global constants:\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = null; // right now there can only be one active at a time\r\n\r\n\r\n// Constructor:\r\n\r\nSocialCalc.SpreadsheetControl = function(idPrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.parentNode = null;\r\n   this.spreadsheetDiv = null;\r\n   this.requestedHeight = 0;\r\n   this.requestedWidth = 0;\r\n   this.requestedSpaceBelow = 0;\r\n   this.height = 0;\r\n   this.width = 0;\r\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\r\n\r\n   // Tab definitions: An array where each tab is an object of the form:\r\n   //\r\n   //    name: \"name\",\r\n   //    text: \"text-on-tab\",\r\n   //    html: \"html-to-create div\",\r\n   //       replacements:\r\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext\r\n   //         Other replacements from spreadsheet.tabreplacements:\r\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\r\n   //    view: \"viewname\", // view to show when selected; \"sheet\" or missing/null is spreadsheet\r\n   //    oncreate: function(spreadsheet, tab-name), // called when first created to initialize\r\n   //    onclick: function(spreadsheet, tab-name), missing/null is sheet default\r\n   //    onclickFocus: text, // spreadsheet.idPrefix+text is given the focus if present instead of normal KeyboardFocus\r\n   //       or if text isn't a string, that value (e.g., true) is used for SocialCalc.CmdGotFocus\r\n   //    onunclick: function(spreadsheet, tab-name), missing/null is sheet default\r\n\r\n   this.tabs = [];\r\n   this.tabnums = {}; // when adding tabs, add tab-name: array-index to this object\r\n   this.tabreplacements = {}; // see use above\r\n   this.currentTab = -1; // currently selected tab index in this.tabs or -1 (maintained by SocialCalc.SetTab)\r\n\r\n   // View definitions: An object where each view is an object of the form:\r\n   //\r\n   //    name: \"name\", // localized when first set using SocialCalc.LocalizeString\r\n   //    element: node-in-the-dom, // filled in when initialized\r\n   //    replacements: {}, // see below\r\n   //    html: \"html-to-create div\",\r\n   //       replacements:\r\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext, \"%img.\": spreadsheet.imagePrefix,\r\n   //         SocialCalc.LocalizeSubstring replacements (\"%loc!string!\" and \"%ssc!constant-name!\")\r\n   //         Other replacements from viewobject.replacements:\r\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\r\n   //    divStyle: attributes for sheet div (SocialCalc.setStyles format)\r\n   //    oncreate: function(spreadsheet, viewobject), // called when first created to initialize\r\n   //    needsresize: true/false/null, // if true, do resize calc after displaying\r\n   //    onresize: function(spreadsheet, viewobject), // called if needs resize\r\n   //    values: {} // optional values to share with onclick handlers, etc.\r\n   //\r\n   // There is always a \"sheet\" view.\r\n\r\n   this.views = {}; // {viewname: view-object, ...}\r\n\r\n   // Dynamic properties:\r\n\r\n   this.sheet = null;\r\n   this.context = null;\r\n   this.editor = null;\r\n\r\n   this.spreadsheetDiv = null;\r\n   this.editorDiv = null;\r\n\r\n   this.sortrange = \"\"; // remembered range for sort tab\r\n\r\n   this.moverange = \"\"; // remembered range from movefrom used by movepaste/moveinsert\r\n\r\n   // Constants:\r\n\r\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\r\n   this.multipartBoundary = \"SocialCalcSpreadsheetControlSave\"; // boundary used by SpreadsheetControlCreateSpreadsheetSave\r\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\r\n\r\n   this.toolbarbackground = scc.SCToolbarbackground;\r\n   this.tabbackground = scc.SCTabbackground; // \"background-color:#CCC;\";\r\n   this.tabselectedCSS = scc.SCTabselectedCSS;\r\n   this.tabplainCSS = scc.SCTabplainCSS;\r\n   this.toolbartext = scc.SCToolbartext;\r\n\r\n   this.formulabarheight = scc.SCFormulabarheight; // in pixels, will contain a text input box\r\n\r\n   this.statuslineheight = scc.SCStatuslineheight; // in pixels\r\n   this.statuslineCSS = scc.SCStatuslineCSS;\r\n\r\n   // Callbacks:\r\n\r\n   this.ExportCallback = null; // a function called for Clipboard Export button: this.ExportCallback(spreadsheet_control_object)\r\n\r\n   // Initialization Code:\r\n\r\n   // eddy Initialization {\r\n   if(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];   \r\n   // }   \r\n   \r\n   this.sheet = new SocialCalc.Sheet();\r\n   this.context = new SocialCalc.RenderContext(this.sheet);\r\n   this.context.showGrid=true;\r\n   this.context.showRCHeaders=true;\r\n   this.editor = new SocialCalc.TableEditor(this.context);\r\n   this.editor.StatusCallback.statusline =\r\n      {func: SocialCalc.SpreadsheetControlStatuslineCallback,\r\n       params: {statuslineid: this.idPrefix+\"statusline\",\r\n                recalcid1: this.idPrefix+\"divider_recalc\",\r\n                recalcid2: this.idPrefix+\"button_recalc\"}};\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = this; // remember this for rendezvousing on events\r\n\r\n   this.editor.MoveECellCallback.movefrom = function(editor) {\r\n      var cr;\r\n      var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n      spreadsheet.context.cursorsuffix = \"\";\r\n      if (editor.range2.hasrange && !editor.cellhandles.noCursorSuffix) {\r\n         if (editor.ecell.row==editor.range2.top && (editor.ecell.col<editor.range2.left || editor.ecell.col>editor.range2.right+1)) {\r\n            spreadsheet.context.cursorsuffix = \"insertleft\";\r\n            }\r\n         if (editor.ecell.col==editor.range2.left && (editor.ecell.row<editor.range2.top || editor.ecell.row>editor.range2.bottom+1)) {\r\n            spreadsheet.context.cursorsuffix = \"insertup\";\r\n            }\r\n         }\r\n      };\r\n\r\n   // formula bar buttons\r\n\r\n   this.formulabuttons = {\r\n      formulafunctions: {image: \"insertformula.png\", tooltip: \"Functions\", // tooltips are localized when set below\r\n                         command: SocialCalc.SpreadsheetControl.DoFunctionList},\r\n      multilineinput: {image: \"listbox.png\", tooltip: \"Multi-line Input Box\",\r\n                         command: SocialCalc.SpreadsheetControl.DoMultiline},\r\n      link: {image: \"inserthyperlink.png\", tooltip: \"Link Input Box\",\r\n                         command: SocialCalc.SpreadsheetControl.DoLink},\r\n      sum: {image: \"autosum.png\", tooltip: \"Auto Sum\",\r\n                         command: SocialCalc.SpreadsheetControl.DoSum}\r\n      }\r\n   \r\n   // find buttons\r\n   this.findbuttons = {\r\n       last: {image: 'upsearch.png', tooltip: 'Find Previous',\r\n              command: SocialCalc.SpreadsheetControl.SearchUp},\r\n       next: {image: 'downsearch.png', tooltip: 'Find Next', \r\n              command: SocialCalc.SpreadsheetControl.SearchDown}\r\n   }\r\n\r\n   // Default tabs:\r\n\r\n   // Edit\r\n\r\n   this.tabnums.edit = this.tabs.length;\r\n   this.tabs.push({name: \"edit\", text: \"Edit\", html:\r\n     ' <div id=\"%id.edittools\" style=\"padding:10px 0px 0px 0px;\">'+\r\n'&nbsp;<img id=\"%id.button_undo\" src=\"%img.undo.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_redo\" src=\"%img.redo.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_copy\" src=\"%img.copy.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_cut\" src=\"%img.cut.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_paste\" src=\"%img.paste.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_delete\" src=\"%img.delete.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_pasteformats\" src=\"%img.formatpaintbrush.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n' <span id=\"%id.locktools\"><img id=\"%id.button_lock\" src=\"%img.lock.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_unlock\" src=\"%img.unlock.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp;</span> '+\r\n'<img id=\"%id.button_filldown\" src=\"%img.filldown.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_fillright\" src=\"%img.fillright.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_movefrom\" src=\"%img.movefromoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_movepaste\" src=\"%img.movepasteoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_moveinsert\" src=\"%img.moveinsertoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_alignleft\" src=\"%img.alignleft.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_aligncenter\" src=\"%img.aligncenter.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_alignright\" src=\"%img.alignright.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_borderon\" src=\"%img.borderson.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_borderoff\" src=\"%img.bordersoff.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_swapcolors\" src=\"%img.swapcolors.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_merge\" src=\"%img.mergecells.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_insertrow\" src=\"%img.insertrows.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_insertcol\" src=\"%img.insertcolumns.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_deleterow\" src=\"%img.deleterows.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_deletecol\" src=\"%img.deletecolumns.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_hiderow\" src=\"%img.hiderow.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_hidecol\" src=\"%img.hidecol.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img id=\"%id.divider_recalc\" src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_recalc\" src=\"%img.recalc.png\" style=\"vertical-align:bottom;\"> '+\r\n      ' </div>',\r\n      oncreate: null, //function(spreadsheet, viewobject) {SocialCalc.DoCmd(null, \"fill-rowcolstuff\");},\r\n      onclick: null});\r\n\r\n   // Settings (Format)\r\n\r\n   this.tabnums.settings = this.tabs.length;\r\n   this.tabs.push({name: \"settings\", text: \"Format\", html:\r\n      '<div id=\"%id.settingstools\" style=\"display:none;\">'+\r\n      ' <div id=\"%id.sheetsettingstoolbar\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '   <div style=\"%tbt.\">%loc!SHEET SETTINGS!:</div>'+\r\n      '   </td></tr><tr><td>'+\r\n      '   <input id=\"%id.settings-savesheet\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'sheet\\');\">'+\r\n      '   <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\r\n      '   <input type=\"button\" value=\"%loc!Show Cell Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'cell\\');return false;\">'+\r\n      '   </td></tr></table>'+\r\n      ' </div>'+\r\n      ' <div id=\"%id.cellsettingstoolbar\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '   <div style=\"%tbt.\">%loc!CELL SETTINGS!: <span id=\"%id.settingsecell\">&nbsp;</span></div>'+\r\n      '   </td></tr><tr><td>'+\r\n      '  <input id=\"%id.settings-savecell\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'cell\\');\">'+\r\n      '  <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\r\n      '  <input type=\"button\" value=\"%loc!Show Sheet Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'sheet\\');return false;\">'+\r\n      '  </td></tr></table>'+\r\n      ' </div>'+\r\n      '</div>',\r\n      view: \"settings\",\r\n      onclick: function(s, t) {\r\n         SocialCalc.SettingsControls.idPrefix = s.idPrefix; // used to get color chooser div\r\n         SocialCalc.SettingControlReset();\r\n         var sheetattribs = s.sheet.EncodeSheetAttributes();\r\n         var cellattribs = s.sheet.EncodeCellAttributes(s.editor.ecell.coord);\r\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.sheetspanel, sheetattribs);\r\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.cellspanel, cellattribs);\r\n         document.getElementById(s.idPrefix+\"settingsecell\").innerHTML = s.editor.ecell.coord;\r\n         SocialCalc.SpreadsheetControlSettingsSwitch(\"cell\");\r\n         s.views.settings.element.style.height = s.viewheight+\"px\";\r\n         s.views.settings.element.firstChild.style.height = s.viewheight+\"px\";\r\n\r\n         var range;  // set save message\r\n         if (s.editor.range.hasrange) {\r\n            range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\r\n               SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\r\n            }\r\n         else {\r\n            range = s.editor.ecell.coord;\r\n            }\r\n         document.getElementById(s.idPrefix+\"settings-savecell\").value = SocialCalc.LocalizeString(\"Save to\")+\": \"+range;\r\n         },\r\n      onclickFocus: true\r\n         });\r\n\r\n   this.views[\"settings\"] = {name: \"settings\", values: {},\r\n      oncreate: function(s, viewobj) {\r\n         var scc = SocialCalc.Constants;\r\n\r\n         viewobj.values.sheetspanel = {\r\n//            name: \"sheet\",\r\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\r\n            formatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"formatnumber\",\r\n               initialdata: scc.SCFormatNumberFormats},\r\n            formattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"formattext\",\r\n               initialdata: scc.SCFormatTextFormats},\r\n            fontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"fontfamily\",\r\n               initialdata: scc.SCFormatFontfamilies},\r\n            fontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"fontlook\",\r\n               initialdata: scc.SCFormatFontlook},\r\n            fontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"fontsize\",\r\n               initialdata: scc.SCFormatFontsizes},\r\n            textalignhoriz: {setting: \"textalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"textalignhoriz\",\r\n               initialdata: scc.SCFormatTextAlignhoriz},\r\n            numberalignhoriz: {setting: \"numberalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"numberalignhoriz\",\r\n               initialdata: scc.SCFormatNumberAlignhoriz},\r\n            alignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"alignvert\",\r\n               initialdata: scc.SCFormatAlignVertical},\r\n            textcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"textcolor\"},\r\n            bgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"bgcolor\"},\r\n            padtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"padtop\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"padright\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"padbottom\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"padleft\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            colwidth: {setting: \"colwidth\", type: \"PopupList\", id: s.idPrefix+\"colwidth\",\r\n               initialdata: scc.SCFormatColwidth},\r\n            recalc: {setting: \"recalc\", type: \"PopupList\", id: s.idPrefix+\"recalc\",\r\n               initialdata: scc.SCFormatRecalc},\r\n            usermaxcol: {setting: \"usermaxcol\", type: \"PopupList\", id: s.idPrefix+\"usermaxcol\",\r\n               initialdata: scc.SCFormatUserMaxCol},\r\n            usermaxrow: {setting: \"usermaxrow\", type: \"PopupList\", id: s.idPrefix+\"usermaxrow\",\r\n               initialdata: scc.SCFormatUserMaxRow}\r\n\r\n            };\r\n         viewobj.values.cellspanel = {\r\n            name: \"cell\",\r\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\r\n            cformatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"cformatnumber\",\r\n               initialdata: scc.SCFormatNumberFormats},\r\n            cformattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"cformattext\",\r\n               initialdata: scc.SCFormatTextFormats},\r\n            cfontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"cfontfamily\",\r\n               initialdata: scc.SCFormatFontfamilies},\r\n            cfontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"cfontlook\",\r\n               initialdata: scc.SCFormatFontlook},\r\n            cfontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"cfontsize\",\r\n               initialdata: scc.SCFormatFontsizes},\r\n            calignhoriz: {setting: \"alignhoriz\", type: \"PopupList\", id: s.idPrefix+\"calignhoriz\",\r\n               initialdata: scc.SCFormatTextAlignhoriz},\r\n            calignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"calignvert\",\r\n               initialdata: scc.SCFormatAlignVertical},\r\n            ctextcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"ctextcolor\"},\r\n            cbgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"cbgcolor\"},\r\n            cbt: {setting: \"bt\", type: \"BorderSide\", id: s.idPrefix+\"cbt\"},\r\n            cbr: {setting: \"br\", type: \"BorderSide\", id: s.idPrefix+\"cbr\"},\r\n            cbb: {setting: \"bb\", type: \"BorderSide\", id: s.idPrefix+\"cbb\"},\r\n            cbl: {setting: \"bl\", type: \"BorderSide\", id: s.idPrefix+\"cbl\"},\r\n            cpadtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"cpadtop\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"cpadright\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"cpadbottom\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"cpadleft\",\r\n               initialdata: scc.SCFormatPadsizes}\r\n            };\r\n\r\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.sheetspanel);\r\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.cellspanel);\r\n         },\r\n      replacements: {\r\n         itemtitle: {regex: /\\%itemtitle\\./g, replacement: 'style=\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\"'},\r\n         sectiontitle: {regex: /\\%sectiontitle\\./g, replacement: 'style=\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\"'},\r\n         parttitle: {regex: /\\%parttitle\\./g, replacement: 'style=\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\"'},\r\n         itembody: {regex: /\\%itembody\\./g, replacement: 'style=\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\"'},\r\n         bodypart: {regex: /\\%bodypart\\./g, replacement: 'style=\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\"'}\r\n         },\r\n      divStyle: \"border:1px solid black;overflow:auto;\",\r\n      html:\r\n '<div id=\"%id.scolorchooser\" style=\"display:none;position:absolute;z-index:20;\"></div>'+\r\n'<table cellspacing=\"0\" cellpadding=\"0\">'+\r\n' <tr><td style=\"vertical-align:top;\">'+\r\n'<table id=\"%id.sheetsettingstable\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\">'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Format!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number!</div>'+\r\n'     <span id=\"%id.formatnumber\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text!</div>'+\r\n'     <span id=\"%id.formattext\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Alignment!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text Horizontal!</div>'+\r\n'     <span id=\"%id.textalignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number Horizontal!</div>'+\r\n'     <span id=\"%id.numberalignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Vertical!</div>'+\r\n'     <span id=\"%id.alignvert\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Font!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Family!</div>'+\r\n'     <span id=\"%id.fontfamily\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\r\n'     <span id=\"%id.fontlook\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Size!</div>'+\r\n'     <span id=\"%id.fontsize\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Color!</div>'+\r\n'     <div id=\"%id.textcolor\"></div>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Background!</div>'+\r\n'     <div id=\"%id.bgcolor\"></div>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Padding!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Top!</div>'+\r\n'     <span id=\"%id.padtop\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Right!</div>'+\r\n'     <span id=\"%id.padright\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bottom!</div>'+\r\n'     <span id=\"%id.padbottom\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Left!</div>'+\r\n'     <span id=\"%id.padleft\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Column Width!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>&nbsp;</div>'+\r\n'     <span id=\"%id.colwidth\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Recalculation!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>&nbsp;</div>'+\r\n'     <span id=\"%id.recalc\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Dimensions!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Columns!</div>'+\r\n'     <span id=\"%id.usermaxcol\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Rows!</div>'+\r\n'     <span id=\"%id.usermaxrow\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'</table>'+\r\n'<table id=\"%id.cellsettingstable\" cellspacing=\"0\" cellpadding=\"0\">'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Format!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number!</div>'+\r\n'     <span id=\"%id.cformatnumber\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text!</div>'+\r\n'     <span id=\"%id.cformattext\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Alignment!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Horizontal!</div>'+\r\n'     <span id=\"%id.calignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Vertical!</div>'+\r\n'     <span id=\"%id.calignvert\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Font!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Family!</div>'+\r\n'     <span id=\"%id.cfontfamily\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\r\n'     <span id=\"%id.cfontlook\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Size!</div>'+\r\n'     <span id=\"%id.cfontsize\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Color!</div>'+\r\n'     <div id=\"%id.ctextcolor\"></div>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Background!</div>'+\r\n'     <div id=\"%id.cbgcolor\"></div>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Borders!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\">'+\r\n'    <tr><td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Top Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Right Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Bottom Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Left Border!</div></td>'+\r\n'    </tr><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbt-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbt-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbr-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbr-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbb-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbb-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbl-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbl-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Padding!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Top!</div>'+\r\n'     <span id=\"%id.cpadtop\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Right!</div>'+\r\n'     <span id=\"%id.cpadright\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bottom!</div>'+\r\n'     <span id=\"%id.cpadbottom\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Left!</div>'+\r\n'     <span id=\"%id.cpadleft\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'</table>'+\r\n' </td><td style=\"vertical-align:top;padding:12px 0px 0px 12px;\">'+\r\n'  <div style=\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\">'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td id=\"sample-text\" style=\"height:100px;width:100px;\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>'+\r\n'   </tr></table>'+\r\n'  </div>'+\r\n' </td></tr></table>'+\r\n'<br>'\r\n      };\r\n\r\n   // Sort\r\n\r\n   this.tabnums.sort = this.tabs.length;\r\n   this.tabs.push({name: \"sort\", text: \"Sort\", html:\r\n      ' <div id=\"%id.sorttools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:4px;width:160px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Set Cells To Sort!</div>'+\r\n      '    <select id=\"%id.sortlist\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[select range]</option><option value=\"all\">Sort All</option></select>'+\r\n      '    <input type=\"button\" value=\"%loc!OK!\" onclick=\"%s.DoCmd(this, \\'ok-setsort\\');\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\">'+\r\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '    <input type=\"button\" id=\"%id.sortbutton\" value=\"%loc!Sort Cells! A1:A1\" onclick=\"%s.DoCmd(this, \\'dosort\\');\" style=\"visibility:hidden;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Major Sort!</div>'+\r\n      '      <select id=\"%id.majorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Minor Sort!</div>'+\r\n      '      <select id=\"%id.minorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Last Sort!</div>'+\r\n      '      <select id=\"%id.lastsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      ' </div>',\r\n      onclick: SocialCalc.SpreadsheetControlSortOnclick});\r\n   this.editor.SettingsCallbacks.sort = {save: SocialCalc.SpreadsheetControlSortSave, load: SocialCalc.SpreadsheetControlSortLoad};\r\n\r\n   // Audit\r\n\r\n   this.tabnums.audit = this.tabs.length;\r\n   this.tabs.push({name: \"audit\", text: \"Audit\", html:\r\n      '<div id=\"%id.audittools\" style=\"display:none;\">'+\r\n      ' <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '</div>',\r\n      view: \"audit\",\r\n      onclick:\r\n         function(s, t) {\r\n            var SCLoc = SocialCalc.LocalizeString;\r\n            var i, j;\r\n            var str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"margin-bottom:10px;\"><tr><td style=\"font-size:small;padding:6px;\"><b>'+SCLoc(\"Audit Trail This Session\")+':</b><br><br>';\r\n            var stack = s.sheet.changes.stack;\r\n            var tos = s.sheet.changes.tos;\r\n            for (i=0; i<stack.length; i++) {\r\n               if (i==tos+1) str += '<br></td></tr><tr><td style=\"font-size:small;background-color:#EEE;padding:6px;\">'+SCLoc(\"UNDONE STEPS\")+':<br>';\r\n               for (j=0; j<stack[i].command.length; j++) {\r\n                  str += SocialCalc.special_chars(stack[i].command[j]) + \"<br>\";\r\n                  }\r\n               }\r\n\t\t\t// --------------------------------------------   \r\n \t\t    // eddy log {\r\n\r\n\t\t\t// --------------------------------------------   \r\n\t\t\tvar ObjToSource = function(o){\r\n\t\t\t\tif (typeof(o) == \"string\") return o;\r\n\t\t\t\tif (!o) return 'null';\r\n\t\t\t\tif (typeof(o) == \"object\") {\r\n\t\t\t\t\tif (!ObjToSource.check) ObjToSource.check = new Array();\r\n\t\t\t\t\tfor (var i=0, k=ObjToSource.check.length ; i<k ; ++i) {\r\n\t\t\t\t\t\tif (ObjToSource.check[i] == o) {return '{}';}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tObjToSource.check.push(o);\r\n\t\t\t\t}\r\n\t\t\t\tvar k=\"\",na=typeof(o.length)==\"undefined\"?1:0,str=\"\";\r\n\t\t\t\tfor(var p in o){\r\n\t\t\t\t\tif (na) k = \"'\"+p+ \"':\";\r\n\t\t\t\t\tif (typeof o[p] == \"string\") str += k + \"'\" + o[p]+\"',\";\r\n\t\t\t\t\telse if (typeof o[p] == \"object\") str += k + ObjToSource(o[p])+\",\";\r\n\t\t\t\t\telse str += k + o[p] + \",\";\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(o) == \"object\") ObjToSource.check.pop();\r\n\t\t\t\tif (na) return \"{\"+str.slice(0,-1)+\"}\";\r\n\t\t\t\telse return \"[\"+str.slice(0,-1)+\"]\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// --------------------------------------------   \r\n\t\t\t\r\n\t\t    if(typeof SocialCalc.debug_log != 'undefined') {\r\n\t\t\t\tfor(var index in SocialCalc.debug_log) { \r\n\t\t\t\t\tstr += ObjToSource(SocialCalc.debug_log[index]) + \"<br>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t    // }   \r\n\t\t\t// --------------------------------------------   \r\n\t\t\t   \r\n            s.views.audit.element.innerHTML = str+\"</td></tr></table>\";\r\n            SocialCalc.CmdGotFocus(true);\r\n            },\r\n      onclickFocus: true\r\n         });\r\n\r\n   this.views[\"audit\"] = {name: \"audit\",\r\n      divStyle: \"border:1px solid black;overflow:auto;\",\r\n      html: 'Audit Trail'\r\n      };\r\n\r\n   // Comment\r\n\r\n   this.tabnums.comment = this.tabs.length;\r\n   this.tabs.push({name: \"comment\", text: \"Comment\", html:\r\n      '<div id=\"%id.commenttools\" style=\"display:none;\">'+\r\n      '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '<textarea id=\"%id.commenttext\" style=\"font-size:small;height:32px;width:600px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'+\r\n      '</td><td style=\"vertical-align:top;\">'+\r\n      '&nbsp;<input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlCommentSet();\" style=\"font-size:x-small;\">'+\r\n      '</td></tr></table>'+\r\n      '</div>',\r\n      view: \"sheet\",\r\n      onclick: SocialCalc.SpreadsheetControlCommentOnclick,\r\n      onunclick: SocialCalc.SpreadsheetControlCommentOnunclick\r\n      });\r\n\r\n   // Names\r\n\r\n   this.tabnums.names = this.tabs.length;\r\n   this.tabs.push({name: \"names\", text: \"Names\", html:\r\n      '<div id=\"%id.namestools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Existing Names!</div>'+\r\n      '    <select id=\"%id.nameslist\" size=\"1\" onchange=\"%s.SpreadsheetControlNamesChangedName();\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[New]</option></select>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Name!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesname\" style=\"font-size:x-small;width:75px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Description!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesdesc\" style=\"font-size:x-small;width:150px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Value!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesvalue\" width=\"16\" style=\"font-size:x-small;width:100px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:12px;width:100px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Set Value To!</div>'+\r\n      '    <input type=\"button\" id=\"%id.namesrangeproposal\" value=\"A1\" onclick=\"%s.SpreadsheetControlNamesSetValue();\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '    <input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlNamesSave();\" style=\"font-size:x-small;\">'+\r\n      '    <input type=\"button\" value=\"%loc!Delete!\" onclick=\"%s.SpreadsheetControlNamesDelete()\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      '</div>',\r\n      view: \"sheet\",\r\n      onclick: SocialCalc.SpreadsheetControlNamesOnclick,\r\n      onunclick: SocialCalc.SpreadsheetControlNamesOnunclick\r\n      });\r\n\r\n   // Clipboard\r\n\r\n   this.tabnums.clipboard = this.tabs.length;\r\n   this.tabs.push({name: \"clipboard\", text: \"Clipboard\", html:\r\n      '<div id=\"%id.clipboardtools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\r\n      '    <div style=\"%tbt.\">'+\r\n      '     &nbsp;'+\r\n      '    </div>'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      '</div>',\r\n      view: \"clipboard\",\r\n      onclick: SocialCalc.SpreadsheetControlClipboardOnclick,\r\n      onclickFocus: \"clipboardtext\"\r\n      });\r\n\r\n   this.views[\"clipboard\"] = {name: \"clipboard\", divStyle: \"overflow:auto;\", html:\r\n      ' <div style=\"font-size:x-small;padding:5px 0px 10px 0px;\">'+\r\n      '  <b>%loc!Display Clipboard in!:</b>'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-tab\" name=\"%id.clipboardformat\" checked onclick=\"%s.SpreadsheetControlClipboardFormat(\\'tab\\');\"> %loc!Tab-delimited format! &nbsp;'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-csv\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'csv\\');\"> %loc!CSV format! &nbsp;'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-scsave\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'scsave\\');\"> %loc!SocialCalc-save format!'+\r\n      ' </div>'+\r\n      ' <input type=\"button\" value=\"%loc!Load SocialCalc Clipboard With This!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardLoad();\">&nbsp; '+\r\n      ' <input type=\"button\" value=\"%loc!Clear SocialCalc Clipboard!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardClear();\">&nbsp; '+\r\n      ' <br>'+\r\n      ' <textarea id=\"%id.clipboardtext\" style=\"font-size:small;height:350px;width:800px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'\r\n      };\r\n\r\n   return;\r\n\r\n   }\r\n\r\n   \r\n// Methods:\r\n\r\nSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl =\r\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetControl(this, node, height, width, spacebelow);};\r\nSocialCalc.SpreadsheetControl.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\r\nSocialCalc.SpreadsheetControl.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\r\nSocialCalc.SpreadsheetControl.prototype.ExecuteCommand = \r\n   function(combostr, sstr) {return SocialCalc.SpreadsheetControlExecuteCommand(this, combostr, sstr);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSheetHTML = \r\n   function() {return SocialCalc.SpreadsheetControlCreateSheetHTML(this);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave = \r\n   function(otherparts) {return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this, otherparts);};\r\nSocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave = \r\n   function(str) {return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this, str);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTML = \r\n   function(coord) {return SocialCalc.SpreadsheetControlCreateCellHTML(this, coord);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave = \r\n   function(range) {return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this, range);};\r\n\r\n\r\n// Sheet Methods to make things a little easier:\r\n\r\nSocialCalc.SpreadsheetControl.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSheetSave = function() {return this.sheet.CreateSheetSave();};\r\n\r\n\r\n// Functions:\r\n\r\n//\r\n// InitializeSpreadsheetControl(spreadsheet, node, height, width, spacebelow)\r\n//\r\n// Creates the control elements and makes them the child of node (string or element).\r\n// If present, height and width specify size.\r\n// If either is 0 or null (missing), the maximum that fits on the screen\r\n// (taking spacebelow into account) is used.\r\n//\r\n// Displays the tabs and creates the views (other than \"sheet\").\r\n// The first tab is set as selected, but onclick is not invoked.\r\n//\r\n// You should do a redisplay or recalc (which redisplays) after running this.\r\n//\r\n\r\nSocialCalc.InitializeSpreadsheetControl = function(spreadsheet, node, height, width, spacebelow) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var html, child, i, vname, v, style, button, bele;\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   spreadsheet.requestedHeight = height;\r\n   spreadsheet.requestedWidth = width;\r\n   spreadsheet.requestedSpaceBelow = spacebelow;\r\n\r\n   if (typeof node == \"string\") node = document.getElementById(node);\r\n\r\n   if (node == null) {\r\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\r\n      }\r\n\r\n   spreadsheet.parentNode = node;\r\n\r\n   // create node to hold spreadsheet control\r\n\r\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\r\n\r\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\r\n\r\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\r\n      node.removeChild(child);\r\n      }\r\n\r\n   // create the tabbed UI at the top\r\n\r\n   html = '<div>'\r\n   html += '<div style=\"'+spreadsheet.tabbackground+'\">'+\r\n      '<table cellpadding=\"0\" cellspacing=\"0\"><tr>';\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      html += '  <td id=\"%id.' + tabs[i].name + 'tab\" style=\"' +\r\n         (i==0 ? spreadsheet.tabselectedCSS : spreadsheet.tabplainCSS) +\r\n         '\" onclick=\"%s.SetTab(this);\">' + SCLoc(tabs[i].text) + '</td>';\r\n      }\r\n\r\n   html += ' </tr></table></div>'\r\n   html += '<div style=\"'+spreadsheet.toolbarbackground+'padding:12px 10px 10px 4px;\">';\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      html += tabs[i].html;\r\n      }\r\n\r\n   html += '</div>'\r\n   html += '</div>';\r\n\r\n   spreadsheet.currentTab = 0; // this is where we started\r\n\r\n   for (style in spreadsheet.tabreplacements) {\r\n      html = html.replace(spreadsheet.tabreplacements[style].regex, spreadsheet.tabreplacements[style].replacement);\r\n      }\r\n   html = html.replace(/\\%s\\./g, \"SocialCalc.\");\r\n   html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\r\n   html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\r\n   html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\r\n\r\n   html = SCLocSS(html); // localize with %loc!string! and %scc!constant!\r\n\r\n   spreadsheet.spreadsheetDiv.innerHTML = html;\r\n\r\n   node.appendChild(spreadsheet.spreadsheetDiv);\r\n\r\n   // Initialize SocialCalc buttons\r\n\r\nspreadsheet.Buttons = {\r\n   button_undo: {tooltip: \"Undo\", command: \"undo\"},\r\n   button_redo: {tooltip: \"Redo\", command: \"redo\"},\r\n   button_copy: {tooltip: \"Copy\", command: \"copy\"},\r\n   button_cut: {tooltip: \"Cut\", command: \"cut\"},\r\n   button_paste: {tooltip: \"Paste\", command: \"paste\"},\r\n   button_pasteformats: {tooltip: \"Paste Formats\", command: \"pasteformats\"},\r\n   button_lock: {tooltip: \"Lock Cell\", command: \"lock\"},\r\n   button_unlock: {tooltip: \"Unlock Cell\", command: \"unlock\"},\r\n   button_delete: {tooltip: \"Delete Cell Contents\", command: \"delete\"},\r\n   button_filldown: {tooltip: \"Fill Down\", command: \"filldown\"},\r\n   button_fillright: {tooltip: \"Fill Right\", command: \"fillright\"},\r\n   button_movefrom: {tooltip: \"Set/Clear Move From\", command: \"movefrom\"},\r\n   button_movepaste: {tooltip: \"Move Paste\", command: \"movepaste\"},\r\n   button_moveinsert: {tooltip: \"Move Insert\", command: \"moveinsert\"},\r\n   button_alignleft: {tooltip: \"Align Left\", command: \"align-left\"},\r\n   button_aligncenter: {tooltip: \"Align Center\", command: \"align-center\"},\r\n   button_alignright: {tooltip: \"Align Right\", command: \"align-right\"},\r\n   button_borderon: {tooltip: \"Borders On\", command: \"borderon\"},\r\n   button_borderoff: {tooltip: \"Borders Off\", command: \"borderoff\"},\r\n   button_swapcolors: {tooltip: \"Swap Colors\", command: \"swapcolors\"},\r\n   button_merge: {tooltip: \"Merge/Unmerge Cells\", command: \"merge\"},\r\n   button_insertrow: {tooltip: \"Insert Row Before\", command: \"insertrow\"},\r\n   button_insertcol: {tooltip: \"Insert Column Before\", command: \"insertcol\"},\r\n   button_deleterow: {tooltip: \"Delete Row\", command: \"deleterow\"},\r\n   button_deletecol: {tooltip: \"Delete Column\", command: \"deletecol\"},\r\n   button_hiderow: {tooltip: \"Hide Row\", command: \"hiderow\"},\r\n   button_hidecol: {tooltip: \"Hide Column\", command: \"hidecol\"},\r\n   button_recalc: {tooltip: \"Recalculate\", command: \"recalc\"}\r\n   }\r\n\r\n   for (button in spreadsheet.Buttons) {\r\n      bele = document.getElementById(spreadsheet.idPrefix+button);\r\n      if (!bele) {alert(\"Button \"+(spreadsheet.idPrefix+button)+\" missing\"); continue;}\r\n      bele.style.border = \"1px solid \"+scc.ISCButtonBorderNormal;\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.Buttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid \"+scc.ISCButtonBorderNormal+\";background-color:\"+scc.ISCButtonNormalBackground+\";\",\r\n          hoverstyle: \"border:1px solid \"+scc.ISCButtonBorderHover+\";background-color:\"+scc.ISCButtonHoverBackground+\";\",\r\n          downstyle: \"border:1px solid \"+scc.ISCButtonBorderDown+\";background-color:\"+scc.ISCButtonDownBackground+\";\"}, \r\n         {MouseDown: SocialCalc.DoButtonCmd, command: spreadsheet.Buttons[button].command});\r\n      }\r\n\r\n   // create formula bar\r\n\r\n   spreadsheet.formulabarDiv = document.createElement(\"div\");\r\n   //spreadsheet.formulabarDiv.style.height = spreadsheet.formulabarheight + \"px\"; // Allow line wrapping\r\n   spreadsheet.formulabarDiv.innerHTML = '<input type=\"text\" size=\"60\" value=\"\">&nbsp;'; //'<textarea rows=\"4\" cols=\"60\" style=\"z-index:5;background-color:white;position:relative;\"></textarea>&nbsp;';\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\r\n   var inputbox = new SocialCalc.InputBox(spreadsheet.formulabarDiv.firstChild, spreadsheet.editor);\r\n   \r\n   for (button in spreadsheet.formulabuttons) {\r\n      bele = document.createElement(\"img\");\r\n      bele.id = spreadsheet.idPrefix+button;\r\n      bele.src = (spreadsheet.formulabuttons[button].skipImagePrefix ? \"\" : spreadsheet.imagePrefix)+spreadsheet.formulabuttons[button].image;\r\n      bele.style.verticalAlign = \"middle\";\r\n      bele.style.border = \"1px solid #FFF\";\r\n      bele.style.marginLeft = \"4px\";\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.formulabuttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\r\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\r\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \r\n         {MouseDown: spreadsheet.formulabuttons[button].command, Disabled: function() {return spreadsheet.editor.ECellReadonly();}});\r\n   spreadsheet.formulabarDiv.appendChild(bele);\r\n   }\r\n\r\n   var input = $(\"<input id='searchbarinput' value='' placeholder='Search sheet'>\");\r\n   var searchBar = $(\"<span id='searchbar'></span>\");\r\n   searchBar.append(\"<div id='searchstatus'></div>\");\r\n   searchBar.append(input);\r\n\r\n   // find buttons (right of formula bar)\r\n   for (button in spreadsheet.findbuttons) {\r\n      bele = document.createElement(\"img\");\r\n      bele.id = spreadsheet.idPrefix+button;\r\n      bele.src = (spreadsheet.imagePrefix)+spreadsheet.findbuttons[button].image;\r\n      bele.style.verticalAlign = \"middle\";\r\n      bele.style.border = \"1px solid #FFF\";\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.findbuttons[button].tooltip), {}, spreadsheet.formulabardiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\r\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\r\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \r\n         {MouseDown: spreadsheet.findbuttons[button].command, Disabled: function() {return false;}});\r\n      searchBar[0].appendChild(bele);\r\n   } \r\n   input.on('input', SocialCalc.SpreadsheetControl.FindInSheet);\r\n   input.on('focus', function() {\r\n        SocialCalc.Keyboard.passThru = true;\r\n   });\r\n   input.on('blur', function() {\r\n        SocialCalc.Keyboard.passThru = false;\r\n   });\r\n   input.keyup(function (e) {\r\n        if (e.keyCode == 13) {\r\n           // search down when enter is pressed\r\n           if (e.shiftKey) {\r\n               SocialCalc.SpreadsheetControl.SearchUp();\r\n           } else {\r\n               SocialCalc.SpreadsheetControl.SearchDown();\r\n           }\r\n        }\r\n   });\r\n   spreadsheet.formulabarDiv.appendChild(searchBar[0]);\r\n   \r\n   // initialize tabs that need it\r\n\r\n   for (i=0; i<tabs.length; i++) { // execute any tab-specific initialization code\r\n      if (tabs[i].oncreate) {\r\n         tabs[i].oncreate(spreadsheet, tabs[i].name);\r\n         }\r\n      }\r\n\r\n   // create sheet view and others\r\n\r\n   // InitializeSpreadsheetControl eddy {\r\n   SocialCalc.CalculateSheetNonViewHeight(spreadsheet);\r\n   // } InitializeSpreadsheetControl\r\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\r\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\r\n\r\n// eddy test add input \r\n   var appViewDiv = document.createElement(\"div\");\r\n   appViewDiv.id = \"te_appView\";\r\n   \r\n   appViewDiv.appendChild(spreadsheet.editorDiv)\r\n   spreadsheet.editorDiv = appViewDiv;\r\n\r\n   var formDataDiv = document.createElement(\"div\");\r\n   formDataDiv.id = \"te_formData\";\r\n   //formDataDiv.style.visibility = \"hidden\";\r\n   formDataDiv.style.display = \"none\";\r\n   //formDataDiv.style.display = \"inline\";\r\n   \r\n  // spreadsheet.spreadsheetDiv.appendChild(formDataDiv);   \r\n   spreadsheet.editorDiv.appendChild(formDataDiv);\r\n       \r\n// }\r\n      \r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\r\n\r\n// form data sheet - all input formulas set values in this sheet as well as the loaded sheet\r\n   spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\"); // should end with -\r\n   spreadsheet.formDataViewer.InitializeSpreadsheetViewer(formDataDiv.id, 180, 0, 200);\r\n   spreadsheet.formDataViewer.editor.ignoreRender = true; // formDataViewer is used for ExecuteSheetCommand only - no need to render\r\n// end\r\n   \r\n   for (vname in views) {\r\n      html = views[vname].html;\r\n      for (style in views[vname].replacements) {\r\n         html = html.replace(views[vname].replacements[style].regex, views[vname].replacements[style].replacement);\r\n         }\r\n      html = html.replace(/\\%s\\./g, \"SocialCalc.\");\r\n      html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\r\n      html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\r\n      html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\r\n      v = document.createElement(\"div\");\r\n      SocialCalc.setStyles(v, views[vname].divStyle);\r\n      v.style.display = \"none\";\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = spreadsheet.viewheight + \"px\";\r\n      v.id = spreadsheet.idPrefix + views[vname].name + \"view\";\r\n\r\n      html = SCLocSS(html); // localize with %loc!string!, etc.\r\n\r\n      v.innerHTML = html;\r\n      spreadsheet.spreadsheetDiv.appendChild(v);\r\n      views[vname].element = v;\r\n      if (views[vname].oncreate) {\r\n         views[vname].oncreate(spreadsheet, views[vname]);\r\n         }\r\n      }\r\n\r\n   views.sheet = {name: \"sheet\", element: spreadsheet.editorDiv};\r\n\r\n   // create statusline\r\n\r\n   spreadsheet.statuslineDiv = document.createElement(\"div\");\r\n   spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\r\n   spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\r\n      (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\r\n      (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\r\n   spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\r\n\r\n   // set current control object based on mouseover\r\n\r\n   if (spreadsheet.spreadsheetDiv.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      spreadsheet.spreadsheetDiv.addEventListener(\"mousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\r\n      spreadsheet.spreadsheetDiv.addEventListener(\"mouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\r\n      }\r\n   else if (spreadsheet.spreadsheetDiv.attachEvent) { // IE 5+\r\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\r\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   // done - refresh screen needed\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// eddy CalculateSheetNonViewHeight {\r\nSocialCalc.CalculateSheetNonViewHeight = function(spreadsheet) {\r\n  spreadsheet.nonviewheight = spreadsheet.statuslineheight;\r\n  for(var nodeIndex = 0;  nodeIndex < spreadsheet.spreadsheetDiv.childNodes.length;  nodeIndex++ ) {\r\n    if(spreadsheet.spreadsheetDiv.childNodes[nodeIndex].id == \"SocialCalc-statusline\") continue;\r\n    spreadsheet.nonviewheight += spreadsheet.spreadsheetDiv.childNodes[nodeIndex].offsetHeight;\r\n  }\r\n  \r\n}\r\n\r\n// }\r\n\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeString(str)\r\n//\r\n// SocialCalc function to make localization easier.\r\n// If str is \"Text to localize\", it returns\r\n// SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n//\r\n\r\nSocialCalc.LocalizeString = function(str) {\r\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\r\n   if (!cstr) { // no - look up\r\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\r\n      SocialCalc.LocalizeStringList[str] = cstr;\r\n      }\r\n   return cstr;\r\n   }\r\n\r\n\r\n\r\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeSubstrings(str)\r\n//\r\n// SocialCalc function to make localization easier using %loc and %scc.\r\n//\r\n// Replaces sections of str with:\r\n//    %loc!Text to localize!\r\n// with SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n// Uses SocialCalc.LocalizeString for this.\r\n//\r\n// Replaces sections of str with:\r\n//    %ssc!constant-name!\r\n// with SocialCalc.Constants.constant-name.\r\n// If the constant doesn't exist, throws and alert.\r\n//\r\n\r\nSocialCalc.LocalizeSubstrings = function(str) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\r\n      if (t==\"ssc\") {\r\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\r\n         }\r\n      else {\r\n         return SCLoc(c);\r\n         }\r\n      });\r\n\r\n   }\r\n\r\n//\r\n// obj = GetSpreadsheetControlObject()\r\n//\r\n// Returns the current spreadsheet control object\r\n//\r\n\r\nSocialCalc.GetSpreadsheetControlObject = function() {\r\n\r\n  // if in viewer mode return CurrentSpreadsheetViewerObject because CurrentSpreadsheetControlObject is null (bug fix) \r\n   var csco = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n   ? SocialCalc.CurrentSpreadsheetControlObject : SocialCalc.CurrentSpreadsheetViewerObject;\r\n   if (csco) return csco;\r\n\r\n//   throw (\"No current SpreadsheetControl object.\");\r\n\r\n   }\r\n\r\n//\r\n// SetSpreadsheetControlObject(spreadsheet)\r\n//\r\n\r\nSocialCalc.SetSpreadsheetControlObject = function(spreadsheet) {\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = spreadsheet;\r\n\r\n   if (SocialCalc.Keyboard.focusTable && spreadsheet) {\r\n      SocialCalc.Keyboard.focusTable = spreadsheet.editor;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoOnResize(spreadsheet)\r\n//\r\n// Processes an onResize event, setting the different views.\r\n//\r\n\r\nSocialCalc.DoOnResize = function(spreadsheet) {\r\n\r\n   var v;\r\n   var views = spreadsheet.views;\r\n\r\n   var needresize = spreadsheet.SizeSSDiv();\r\n   if (!needresize) return;\r\n\r\n   for (vname in views) {\r\n      v = views[vname].element;\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\r\n      }\r\n\r\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\r\n\r\n   }\r\n\r\n\r\n//\r\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\r\n//\r\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\r\n// Sets ssdiv to that.\r\n// Return true if different than existing values.\r\n//\r\n\r\nSocialCalc.SizeSSDiv = function(spreadsheet) {\r\n\r\n   var sizes, pos, resized, nodestyle, newval;\r\n   var fudgefactorX = 10; // for IE\r\n   var fudgefactorY = 10;\r\n\r\n   resized = false;\r\n\r\n   sizes = SocialCalc.GetViewportInfo();\r\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\r\n   pos.bottom = 0;\r\n   pos.right = 0;\r\n\r\n   nodestyle = spreadsheet.parentNode.style;\r\n\r\n   if (nodestyle.marginTop) {\r\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginBottom) {\r\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginLeft) {\r\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginRight) {\r\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\r\n      }\r\n\r\n   newval = spreadsheet.requestedHeight ||\r\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\r\n               (spreadsheet.requestedSpaceBelow || 0);\r\n   if (spreadsheet.height != newval) {\r\n      spreadsheet.height = newval;\r\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\r\n      resized = true;\r\n      }\r\n   newval = spreadsheet.requestedWidth ||\r\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\r\n   if (spreadsheet.width != newval) {\r\n      spreadsheet.width = newval;\r\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\r\n      resized = true;\r\n      }\r\n\r\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\r\n\r\n   return resized;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SetTab(obj)\r\n//\r\n// The obj argument is either a string with the tab name or a DOM element with an ID\r\n//\r\n\r\nSocialCalc.SetTab = function(obj) {\r\n\r\n   var newtab, tname, newtabnum, newview, i, vname, ele;\r\n   var menutabs = {};\r\n   var tools = {};\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   if (typeof obj == \"string\") {\r\n      newtab = obj;\r\n      }\r\n   else {\r\n      newtab = obj.id.slice(spreadsheet.idPrefix.length,-3);\r\n      }\r\n\r\n   if (spreadsheet.editor.busy && // if busy and switching from \"sheet\", ignore\r\n         (!tabs[spreadsheet.currentTab].view || tabs[spreadsheet.currentTab].view==\"sheet\")) {\r\n      for (i=0; i<tabs.length; i++) {\r\n         if(tabs[i].name==newtab && (tabs[i].view && tabs[i].view!=\"sheet\")) {\r\n            return;\r\n            }\r\n         }\r\n      }\r\n\r\n   if (spreadsheet.tabs[spreadsheet.currentTab].onunclick) {\r\n      spreadsheet.tabs[spreadsheet.currentTab].onunclick(spreadsheet, spreadsheet.tabs[spreadsheet.currentTab].name);\r\n      }\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      tname = tabs[i].name;\r\n      menutabs[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tab\");\r\n      tools[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tools\");\r\n      if (tname==newtab) {\r\n         newtabnum = i;\r\n         tools[tname].style.display = \"block\";\r\n         menutabs[tname].style.cssText = spreadsheet.tabselectedCSS;\r\n         }\r\n      else {\r\n         tools[tname].style.display = \"none\";\r\n         menutabs[tname].style.cssText = spreadsheet.tabplainCSS;\r\n         }\r\n      }\r\n\r\n   spreadsheet.currentTab = newtabnum;\r\n\r\n   if (tabs[newtabnum].onclick) {\r\n      tabs[newtabnum].onclick(spreadsheet, newtab);\r\n      }\r\n\r\n   for (vname in views) {\r\n      if ((!tabs[newtabnum].view && vname == \"sheet\") || tabs[newtabnum].view == vname) {\r\n         views[vname].element.style.display = \"block\";\r\n         newview = vname;\r\n         }\r\n      else {\r\n         views[vname].element.style.display = \"none\";\r\n         }\r\n      }\r\n\r\n   if (tabs[newtabnum].onclickFocus) {\r\n      ele = tabs[newtabnum].onclickFocus;\r\n      if (typeof ele == \"string\") {\r\n         ele = document.getElementById(spreadsheet.idPrefix+ele);\r\n         ele.focus();\r\n         }\r\n      SocialCalc.CmdGotFocus(ele);\r\n      }\r\n   else {\r\n      SocialCalc.KeyboardFocus();\r\n      }\r\n\r\n   if (views[newview].needsresize && views[newview].onresize) {\r\n      views[newview].needsresize = false;\r\n      views[newview].onresize(spreadsheet, views[newview]);\r\n      }\r\n\r\n   if (newview == \"sheet\") {\r\n      spreadsheet.statuslineDiv.style.display = \"block\";\r\n      spreadsheet.editor.ScheduleRender();\r\n      }\r\n   else {\r\n      spreadsheet.statuslineDiv.style.display = \"none\";\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SpreadsheetControlStatuslineCallback\r\n//\r\n\r\nSocialCalc.SpreadsheetControlStatuslineCallback = function(editor, status, arg, params) {\r\n\r\n   var rele1, rele2;\r\n\r\n   var ele = document.getElementById(params.statuslineid);\r\n\r\n   if (ele) {\r\n      ele.innerHTML = editor.GetStatuslineString(status, arg, params);\r\n      }\r\n\r\n   switch (status) {\r\n      case \"cmdendnorender\":\r\n      case \"calcfinished\":\r\n      case \"doneposcalc\":\r\n         rele1 = document.getElementById(params.recalcid1);\r\n         rele2 = document.getElementById(params.recalcid2);\r\n         if (!rele1 || !rele2) break;\r\n         if (editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\r\n            rele1.style.display = \"inline\";\r\n            rele2.style.display = \"inline\";\r\n            }\r\n         else {\r\n            rele1.style.display = \"none\";\r\n            rele2.style.display = \"none\";\r\n            }\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.UpdateSortRangeProposal(editor)\r\n//\r\n// Updates sort range proposed in the UI in element idPrefix+sortlist\r\n//\r\n\r\nSocialCalc.UpdateSortRangeProposal = function(editor) {\r\n\r\n   var ele = document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\"sortlist\");\r\n   if (editor.range.hasrange) {\r\n      ele.options[0].text = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   else {\r\n      ele.options[0].text = SocialCalc.LocalizeString(\"[select range]\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.LoadColumnChoosers(spreadsheet)\r\n//\r\n// Updates list of columns for choosing which to sort for Major, Minor, and Last sort\r\n//\r\n\r\nSocialCalc.LoadColumnChoosers = function(spreadsheet) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   var sortrange, nrange, rparts, col, colname, sele, oldindex;\r\n\r\n   if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\r\n      nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\r\n      if (nrange.type == \"range\") {\r\n         rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\r\n         sortrange = rparts[1] + \":\" + rparts[2];\r\n         }\r\n      else {\r\n         sortrange = \"A1:A1\";\r\n         }\r\n      }\r\n   else {\r\n      sortrange = spreadsheet.sortrange;\r\n      }\r\n   var range = SocialCalc.ParseRange(sortrange);\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(SCLoc(\"Column \")+colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 1 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 1; // restore what was there if reasonable\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CmdGotFocus(obj)\r\n//\r\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\r\n//\r\n\r\nSocialCalc.CmdGotFocus = function(obj) {\r\n\r\n   SocialCalc.Keyboard.passThru = obj;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoButtonCmd(e, buttoninfo, bobj)\r\n//\r\n\r\nSocialCalc.DoButtonCmd = function(e, buttoninfo, bobj) {\r\n\r\n   SocialCalc.DoCmd(bobj.element, bobj.functionobj.command);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.DoCmd(obj, which)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.DoCmd = function(obj, which) {\r\n\r\n   var combostr, sstr, cl, i, clele, slist, slistele, str, sele, rele, lele, ele, sortrange, nrange, rparts;\r\n   var sheet, cell, color, bgcolor, defaultcolor, defaultbgcolor;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   switch (which) {\r\n      case \"undo\":\r\n         spreadsheet.ExecuteCommand(\"undo\", \"\");\r\n         break;\r\n\r\n      case \"redo\":\r\n         spreadsheet.ExecuteCommand(\"redo\", \"\");\r\n         break;\r\n\r\n      case \"fill-rowcolstuff\":\r\n      case \"fill-text\":\r\n         cl = which.substring(5);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         clele.length = 0;\r\n         for (i=0; i<SocialCalc.SpreadsheetCmdTable[cl].length; i++) {\r\n            clele.options[i] = new Option(SocialCalc.SpreadsheetCmdTable[cl][i].t);\r\n            }\r\n         which = \"changed-\"+cl; // fall through to changed code\r\n\r\n      case \"changed-rowcolstuff\":\r\n      case \"changed-text\":\r\n         cl = which.substring(8);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         slist = SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].s]; // get sList for this command\r\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\r\n         slistele.length = 0; // reset\r\n         for (i=0; i<(slist.length||0); i++) {\r\n            slistele.options[i] = new Option(slist[i].t, slist[i].s);\r\n            }\r\n         return; // nothing else to do\r\n\r\n      case \"ok-rowcolstuff\":\r\n      case \"ok-text\":\r\n         cl = which.substring(3);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\r\n         combostr = SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].c;\r\n         sstr = slistele[slistele.selectedIndex].value;\r\n         SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr);\r\n         break;\r\n\r\n      case \"ok-setsort\":\r\n         lele = document.getElementById(spreadsheet.idPrefix+\"sortlist\");\r\n         if (lele.selectedIndex==0) {\r\n            if (editor.range.hasrange) {\r\n               spreadsheet.sortrange = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                          SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n               }\r\n            else {\r\n               spreadsheet.sortrange = editor.ecell.coord+\":\"+editor.ecell.coord;\r\n               }\r\n            }\r\n         else {\r\n            var val = lele.options[lele.selectedIndex].value;\r\n            if (val == 'all') {\r\n                var cells = spreadsheet.sheet.cells; \r\n                var min_col = -1, max_col = -1, min_row = -1, max_row = -1;\r\n                for (var cell_id in cells) {\r\n                    var cr = SocialCalc.coordToCr(cell_id);\r\n                    if (min_row == -1 || cr.row < min_row) {\r\n                        min_row = cr.row;\r\n                    }\r\n                    if (min_col == -1 || cr.col < min_col) {\r\n                        min_col = cr.col;\r\n                    }\r\n                    if (max_row == -1 || cr.row > max_row) {\r\n                        max_row = cr.row;\r\n                    }\r\n                    if (max_col == -1 || cr.col > max_col) {\r\n                        max_col = cr.col;\r\n                    }\r\n                } \r\n                spreadsheet.sortrange = SocialCalc.crToCoord(min_col, min_row) + \":\" + SocialCalc.crToCoord(max_col, max_row); \r\n                lele.options[lele.selectedIndex].text += \" (\" + spreadsheet.sortrange + \")\";\r\n            } else { \r\n                spreadsheet.sortrange = lele.options[lele.selectedIndex].value;\r\n            }\r\n         }\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\r\n         ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\r\n         ele.style.visibility = \"visible\";\r\n         SocialCalc.LoadColumnChoosers(spreadsheet);\r\n         if (obj && obj.blur) obj.blur();\r\n         SocialCalc.KeyboardFocus();   \r\n         return;\r\n\r\n      case \"dosort\":\r\n         if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\r\n            nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\r\n            if (nrange.type != \"range\") return;\r\n            rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\r\n            sortrange = rparts[1] + \":\" + rparts[2];\r\n            }\r\n         else {\r\n            sortrange = spreadsheet.sortrange;\r\n            }\r\n         if (sortrange == \"A1:A1\") return;\r\n         str = \"sort \"+sortrange+\" \";\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n         rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\r\n         str += sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n         if (sele.selectedIndex>0) {\r\n           rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\r\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n           }\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n         if (sele.selectedIndex>0) {\r\n           rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\r\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n           }\r\n         spreadsheet.ExecuteCommand(str, \"\");\r\n         break;\r\n\r\n      case \"merge\":\r\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\r\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\r\n         spreadsheet.ExecuteCommand(combostr, sstr);\r\n         if (editor.range.hasrange) { // set ecell to upper left\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\r\n            editor.RangeRemove();\r\n            }\r\n         break;\r\n\r\n      case \"movefrom\":\r\n         if (editor.range2.hasrange) { // toggle if already there\r\n            spreadsheet.context.cursorsuffix = \"\";\r\n            editor.Range2Remove();\r\n            spreadsheet.ExecuteCommand(\"redisplay\", \"\");\r\n            }\r\n         else if (editor.range.hasrange) { // set range2 to range or one cell\r\n            editor.range2.top = editor.range.top;\r\n            editor.range2.right = editor.range.right;\r\n            editor.range2.bottom = editor.range.bottom;\r\n            editor.range2.left = editor.range.left;\r\n            editor.range2.hasrange = true;\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\r\n            }\r\n         else {\r\n            editor.range2.top = editor.ecell.row;\r\n            editor.range2.right = editor.ecell.col;\r\n            editor.range2.bottom = editor.ecell.row;\r\n            editor.range2.left = editor.ecell.col;\r\n            editor.range2.hasrange = true;\r\n            }\r\n         str = editor.range2.hasrange ? \"\" : \"off\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\r\n         ele.src=spreadsheet.imagePrefix+\"movefrom\"+str+\".gif\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\r\n         ele.src=spreadsheet.imagePrefix+\"movepaste\"+str+\".gif\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\r\n         ele.src=spreadsheet.imagePrefix+\"moveinsert\"+str+\".gif\";\r\n         if (editor.range2.hasrange) editor.RangeRemove();\r\n         break;\r\n\r\n      case \"movepaste\":\r\n      case \"moveinsert\":\r\n         if (editor.range2.hasrange) {\r\n            spreadsheet.context.cursorsuffix = \"\";\r\n            combostr = which+\" \"+\r\n               SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n               SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n               +\" \"+editor.ecell.coord;\r\n            spreadsheet.ExecuteCommand(combostr, \"\");\r\n            editor.Range2Remove();\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\r\n            ele.src=spreadsheet.imagePrefix+\"movefromoff.gif\";\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\r\n            ele.src=spreadsheet.imagePrefix+\"movepasteoff.gif\";\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\r\n            ele.src=spreadsheet.imagePrefix+\"moveinsertoff.gif\";\r\n            }\r\n         break;\r\n\r\n      case \"swapcolors\":\r\n         sheet = spreadsheet.sheet;\r\n         cell = sheet.GetAssuredCell(editor.ecell.coord);\r\n         defaultcolor = sheet.attribs.defaultcolor ? sheet.colors[sheet.attribs.defaultcolor] : \"rgb(0,0,0)\";\r\n         defaultbgcolor = sheet.attribs.defaultbgcolor ? sheet.colors[sheet.attribs.defaultbgcolor] : \"rgb(255,255,255)\";\r\n         color = cell.color ? sheet.colors[cell.color] : defaultcolor; // get color\r\n         if (color == defaultbgcolor) color = \"\"; // going to swap, so if same as background default, use default\r\n         bgcolor = cell.bgcolor ? sheet.colors[cell.bgcolor] : defaultbgcolor;\r\n         if (bgcolor == defaultcolor) bgcolor = \"\"; // going to swap, so if same as foreground default, use default\r\n         spreadsheet.ExecuteCommand(\"set %C color \"+bgcolor+\"%Nset %C bgcolor \"+color, \"\");\r\n         break;\r\n\r\n      default:\r\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\r\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\r\n         spreadsheet.ExecuteCommand(combostr, sstr);\r\n         break;\r\n      }\r\n\r\n   if (obj && obj.blur) obj.blur();\r\n   SocialCalc.KeyboardFocus();   \r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetCmdLookup = {\r\n 'copy': 'copy %C all',\r\n 'cut': 'cut %C all',\r\n 'paste': 'paste %C all',\r\n 'pasteformats': 'paste %C formats',\r\n 'lock': 'set %C readonly yes',\r\n 'unlock': 'set %C readonly no',\r\n 'delete': 'erase %C formulas',\r\n 'filldown': 'filldown %C all',\r\n 'fillright': 'fillright %C all',\r\n 'erase': 'erase %C all',\r\n 'borderon': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\r\n 'borderoff': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\r\n 'merge': 'merge %C',\r\n 'unmerge': 'unmerge %C',\r\n 'align-left': 'set %C cellformat left',\r\n 'align-center': 'set %C cellformat center',\r\n 'align-right': 'set %C cellformat right',\r\n 'align-default': 'set %C cellformat',\r\n 'insertrow': 'insertrow %C',\r\n 'insertcol': 'insertcol %C',\r\n 'deleterow': 'deleterow %C',\r\n 'deletecol': 'deletecol %C',\r\n 'hiderow': 'set %H hide yes',\r\n 'hidecol': 'set %W hide yes',\r\n 'undo': 'undo',\r\n 'redo': 'redo',\r\n 'recalc': 'recalc'\r\n }\r\n\r\nSocialCalc.SpreadsheetCmdSLookup = {\r\n 'borderon': '1px solid rgb(0,0,0)',\r\n 'borderoff': ''\r\n }\r\n\r\n/******* NO LONGER USED\r\n\r\nSocialCalc.SpreadsheetCmdTable = {\r\n cmd: [\r\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\r\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"},\r\n  {t:\"Copy\", s:\"all\", c:\"copy %C %S\"},\r\n  {t:\"Cut\", s:\"all\", c:\"cut %C %S\"},\r\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\r\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\r\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\r\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\r\n  {t:\"Merge Cells\", s:\"none\", c:\"merge %C\"},\r\n  {t:\"Unmerge\", s:\"none\", c:\"unmerge %C\"},\r\n  {t:\"Sort\", s:\"sortcol\", c:\"sort %R %S\"},\r\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\r\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\r\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\r\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\r\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\r\n  {t:\"Cell Borders\", s:\"borderOnOff\", c:\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\"},\r\n  {t:\"Column Width\", s:\"colWidths\", c:\"set %W width %S\"},\r\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\r\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\r\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\r\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\r\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\r\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"},\r\n  {t:\"Default Column Width\", s:\"colWidths\", c:\"set sheet defaultcolwidth %S\"}\r\n  ],\r\n rowcolstuff: [\r\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\r\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\r\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\r\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\r\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\r\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"}\r\n  ],\r\n text: [\r\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\r\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\r\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\r\n  {t:\"Cell Text Format\", s:\"tvf\", c:\"set %C textvalueformat %S\"},\r\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\r\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\r\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\r\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\r\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\r\n  {t:\"Default Text Format\", s:\"tvf\", c:\"set sheet defaulttextvalueformat %S\"},\r\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\r\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\r\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"}\r\n  ],\r\n slists: {\r\n  \"colors\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Black\", s:\"rgb(0,0,0)\"},\r\n   {t:\"Dark Gray\", s:\"rgb(102,102,102)\"}, // #666\r\n   {t:\"Gray\", s:\"rgb(204,204,204)\"}, // #CCC\r\n   {t:\"White\", s:\"rgb(255,255,255)\"},\r\n   {t:\"Red\", s:\"rgb(255,0,0)\"},\r\n   {t:\"Dark Red\", s:\"rgb(153,0,0)\"},\r\n   {t:\"Orange\", s:\"rgb(255,153,0)\"},\r\n   {t:\"Yellow\", s:\"rgb(255,255,0)\"},\r\n   {t:\"Light Yellow\", s:\"rgb(255,255,204)\"},\r\n   {t:\"Green\", s:\"rgb(0,255,0)\"},\r\n   {t:\"Dark Green\", s:\"rgb(0,153,0)\"},\r\n   {t:\"Blue\", s:\"rgb(0,0,255)\"},\r\n   {t:\"Dark Blue\", s:\"rgb(0,0,153)\"},\r\n   {t:\"Light Blue\", s:\"rgb(204,204,255)\"}\r\n   ],\r\n  \"fonts\": [ // style weight size family\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Bold\", s:\"normal bold * *\"},\r\n   {t:\"Italic\", s:\"italic normal * *\"},\r\n   {t:\"Small\", s:\"* small *\"},\r\n   {t:\"Medium\", s:\"* medium *\"},\r\n   {t:\"Large\", s:\"* large *\"},\r\n   {t:\"Bold Small\", s:\"normal bold small *\"},\r\n   {t:\"Bold Medium\", s:\"normal bold medium *\"},\r\n   {t:\"Bold Large\", s:\"normal bold large *\"}\r\n   ],\r\n  \"cellformat\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Left\", s:\"left\"},\r\n   {t:\"Right\", s:\"right\"},\r\n   {t:\"Center\", s:\"center\"}\r\n   ],\r\n  \"borderOnOff\": [\r\n   {t:\"On\", s:\"1px solid rgb(0,0,0)\"},\r\n   {t:\"Off\", s:\"\"}\r\n   ],\r\n  \"colWidths\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"20\", s:\"20\"},\r\n   {t:\"40\", s:\"40\"},\r\n   {t:\"60\", s:\"60\"},\r\n   {t:\"80\", s:\"80\"},\r\n   {t:\"100\", s:\"100\"},\r\n   {t:\"120\", s:\"120\"},\r\n   {t:\"140\", s:\"140\"},\r\n   {t:\"160\", s:\"160\"},\r\n   {t:\"180\", s:\"180\"},\r\n   {t:\"200\", s:\"200\"},\r\n   {t:\"220\", s:\"220\"},\r\n   {t:\"240\", s:\"240\"},\r\n   {t:\"260\", s:\"260\"},\r\n   {t:\"280\", s:\"280\"},\r\n   {t:\"300\", s:\"300\"}\r\n   ],\r\n  \"ntvf\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"1234\", s:\"0\"},\r\n   {t:\"1,234\", s:\"#,##0\"},\r\n   {t:\"1,234.5\", s:\"#,##0.0\"},\r\n   {t:\"1,234.56\", s:\"#,##0.00\"},\r\n   {t:\"1,234.567\", s:\"#,##0.000\"},\r\n   {t:\"1,234%\", s:\"#,##0%\"},\r\n   {t:\"1,234.5%\", s:\"#,##0.0%\"},\r\n   {t:\"(1,234)\", s:\"#,##0_);(#,##0)\"},\r\n   {t:\"(1,234.5)\", s:\"#,##0.0_);(#,##0.0)\"},\r\n   {t:\"(1,234.56)\", s:\"#,##0.00_);(#,##0.00)\"},\r\n   {t:\"00\", s:\"00\"},\r\n   {t:\"000\", s:\"000\"},\r\n   {t:\"0000\", s:\"0000\"},\r\n   {t:\"$1,234.56\", s:\"$#,##0.00\"},\r\n   {t:\"2006-01-04\", s:\"yyyy-mm-dd\"},\r\n   {t:\"01:23:45\", s:\"hh:mm:ss\"},\r\n   {t:\"2006-01-04 01:23:45\", s:\"yyyy-mm-dd hh:mm:ss\"},\r\n   {t:\"Hidden\", s:\"hidden\"}\r\n   ],\r\n  \"tvf\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Automatic\", s:\"general\"},\r\n   {t:\"Plain Text\", s:\"text-plain\"},\r\n   {t:\"HTML\", s:\"text-html\"},\r\n   {t:\"Wiki\", s:\"text-wiki\"},\r\n   {t:\"Hidden\", s:\"hidden\"}\r\n   ],\r\n  \"ffal\": [ // Formulas, Formats, All\r\n   {t:\"All\", s:\"all\"},\r\n   {t:\"Contents\", s:\"formulas\"},\r\n   {t:\"Formats\", s:\"formats\"}\r\n   ],\r\n  \"all\": [ // All\r\n   {t:\"All\", s:\"all\"}\r\n   ],\r\n  \"rowcol\": [\r\n   {t:\"Row\", s:\"row\"},\r\n   {t:\"Column\", s:\"col\"}\r\n   ],\r\n  \"sortcol\": [\r\n   {t:\"A up\", s:\"A up\"},\r\n   {t:\"B up\", s:\"B up\"},\r\n   {t:\"C up\", s:\"C up\"},\r\n   {t:\"A down\", s:\"A down\"},\r\n   {t:\"B down\", s:\"B down\"},\r\n   {t:\"C down\", s:\"C down\"},\r\n   {t:\"A, B, C up\", s:\"A up B up C up\"}\r\n   ],\r\n  \"none\": [ // nothing\r\n   {t:\" \", s:\" \"}\r\n   ]\r\n  }\r\n }\r\n*********/\r\n\r\n//\r\n// SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.SpreadsheetControlExecuteCommand = function(obj, combostr, sstr) {\r\n\r\n   var i, commands;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var eobj = spreadsheet.editor;\r\n\r\n   var str = {};\r\n   str.P = \"%\";\r\n   str.N = \"\\n\"\r\n   if (eobj.range.hasrange) {\r\n      str.R = SocialCalc.crToCoord(eobj.range.left, eobj.range.top)+\r\n             \":\"+SocialCalc.crToCoord(eobj.range.right, eobj.range.bottom);\r\n      str.C = str.R;\r\n      str.W = SocialCalc.rcColname(eobj.range.left) + \":\" + SocialCalc.rcColname(eobj.range.right);\r\n      str.H = eobj.range.top + \":\" + eobj.range.bottom;\r\n      }\r\n   else if (eobj.ecell) {\r\n      str.C = eobj.ecell.coord;\r\n      str.R = eobj.ecell.coord+\":\"+eobj.ecell.coord;\r\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr(eobj.ecell.coord).col);\r\n      str.H = SocialCalc.coordToCr(eobj.ecell.coord).row;\r\n      }\r\n   else {\r\n      str.C = 'A1'\r\n      str.R = 'A1:A1'\r\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr('A1').col);\r\n      str.H = SocialCalc.coordToCr('A1').row;\r\n      }\r\n   str.S = sstr;\r\n   combostr = combostr.replace(/%C/g, str.C);\r\n   combostr = combostr.replace(/%R/g, str.R);\r\n   combostr = combostr.replace(/%N/g, str.N);\r\n   combostr = combostr.replace(/%S/g, str.S);\r\n   combostr = combostr.replace(/%W/g, str.W);\r\n   combostr = combostr.replace(/%H/g, str.H);\r\n   combostr = combostr.replace(/%P/g, str.P);\r\n\r\n   eobj.EditorScheduleSheetCommands(combostr, true, false);\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateSheetHTML(spreadsheet)\r\n//\r\n// Returns the HTML representation of the whole spreadsheet\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateSheetHTML = function(spreadsheet) {\r\n\r\n   var context, div, ele;\r\n\r\n   var result = \"\";\r\n\r\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\r\n   div = document.createElement(\"div\");\r\n   ele = context.RenderSheet(null, {type: \"html\"});\r\n   div.appendChild(ele);\r\n   delete context;\r\n   result = div.innerHTML;\r\n   delete ele;\r\n   delete div;\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateCellHTML(spreadsheet, coord, linkstyle)\r\n//\r\n// Returns the HTML representation of a cell. Blank is \"\", not \"&nbsp;\".\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateCellHTML = function(spreadsheet, coord, linkstyle) {\r\n\r\n   var result = \"\";\r\n   var cell = spreadsheet.sheet.cells[coord];\r\n\r\n   if (!cell) return \"\";\r\n\r\n   if (cell.displaystring == undefined) {\r\n      result = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\r\n      }\r\n   else {\r\n      result = cell.displaystring;\r\n      }\r\n\r\n   if (result == \"&nbsp;\") result = \"\";\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateCellHTMLSave(spreadsheet, range, linkstyle)\r\n//\r\n// Returns the HTML representation of a range of cells, or the whole sheet if range is null.\r\n// The form is:\r\n//    version:1.0\r\n//    coord:cell-HTML\r\n//    coord:cell-HTML\r\n//    ...\r\n//\r\n// Empty cells are skipped. The cell-HTML is encoded with \":\"=>\"\\c\", newline=>\"\\n\", and \"\\\"=>\"\\b\".\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateCellHTMLSave = function(spreadsheet, range, linkstyle) {\r\n\r\n   var cr1, cr2, row, col, coord, cell, cellHTML;\r\n   var result = [];\r\n   var prange;\r\n\r\n   if (range) {\r\n      prange = SocialCalc.ParseRange(range);\r\n      }\r\n   else {\r\n      prange = {cr1: {row: 1, col:1},\r\n                cr2: {row: spreadsheet.sheet.attribs.lastrow, col: spreadsheet.sheet.attribs.lastcol}};\r\n      }\r\n   cr1 = prange.cr1;\r\n   cr2 = prange.cr2;\r\n\r\n   result.push(\"version:1.0\");\r\n\r\n   for (row=cr1.row; row <= cr2.row; row++) {\r\n      for (col=cr1.col; col <= cr2.col; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         cell=spreadsheet.sheet.cells[coord];\r\n         if (!cell) continue;\r\n         if (cell.displaystring == undefined) {\r\n            cellHTML = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\r\n            }\r\n         else {\r\n            cellHTML = cell.displaystring;\r\n            }\r\n         if (cellHTML == \"&nbsp;\") continue;\r\n         result.push(coord+\":\"+SocialCalc.encodeForSave(cellHTML));\r\n         }\r\n      }\r\n\r\n   result.push(\"\"); // one extra to get extra \\n\r\n   return result.join(\"\\n\");\r\n   }\r\n\r\n//\r\n// Formula Bar Button Routines\r\n//\r\n\r\nSocialCalc.SpreadsheetControl.DoFunctionList = function() {\r\n\r\n   var i, cname, str, f, ele;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var fcl = scc.function_classlist;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   scf.FillFunctionInfo();\r\n\r\n   str = '<table><tr><td><span style=\"font-size:x-small;font-weight:bold\">%loc!Category!</span><br>'+\r\n      '<select id=\"'+idp+'class\" size=\"'+fcl.length+'\" style=\"width:120px;\" onchange=\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\">';\r\n   for (i=0; i<fcl.length; i++) {\r\n      str += '<option value=\"'+fcl[i]+'\"'+(i==0?' selected>':'>')+SocialCalc.special_chars(scf.FunctionClasses[fcl[i]].name)+'</option>';\r\n      }\r\n   str += '</select></td><td>&nbsp;&nbsp;</td><td id=\"'+idp+'list\"><span style=\"font-size:x-small;font-weight:bold\">%loc!Functions!</span><br>'+\r\n      '<select id=\"'+idp+'name\" size=\"'+fcl.length+'\" style=\"width:240px;\" '+\r\n      'onchange=\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\" ondblclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">';\r\n   str += SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\"all\");\r\n   str += '</td></tr><tr><td colspan=\"3\">'+\r\n          '<div id=\"'+idp+'desc\" style=\"width:380px;height:80px;overflow:auto;font-size:x-small;\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(scf.FunctionClasses[fcl[0]].items[0])+'</div>'+\r\n          '<div style=\"width:380px;text-align:right;padding-top:6px;font-size:small;\">'+\r\n          '<input type=\"button\" value=\"%loc!Paste!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">&nbsp;'+\r\n          '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\"></div>'+\r\n          '</td></tr></table>';\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;%loc!Function List!\"+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   str = SocialCalc.LocalizeSubstrings(str);\r\n\r\n   main.innerHTML = str;\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true,\r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"name\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide; if All, letter scrolls to there\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.GetFunctionNamesStr = function(cname) {\r\n\r\n   var i, f;\r\n   var scf = SocialCalc.Formula;\r\n   var str = \"\";\r\n\r\n   f = scf.FunctionClasses[cname];\r\n   for (i=0; i<f.items.length; i++) {\r\n      str += '<option value=\"'+f.items[i]+'\"'+(i==0?' selected>':'>')+f.items[i]+'</option>';\r\n      }\r\n\r\n   return str;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FillFunctionNames = function(cname, ele) {\r\n\r\n   var i, f;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   ele.length = 0;\r\n   f = scf.FunctionClasses[cname];\r\n   for (i=0; i<f.items.length; i++) {\r\n      ele.options[i] = new Option(f.items[i], f.items[i]);\r\n      if (i==0) {\r\n         ele.options[i].selected = true;\r\n         }\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.GetFunctionInfoStr = function(fname) {\r\n   \r\n   var scf = SocialCalc.Formula;\r\n   var f = scf.FunctionList[fname];\r\n   var scsc = SocialCalc.special_chars;\r\n\r\n   var str = \"<b>\"+fname+\"(\"+scsc(scf.FunctionArgString(fname))+\")</b><br>\";\r\n   str += scsc(f[3]);\r\n\r\n   return str;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FunctionClassChosen = function(cname) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n   var scf = SocialCalc.Formula;\r\n\r\n   SocialCalc.SpreadsheetControl.FillFunctionNames(cname, document.getElementById(idp+\"name\"));\r\n\r\n   SocialCalc.SpreadsheetControl.FunctionChosen(scf.FunctionClasses[cname].items[0]);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FunctionChosen = function(fname) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n\r\n   document.getElementById(idp+\"desc\").innerHTML = SocialCalc.SpreadsheetControl.GetFunctionInfoStr(fname);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.HideFunctions = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functiondialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoFunctionPaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functionname\");\r\n   var mele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   var text = ele.value+\"(\";\r\n\r\n   SocialCalc.SpreadsheetControl.HideFunctions();\r\n\r\n   if (mele) { // multi-line editing is in progress\r\n      mele.value += text;\r\n      mele.focus();\r\n      SocialCalc.CmdGotFocus(mele);\r\n      }\r\n   else {\r\n      editor.EditorAddToInput(text, \"=\");\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoMultiline = function() {\r\n\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var str, ele, text;\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"multiline\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         text = editor.inputBox.GetText();\r\n         break;\r\n      }\r\n\r\n   editor.inputBox.element.disabled = true;\r\n\r\n   text = SocialCalc.special_chars(text);\r\n\r\n   str = '<textarea id=\"'+idp+'textarea\" style=\"width:380px;height:120px;margin:10px 0px 0px 6px;\">'+text+'</textarea>'+\r\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\r\n         SCLocSS('<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilineClear();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\"></div>'+\r\n         '</div>');\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\r\n      SCLocSS(\"&nbsp;%loc!Multi-line Input Box!\")+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"textarea\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide?\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.HideMultiline = function() {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinedialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.disabled = false;\r\n         editor.inputBox.Focus();\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoMultilineClear = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   ele.value = \"\";\r\n   ele.focus();\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoMultilinePaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   var text = ele.value;\r\n\r\n   SocialCalc.SpreadsheetControl.HideMultiline();\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         break;\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         break;\r\n      }\r\n\r\n   editor.EditorSaveEdit(text);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoLink = function() {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   var str, ele, text, cell, setformat, popup;\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"link\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         text = editor.inputBox.GetText();\r\n         break;\r\n      }\r\n\r\n   editor.inputBox.element.disabled = true;\r\n\r\n   if (text.charAt(0)==\"'\") {\r\n      text = text.slice(1);\r\n      }\r\n\r\n   var parts = SocialCalc.ParseCellLinkText(text);\r\n\r\n   text = SocialCalc.special_chars(text);\r\n\r\n   cell = spreadsheet.sheet.cells[editor.ecell.coord];\r\n   if (!cell || !cell.textvalueformat) { // set to link format, but don't override\r\n      setformat = \" checked\";\r\n      }\r\n   else {\r\n      setformat = \"\";\r\n      }\r\n\r\n   popup = parts.newwin ? \" checked\" : \"\";\r\n\r\n   str = '<div style=\"padding:6px 0px 4px 6px;\">'+\r\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"Description\")+'</span><br>'+\r\n         '<input type=\"text\" id=\"'+idp+'desc\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.desc)+'\"><br>'+\r\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"URL\")+'</span><br>'+\r\n         '<input type=\"text\" id=\"'+idp+'url\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.url)+'\"><br>';\r\n   if (SocialCalc.Callbacks.MakePageLink) { // only show if handling pagenames here\r\n      str += '<span style=\"font-size:smaller;\">'+SCLoc(\"Page Name\")+'</span><br>'+\r\n             '<input type=\"text\" id=\"'+idp+'pagename\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.pagename)+'\"><br>'+\r\n             '<span style=\"font-size:smaller;\">'+SCLoc(\"Workspace\")+'</span><br>'+\r\n             '<input type=\"text\" id=\"'+idp+'workspace\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.workspace)+'\"><br>';\r\n      }\r\n   str += SocialCalc.LocalizeSubstrings('<input type=\"checkbox\" id=\"'+idp+'format\"'+setformat+'>&nbsp;'+\r\n         '<span style=\"font-size:smaller;\">%loc!Set to Link format!</span><br>'+\r\n         '<input type=\"checkbox\" id=\"'+idp+'popup\"'+popup+'>&nbsp;'+\r\n         '<span style=\"font-size:smaller;\">%loc!Show in new browser window!</span>'+\r\n         '</div>'+\r\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\r\n         '<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkPaste();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkClear();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\"></div>'+\r\n         '</div>');\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+SCLoc(\"Link Input Box\")+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"url\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide?\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.HideLink = function() {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkdialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.disabled = false;\r\n         editor.inputBox.Focus();\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoLinkClear = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   document.getElementById(spreadsheet.idPrefix+\"linkdesc\").value = \"\";\r\n   document.getElementById(spreadsheet.idPrefix+\"linkpagename\").value = \"\";\r\n   document.getElementById(spreadsheet.idPrefix+\"linkworkspace\").value = \"\";\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\r\n   ele.value = \"\";\r\n   ele.focus();\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoLinkPaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var descele = document.getElementById(spreadsheet.idPrefix+\"linkdesc\");\r\n   var urlele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\r\n   var pagenameele = document.getElementById(spreadsheet.idPrefix+\"linkpagename\");\r\n   var workspaceele = document.getElementById(spreadsheet.idPrefix+\"linkworkspace\");\r\n   var formatele = document.getElementById(spreadsheet.idPrefix+\"linkformat\");\r\n   var popupele = document.getElementById(spreadsheet.idPrefix+\"linkpopup\");\r\n\r\n   var text = \"\";\r\n\r\n   var ltsym, gtsym, obsym, cbsym;\r\n\r\n   if (popupele.checked) {\r\n      ltsym = \"<<\"; gtsym = \">>\"; obsym = \"[[\"; cbsym = \"]]\";\r\n      }\r\n   else {\r\n      ltsym = \"<\"; gtsym = \">\"; obsym = \"[\"; cbsym = \"]\";\r\n      }\r\n\r\n   if (pagenameele && pagenameele.value) {\r\n      if (workspaceele.value) {\r\n         text = descele.value+\"{\"+workspaceele.value+obsym+pagenameele.value+cbsym+\"}\";\r\n         }\r\n      else {\r\n         text = descele.value+obsym+pagenameele.value+cbsym;\r\n         }\r\n      }\r\n   else {\r\n      text = descele.value+ltsym+urlele.value+gtsym;\r\n      }\r\n\r\n   SocialCalc.SpreadsheetControl.HideLink();\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         break;\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         break;\r\n      }\r\n\r\n   if (formatele.checked) {\r\n      SocialCalc.SpreadsheetControlExecuteCommand(null, \"set %C textvalueformat text-link\", \"\");\r\n      }\r\n\r\n   editor.EditorSaveEdit(text);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoSum = function() {\r\n\r\n   var cmd, cell, row, col, sel, cr, foundvalue;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var sheet = editor.context.sheetobj;\r\n\r\n   if (editor.range.hasrange) {\r\n      sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n         \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      cmd = \"set \"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom+1)+\r\n         \" formula sum(\"+sel+\")\";\r\n      }\r\n   else {\r\n      row = editor.ecell.row - 1;\r\n      col = editor.ecell.col;\r\n      if (row<=1) {\r\n         cmd = \"set \"+editor.ecell.coord+\" constant e#REF! 0 #REF!\";\r\n         }\r\n      else {\r\n         foundvalue = false;\r\n         while (row>0) {\r\n            cr = SocialCalc.crToCoord(col, row);\r\n            cell = sheet.GetAssuredCell(cr);\r\n            if (!cell.datatype || cell.datatype==\"t\") {\r\n               if (foundvalue) {\r\n                  row++;\r\n                  break;\r\n                  }\r\n               }\r\n            else {\r\n               foundvalue = true;\r\n               }\r\n            row--;\r\n            }\r\n         cmd = \"set \"+editor.ecell.coord+\" formula sum(\"+\r\n            SocialCalc.crToCoord(col,row)+\":\"+SocialCalc.crToCoord(col, editor.ecell.row-1)+\")\";\r\n         }\r\n      }\r\n\r\n   editor.EditorScheduleSheetCommands(cmd, true, false);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FindInSheet = function() {\r\n    var searchstatus = $(\"#searchstatus\");\r\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n    if (!this.value.length) {\r\n        searchstatus.text(\"\");\r\n        spreadsheet.sheet.search_cells = [];\r\n        spreadsheet.sheet.selected_search_cell = undefined;\r\n        return;\r\n    }\r\n    var cells = spreadsheet.sheet.cells;\r\n    var regex = new RegExp(this.value, 'im');\r\n    var cell, cellvalue;\r\n    var search_cells = [];\r\n    for (var cell_id in cells) {\r\n        cell = cells[cell_id];\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (spreadsheet.sheet.rowattribs.hide[cr.row] === 'yes' || spreadsheet.sheet.colattribs.hide[SocialCalc.rcColname(cr.col)] === 'yes') {\r\n            continue;\r\n        }\r\n        if (cell.datatype === 'c') {\r\n            cellvalue = cell.displaystring;\r\n        } else {\r\n            cellvalue = String(cell.datavalue);\r\n        }\r\n        if (cellvalue !== undefined && cellvalue.match(regex)) {\r\n           search_cells.push(cell_id);\r\n        } \r\n    }\r\n    spreadsheet.sheet.search_cells = search_cells;\r\n    if (search_cells.length) {\r\n        spreadsheet.sheet.selected_search_cell = 0;\r\n        spreadsheet.editor.MoveECell(search_cells[0]);\r\n        searchstatus.text(\"1 of \" + search_cells.length); \r\n    } else {\r\n        spreadsheet.sheet.selected_search_cell = undefined;\r\n        searchstatus.text(\"No Matches\");\r\n    }\r\n        \r\n}\r\n\r\nSocialCalc.SpreadsheetControl.SearchSheet = function(direction) {\r\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n    var sheet = spreadsheet.sheet;\r\n    var cells = sheet.search_cells;\r\n    if (!cells.length) {\r\n        return;\r\n    }\r\n    var selected_cell = sheet.selected_search_cell;\r\n    if (selected_cell === (direction === 0 ? 0 : cells.length-1)) {\r\n        selected_cell = (direction === 0 ? cells.length-1 : 0);\r\n    } else {\r\n        selected_cell += (direction === 0 ? -1 : 1);\r\n    }\r\n    var new_cell = cells[selected_cell];\r\n    sheet.selected_search_cell = selected_cell; \r\n    spreadsheet.editor.MoveECell(new_cell);\r\n    document.getElementById(\"searchstatus\").textContent = String(selected_cell+1) + \" of \" + cells.length;\r\n}\r\n \r\nSocialCalc.SpreadsheetControl.SearchUp = function() {\r\n    SocialCalc.SpreadsheetControl.SearchSheet(0);    \r\n}\r\n\r\nSocialCalc.SpreadsheetControl.SearchDown = function() {\r\n    SocialCalc.SpreadsheetControl.SearchSheet(1);\r\n}\r\n\r\n//\r\n// TAB Routines\r\n//\r\n\r\n// Sort\r\n\r\nSocialCalc.SpreadsheetControlSortOnclick = function(s, t) {\r\n\r\n   var name, i;\r\n   var namelist = [];\r\n   var nl = document.getElementById(s.idPrefix+\"sortlist\");\r\n   SocialCalc.LoadColumnChoosers(s);\r\n   s.editor.RangeChangeCallback.sort = SocialCalc.UpdateSortRangeProposal;\r\n\r\n   for (name in s.sheet.names) {\r\n      namelist.push(name);\r\n      }\r\n   namelist.sort();\r\n   nl.length = 0;\r\n   nl.options[0] = new Option(SocialCalc.LocalizeString(\"[select range]\"));\r\n   nl.options[1] = new Option(SocialCalc.LocalizeString(\"Sort All\"), \"all\");\r\n   n_options = nl.options.length;\r\n\r\n   for (i=0; i<namelist.length; i++) {\r\n      name = namelist[i];\r\n      nl.options[i+n_options] = new Option(name, name);\r\n      if (name == s.sortrange) {\r\n         nl.options[i+n_options].selected = true;\r\n         }\r\n      }\r\n   if (s.sortrange == \"\") {\r\n      nl.options[0].selected = true;\r\n      }\r\n\r\n   SocialCalc.UpdateSortRangeProposal(s.editor);\r\n   SocialCalc.KeyboardFocus();\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlSortSave = function(editor, setting) {\r\n   // Format is:\r\n   //    sort:sortrange:major:up/down:minor:up/down:last:up/down\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var str, sele, rele;\r\n\r\n   str = \"sort:\"+SocialCalc.encodeForSave(spreadsheet.sortrange)+\":\";\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\r\n   str += sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   if (sele.selectedIndex>0) {\r\n      rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\r\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n      }\r\n   else {\r\n      str += \"::\";\r\n      }\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   if (sele.selectedIndex>0) {\r\n      rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\r\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n      }\r\n    else {\r\n      str += \"::\";\r\n      }\r\n   return str+\"\\n\";\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlSortLoad = function(editor, setting, line, flags) {\r\n   var parts, ele;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   parts = line.split(\":\");\r\n   spreadsheet.sortrange = SocialCalc.decodeFromSave(parts[1]);\r\n   ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\r\n   if (spreadsheet.sortrange) {\r\n      ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\r\n      ele.style.visibility = \"visible\";\r\n      }\r\n   else {\r\n      ele.style.visibility = \"hidden\";\r\n      }\r\n   SocialCalc.LoadColumnChoosers(spreadsheet);\r\n\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   sele.selectedIndex = parts[2]-0;\r\n   document.getElementById(spreadsheet.idPrefix+\"majorsort\"+parts[3]).checked = true;\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   if (parts[4]) {\r\n      sele.selectedIndex = parts[4]-0;\r\n      document.getElementById(spreadsheet.idPrefix+\"minorsort\"+parts[5]).checked = true;\r\n      }\r\n   else {\r\n      sele.selectedIndex = 0;\r\n      document.getElementById(spreadsheet.idPrefix+\"minorsortup\").checked = true;\r\n      }\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   if (parts[6]) {\r\n      sele.selectedIndex = parts[6]-0;\r\n      document.getElementById(spreadsheet.idPrefix+\"lastsort\"+parts[7]).checked = true;\r\n      }\r\n    else {\r\n      sele.selectedIndex = 0;\r\n      document.getElementById(spreadsheet.idPrefix+\"lastsortup\").checked = true;\r\n      }\r\n\r\n   return true;\r\n   }\r\n\r\n// Comment\r\n\r\nSocialCalc.SpreadsheetControlCommentOnclick = function(s, t) {\r\n   s.editor.MoveECellCallback.comment = SocialCalc.SpreadsheetControlCommentMoveECell;\r\n   SocialCalc.SpreadsheetControlCommentDisplay(s, t);\r\n   SocialCalc.KeyboardFocus();\r\n   return;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentDisplay = function(s, t) {\r\n   var c = \"\";\r\n   if (s.editor.ecell && s.editor.ecell.coord && s.sheet.cells[s.editor.ecell.coord]) {\r\n      c = s.sheet.cells[s.editor.ecell.coord].comment || \"\";\r\n      }\r\n   document.getElementById(s.idPrefix+\"commenttext\").value = c;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentMoveECell = function(editor) {\r\n   SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(), \"comment\");\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentSet = function() {\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   s.ExecuteCommand(\"set %C comment \"+SocialCalc.encodeForSave(document.getElementById(s.idPrefix+\"commenttext\").value));\r\n   var cell=SocialCalc.GetEditorCellElement(s.editor, s.editor.ecell.row, s.editor.ecell.col);\r\n   if (!s.editor.ECellReadonly()) {\r\n      cell.element.title = document.getElementById(s.idPrefix+\"commenttext\").value;\r\n      s.editor.UpdateCellCSS(cell, s.editor.ecell.row, s.editor.ecell.col);\r\n      }\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentOnunclick = function(s, t) {\r\n   delete s.editor.MoveECellCallback.comment;\r\n   }\r\n\r\n// Names\r\n\r\nSocialCalc.SpreadsheetControlNamesOnclick = function(s, t) {\r\n   document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n   document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n   document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n   s.editor.RangeChangeCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\r\n   s.editor.MoveECellCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\r\n   SocialCalc.SpreadsheetControlNamesRangeChange(s.editor);\r\n   SocialCalc.SpreadsheetControlNamesFillNameList();\r\n   SocialCalc.SpreadsheetControlNamesChangedName();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesFillNameList = function() {\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var name, i;\r\n   var namelist = [];\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\r\n   var currentname = document.getElementById(s.idPrefix+\"namesname\").value.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\r\n   for (name in s.sheet.names) {\r\n      namelist.push(name);\r\n      }\r\n   namelist.sort();\r\n   nl.length = 0;\r\n   if (namelist.length > 0) {\r\n      nl.options[0] = new Option(SCLoc(\"[New]\"));\r\n      }\r\n   else {\r\n      nl.options[0] = new Option(SCLoc(\"[None]\"));\r\n      }\r\n   for (i=0; i<namelist.length; i++) {\r\n      name = namelist[i];\r\n      nl.options[i+1] = new Option(name, name);\r\n      if (name == currentname) {\r\n         nl.options[i+1].selected = true;\r\n         }\r\n      }\r\n   if (currentname == \"\") {\r\n      nl.options[0].selected = true;\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesChangedName = function() {\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\r\n   var name = nl.options[nl.selectedIndex].value;\r\n   if (s.sheet.names[name]) {\r\n      document.getElementById(s.idPrefix+\"namesname\").value = name;\r\n      document.getElementById(s.idPrefix+\"namesdesc\").value = s.sheet.names[name].desc || \"\";\r\n      document.getElementById(s.idPrefix+\"namesvalue\").value = s.sheet.names[name].definition || \"\";\r\n      }\r\n   else {\r\n      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesRangeChange = function(editor) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var ele = document.getElementById(s.idPrefix+\"namesrangeproposal\");\r\n   if (editor.range.hasrange) {\r\n      ele.value = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   else {\r\n      ele.value = editor.ecell.coord;\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesOnunclick = function(s, t) {\r\n   delete s.editor.RangeChangeCallback.names;\r\n   delete s.editor.MoveECellCallback.names;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesSetValue = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   document.getElementById(s.idPrefix+\"namesvalue\").value = document.getElementById(s.idPrefix+\"namesrangeproposal\").value;\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesSave = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (name != \"\") {\r\n      s.ExecuteCommand(\"name define \"+name+\" \"+document.getElementById(s.idPrefix+\"namesvalue\").value+\"\\n\"+\r\n         \"name desc \"+name+\" \"+document.getElementById(s.idPrefix+\"namesdesc\").value);\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesDelete = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (name != \"\") {\r\n      s.ExecuteCommand(\"name delete \"+name);\r\n//      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n//      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n//      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n//      SocialCalc.SpreadsheetControlNamesFillNameList();\r\n      }\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\n// Clipboard\r\n\r\nSocialCalc.SpreadsheetControlClipboardOnclick = function(s, t) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   document.getElementById(s.idPrefix+\"clipboardformat-tab\").checked = true;\r\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\r\n   return;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardFormat = function(which) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, which);\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardLoad = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var savetype = \"tab\";\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (document.getElementById(s.idPrefix+\"clipboardformat-csv\").checked) {\r\n      savetype = \"csv\";\r\n      }\r\n   else if (document.getElementById(s.idPrefix+\"clipboardformat-scsave\").checked) {\r\n      savetype = \"scsave\";\r\n      }\r\n   // control+v ignores ignore windows clipboard - see ctrlkeyFunction(editor, charname)\r\n   s.editor.pastescclipboard = true;\r\n   s.editor.EditorScheduleSheetCommands(\"loadclipboard \"+\r\n      SocialCalc.encodeForSave(\r\n         SocialCalc.ConvertOtherFormatToSave(document.getElementById(s.idPrefix+\"clipboardtext\").value, savetype)), true, false);\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardClear = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   clipele.value = \"\";\r\n   s.editor.EditorScheduleSheetCommands(\"clearclipboard\", true, false);\r\n   clipele.focus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardExport = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   if (s.ExportCallback) {\r\n      s.ExportCallback(s);\r\n      }\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\n// Settings\r\n\r\nSocialCalc.SpreadsheetControlSettingsSwitch = function(target) {\r\n   SocialCalc.SettingControlReset();\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var sheettable = document.getElementById(s.idPrefix+\"sheetsettingstable\");\r\n   var celltable = document.getElementById(s.idPrefix+\"cellsettingstable\");\r\n   var sheettoolbar = document.getElementById(s.idPrefix+\"sheetsettingstoolbar\");\r\n   var celltoolbar = document.getElementById(s.idPrefix+\"cellsettingstoolbar\");\r\n   if (target==\"sheet\") {\r\n      sheettable.style.display = \"block\";\r\n      celltable.style.display = \"none\";\r\n      sheettoolbar.style.display = \"block\";\r\n      celltoolbar.style.display = \"none\";\r\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.sheetspanel);\r\n      }\r\n   else {\r\n      sheettable.style.display = \"none\";\r\n      celltable.style.display = \"block\";\r\n      sheettoolbar.style.display = \"none\";\r\n      celltoolbar.style.display = \"block\";\r\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.cellspanel);\r\n      }\r\n   }\r\n\r\nSocialCalc.SettingsControlSave = function(target) {\r\n   var range, cmdstr;\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var sc = SocialCalc.SettingsControls;\r\n   var panelobj = sc.CurrentPanel;\r\n   var attribs = SocialCalc.SettingsControlUnloadPanel(panelobj);\r\n\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (target==\"sheet\") {\r\n      cmdstr = s.sheet.DecodeSheetAttributes(attribs);\r\n      }\r\n   else if (target==\"cell\") {\r\n      if (s.editor.range.hasrange) {\r\n         range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\r\n            SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\r\n         }\r\n      cmdstr = s.sheet.DecodeCellAttributes(s.editor.ecell.coord, attribs, range);\r\n      }\r\n   else { // Cancel\r\n      }\r\n   if (cmdstr) {\r\n      s.editor.EditorScheduleSheetCommands(cmdstr, true, false);\r\n      }\r\n   }\r\n\r\n///////////////////////\r\n//\r\n// SAVE / LOAD ROUTINES\r\n//\r\n///////////////////////\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet, otherparts)\r\n//\r\n// Saves the spreadsheet's sheet data, editor settings, and audit trail (redo stack).\r\n// The serialized data strings are concatenated together in multi-part MIME format.\r\n// The first part lists the types of the subsequent parts (e.g., \"sheet\", \"editor\", and \"audit\")\r\n// in this format:\r\n//   # comments\r\n//   version:1.0\r\n//   part:type1\r\n//   part:type2\r\n//   ...\r\n//\r\n// If otherparts is non-null, it is an object with:\r\n//   partname1: \"part contents - should end with \\n\",\r\n//   partname2: \"part contents - should end with \\n\"\r\n//\r\n\r\n\r\nSocialCalc.SpreadsheetControlCreateSpreadsheetSave = function(spreadsheet, otherparts) {\r\n\r\n   var result;\r\n\r\n   var otherpartsstr = \"\";\r\n   var otherpartsnames = \"\";\r\n   var partname, extranl;\r\n\r\n   if (otherparts) {\r\n      for (partname in otherparts) {\r\n         if (otherparts[partname].charAt(otherparts[partname]-1) != \"\\n\") {\r\n            extranl = \"\\n\";\r\n            }\r\n         else {\r\n            extranl = \"\";\r\n            }\r\n         otherpartsstr += \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n            otherparts[partname] + extranl;\r\n         otherpartsnames += \"part:\"+partname + \"\\n\";\r\n         }\r\n      }\r\n\r\n   result = \"socialcalc:version:1.0\\n\" +\r\n      \"MIME-Version: 1.0\\nContent-Type: multipart/mixed; boundary=\"+\r\n      spreadsheet.multipartBoundary + \"\\n\" +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      \"# SocialCalc Spreadsheet Control Save\\nversion:1.0\\npart:sheet\\npart:edit\\npart:audit\\n\" + otherpartsnames +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.CreateSheetSave() +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.editor.SaveEditorSettings() +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.sheet.CreateAuditString() +\r\n      otherpartsstr +\r\n      \"--\" + spreadsheet.multipartBoundary + \"--\\n\";\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// parts = SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(spreadsheet, str)\r\n//\r\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\r\n//\r\n//    {type1: {start: startpos, end: endpos}, type2:...}\r\n//\r\n\r\nSocialCalc.SpreadsheetControlDecodeSpreadsheetSave = function(spreadsheet, str) {\r\n\r\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\r\n   var parts = {};\r\n   var partlist = [];\r\n\r\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\r\n   if (pos1 < 0) return parts;\r\n\r\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\r\n   mpregex.lastIndex = pos1;\r\n\r\n   searchinfo = mpregex.exec(str);\r\n   if (mpregex.lastIndex <= 0) return parts;\r\n   boundary = searchinfo[1];\r\n\r\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\r\n   boundaryregex.lastIndex = mpregex.lastIndex;\r\n\r\n   searchinfo = boundaryregex.exec(str); // find header top boundary\r\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\r\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\r\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\r\n   if (!searchinfo) return parts;\r\n   start = blanklineregex.lastIndex;\r\n   boundaryregex.lastIndex = start;\r\n   searchinfo = boundaryregex.exec(str); // find end of header\r\n   if (!searchinfo) return parts;\r\n   ending = searchinfo.index;\r\n\r\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      p = line.split(\":\");\r\n      switch (p[0]) {\r\n         case \"version\":\r\n            break;\r\n         case \"part\":\r\n            partlist.push(p[1]);\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\r\n      blanklineregex.lastIndex = ending;\r\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\r\n      if (!searchinfo) return parts;\r\n      start = blanklineregex.lastIndex;\r\n      if (pnum==partlist.length-1) { // last one has different boundary\r\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\r\n         }\r\n      boundaryregex.lastIndex = start;\r\n      searchinfo = boundaryregex.exec(str); // find ending boundary\r\n      if (!searchinfo) return parts;\r\n      ending = searchinfo.index;\r\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\r\n      }\r\n\r\n   return parts;\r\n\r\n   }\r\n\r\n\r\n/*\r\n* SettingsControls\r\n*\r\n* Each settings panel has an object in the following form:\r\n*\r\n*    {ctrl-name1: {setting: setting-nameA, type: ctrl-type, id: id-component},\r\n*     ctrl-name2: {setting: setting-nameB, type: ctrl-type, id: id-component, initialdata: optional-initialdata-override},\r\n*     ...}\r\n*\r\n* The ctrl-types are names that correspond to:\r\n*\r\n*    SocialCalc.SettingsControls.Controls = {\r\n*       ctrl-type1: {\r\n*          SetValue: function(panel-obj, ctrl-name, {def: true/false, val: value}) {...;},\r\n*          ColorValues: if true, Onchanged converts between hex and RGB\r\n*          GetValue: function(panel-obj, ctrl-name) {...return {def: true/false, val: value};},\r\n*          Initialize: function(panel-obj, ctrl-name) {...;}, // used to fill dropdowns, etc.\r\n*          InitialData: control-dependent, // used by Initialize (if no panel ctrlname.initialdata)\r\n*          OnReset: function(ctrl-name) {...;}, // called to put down popups, etc.\r\n*          ChangedCallback: function(ctrl-name) {...;} // if not null, called by control when user changes value\r\n*       }\r\n*\r\n*/\r\n\r\nSocialCalc.SettingsControls = {\r\n   Controls: {},\r\n   CurrentPanel: null // panel object to search on events\r\n   };\r\n\r\n//\r\n// SocialCalc.SettingsControlSetCurrentPanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlSetCurrentPanel = function(panelobj) {\r\n\r\n   SocialCalc.SettingsControls.CurrentPanel = panelobj;\r\n\r\n   SocialCalc.SettingsControls.PopupChangeCallback({panelobj: panelobj}, \"\", null);\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlInitializePanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlInitializePanel = function(panelobj) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.Initialize) ctrl.Initialize(panelobj, ctrlname);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlLoadPanel(panel-object, attribs)\r\n//\r\n\r\nSocialCalc.SettingsControlLoadPanel = function(panelobj, attribs) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.SetValue) ctrl.SetValue(panelobj, ctrlname, attribs[panelobj[ctrlname].setting]);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// attribs = SocialCalc.SettingsControlUnloadPanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlUnloadPanel = function(panelobj) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var attribs = {};\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.GetValue) attribs[panelobj[ctrlname].setting] = ctrl.GetValue(panelobj, ctrlname);\r\n      }\r\n\r\n   return attribs;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupChangeCallback\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupChangeCallback = function(attribs, id, value) {\r\n\r\n   var sc = SocialCalc.Constants;\r\n\r\n   var ele = document.getElementById(\"sample-text\");\r\n\r\n   if (!ele || !attribs || !attribs.panelobj) return;\r\n\r\n   var idPrefix = SocialCalc.CurrentSpreadsheetControlObject.idPrefix;\r\n\r\n   var c = attribs.panelobj.name == \"cell\" ? \"c\" : \"\";\r\n\r\n   var v, a, parts, str1, str2, i;\r\n\r\n   parts = sc.defaultCellLayout.match(/^padding.(\\S+) (\\S+) (\\S+) (\\S+).vertical.align.(\\S+);$/) || [];\r\n\r\n   var cv = {color: [\"textcolor\"], backgroundColor: [\"bgcolor\", \"#FFF\"],\r\n             fontSize: [\"fontsize\", sc.defaultCellFontSize], fontFamily: [\"fontfamily\"],\r\n             paddingTop: [\"padtop\", parts[1]], paddingRight: [\"padright\", parts[2]],\r\n             paddingBottom: [\"padbottom\", parts[3]], paddingLeft: [\"padleft\", parts[4]],\r\n             verticalAlign: [\"alignvert\", parts[5]]};\r\n\r\n   for (a in cv) {\r\n      v = SocialCalc.Popup.GetValue(idPrefix+c+cv[a][0]) || cv[a][1] || \"\";\r\n      ele.style[a] = v;\r\n      }\r\n\r\n   if (c==\"c\") {\r\n      cv = {borderTop: \"cbt\", borderRight: \"cbr\", borderBottom: \"cbb\", borderLeft: \"cbl\"};\r\n      for (a in cv) {\r\n         v = SocialCalc.SettingsControls.BorderSideGetValue(attribs.panelobj, cv[a]);\r\n         ele.style[a] = v ? (v.val || \"\") : \"\";\r\n         }\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"calignhoriz\");\r\n      ele.style.textAlign = v || \"left\";\r\n      ele.childNodes[1].style.textAlign = v || \"right\";\r\n      }\r\n   else {\r\n      ele.style.border = \"\";\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"textalignhoriz\");\r\n      ele.style.textAlign = v || \"left\";\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"numberalignhoriz\");\r\n      ele.childNodes[1].style.textAlign = v || \"right\";\r\n      }\r\n\r\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"fontlook\");\r\n   parts = v ? (v.match(/^(\\S+) (\\S+)$/) || []) : [];\r\n   ele.style.fontStyle = parts[1] || \"\";\r\n   ele.style.fontWeight = parts[2] || \"\";\r\n\r\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"formatnumber\") || \"General\";\r\n   str1 = SocialCalc.FormatNumber.formatNumberWithFormat(9.8765, v, \"\");\r\n   str2 = SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5, v, \"\");\r\n   if (str2 != \"??-???-??&nbsp;??:??:??\") { // not bad date from negative number\r\n      str1 += \"<br>\"+str2;\r\n      }\r\n      \r\n   ele.childNodes[1].innerHTML = str1;\r\n\r\n   }\r\n\r\n//\r\n// PopupList Control\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (!value.def) {\r\n      sp.SetValue(panelobj[ctrlname].id, value.val);\r\n      }\r\n   else {\r\n      sp.SetValue(panelobj[ctrlname].id, \"\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListGetValue = function(panelobj, ctrlname) {\r\n\r\n   var ctl = panelobj[ctrlname];\r\n   if (!ctl) return null;\r\n\r\n   var value = SocialCalc.Popup.GetValue(ctl.id);\r\n   if (value) {\r\n      return {def: false, val: value};\r\n      }\r\n   else {\r\n      return {def: true, val: 0};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListInitialize = function(panelobj, ctrlname) {\r\n\r\n   var i, val, pos, otext;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var initialdata = panelobj[ctrlname].initialdata || sc.Controls[panelobj[ctrlname].type].InitialData || \"\";\r\n   initialdata = SocialCalc.LocalizeSubstrings(initialdata);\r\n   var optionvals = initialdata.split(/\\|/);\r\n\r\n   var options = [];\r\n\r\n   for (i=0; i<(optionvals.length||0); i++) {\r\n      val = optionvals[i];\r\n      pos = val.indexOf(\":\");\r\n      otext = val.substring(0, pos);\r\n      if (otext.indexOf(\"\\\\\")!=-1) { // escape any colons\r\n         otext = otext.replace(/\\\\c/g,\":\");\r\n         otext = otext.replace(/\\\\b/g,\"\\\\\");\r\n\r\n         }\r\n      otext = SocialCalc.special_chars(otext);\r\n      if (otext == \"[custom]\") {\r\n         options[i] = {o: SocialCalc.Constants.s_PopupListCustom, v: val.substring(pos+1), a:{custom: true}};\r\n         }\r\n      else if (otext == \"[cancel]\") {\r\n         options[i] = {o: SocialCalc.Constants.s_PopupListCancel, v: \"\", a:{cancel: true}};\r\n         }\r\n      else if (otext == \"[break]\") {\r\n         options[i] = {o: \"-----\", v: \"\", a:{skip: true}};\r\n         }\r\n      else if (otext == \"[newcol]\") {\r\n         options[i] = {o: \"\", v: \"\", a:{newcol: true}};\r\n         }\r\n      else {\r\n         options[i] = {o: otext, v: val.substring(pos+1)};\r\n         }\r\n      }\r\n\r\n   SocialCalc.Popup.Create(\"List\", panelobj[ctrlname].id, {});\r\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id, \r\n      {options: options, \r\n       attribs:{changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListReset\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListReset = function(ctrlname) {\r\n\r\n   SocialCalc.Popup.Reset(\"List\");\r\n\r\n   }\r\n\r\nSocialCalc.SettingsControls.Controls.PopupList = {\r\n   SetValue: SocialCalc.SettingsControls.PopupListSetValue,\r\n   GetValue: SocialCalc.SettingsControls.PopupListGetValue,\r\n   Initialize: SocialCalc.SettingsControls.PopupListInitialize,\r\n   OnReset: SocialCalc.SettingsControls.PopupListReset,\r\n   ChangedCallback: null\r\n   }\r\n\r\n//\r\n// ColorChooser Control\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (!value.def) {\r\n      sp.SetValue(panelobj[ctrlname].id, value.val);\r\n      }\r\n   else {\r\n      sp.SetValue(panelobj[ctrlname].id, \"\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserGetValue = function(panelobj, ctrlname) {\r\n\r\n   var value = SocialCalc.Popup.GetValue(panelobj[ctrlname].id);\r\n   if (value) {\r\n      return {def: false, val: value};\r\n      }\r\n   else {\r\n      return {def: true, val: 0};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserInitialize = function(panelobj, ctrlname) {\r\n\r\n   var i, val, pos, otext;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   SocialCalc.Popup.Create(\"ColorChooser\", panelobj[ctrlname].id, {});\r\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id,\r\n      {attribs:{title: \"&nbsp;\", moveable: true, width: \"106px\",\r\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserReset\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserReset = function(ctrlname) {\r\n\r\n   SocialCalc.Popup.Reset(\"ColorChooser\");\r\n\r\n   }\r\n\r\nSocialCalc.SettingsControls.Controls.ColorChooser = {\r\n   SetValue: SocialCalc.SettingsControls.ColorChooserSetValue,\r\n   GetValue: SocialCalc.SettingsControls.ColorChooserGetValue,\r\n   Initialize: SocialCalc.SettingsControls.ColorChooserInitialize,\r\n   OnReset: SocialCalc.SettingsControls.ColorChooserReset,\r\n   ChangedCallback: null\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideSetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ele, found, idname, parts;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\r\n   if (!ele) return;\r\n\r\n   if (value.val) { // border does not use default: it looks only to the value currently\r\n      ele.checked = true;\r\n      ele.value = value.val;\r\n      parts = value.val.match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\r\n      idname = idstart+\"-color\";\r\n      SocialCalc.Popup.SetValue(idname, parts[3]);\r\n      SocialCalc.Popup.SetDisabled(idname, false);\r\n      }\r\n   else {\r\n      ele.checked = false;\r\n      ele.value = value.val;\r\n      idname = idstart+\"-color\";\r\n      SocialCalc.Popup.SetValue(idname, \"\");\r\n      SocialCalc.Popup.SetDisabled(idname, true);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideGetValue = function(panelobj, ctrlname) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ele, value;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\r\n   if (!ele) return;\r\n\r\n\r\n   if (ele.checked) { // on\r\n      value = SocialCalc.Popup.GetValue(idstart+\"-color\");\r\n      value = \"1px solid \" + (value || \"rgb(0,0,0)\");\r\n      return {def: false, val: value};\r\n      }\r\n   else { // off\r\n      return {def: false, val: \"\"};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideInitialize = function(panelobj, ctrlname) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   SocialCalc.Popup.Create(\"ColorChooser\", idstart+\"-color\", {});\r\n   SocialCalc.Popup.Initialize(idstart+\"-color\",\r\n      {attribs:{title: \"&nbsp;\", width: \"106px\", moveable: true,\r\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlOnchangeBorder = function(ele)\r\n//\r\n\r\nSocialCalc.SettingsControlOnchangeBorder = function(ele) {\r\n\r\n   var idname, value, found, ele2;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var panelobj = sc.CurrentPanel;\r\n\r\n   var nameparts = ele.id.match(/(^.*\\-)(\\w+)\\-(\\w+)\\-(\\w+)$/);\r\n   if (!nameparts) return;\r\n   var prefix = nameparts[1];\r\n   var ctrlname = nameparts[2];\r\n   var ctrlsubid = nameparts[3]\r\n   var ctrlidsuffix = nameparts[4];\r\n   var ctrltype = panelobj[ctrlname].type;\r\n\r\n   switch (ctrlidsuffix) {\r\n      case \"bcb\": // border checkbox\r\n         if (ele.checked) {\r\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: ele.value || \"1px solid rgb(0,0,0)\"});\r\n            }\r\n         else {\r\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: \"\"});\r\n            }\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SettingsControls.Controls.BorderSide = {\r\n   SetValue: SocialCalc.SettingsControls.BorderSideSetValue,\r\n   GetValue: SocialCalc.SettingsControls.BorderSideGetValue,\r\n   OnClick: SocialCalc.SettingsControls.ColorComboOnClick,\r\n   Initialize: SocialCalc.SettingsControls.BorderSideInitialize,\r\n   InitialData: {thickness: \"1 pixel:1px\", style: \"Solid:solid\"},\r\n   ChangedCallback: null\r\n   }\r\n\r\n\r\nSocialCalc.SettingControlReset = function() {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ctrlname;\r\n\r\n   for (ctrlname in sc.Controls) {\r\n      if (sc.Controls[ctrlname].OnReset) sc.Controls[ctrlname].OnReset(ctrlname);\r\n      }\r\n   }\r\n\r\n\r\n/**********************\r\n*\r\n* CtrlSEditor implementation for editing SocialCalc.OtherSaveParts\r\n*\r\n*/\r\n\r\nSocialCalc.OtherSaveParts = {}; // holds other parts to save - must be set when loaded if you want to keep\r\n\r\nSocialCalc.CtrlSEditor = function(whichpart) {\r\n\r\n   var strtoedit, partname;\r\n   if (whichpart.length > 0) {\r\n      strtoedit = SocialCalc.special_chars(SocialCalc.OtherSaveParts[whichpart] || \"\");\r\n      }\r\n   else {\r\n      strtoedit = \"Listing of Parts\\n\";\r\n      for (partname in SocialCalc.OtherSaveParts) {\r\n         strtoedit += SocialCalc.special_chars(\"\\nPart: \"+partname+\"\\n=====\\n\"+SocialCalc.OtherSaveParts[partname]+\"\\n\");\r\n         }\r\n      }\r\n   var editbox = document.createElement(\"div\");\r\n   editbox.style.cssText = \"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\";\r\n   editbox.id = \"socialcalc-editbox\";\r\n   editbox.innerHTML = whichpart+'<br><br><textarea id=\"socialcalc-editbox-textarea\" style=\"width:250px;height:200px;\">'+\r\n      strtoedit + '</textarea><br><br><input type=button ' +\r\n      'onclick=\"SocialCalc.CtrlSEditorDone (\\'socialcalc-editbox\\', \\''+whichpart+'\\');\" value=\"OK\">';\r\n   document.body.appendChild(editbox);\r\n\r\n   var ebta = document.getElementById(\"socialcalc-editbox-textarea\");\r\n   ebta.focus();\r\n   SocialCalc.CmdGotFocus(ebta);\r\n\r\n   }\r\n\r\nSocialCalc.CtrlSEditorDone = function(idprefix, whichpart) {\r\n\r\n   var edittextarea = document.getElementById(idprefix+\"-textarea\");\r\n   var text = edittextarea.value;\r\n   if (whichpart.length > 0) {\r\n      if (text.length > 0) {\r\n         SocialCalc.OtherSaveParts[whichpart] = text;\r\n         }\r\n      else {\r\n         delete SocialCalc.OtherSaveParts[whichpart];\r\n         }\r\n      }\r\n\r\n   var editbox = document.getElementById(idprefix);\r\n   SocialCalc.KeyboardFocus();\r\n   editbox.parentNode.removeChild(editbox);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalcViewer\r\n//\r\n/*\r\n// The code module of the SocialCalc package that lets you embed a spreadsheet viewer\r\n// with an optional simple toolbar into a web page.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n*/\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript SpreadsheetViewer.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the SpreadsheetViewer is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) {\r\n      alert(\"Main SocialCalc code module needed\");\r\n      SocialCalc = {};\r\n      }\r\n   if (!SocialCalc.TableEditor) {\r\n      alert(\"SocialCalc TableEditor code module needed\");\r\n      }\r\n\r\n// *************************************\r\n//\r\n// SpreadsheetViewer class:\r\n//\r\n// *************************************\r\n\r\n// Global constants:\r\n\r\n   SocialCalc.CurrentSpreadsheetViewerObject = null; // right now there can only be one active at a time\r\n\r\n\r\n// Constructor:\r\n\r\nSocialCalc.SpreadsheetViewer = function(idPrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.parentNode = null;\r\n   this.spreadsheetDiv = null;\r\n   this.requestedHeight = 0;\r\n   this.requestedWidth = 0;\r\n   this.requestedSpaceBelow = 0;\r\n   this.height = 0;\r\n   this.width = 0;\r\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\r\n\r\n   // Dynamic properties:\r\n\r\n   this.sheet = null;\r\n   this.context = null;\r\n   this.editor = null;\r\n\r\n   this.spreadsheetDiv = null;\r\n   this.editorDiv = null;\r\n\r\n   this.sortrange = \"\"; // remembered range for sort tab\r\n\r\n   // Constants:\r\n\r\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\r\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\r\n\r\n   this.statuslineheight = scc.SVStatuslineheight; // in pixels\r\n   this.statuslineCSS = scc.SVStatuslineCSS;\r\n\r\n   // Callbacks:\r\n\r\n   // Initialization Code:\r\n\r\n   this.sheet = new SocialCalc.Sheet();\r\n   this.context = new SocialCalc.RenderContext(this.sheet);\r\n   // eddy SpreadsheetViewer {\r\n   if(SocialCalc._app == true || SocialCalc._view == true) scc.defaultImagePrefix = this.imagePrefix = \"../\"+ this.imagePrefix;\r\n   if(SocialCalc._app == true) {\r\n     this.context.showGrid= false; \r\n     this.context.showRCHeaders= false;\r\n     this.context.highlightTypes.range.style = \"\"; // no cell highlighting in app mode\r\n     \r\n     // Loading Message - add to cell A1 - shows when app is loading a large sheet or from a slow server\r\n     this.context.sheetobj.cells[\"A1\"] = new SocialCalc.Cell(\"A1\");\r\n     this.context.sheetobj.cells[\"A1\"].displaystring = \"Loading ... \"; // will display until recalc issues a render request - auto reset by recalc on load\r\n     \r\n   } else {\r\n     this.context.showGrid= true; \r\n     this.context.showRCHeaders= true;     \r\n   }\r\n   // } SpreadsheetViewer\r\n   this.editor = new SocialCalc.TableEditor(this.context);\r\n   this.editor.noEdit = true;\r\n   this.editor.StatusCallback.statusline =\r\n      {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\r\n       params: {}};\r\n   this.hasStatusLine = true; // default\r\n//   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td><a href=\"\">Will&nbsp;be&nbsp;link</a></td></tr></table>';\r\n   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td>&nbsp;</td></tr></table>';\r\n   this.statuslineFull = true;\r\n   this.noRecalc = true; // don't do a recalc when loaded, so no need for external sheet routines\r\n\r\n   // Repeating macro info\r\n\r\n   this.repeatingMacroTimer = null;\r\n   this.repeatingMacroInterval = 60; // default to 60 seconds\r\n   this.repeatingMacroCommands = \"\"; // what to execute\r\n\r\n\r\n   SocialCalc.CurrentSpreadsheetViewerObject = this; // remember this for rendezvousing on events\r\n\r\n   return;\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer =\r\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetViewer(this, node, height, width, spacebelow);};\r\nSocialCalc.SpreadsheetViewer.prototype.LoadSave = function(str) {return SocialCalc.SpreadsheetViewerLoadSave(this, str);};\r\nSocialCalc.SpreadsheetViewer.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\r\nSocialCalc.SpreadsheetViewer.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\r\nSocialCalc.SpreadsheetViewer.prototype.DecodeSpreadsheetSave = \r\n   function(str) {return SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(this, str);};\r\n\r\n// Sheet Methods to make things a little easier:\r\n\r\nSocialCalc.SpreadsheetViewer.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\r\n\r\n\r\n// Functions:\r\n\r\n//\r\n// InitializeSpreadsheetViewer(spreadsheet, node, height, width, spacebelow)\r\n//\r\n// Creates the control elements and makes them the child of node (string or element).\r\n// If present, height and width specify size.\r\n// If either is 0 or null (missing), the maximum that fits on the screen\r\n// (taking spacebelow into account) is used.\r\n//\r\n// You should do a redisplay or recalc (which redisplays) after running this.\r\n//\r\n\r\nSocialCalc.InitializeSpreadsheetViewer = function(spreadsheet, node, height, width, spacebelow) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var html, child, i, vname, v, style, button, bele;\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   spreadsheet.requestedHeight = height;\r\n   spreadsheet.requestedWidth = width;\r\n   spreadsheet.requestedSpaceBelow = spacebelow;\r\n\r\n   if (typeof node == \"string\") node = document.getElementById(node);\r\n\r\n   if (node == null) {\r\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\r\n      }\r\n\r\n   spreadsheet.parentNode = node;\r\n\r\n   // create node to hold spreadsheet view\r\n\r\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\r\n\r\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\r\n\r\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\r\n      node.removeChild(child);\r\n      }\r\n\r\n   node.appendChild(spreadsheet.spreadsheetDiv);\r\n\r\n   // create sheet div\r\n\r\n   spreadsheet.nonviewheight = spreadsheet.hasStatusLine ? spreadsheet.statuslineheight : 0;\r\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\r\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\r\n\r\n   // create statusline\r\n\r\n   if (spreadsheet.hasStatusLine) {\r\n      spreadsheet.statuslineDiv = document.createElement(\"div\");\r\n      spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\r\n      spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\r\n         (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\r\n         (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\r\n      spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\r\n      spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\r\n      spreadsheet.editor.StatusCallback.statusline =\r\n         {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\r\n          params: {spreadsheetobj:spreadsheet}};\r\n      }\r\n\r\n   // eddy InitializeSpreadsheetViewer {\r\n   if(SocialCalc._app == true) {\r\n     spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\");\r\n     // remove callback to stop drawing of table.\r\n     spreadsheet.formDataViewer.sheet.statuscallback = null;\r\n     // setup app viewer object\r\n     SocialCalc.CurrentSpreadsheetViewerObject = spreadsheet;\r\n   }\r\n   \r\n   // done - refresh screen needed\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetViewerLoadSave = function(spreadsheet, savestr) {\r\n\r\n   var rmstr, pos, t, t2;\r\n\r\n   var parts = spreadsheet.DecodeSpreadsheetSave(savestr);\r\n   if (parts) {\r\n      if (parts.sheet) {\r\n         spreadsheet.sheet.ResetSheet();\r\n         spreadsheet.sheet.ParseSheetSave(savestr.substring(parts.sheet.start, parts.sheet.end));\r\n         }\r\n      if (parts.edit) {\r\n         spreadsheet.editor.LoadEditorSettings(savestr.substring(parts.edit.start, parts.edit.end));\r\n         }\r\n      if (parts.startupmacro) { // executed now\r\n         spreadsheet.editor.EditorScheduleSheetCommands(savestr.substring(parts.startupmacro.start, parts.startupmacro.end), false, true);\r\n         }\r\n      if (parts.repeatingmacro) { // first line tells how many seconds before first execution. Last cmd must be \"cmdextension repeatmacro delay\" to continue repeating.\r\n         rmstr = savestr.substring(parts.repeatingmacro.start, parts.repeatingmacro.end);\r\n         rmstr = rmstr.replace(\"\\r\", \"\"); // make sure no CR, only LF\r\n         pos = rmstr.indexOf(\"\\n\");\r\n         if (pos > 0) {\r\n            t = rmstr.substring(0, pos)-0; // get number\r\n            t2 = t;\r\n//            if (!(t > 0)) t = 60; // handles NAN, too\r\n            spreadsheet.repeatingMacroInterval = t;\r\n            spreadsheet.repeatingMacroCommands = rmstr.substring(pos+1);\r\n            if (t2 > 0) { // zero means don't start yet\r\n               spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\r\n               }\t\r\n            }\r\n         }\r\n      }\r\n   if (spreadsheet.editor.context.sheetobj.attribs.recalc==\"off\" || spreadsheet.noRecalc) {\r\n      spreadsheet.editor.ScheduleRender();\r\n      }\r\n   else {\r\n      spreadsheet.editor.EditorScheduleSheetCommands(\"recalc\");\r\n      }\r\n   }\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerDoRepeatingMacro\r\n//\r\n// Called by a timer. Executes repeatingMacroCommands once.\r\n// Use the \"startcmdextension repeatmacro delay\" command last to schedule this again.\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDoRepeatingMacro = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   spreadsheet.repeatingMacroTimer = null;\r\n\r\n   SocialCalc.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro = {func:SocialCalc.SpreadsheetViewerRepeatMacroCommand, data:null};\r\n\r\n   editor.EditorScheduleSheetCommands(spreadsheet.repeatingMacroCommands);\r\n\r\n}\r\n\r\nSocialCalc.SpreadsheetViewerRepeatMacroCommand = function(name, data, sheet, cmd, saveundo) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n\r\n   var rest = cmd.RestOfString();\r\n   var t = rest-0; // get number\r\n   if (!(t > 0)) t = spreadsheet.repeatingMacroInterval; // handles NAN, too, using last value\r\n   spreadsheet.repeatingMacroInterval = t;\r\n\r\n   spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\r\n\r\n}\r\n\r\nSocialCalc.SpreadsheetViewerStopRepeatingMacro = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n\r\n   if (spreadsheet.repeatingMacroTimer) {\r\n      window.clearTimeout(spreadsheet.repeatingMacroTimer);\r\n      spreadsheet.repeatingMacroTimer = null;\r\n      }\r\n}\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerDoButtonCmd(e, buttoninfo, bobj)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDoButtonCmd = function(e, buttoninfo, bobj) {\r\n\r\n   var obj = bobj.element;\r\n   var which = bobj.functionobj.command;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   switch (which) {\r\n      case \"recalc\":\r\n         editor.EditorScheduleSheetCommands(\"recalc\");\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   if (obj && obj.blur) obj.blur();\r\n   SocialCalc.KeyboardFocus();   \r\n\r\n   }\r\n\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeString(str)\r\n//\r\n// SocialCalc function to make localization easier.\r\n// If str is \"Text to localize\", it returns\r\n// SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n//\r\n\r\nSocialCalc.LocalizeString = function(str) {\r\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\r\n   if (!cstr) { // no - look up\r\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\r\n      SocialCalc.LocalizeStringList[str] = cstr;\r\n      }\r\n   return cstr;\r\n   }\r\n\r\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeSubstrings(str)\r\n//\r\n// SocialCalc function to make localization easier using %loc and %scc.\r\n//\r\n// Replaces sections of str with:\r\n//    %loc!Text to localize!\r\n// with SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n// Uses SocialCalc.LocalizeString for this.\r\n//\r\n// Replaces sections of str with:\r\n//    %ssc!constant-name!\r\n// with SocialCalc.Constants.constant-name.\r\n// If the constant doesn't exist, throws and alert.\r\n//\r\n\r\nSocialCalc.LocalizeSubstrings = function(str) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\r\n      if (t==\"ssc\") {\r\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\r\n         }\r\n      else {\r\n         return SCLoc(c);\r\n         }\r\n      });\r\n\r\n   }\r\n\r\n//\r\n// obj = GetSpreadsheetViewerObject()\r\n//\r\n// Returns the current spreadsheet view object\r\n//\r\n\r\nSocialCalc.GetSpreadsheetViewerObject = function() {\r\n\r\n   var csvo = SocialCalc.CurrentSpreadsheetViewerObject;\r\n   if (csvo) return csvo;\r\n\r\n   throw (\"No current SpreadsheetViewer object.\");\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoOnResize(spreadsheet)\r\n//\r\n// Processes an onResize event, setting the different views.\r\n//\r\n\r\nSocialCalc.DoOnResize = function(spreadsheet) {\r\n\r\n   var v;\r\n   var views = spreadsheet.views;\r\n\r\n   var needresize = spreadsheet.SizeSSDiv();\r\n   if (!needresize) return;\r\n\r\n   for (vname in views) {\r\n      v = views[vname].element;\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\r\n      }\r\n\r\n   if(SocialCalc._app) return; // app has no scroll bars and keep normal HTML style page scroll - for mobile\r\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\r\n\r\n   }\r\n\r\n\r\n//\r\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\r\n//\r\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\r\n// Sets ssdiv to that.\r\n// Return true if different than existing values.\r\n//\r\n\r\nSocialCalc.SizeSSDiv = function(spreadsheet) {\r\n\r\n   var sizes, pos, resized, nodestyle, newval;\r\n   var fudgefactorX = 10; // for IE\r\n   var fudgefactorY = 10;\r\n\r\n   resized = false;\r\n\r\n   sizes = SocialCalc.GetViewportInfo();\r\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\r\n   pos.bottom = 0;\r\n   pos.right = 0;\r\n\r\n   nodestyle = spreadsheet.parentNode.style;\r\n\r\n   if (nodestyle.marginTop) {\r\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginBottom) {\r\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginLeft) {\r\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginRight) {\r\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\r\n      }\r\n\r\n   newval = spreadsheet.requestedHeight ||\r\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\r\n               (spreadsheet.requestedSpaceBelow || 0);\r\n   if (spreadsheet.height != newval) {\r\n      spreadsheet.height = newval;\r\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\r\n      resized = true;\r\n      }\r\n   newval = spreadsheet.requestedWidth ||\r\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\r\n   if (spreadsheet.width != newval) {\r\n      spreadsheet.width = newval;\r\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\r\n      resized = true;\r\n      }\r\n\r\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\r\n\r\n   return resized;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerStatuslineCallback\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerStatuslineCallback = function(editor, status, arg, params) {\r\n\r\n   var spreadsheet = params.spreadsheetobj;\r\n   var slstr = \"\";\r\n\r\n   if (spreadsheet && spreadsheet.statuslineDiv) {\r\n      if (spreadsheet.statuslineFull) {\r\n         slstr = editor.GetStatuslineString(status, arg, params);\r\n         }\r\n      else {\r\n         slstr = editor.ecell.coord;\r\n         }\r\n      slstr = spreadsheet.statuslineHTML.replace(/\\{status\\}/, slstr);\r\n      spreadsheet.statuslineDiv.innerHTML = slstr;\r\n      }\r\n\r\n   switch (status) {\r\n      case \"cmdendnorender\":\r\n      case \"calcfinished\":\r\n      case \"doneposcalc\":\r\n         break; // not updating Recalc button since no toolbar\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.CmdGotFocus(obj)\r\n//\r\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\r\n//\r\n\r\nSocialCalc.CmdGotFocus = function(obj) {\r\n\r\n   SocialCalc.Keyboard.passThru = obj;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetViewerCreateSheetHTML(spreadsheet)\r\n//\r\n// Returns the HTML representation of the whole spreadsheet\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerCreateSheetHTML = function(spreadsheet) {\r\n\r\n   var context, div, ele;\r\n\r\n   var result = \"\";\r\n\r\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\r\n   div = document.createElement(\"div\");\r\n   ele = context.RenderSheet(null, {type: \"html\"});\r\n   div.appendChild(ele);\r\n   delete context;\r\n   result = div.innerHTML;\r\n   delete ele;\r\n   delete div;\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n///////////////////////\r\n//\r\n// LOAD ROUTINE\r\n//\r\n///////////////////////\r\n\r\n//\r\n// parts = SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(spreadsheet, str)\r\n//\r\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\r\n//\r\n//    {type1: {start: startpos, end: endpos}, type2:...}\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDecodeSpreadsheetSave = function(spreadsheet, str) {\r\n\r\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\r\n   var parts = {};\r\n   var partlist = [];\r\n\r\nvar hasreturnonly = /[^\\n]\\r[^\\n]/;\r\nif (hasreturnonly.test(str)) {\r\nstr = str.replace(/([^\\n])\\r([^\\n])/g, \"$1\\r\\n$2\");\r\n}\r\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\r\n   if (pos1 < 0) return parts;\r\n\r\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\r\n   mpregex.lastIndex = pos1;\r\n\r\n   searchinfo = mpregex.exec(str);\r\n   if (mpregex.lastIndex <= 0) return parts;\r\n   boundary = searchinfo[1];\r\n\r\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\r\n   boundaryregex.lastIndex = mpregex.lastIndex;\r\n\r\n   searchinfo = boundaryregex.exec(str); // find header top boundary\r\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\r\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\r\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\r\n   if (!searchinfo) return parts;\r\n   start = blanklineregex.lastIndex;\r\n   boundaryregex.lastIndex = start;\r\n   searchinfo = boundaryregex.exec(str); // find end of header\r\n   if (!searchinfo) return parts;\r\n   ending = searchinfo.index;\r\n\r\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      p = line.split(\":\");\r\n      switch (p[0]) {\r\n         case \"version\":\r\n            break;\r\n         case \"part\":\r\n            partlist.push(p[1]);\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\r\n      blanklineregex.lastIndex = ending;\r\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\r\n      if (!searchinfo) return parts;\r\n      start = blanklineregex.lastIndex;\r\n      if (pnum==partlist.length-1) { // last one has different boundary\r\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\r\n         }\r\n      boundaryregex.lastIndex = start;\r\n      searchinfo = boundaryregex.exec(str); // find ending boundary\r\n      if (!searchinfo) return parts;\r\n      ending = searchinfo.index;\r\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\r\n      }\r\n\r\n   return parts;\r\n\r\n   }\r\n\r\n\r\n// END OF FILE\r\n\r\nif('undefined' === typeof document) {\r\n  // We don't really need a DOM-based presentation layer on the server\r\n  SocialCalc.GetEditorCellElement = function () {};\r\n  SocialCalc.ReplaceCell = function () {};\r\n  SocialCalc.EditorRenderSheet = function () {};\r\n  SocialCalc.SpreadsheetControlSortSave = function () { return \"\" };\r\n  SocialCalc.SpreadsheetControlStatuslineCallback = function () {};\r\n  SocialCalc.DoPositionCalculations = function (editor) {\r\n      SocialCalc.EditorSheetStatusCallback(\r\n\t  null, \"doneposcalc\", null, editor\r\n      );\r\n  }\r\n}\r\n\r\n// Compatibility with webworker-threads\r\nif (typeof self !== 'undefined' && self.thread) {\r\n    window.setTimeout = function (cb, ms) {\r\n        if (ms <= 1) { self.thread.nextTick(cb); }\r\n    };\r\n    window.clearTimeout = function () {};\r\n}\r\n\r\n    // Just return a value to define the module export.\r\n    return SocialCalc;\r\n}));\r\n","(function() {\r\n\r\nClass = function(classDefinition, classWrapper) {\r\n    if (!classDefinition) throw(\"Class requires a class definition string as its first argument\");\r\n    if (!classWrapper) throw(\"Class requires a class wrapper function as its second argument\");\r\n\r\n    if (! classDefinition.match(/^([\\w\\.]+)(?:\\(\\s*([\\w\\.]+)\\s*\\))?(?:\\s+(.*?)\\s*)?$/))\r\n        throw(\"Can't parse Class Definition: '\" + classDefinition + \"'\");\r\n    var className = RegExp.$1;\r\n    var baseClassName = RegExp.$2 || '';\r\n    var options = [];\r\n    if (RegExp.$3) {\r\n        options = RegExp.$3.split(/\\s+/);\r\n    }\r\n    var incValues = [];\r\n    var strict = true;\r\n    for (var i = 0, l = options.length; i < l; i++) {\r\n        var option = options[i];\r\n        if (option == '-nostrict') {\r\n            strict = false;\r\n        }\r\n        if (option.match(/^-inc=(.+)$/)) {\r\n            incValues = RegExp.$1.split(',');\r\n        }\r\n    }\r\n\r\n    var parts = className.split('.');\r\n    var klass = Class.global;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        if (! klass[parts[i]]) {\r\n            klass[parts[i]] = function() {\r\n                try { this.init() } catch(e) {}\r\n            };\r\n        }\r\n        klass = klass[parts[i]];\r\n    }\r\n    klass.className = className;\r\n\r\n    klass.isa = function(baseName) {\r\n        klass.baseClassName = baseName;\r\n        if (baseName) {\r\n            klass.prototype = eval('new ' + baseName + '()');\r\n            klass.prototype.superFunc = function(name) {\r\n                return eval(baseName).prototype[name];\r\n            }\r\n        }\r\n    };\r\n    klass.isa(baseClassName);\r\n\r\n    klass.global = Class.global;\r\n\r\n    klass.addGlobal = function() {\r\n        this.newGlobals++;\r\n        return Class.global;\r\n    }\r\n\r\n    klass.extend = function(pairs) {\r\n        if (typeof pairs != 'object') {\r\n            throw(\"extend requires an object of name:value pairs\");\r\n        }\r\n        for (var name in pairs) {\r\n            klass.prototype[name] = pairs[name];\r\n        }\r\n    }\r\n\r\n    for (var ii = 0, ll = incValues.length; ii < ll; ii++) {\r\n        var value = incValues[ii];\r\n        if (value == 'proto') {\r\n            incValues[ii] = klass.prototype;\r\n        }\r\n        else if (value == 'this') {\r\n            incValues[ii] = klass;\r\n        }\r\n        else {\r\n            incValues[ii] = Class.global[value];\r\n        }\r\n    }\r\n\r\n    if (strict) {\r\n        Class.eval_strict(classWrapper, klass, incValues);\r\n    }\r\n    else {\r\n        classWrapper.apply(klass, incValues);\r\n    }\r\n\r\n    return klass;\r\n};\r\n\r\n})();\r\n\r\nClass.global = this;\r\n\r\nClass.eval_strict = function(classWrapper, klass, incValues) {\r\n    var globals = 0;\r\n    var last_key;\r\n\r\n    for (var k in Class.global) {\r\n        globals++;\r\n        last_key = k;\r\n    }\r\n\r\n    klass.newGlobals = 0;\r\n\r\n    classWrapper.apply(klass, incValues);\r\n\r\n    var globals_after = 0;\r\n    for (var k in Class.global) {\r\n        globals_after++;\r\n    }\r\n\r\n    if (globals + klass.newGlobals != globals_after) {\r\n        throw(\"Class '\" + klass.className + \"' defines \" + (globals_after - globals) + \" new global JavaScript variables without using this.addGlobal()\");\r\n    }\r\n\r\n    delete klass.newGlobals;\r\n};\r\n\r\n","Class('Document.Emitter', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Emitter';\r\n\r\nproto.instantiate = function() {\r\n    return eval('new ' + this.className + '()');\r\n}\r\n\r\nproto.init = function() {\r\n    this.output = '';\r\n}\r\n\r\nproto.content = function() {\r\n    return this.output;\r\n}\r\n\r\nproto.insert = function(receiver) {\r\n    this.output += receiver.output;\r\n}\r\n\r\n});\r\n","Class('Document.Emitter.HTML(Document.Emitter)', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Emitter.HTML';\r\n\r\nproto.begin_node = function(node) {\r\n    var tag = node.type;\r\n    switch (tag) {\r\n        case 'asis': case 'line': return;\r\n        case 'br': case 'hr': {\r\n            this.output += '<'+tag+' />';\r\n            return;\r\n        }\r\n        case 'html': {\r\n            this.output += '<span class=\"wafl\">Raw HTML section. Edit in Wiki Text mode.</span>';\r\n            return;\r\n        }\r\n        case 'waflparagraph': case 'waflphrase': case 'im': {\r\n            if (node._wafl.match(/^image:\\s*(\\S+)(?:\\s+size=(\\w+))?/)) {\r\n                var onload = \"if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/\"+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+\"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'\";\r\n\r\n                var imageName = RegExp.$1;\r\n                var width = RegExp.$2;\r\n                switch (width) {\r\n                    case 'small':  { width = '100'; break; }\r\n                    case 'medium': { width = '300'; break; }\r\n                    case 'large':  { width = '600'; break; }\r\n                }\r\n                if (width) {\r\n                    width = ' width=\"'+width+'\"';\r\n                }\r\n                this.output += '<img src=\"'+imageName.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")+'\" onload=\"'+onload+'\"'+width+' />';\r\n                return;\r\n            }\r\n            this.output += '<span class=\"wafl\">'+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+'</span>';\r\n\r\n            return;\r\n        }\r\n        case 'a': case 'wikilink': {\r\n            this.output += '<a href=\"'+encodeURI(node._href)+'\">';\r\n            return;\r\n        }\r\n        case 'file': {\r\n            this.output += '<a title=\"(network resource)\" href=\"'+encodeURI(node._href)+'\">';\r\n            return;\r\n        }\r\n        case 'ul': case 'ol': case 'table': case 'tr': {\r\n            this.output += '<'+tag+\">\\n\";\r\n            return;\r\n        }\r\n        default: {\r\n            this.output += '<'+tag+'>';\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\nproto.end_node = function(node) {\r\n    var tag = node.type;\r\n    switch (tag) {\r\n        case 'asis': case 'br': case 'hr': case 'html': case 'waflparagraph': case 'waflphrase': case 'im': return;\r\n        case 'line': {\r\n            this.output += '<br />';\r\n            return;\r\n        }\r\n        case 'file': case 'wikilink': {\r\n            this.output += '</a>';\r\n            return;\r\n        }\r\n        default: {\r\n            if (tag.search(/^(?:p|ul|ol|li|h\\d|table|tr|td)$/) == 0) {\r\n                this.output += '</'+tag+\">\\n\";\r\n            }\r\n            else {\r\n                this.output += '</'+tag+'>';\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    return;\r\n}\r\n\r\nproto.text_node = function(text) {\r\n    this.output += text\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&apos;');\r\n}\r\n\r\n});\r\n","Class('Document.Parser', function() {\r\n\r\nvar proto = this.prototype;\r\n\r\nproto.className = 'Document.Parser';\r\n\r\nproto.init = function() {}\r\n\r\nproto.parse = function(input, receiver) {\r\n    this.input = (input.search(/\\n$/) == -1) ? input+\"\\n\" : input;\r\n    if (receiver) this.receiver = receiver;\r\n    this.receiver.init();\r\n    this.grammar = this.create_grammar();\r\n    this.parse_blocks('top');\r\n    return this.receiver.content();\r\n}\r\n\r\nproto.create_grammar = function() {\r\n    throw \"Please define create_grammar in a derived class of Document.Parser.\";\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// Parse input into a series of blocks. With each iteration the parser must\r\n// match a block at position 0 of the text, and remove that block from the\r\n// input reparse it further. This continues until there is no input left.\r\n//------------------------------------------------------------------------------\r\nproto.parse_blocks = function(container_type) {\r\n    var types = this.grammar[container_type].blocks; // Document.contains[container_type];\r\n    if (!types) return;\r\n    while (this.input.length) {\r\n        var length = this.input.length;\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            var matched = this.find_match('matched_block', type);\r\n            if (matched) {\r\n                this.input = this.input.substr(matched.end);\r\n                this.handle_match(type, matched);\r\n                break;\r\n            }\r\n        }\r\n        if (this.input.length >= length)\r\n            throw this.classname + ': Reduction error for:\\n' + this.input +\r\n            '\\n' + JSON.stringify(this);\r\n    }\r\n    return;\r\n}\r\n\r\nproto.handle_match = function(type, match) {\r\n    var grammar = this.grammar[type];\r\n    var parse = grammar.blocks ? 'parse_blocks' : 'parse_phrases';\r\n    // console.log(\"Subparsing \" + parse + '(' + type + '): ');\r\n    // console.log(match);\r\n    this.subparse(parse, match, type, grammar.filter);\r\n}\r\n\r\nproto.find_match = function(matched_func, type) {\r\n    var re = this.grammar[type].match;\r\n    if (!re) throw 'no regexp for type: ' + type;\r\n    var capture = this.input.match(re);\r\n    if (capture) {\r\n        // console.log(\"Found match \" + type + \" - \" + matched_func);\r\n        var match = this[matched_func].call(this, capture, this.grammar[type].lookbehind);\r\n        match.type = this.grammar[type].type || type;\r\n        // console.log(match);\r\n        return match;\r\n    }\r\n    return;\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// This code parses a chunk into interleaved pieces of plain text and\r\n// phrases. It repeatedly tries to match every possible phrase and\r\n// then takes the match closest to the start. Everything before a\r\n// match is written as text. Matched phrases are subparsed according\r\n// to their rules. This continues until the input is all eaten.\r\n//------------------------------------------------------------------------------\r\nproto.parse_phrases = function(container_type) {\r\n    var types = this.grammar[container_type].phrases;\r\n    if (!types) { this.receiver.text_node(this.input || ''); return }\r\n    // console.log(\"INPUT: \" + this.input);\r\n    while (this.input.length) {\r\n        var match = null;\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            var matched = this.find_match('matched_phrase', type);\r\n            if (! matched) continue;\r\n\r\n            if (!match || (matched.begin < match.begin)) {\r\n                match = matched;\r\n                if (match.begin == 0) break;\r\n            }\r\n        }\r\n        if (!match) {\r\n            // console.log(\"NO MATCH: \" + this.input);\r\n            this.receiver.text_node(this.input || '');\r\n            break;\r\n        }\r\n        if (match.begin != 0) {\r\n            // console.log(\"MATCH OFFSET:\" + this.input + \" (\" + match.type + \")\" + match.begin);\r\n            this.receiver.text_node(this.input.substr(0, match.begin) || '');\r\n            }\r\n        this.input = this.input.substr(match.end);\r\n        this.handle_match(match.type, match);\r\n    }\r\n    return;\r\n}\r\n\r\nproto.subparse = function(func, match, type, filter) {\r\n    /* The call could cause side effects to the match object. */\r\n    match.type = this.grammar[type].type;\r\n    if (match.type == null) match.type = type;\r\n\r\n    var filtered_text = filter ? filter(match) : null;\r\n\r\n    if (match.type) this.receiver.begin_node(match);\r\n\r\n    var parser = eval('new ' + this.className + '()');\r\n\r\n    parser.input = (filtered_text == null) ? match.text : filtered_text;\r\n    parser.grammar = this.grammar;\r\n    parser.receiver = this.receiver.instantiate();\r\n    // console.log(\"SEEDED: (\" + type + \")\" + parser.input);\r\n    parser[func].call(parser, type);\r\n    this.receiver.insert(parser.receiver);\r\n\r\n    if (match.type) this.receiver.end_node(match);\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Helper functions\r\n//\r\n// These are the odds and ends called by the code above.\r\n//------------------------------------------------------------------------------\r\n\r\n/* Blocks has no lookbehinds, so:\r\n * All match begins at 0. The first capture is text; the next ones are various parts.\r\n */\r\nproto.matched_block = function(capture) {\r\n    return {\r\n        begin: capture.index,\r\n        text: capture[1],\r\n        end: capture[0].length,\r\n        1: capture[2],\r\n        2: capture[3],\r\n        3: capture[4]\r\n    };\r\n}\r\n\r\n/* The first capture in a Phrases is the lookbehind. So:\r\n */\r\nproto.matched_phrase = function(capture, lookbehind) {\r\n    if (lookbehind) {\r\n        var text = capture[2];\r\n        var begin = this.input.indexOf(capture[1]);\r\n        return {\r\n            text: text,\r\n            begin: begin,\r\n            end: (begin + capture[1].length),\r\n            1: RegExp.$2,\r\n            2: RegExp.$3,\r\n            3: RegExp.$4\r\n        };\r\n    }\r\n\r\n    return {\r\n        begin: capture.index,\r\n        text: capture[1],\r\n        end: capture.index + capture[0].length,\r\n        1: capture[2],\r\n        2: capture[3],\r\n        3: capture[4]\r\n    };\r\n}\r\n\r\n});\r\n","Class('Document.Parser.Wikitext(Document.Parser)', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Parser.Wikitext';\r\n\r\nproto.init = function() {}\r\n\r\nproto.create_grammar = function() {\r\n    var all_blocks = ['pre', 'html', 'hr', 'hx', 'waflparagraph', 'ul', 'ol', 'blockquote', 'p', 'empty', 'else'];\r\n\r\n    // Phrase TODO: im\r\n    var all_phrases = ['waflphrase', 'asis', 'wikilink', 'wikilink2', 'a', 'im', 'mail', 'file', 'tt', 'b', 'i', 'del', 'a'];\r\n\r\n    var re_huggy = function(brace1, brace2) {\r\n        brace2 = '\\\\' + (brace2 || brace1);\r\n        brace1 = '\\\\' + brace1;\r\n        return {\r\n            match: new RegExp('(?:^|[^'+brace1+'\\\\w])('+brace1+'(?=\\\\S)(?!'+brace2+')(.*?)'+brace2+'(?=[^'+brace2+'\\\\w]|$))'),\r\n            phrases: (brace1 == '\\\\`') ? null : all_phrases,\r\n            lookbehind: true\r\n        };\r\n    };\r\n\r\n    var im_types = {\r\n        yahoo: 'yahoo',\r\n        ymsgr: 'yahoo',\r\n        callto: 'callto',\r\n        callme: 'callto',\r\n        skype: 'callto',\r\n        aim: 'aim'\r\n    };\r\n\r\n    var im_label = {\r\n        aim: \"AIM: %1\",\r\n        yahoo: \"Yahoo: %1\",\r\n        callto: \"Skype: %1\"\r\n    };\r\n\r\n    var im_re = '(\\\\b(';\r\n    for (var key in im_types) {\r\n        im_re += key + '|';\r\n    }\r\n    im_re = im_re.replace(/\\|$/, ')\\\\:([^\\\\s\\\\>\\\\)]+))');\r\n\r\n    var re_list = function(bullet, filter_out) {\r\n        var exclusion = new RegExp('(^|\\n)' + filter_out + '\\ *', 'g');\r\n        return {\r\n            match: new RegExp(\r\n                \"^(\" + bullet + \"+\\ .*\\n\" +\r\n                \"(?:[\\*\\-\\+\\#]+\\ .*\\n)*\" +\r\n                \")(?:\\s*\\n)?\"\r\n            ),\r\n            blocks: ['ul', 'ol', 'subl', 'li'],\r\n            filter: function(node) {\r\n                return node.text.replace(exclusion, '$1');\r\n            }\r\n        };\r\n    };\r\n\r\n    return {\r\n        _all_blocks: all_blocks,\r\n        _all_phrases: all_phrases,\r\n        top: { blocks: all_blocks },\r\n        ol: re_list('#', '[*#]'),\r\n        ul: re_list('[-+*]', '[-+*#]'),\r\n        blockquote: {\r\n            match: /^((?:>[^\\n]*\\n)+)(?:\\s*\\n)?/,\r\n            blocks: ['blockquote', 'line'],\r\n            filter: function(node) { return node.text.replace(/(^|\\n)>\\ ?/g, '$1') }\r\n        },\r\n        line: {\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        subl: {\r\n            type: 'li',\r\n            match: /^(([^\\n]*)\\n[*#]+\\ [^\\n]*\\n(?:[*#]+\\ [^\\n]*\\n)*)(?:\\s*\\n)?/,\r\n            blocks: ['ul', 'ol', 'li2']\r\n        },\r\n        li: {\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        li2: {\r\n            type: '', // Do not emit begin/end node; just reparse\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        html: {\r\n            match: /^(\\.html\\ *\\n(?:[^\\n]*\\n)*?\\.html)\\ *\\n(?:\\s*\\n)?/,\r\n            filter: function(node) {\r\n                node._html = node.text;\r\n                return '';\r\n            }\r\n        },\r\n        pre: { match: /^\\.pre\\ *\\n((?:[^\\n]*\\n)*?)\\.pre\\ *\\n(?:\\s*\\n)?/ },\r\n        hr: { match: /^--+(?:\\s*\\n)?/ },\r\n        hx: {\r\n            match: /^((\\^+) *([^\\n]*?)(\\s+=+)?\\s*?\\n+)/,\r\n            phrases: all_phrases,\r\n            filter: function(node) {\r\n                node.type = 'h' + node['1'].length;\r\n                return node[2];\r\n            }\r\n        },\r\n        p: {\r\n            match: /^((?:(?!(?:(?:\\^+|\\#+|\\*+|\\-+) |\\>|\\.\\w+\\s*\\n|\\{[^\\}]+\\}\\s*\\n))[^\\n]*\\S[^\\n]*\\n)+(?:(?=^|\\n)\\s*\\n)*)/,\r\n            phrases: all_phrases,\r\n            filter: function(node) { return node.text.replace(/\\n$/, '') }\r\n        },\r\n        empty: {\r\n            match: /^(\\s*\\n)/,\r\n            filter: function(node) { node.type = '' }\r\n        },\r\n        'else': {\r\n            match: /^(([^\\n]*)\\n)/,\r\n            phrases: [],\r\n            filter: function(node) {\r\n                node.type = 'p';\r\n            }\r\n        },\r\n        waflparagraph: {\r\n            match: /^\\{(.*)\\}[\\ \\t]*\\n(?:\\s*\\n)?/,\r\n            filter: function(node) {\r\n                node._wafl = node._label = node.text;\r\n                // node._function = node._wafl.replace(/[: ].*/, '');;\r\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\r\n                return '';\r\n            }\r\n        },\r\n        waflphrase: {\r\n            match: /(?:^|[\\s\\-])((?:\"([^\\n]+?)\")?\\{([\\w-]+(?=[\\:\\ \\}])(?:\\s*:)?\\s*[^\\n]*?\\s*)\\}(?=[\\W_]|$))/,\r\n            filter: function(node) {\r\n                node._wafl = node[2];\r\n                node._label = node[1] || node._wafl;\r\n                // node._function = node._wafl.replace(/[: ].*/, '');;\r\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\r\n                return '';\r\n            },\r\n            lookbehind: true\r\n        },\r\n        asis: {\r\n            match: /(\\{\\{([^\\n]*?)\\}\\}(\\}*))/,\r\n            filter: function(node) {\r\n                node.type = '';\r\n                return(node[1] + node[2]);\r\n            }\r\n        },\r\n        wikilink: {\r\n            match: /(?:^|[_\\W])(\\[()(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\r\n            filter: function(node) {\r\n                node._href = '?' + node[2];\r\n                return(node.text || node[2]);\r\n            },\r\n            lookbehind: true\r\n        },\r\n        wikilink2: {\r\n            type: 'wikilink',\r\n            match: /(?:\"([^\"]*)\"\\s*)(\\[(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\r\n            filter: function(node) {\r\n                node._href = '?' + node[2];\r\n                return(node[1] || node[2]);\r\n            }\r\n        },\r\n        a: {\r\n            match: /((?:\"([^\"]*)\"\\s*)?<?((?:http|https|ftp|irc|file):(?:\\/\\/)?[\\;\\/\\?\\:\\@\\&\\=\\+\\$\\,\\[\\]\\#A-Za-z0-9\\-\\_\\.\\!\\~\\*\\'\\(\\)]+[A-Za-z0-9\\/#])>?)/,\r\n            filter: function(node) {\r\n                node._href = node[2];\r\n                return(node[1] || node[2]);\r\n            }\r\n        },\r\n        file: {\r\n            match: /((?:\"([^\"]*)\")?<(\\\\\\\\[^\\s\\>\\)]+)>)/,\r\n            filter: function(node) {\r\n                var href = node[2].replace(/^\\\\\\\\/, '');\r\n                node._href = \"file://\" + href.replace(/\\\\/g, '/');\r\n                return(node['1'] || href);\r\n            }\r\n        },\r\n        im: {\r\n            match: (new RegExp(im_re)),\r\n            filter: function(node) {\r\n                node._wafl = node[1] + ': ' + node[2];\r\n                node._label = (im_label[im_types[node[1]]] || '%1').replace(/%1/g, node[2]);\r\n                return '';\r\n            }\r\n        },\r\n        mail: {\r\n            match: /([\\w+%\\-\\.]+@(?:[\\w\\-]+\\.)+[\\w\\-]+)/,\r\n            filter: function(node) {\r\n                node.type = 'a';\r\n                node._href = \"mailto:\" + node.text.replace(/%/g, '%25');\r\n            }\r\n        },\r\n        tt: re_huggy('`'), // Special-cased in re_huggy above to disallow subphrases\r\n        b: re_huggy('*'),\r\n        i: re_huggy('_'),\r\n        del: re_huggy('-')\r\n    };\r\n};\r\n\r\n});\r\n","/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */\r\n!function(a,b){\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error(\"jQuery requires a window with a document\");return b(a)}:b(a)}(\"undefined\"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k=\"\".trim,l={},m=\"1.11.0\",n=function(a,b){return new n.fn.init(a,b)},o=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,p=/^-ms-/,q=/-([\\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:\"\",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for(\"boolean\"==typeof g&&(j=g,g=arguments[h]||{},h++),\"object\"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:\"jQuery\"+(m+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return\"function\"===n.type(a)},isArray:Array.isArray||function(a){return\"array\"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||\"object\"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,\"constructor\")&&!j.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?h[i.call(a)]||\"object\":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,\"ms-\").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call(\"\\ufeff\\xa0\")?function(a){return null==a?\"\":k.call(a)}:function(a){return null==a?\"\":(a+\"\").replace(o,\"\")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,\"string\"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return\"string\"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(a,b){h[\"[object \"+b+\"]\"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return\"function\"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:\"array\"===c||0===b||\"number\"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=\"sizzle\"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A=\"undefined\",B=1<<31,C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},J=\"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",K=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",L=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",M=L.replace(\"w\",\"w#\"),N=\"\\\\[\"+K+\"*(\"+L+\")\"+K+\"*(?:([*^$|!~]?=)\"+K+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+M+\")|)|)\"+K+\"*\\\\]\",O=\":(\"+L+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+N.replace(3,8)+\")*)|.*)\\\\)|)\",P=new RegExp(\"^\"+K+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+K+\"+$\",\"g\"),Q=new RegExp(\"^\"+K+\"*,\"+K+\"*\"),R=new RegExp(\"^\"+K+\"*([>+~]|\"+K+\")\"+K+\"*\"),S=new RegExp(\"=\"+K+\"*([^\\\\]'\\\"]*?)\"+K+\"*\\\\]\",\"g\"),T=new RegExp(O),U=new RegExp(\"^\"+M+\"$\"),V={ID:new RegExp(\"^#(\"+L+\")\"),CLASS:new RegExp(\"^\\\\.(\"+L+\")\"),TAG:new RegExp(\"^(\"+L.replace(\"w\",\"w*\")+\")\"),ATTR:new RegExp(\"^\"+N),PSEUDO:new RegExp(\"^\"+O),CHILD:new RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+K+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+K+\"*(?:([+-]|)\"+K+\"*(\\\\d+)|))\"+K+\"*\\\\)|)\",\"i\"),bool:new RegExp(\"^(?:\"+J+\")$\",\"i\"),needsContext:new RegExp(\"^\"+K+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+K+\"*((?:-\\\\d)?\\\\d*)\"+K+\"*\\\\)|)(?=[^-]|$)\",\"i\")},W=/^(?:input|select|textarea|button)$/i,X=/^h\\d$/i,Y=/^[^{]+\\{\\s*\\[native \\w/,Z=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,$=/[+~]/,_=/'|\\\\/g,ab=new RegExp(\"\\\\\\\\([\\\\da-f]{1,6}\"+K+\"?|(\"+K+\")|.)\",\"ig\"),bb=function(a,b,c){var d=\"0x\"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||\"string\"!=typeof a)return d;if(1!==(i=b.nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(g=b.getElementById(h),!g||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&\"object\"!==b.nodeName.toLowerCase()){m=ob(a),(p=b.getAttribute(\"id\"))?q=p.replace(_,\"\\\\$&\"):b.setAttribute(\"id\",q),q=\"[id='\"+q+\"'] \",j=m.length;while(j--)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(\",\")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute(\"id\")}}}return xb(a.replace(P,\"$1\"),b,d,e)}function eb(){var a=[];function b(c,e){return a.push(c+\" \")>d.cacheLength&&delete b[a.shift()],b[c+\" \"]=e}return b}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement(\"div\");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){var c=a.split(\"|\"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){var c=b.nodeName.toLowerCase();return\"input\"===c&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return(\"input\"===c||\"button\"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&typeof a.getElementsByTagName!==A&&a}c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?\"HTML\"!==b.nodeName:!1},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener(\"unload\",function(){k()},!1):g.attachEvent&&g.attachEvent(\"onunload\",function(){k()})),c.attributes=gb(function(a){return a.className=\"i\",!a.getAttribute(\"className\")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment(\"\")),!a.getElementsByTagName(\"*\").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML=\"<div class='a'></div><div class='a i'></div>\",a.firstChild.className=\"i\",2===a.getElementsByClassName(\"i\").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute(\"id\")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=typeof a.getAttributeNode!==A&&a.getAttributeNode(\"id\");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if(\"*\"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML=\"<select t=''><option selected=''></option></select>\",a.querySelectorAll(\"[t^='']\").length&&o.push(\"[*^$]=\"+K+\"*(?:''|\\\"\\\")\"),a.querySelectorAll(\"[selected]\").length||o.push(\"\\\\[\"+K+\"*(?:value|\"+J+\")\"),a.querySelectorAll(\":checked\").length||o.push(\":checked\")}),gb(function(a){var b=e.createElement(\"input\");b.setAttribute(\"type\",\"hidden\"),a.appendChild(b).setAttribute(\"name\",\"D\"),a.querySelectorAll(\"[name=d]\").length&&o.push(\"name\"+K+\"*[*^$|!~]?=\"),a.querySelectorAll(\":enabled\").length||o.push(\":enabled\",\":disabled\"),a.querySelectorAll(\"*,:x\"),o.push(\",.*:\")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,\"div\"),q.call(a,\"[s!='']:x\"),p.push(\"!=\",O)}),o=o.length&&new RegExp(o.join(\"|\")),p=p.length&&new RegExp(p.join(\"|\")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)k.unshift(c);while(h[d]===k[d])d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,\"='$1']\"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return db(b,l,null,[a]).length>0},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error(\"Syntax error, unrecognized expression: \"+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c=\"\",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if(\"string\"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||\"\").replace(ab,bb),\"~=\"===a[2]&&(a[3]=\" \"+a[3]+\" \"),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),\"nth\"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*(\"even\"===a[3]||\"odd\"===a[3])),a[5]=+(a[7]+a[8]||\"odd\"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(\")\",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return\"*\"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+\" \"];return b||(b=new RegExp(\"(^|\"+K+\")\"+a+\"(\"+K+\"|$)\"))&&w(a,function(a){return b.test(\"string\"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute(\"class\")||\"\")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?\"!=\"===b:b?(e+=\"\",\"=\"===b?e===c:\"!=\"===b?e!==c:\"^=\"===b?c&&0===e.indexOf(c):\"*=\"===b?c&&e.indexOf(c)>-1:\"$=\"===b?c&&e.slice(-c.length)===c:\"~=\"===b?(\" \"+e+\" \").indexOf(c)>-1:\"|=\"===b?e===c||e.slice(0,c.length+1)===c+\"-\":!1):!0}},CHILD:function(a,b,c,d,e){var f=\"nth\"!==a.slice(0,3),g=\"last\"!==a.slice(-4),h=\"of-type\"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?\"nextSibling\":\"previousSibling\",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p=\"only\"===a&&!o&&\"nextSibling\"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){k=q[s]||(q[s]={}),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}))[a]=[u,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error(\"unsupported pseudo: \"+a);return e[s]?e(b):e.length>1?(c=[a,a,\"\",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,\"$1\"));return d[s]?fb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return db(a,b).length>0}}),contains:fb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:fb(function(a){return U.test(a||\"\")||db.error(\"unsupported lang: \"+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do if(c=n?b.lang:b.getAttribute(\"xml:lang\")||b.getAttribute(\"lang\"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+\"-\");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&!!a.checked||\"option\"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&\"button\"===a.type||\"button\"===b},text:function(a){var b;return\"input\"===a.nodeName.toLowerCase()&&\"text\"===a.type&&(null==(b=a.getAttribute(\"type\"))||\"text\"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[0>c?c+b:c]}),even:lb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;function ob(a,b){var c,e,f,g,h,i,j,k=x[a+\" \"];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P,\" \")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d=\"\";c>b;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&\"parentNode\"===d,f=v++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[s]||(b[s]={}),(h=i[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function rb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||\"*\",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=sb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[\" \"],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return I.call(b,a)>-1},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>j;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){for(e=++j;f>e;e++)if(d.relative[a[e].type])break;return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({value:\" \"===a[j-2].type?\"*\":\"\"})).replace(P,\"$1\"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){var m,n,o,p=0,q=\"0\",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG(\"*\",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){n=0;while(o=a[n++])if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,f&&r.push(m))}if(p+=q,c&&q!==p){n=0;while(o=b[n++])o(r,s,g,i);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+\" \"];if(!f){b||(b=ob(a)),c=b.length;while(c--)f=ub(b[c]),f[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f};function wb(a,b,c){for(var d=0,e=b.length;e>d;d++)db(a,b[d],c);return c}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(i=m[0]=m[0].slice(0),i.length>2&&\"ID\"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b)return e;a=a.slice(i.shift().value.length)}h=V.needsContext.test(a)?0:i.length;while(h--){if(j=i[h],d.relative[k=j.type])break;if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),a=f.length&&pb(i),!a)return G.apply(e,f),e;break}}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return c.sortStable=s.split(\"\").sort(z).join(\"\")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement(\"div\"))}),gb(function(a){return a.innerHTML=\"<a href='#'></a>\",\"#\"===a.firstChild.getAttribute(\"href\")})||hb(\"type|href|height|width\",function(a,b,c){return c?void 0:a.getAttribute(b,\"type\"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML=\"<input/>\",a.firstChild.setAttribute(\"value\",\"\"),\"\"===a.firstChild.getAttribute(\"value\")})||hb(\"value\",function(a,b,c){return c||\"input\"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute(\"disabled\")})||hb(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[\":\"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,w=/^.[^:#\\[\\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if(\"string\"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return n.inArray(a,b)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=\":not(\"+a+\")\"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if(\"string\"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;e>b;b++)if(n.contains(d[b],this))return!0}));for(b=0;e>b;b++)n.find(a,d[b],c);return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+\" \"+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,\"string\"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,B=n.fn.init=function(a,b){var c,d;if(!a)return this;if(\"string\"==typeof a){if(c=\"<\"===a.charAt(0)&&\">\"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=z.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?\"undefined\"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};B.prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||\"string\"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?\"string\"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,\"parentNode\")},parentsUntil:function(a,b,c){return n.dir(a,\"parentNode\",c)},next:function(a){return E(a,\"nextSibling\")},prev:function(a){return E(a,\"previousSibling\")},nextAll:function(a){return n.dir(a,\"nextSibling\")},prevAll:function(a){return n.dir(a,\"previousSibling\")},nextUntil:function(a,b,c){return n.dir(a,\"nextSibling\",c)},prevUntil:function(a,b,c){return n.dir(a,\"previousSibling\",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,\"iframe\")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return\"Until\"!==a.slice(-5)&&(d=c),d&&\"string\"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var F=/\\S+/g,G={};function H(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a=\"string\"==typeof a?G[a]||H(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);\"function\"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&\"string\"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){var d;while((d=n.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[[\"resolve\",\"done\",n.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",n.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",n.Callbacks(\"memory\")]],c=\"pending\",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+\"With\"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+\"With\"](this===e?d:this,arguments),this},e[f[0]+\"With\"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(a===!0?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger(\"ready\").off(\"ready\"))}}});function J(){z.addEventListener?(z.removeEventListener(\"DOMContentLoaded\",K,!1),a.removeEventListener(\"load\",K,!1)):(z.detachEvent(\"onreadystatechange\",K),a.detachEvent(\"onload\",K))}function K(){(z.addEventListener||\"load\"===event.type||\"complete\"===z.readyState)&&(J(),n.ready())}n.ready.promise=function(b){if(!I)if(I=n.Deferred(),\"complete\"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener(\"DOMContentLoaded\",K,!1),a.addEventListener(\"load\",K,!1);else{z.attachEvent(\"onreadystatechange\",K),a.attachEvent(\"onload\",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll(\"left\")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var L=\"undefined\",M;for(M in n(l))break;l.ownLast=\"0\"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName(\"body\")[0];c&&(a=z.createElement(\"div\"),a.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",b=z.createElement(\"div\"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText=\"border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1\",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement(\"div\");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+\" \").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute(\"classid\")===b};var N=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d=\"data-\"+b.replace(O,\"-$1\").toLowerCase();if(c=a.getAttribute(d),\"string\"==typeof c){try{c=\"true\"===c?!0:\"false\"===c?!1:\"null\"===c?null:+c+\"\"===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if((\"data\"!==b||!n.isEmptyObject(a[b]))&&\"toJSON\"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||\"string\"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),(\"object\"==typeof b||\"function\"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),\"string\"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f\r\n}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(\" \")),e=b.length;while(e--)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{\"applet \":!0,\"embed \":!0,\"object \":\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,\"parsedAttrs\"))){c=g.length;while(c--)d=g[c].name,0===d.indexOf(\"data-\")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]));n._data(f,\"parsedAttrs\",!0)}return e}return\"object\"==typeof a?this.each(function(){n.data(this,a)}):arguments.length>1?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||\"fx\")+\"queue\",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||\"fx\";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};\"inprogress\"===e&&(e=c.shift(),d--),e&&(\"fx\"===b&&c.unshift(\"inprogress\"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+\"queueHooks\";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks(\"once memory\").add(function(){n._removeData(a,b+\"queue\"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return\"string\"!=typeof a&&(b=a,a=\"fx\",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),\"fx\"===a&&\"inprogress\"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||\"fx\",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};\"string\"!=typeof a&&(b=a,a=void 0),a=a||\"fx\";while(g--)c=n._data(f[g],a+\"queueHooks\"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,U=[\"Top\",\"Right\",\"Bottom\",\"Left\"],V=function(a,b){return a=b||a,\"none\"===n.css(a,\"display\")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if(\"object\"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement(\"div\"),c=z.createElement(\"input\");if(b.setAttribute(\"className\",\"t\"),b.innerHTML=\"  <link/><table></table><a href='/a'>a</a>\",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName(\"tbody\").length,l.htmlSerialize=!!b.getElementsByTagName(\"link\").length,l.html5Clone=\"<:nav></:nav>\"!==z.createElement(\"nav\").cloneNode(!0).outerHTML,c.type=\"checkbox\",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML=\"<textarea>x</textarea>\",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML=\"<input type='radio' checked='checked' name='t'/>\",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent(\"onclick\",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement(\"div\");for(b in{submit:!0,change:!0,focusin:!0})c=\"on\"+b,(l[b+\"Bubbles\"]=c in a)||(d.setAttribute(c,\"t\"),l[b+\"Bubbles\"]=d.attributes[c].expando===!1);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||\"\").match(F)||[\"\"],h=b.length;while(h--)f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||\"\").split(\".\").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(\".\")},i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent(\"on\"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){b=(b||\"\").match(F)||[\"\"],j=b.length;while(j--)if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||\"\").split(\".\").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp(\"(^|\\\\.)\"+p.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),i=f=m.length;while(f--)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&(\"**\"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,\"events\"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,\"type\")?b.type:b,q=j.call(b,\"namespace\")?b.namespace.split(\".\"):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(\".\")>=0&&(q=p.split(\".\"),p=q.shift(),q.sort()),g=p.indexOf(\":\")<0&&\"on\"+p,b=b[n.expando]?b:new n.Event(p,\"object\"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join(\".\"),b.namespace_re=b.namespace?new RegExp(\"(^|\\\\.)\"+q.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}m=0;while((h=o[m++])&&!b.isPropagationStopped())b.type=m>1?i:k.bindType||p,f=(n._data(h,\"events\")||{})[b.type]&&n._data(h,\"handle\"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){l=d[g],l&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,\"events\")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||\"click\"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||\"click\"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+\" \",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:\"focusout\"},click:{trigger:function(){return n.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,\"a\")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d=\"on\"+b;a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return n.nodeName(this,\"form\")?!1:void n.event.add(this,\"click._submit keypress._submit\",function(a){var b=a.target,c=n.nodeName(b,\"input\")||n.nodeName(b,\"button\")?b.form:void 0;c&&!n._data(c,\"submitBubbles\")&&(n.event.add(c,\"submit._submit\",function(a){a._submit_bubble=!0}),n._data(c,\"submitBubbles\",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate(\"submit\",this.parentNode,a,!0))},teardown:function(){return n.nodeName(this,\"form\")?!1:void n.event.remove(this,\"._submit\")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(n.event.add(this,\"propertychange._change\",function(a){\"checked\"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,\"click._change\",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate(\"change\",this,a,!0)})),!1):void n.event.add(this,\"beforeactivate._change\",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,\"changeBubbles\")&&(n.event.add(b,\"change._change\",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate(\"change\",this.parentNode,a,!0)}),n._data(b,\"changeBubbles\",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||\"radio\"!==b.type&&\"checkbox\"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,\"._change\"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:\"focusin\",blur:\"focusout\"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if(\"object\"==typeof a){\"string\"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&(\"string\"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=cb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return n().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+\".\"+d.namespace:d.origType,d.selector,d.handler),this;if(\"object\"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||\"function\"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});function eb(a){var b=fb.split(\"|\"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var fb=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gb=/ jQuery\\d+=\"(?:null|\\d+)\"/g,hb=new RegExp(\"<(?:\"+fb+\")[\\\\s/>]\",\"i\"),ib=/^\\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,kb=/<([\\w:]+)/,lb=/<tbody/i,mb=/<|&#?\\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\\s*(?:[^=]|=\\s*.checked.)/i,pb=/^$|\\/(?:java|ecma)script/i,qb=/^true\\/(.*)/,rb=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,sb={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:l.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},tb=eb(z),ub=tb.appendChild(z.createElement(\"div\"));sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;function vb(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||\"*\"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||\"*\"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,\"table\")&&n.nodeName(11!==b.nodeType?b:b.firstChild,\"tr\")?a.getElementsByTagName(\"tbody\")[0]||a.appendChild(a.ownerDocument.createElement(\"tbody\")):a}function yb(a){return a.type=(null!==n.find.attr(a,\"type\"))+\"/\"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute(\"type\"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,\"globalEval\",!b||n._data(b[d],\"globalEval\"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)n.event.add(b,c,h[c][d])}g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){e=n._data(b);for(d in e.events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}\"script\"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):\"object\"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):\"input\"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):\"option\"===c?b.defaultSelected=b.selected=a.defaultSelected:(\"input\"===c||\"textarea\"===c)&&(b.defaultValue=a.defaultValue)}}n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test(\"<\"+a.nodeName+\">\")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return d=vb(f,\"script\"),d.length>0&&Ab(d,!i&&vb(a,\"script\")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;m>q;q++)if(f=a[q],f||0===f)if(\"object\"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){h=h||o.appendChild(b.createElement(\"div\")),i=(kb.exec(f)||[\"\",\"\"])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,\"<$1></$2>\")+k[2],e=k[0];while(e--)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){f=\"table\"!==i||lb.test(f)?\"<table>\"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)n.nodeName(j=f.childNodes[e],\"tbody\")&&!j.childNodes.length&&f.removeChild(j)}n.merge(p,h.childNodes),h.textContent=\"\";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,\"input\"),wb),q=0;while(f=p[q++])if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),\"script\"),g&&Ab(h),c)){e=0;while(f=h[e++])pb.test(f.type||\"\")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,\"script\")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&n.cleanData(vb(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&n.nodeName(a,\"select\")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,\"\"):void 0;if(!(\"string\"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||[\"\",\"\"])[1].toLowerCase()])){a=a.replace(jb,\"<$1></$2>\");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||k>1&&\"string\"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=n.map(vb(i,\"script\"),yb),f=g.length;k>j;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,\"script\"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;f>j;j++)d=g[j],pb.test(d.type||\"\")&&!n._data(d,\"globalEval\")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||\"\").replace(rb,\"\")));i=c=null}return this}}),n.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],\"display\");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||(c=Fb(a,b),\"none\"!==c&&c||(Db=(Db||n(\"<iframe frameborder='0' width='0' height='0'/>\")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement(\"div\"),d=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";c.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=c.getElementsByTagName(\"a\")[0],a.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip=\"content-box\",c.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=z.getElementsByTagName(\"body\")[0],!a)return;f=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",c=z.createElement(\"div\"),e=z.createElement(\"div\"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+\";width:1px;padding:1px;zoom:1\",e.innerHTML=\"<div></div>\",e.firstChild.style.width=\"5px\",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Hb=/^margin/,Ib=new RegExp(\"^(\"+T+\")(?!px)[a-z%]+$\",\"i\"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(\"\"!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+\"\"}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left=\"fontSize\"===b?\"1em\":g,g=h.pixelLeft+\"px\",h.left=d,f&&(e.left=f)),void 0===g?g:g+\"\"||\"auto\"});function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h=z.createElement(\"div\"),i=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",j=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";h.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",b=h.getElementsByTagName(\"a\")[0],b.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip=\"content-box\",h.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement(\"div\"),f=z.getElementsByTagName(\"body\")[0];if(f)return e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=z.createElement(\"div\"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",b=e.getElementsByTagName(\"td\"),b[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",d=0===b[0].offsetHeight,b[0].style.display=\"\",b[1].style.display=\"none\",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(b=z.getElementsByTagName(\"body\")[0],!b)return;c=z.createElement(\"div\"),d=z.createElement(\"div\"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement(\"div\")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width=\"0\",d.style.width=\"1px\",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}});function k(){var b,c,h=z.getElementsByTagName(\"body\")[0];h&&(b=z.createElement(\"div\"),c=z.createElement(\"div\"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText=\"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%\",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),e=!0,f=!1,g=!0,a.getComputedStyle&&(f=\"1%\"!==(a.getComputedStyle(c,null)||{}).top,e=\"4px\"===(a.getComputedStyle(c,null)||{width:\"4px\"}).width),h.removeChild(b),c=h=null)}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Nb=/alpha\\([^)]*\\)/i,Ob=/opacity\\s*=\\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp(\"^(\"+T+\")(.*)$\",\"i\"),Rb=new RegExp(\"^([+-])=(\"+T+\")\",\"i\"),Sb={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Tb={letterSpacing:0,fontWeight:400},Ub=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function Vb(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;while(e--)if(b=Ub[e]+c,b in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=n._data(d,\"olddisplay\"),c=d.style.display,b?(f[g]||\"none\"!==c||(d.style.display=\"\"),\"\"===d.style.display&&V(d)&&(f[g]=n._data(d,\"olddisplay\",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&\"none\"!==c||!e)&&n._data(d,\"olddisplay\",e?c:n.css(d,\"display\"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&\"none\"!==d.style.display&&\"\"!==d.style.display||(d.style.display=b?f[g]||\"\":\"none\"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||\"px\"):b}function Yb(a,b,c,d,e){for(var f=c===(d?\"border\":\"content\")?4:\"width\"===b?1:0,g=0;4>f;f+=2)\"margin\"===c&&(g+=n.css(a,c+U[f],!0,e)),d?(\"content\"===c&&(g-=n.css(a,\"padding\"+U[f],!0,e)),\"margin\"!==c&&(g-=n.css(a,\"border\"+U[f]+\"Width\",!0,e))):(g+=n.css(a,\"padding\"+U[f],!0,e),\"padding\"!==c&&(g+=n.css(a,\"border\"+U[f]+\"Width\",!0,e)));return g}function Zb(a,b,c){var d=!0,e=\"width\"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,f);if(0>=e||null==e){if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?\"border\":\"content\"),d,f)+\"px\"}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,\"opacity\");return\"\"===c?\"1\":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":l.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&\"get\"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,\"string\"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f=\"number\"),null!=c&&c===c&&(\"number\"!==f||n.cssNumber[h]||(c+=\"px\"),l.clearCloneStyle||\"\"!==c||0!==b.indexOf(\"background\")||(i[b]=\"inherit\"),!(g&&\"set\"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=\"\",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&\"get\"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),\"normal\"===f&&b in Tb&&(f=Tb[b]),\"\"===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f}}),n.each([\"height\",\"width\"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,\"display\"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":b?\"1\":\"\"},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?\"alpha(opacity=\"+100*b+\")\":\"\",f=d&&d.filter||c.filter||\"\";c.zoom=1,(b>=1||\"\"===b)&&\"\"===n.trim(f.replace(Nb,\"\"))&&c.removeAttribute&&(c.removeAttribute(\"filter\"),\"\"===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+\" \"+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:\"inline-block\"},Kb,[a,\"marginRight\"]):void 0}),n.each({margin:\"\",padding:\"\",border:\"Width\"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f=\"string\"==typeof c?c.split(\" \"):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)\r\n},a,b,arguments.length>1)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return\"boolean\"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}});function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.Tween=$b,$b.prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||\"swing\",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?\"\":\"px\")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}},$b.prototype.init.prototype=$b.prototype,$b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,\"\"),b&&\"auto\"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},$b.propHooks.scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp(\"^(?:([+-])=|)(\"+T+\")([a-z%]*)$\",\"i\"),dc=/queueHooks$/,ec=[jc],fc={\"*\":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?\"\":\"px\"),g=(n.cssNumber[a]||\"px\"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||\".5\",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=U[e],d[\"margin\"+c]=d[\"padding\"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc[\"*\"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function jc(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,\"fxshow\");c.queue||(h=n._queueHooks(a,\"fx\"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,\"fx\").length||h.empty.fire()})})),1===a.nodeType&&(\"height\"in b||\"width\"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,\"display\"),k=Gb(a.nodeName),\"none\"===j&&(j=k),\"inline\"===j&&\"none\"===n.css(a,\"float\")&&(l.inlineBlockNeedsLayout&&\"inline\"!==k?p.zoom=1:p.display=\"inline-block\")),c.overflow&&(p.overflow=\"hidden\",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||\"toggle\"===e,e===(q?\"hide\":\"show\")){if(\"show\"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o)){r?\"hidden\"in r&&(q=r.hidden):r=n._data(a,\"fxshow\",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;n._removeData(a,\"fxshow\");for(b in o)n.style(a,b,o[b])});for(d in o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start=\"width\"===d||\"height\"===d?1:0))}}function kc(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&\"expand\"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(kc(k,j.opts.specialEasing);g>f;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){n.isFunction(a)?(b=a,a=[\"*\"]):a=a.split(\" \");for(var c,d=0,e=a.length;e>d;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&\"object\"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:\"number\"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue=\"fx\"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css(\"opacity\",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,\"finish\"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return\"string\"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||\"fx\",[]),this.each(function(){var b=!0,e=null!=a&&a+\"queueHooks\",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||\"fx\"),this.each(function(){var b,c=n._data(this),d=c[a+\"queue\"],e=c[a+\"queueHooks\"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each([\"toggle\",\"show\",\"hide\"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||\"boolean\"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc(\"show\"),slideUp:hc(\"hide\"),slideToggle:hc(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||\"fx\",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement(\"div\");e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=e.getElementsByTagName(\"a\")[0],c=z.createElement(\"select\"),d=c.appendChild(z.createElement(\"option\")),b=e.getElementsByTagName(\"input\")[0],a.style.cssText=\"top:1px\",l.getSetAttribute=\"t\"!==e.className,l.style=/top/.test(a.getAttribute(\"style\")),l.hrefNormalized=\"/a\"===a.getAttribute(\"href\"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement(\"form\").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement(\"input\"),b.setAttribute(\"value\",\"\"),l.input=\"\"===b.getAttribute(\"value\"),b.value=\"t\",b.setAttribute(\"type\",\"radio\"),l.radioValue=\"t\"===b.value,a=b=c=d=e=null}();var mc=/\\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e=\"\":\"number\"==typeof e?e+=\"\":n.isArray(e)&&(e=n.map(e,function(a){return null==a?\"\":a+\"\"})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&\"set\"in b&&void 0!==b.set(this,e,\"value\")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&\"get\"in b&&void 0!==(c=b.get(e,\"value\"))?c:(c=e.value,\"string\"==typeof c?c.replace(mc,\"\"):null==c?\"\":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,\"value\");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f=\"select-one\"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute(\"disabled\"))||c.parentNode.disabled&&n.nodeName(c.parentNode,\"optgroup\"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each([\"radio\",\"checkbox\"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute(\"value\")?\"on\":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&\"get\"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&\"set\"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+\"\"),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase(\"default-\"+c)]=a[d]=!1:n.attr(a,c,\"\"),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&\"radio\"===b&&n.nodeName(a,\"input\")){var c=a.value;return a.setAttribute(\"type\",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase(\"default-\"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase(\"default-\"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,\"input\")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+=\"\",\"value\"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&\"\"!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,\"\"===b?!1:b,c)}},n.each([\"width\",\"height\"],function(a,b){n.attrHooks[b]={set:function(a,c){return\"\"===c?(a.setAttribute(b,\"auto\"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+\"\"}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{\"for\":\"htmlFor\",\"class\":\"className\"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&\"set\"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&\"get\"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,\"tabindex\");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each([\"href\",\"src\"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each([\"tabIndex\",\"readOnly\",\"maxLength\",\"cellSpacing\",\"cellPadding\",\"rowSpan\",\"colSpan\",\"useMap\",\"frameBorder\",\"contentEditable\"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype=\"encoding\");var vc=/[\\t\\r\\n\\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\" \")){f=0;while(e=b[f++])d.indexOf(\" \"+e+\" \")<0&&(d+=e+\" \");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\"\")){f=0;while(e=b[f++])while(d.indexOf(\" \"+e+\" \")>=0)d=d.replace(\" \"+e+\" \",\" \");g=a?n.trim(d):\"\",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return\"boolean\"==typeof b&&\"string\"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if(\"string\"===c){var b,d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===L||\"boolean\"===c)&&(this.className&&n._data(this,\"__className__\",this.className),this.className=this.className||a===!1?\"\":n._data(this,\"__className__\")||\"\")})},hasClass:function(a){for(var b=\" \"+a+\" \",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(\" \"+this[c].className+\" \").replace(vc,\" \").indexOf(b)>=0)return!0;return!1}}),n.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,\"**\"):this.off(b,a||\"**\",c)}});var wc=n.now(),xc=/\\?/,yc=/(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+\"\");var c,d=null,e=n.trim(b+\"\");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,\"\")}))?Function(\"return \"+e)():n.error(\"Invalid JSON: \"+b)},n.parseXML=function(b){var c,d;if(!b||\"string\"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,\"text/xml\")):(c=new ActiveXObject(\"Microsoft.XMLDOM\"),c.async=\"false\",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName(\"parsererror\").length||n.error(\"Invalid XML: \"+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\\/\\//,Hc=/^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,Ic={},Jc={},Kc=\"*/\".concat(\"*\");try{Ac=location.href}catch(Lc){Ac=z.createElement(\"a\"),Ac.href=\"\",Ac=Ac.href}zc=Hc.exec(Ac.toLowerCase())||[];function Mc(a){return function(b,c){\"string\"!=typeof b&&(c=b,b=\"*\");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])\"+\"===d.charAt(0)?(d=d.slice(1)||\"*\",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return\"string\"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e[\"*\"]&&g(\"*\")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}function Pc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while(\"*\"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader(\"Content-Type\"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+\" \"+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Qc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if(\"*\"===f)f=i;else if(\"*\"!==i&&i!==f){if(g=j[i+\" \"+f]||j[\"* \"+f],!g)for(e in j)if(h=e.split(\" \"),h[1]===f&&(g=j[i+\" \"+h[0]]||j[\"* \"+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a[\"throws\"])b=g(b);else try{b=g(b)}catch(l){return{state:\"parsererror\",error:g?l:\"No conversion from \"+i+\" to \"+f}}}return{state:\"success\",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:\"GET\",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Kc,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\",json:\"responseJSON\"},converters:{\"* text\":String,\"text html\":!0,\"text json\":n.parseJSON,\"text xml\":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){\"object\"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks(\"once memory\"),q=k.statusCode||{},r={},s={},t=0,u=\"canceled\",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Dc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+\"\").replace(Bc,\"\").replace(Gc,zc[1]+\"//\"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||\"*\").toLowerCase().match(F)||[\"\"],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||(\"http:\"===c[1]?\"80\":\"443\"))===(zc[3]||(\"http:\"===zc[1]?\"80\":\"443\")))),k.data&&k.processData&&\"string\"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;h=k.global,h&&0===n.active++&&n.event.trigger(\"ajaxStart\"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?\"&\":\"?\")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,\"$1_=\"+wc++):e+(xc.test(e)?\"&\":\"?\")+\"_=\"+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader(\"If-Modified-Since\",n.lastModified[e]),n.etag[e]&&v.setRequestHeader(\"If-None-Match\",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader(\"Content-Type\",k.contentType),v.setRequestHeader(\"Accept\",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+(\"*\"!==k.dataTypes[0]?\", \"+Kc+\"; q=0.01\":\"\"):k.accepts[\"*\"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u=\"abort\";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger(\"ajaxSend\",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort(\"timeout\")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,\"No Transport\");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||\"\",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader(\"Last-Modified\"),w&&(n.lastModified[e]=w),w=v.getResponseHeader(\"etag\"),w&&(n.etag[e]=w)),204===a||\"HEAD\"===k.type?x=\"nocontent\":304===a?x=\"notmodified\":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x=\"error\",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+\"\",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?\"ajaxSuccess\":\"ajaxError\",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger(\"ajaxComplete\",[v,k]),--n.active||n.event.trigger(\"ajaxStop\")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,\"json\")},getScript:function(a,b){return n.get(a,void 0,b,\"script\")}}),n.each([\"get\",\"post\"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,\"body\")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&\"none\"===(a.style&&a.style.display||n.css(a,\"display\"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\\[\\]$/,Tc=/\\r?\\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+\"[\"+(\"object\"==typeof e?b:\"\")+\"]\",e,c,d)});else if(c||\"object\"!==n.type(b))d(a,b);else for(e in b)Wc(a+\"[\"+e+\"]\",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?\"\":b,d[d.length]=encodeURIComponent(a)+\"=\"+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join(\"&\").replace(Rc,\"+\")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,\"elements\");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(\":disabled\")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,\"\\r\\n\")}}):{name:b.name,value:c.replace(Tc,\"\\r\\n\")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on(\"unload\",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&\"withCredentials\"in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){if(!a.crossDomain||l.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c[\"X-Requested-With\"]||(c[\"X-Requested-With\"]=\"XMLHttpRequest\");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+\"\");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,\"string\"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=\"\"}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function $c(){try{return new a.XMLHttpRequest}catch(b){}}function _c(){try{return new a.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(b){}}n.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter(\"script\",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type=\"GET\",a.global=!1)}),n.ajaxTransport(\"script\",function(a){if(a.crossDomain){var b,c=z.head||n(\"head\")[0]||z.documentElement;return{send:function(d,e){b=z.createElement(\"script\"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,\"success\"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\\?(?=&|$)|\\?\\?/;n.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var a=ad.pop()||n.expando+\"_\"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter(\"json jsonp\",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?\"url\":\"string\"==typeof b.data&&!(b.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&bd.test(b.data)&&\"data\");return h||\"jsonp\"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,\"$1\"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?\"&\":\"?\")+b.jsonp+\"=\"+e),b.converters[\"script json\"]=function(){return g||n.error(e+\" was not called\"),g[0]},b.dataTypes[0]=\"json\",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),\"script\"):void 0}),n.parseHTML=function(a,b,c){if(!a||\"string\"!=typeof a)return null;\"boolean\"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if(\"string\"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(\" \");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&\"object\"==typeof b&&(f=\"POST\"),g.length>0&&n.ajax({url:a,type:f,dataType:\"html\",data:b}).done(function(a){e=arguments,g.html(d?n(\"<div>\").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,\"position\"),l=n(a),m={};\"static\"===k&&(a.style.position=\"relative\"),h=l.offset(),f=n.css(a,\"top\"),i=n.css(a,\"left\"),j=(\"absolute\"===k||\"fixed\"===k)&&n.inArray(\"auto\",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),\"using\"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return\"fixed\"===n.css(d,\"position\")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],\"html\")||(c=a.offset()),c.top+=n.css(a[0],\"borderTopWidth\",!0),c.left+=n.css(a[0],\"borderLeftWidth\",!0)),{top:b.top-c.top-n.css(d,\"marginTop\",!0),left:b.left-c.left-n.css(d,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||dd;while(a&&!n.nodeName(a,\"html\")&&\"static\"===n.css(a,\"position\"))a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each([\"top\",\"left\"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+\"px\":c):void 0})}),n.each({Height:\"height\",Width:\"width\"},function(a,b){n.each({padding:\"inner\"+a,content:b,\"\":\"outer\"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||\"boolean\"!=typeof d),g=c||(d===!0||e===!0?\"margin\":\"border\");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement[\"client\"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body[\"scroll\"+a],e[\"scroll\"+a],b.body[\"offset\"+a],e[\"offset\"+a],e[\"client\"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,\"function\"==typeof define&&define.amd&&define(\"jquery\",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},typeof b===L&&(a.jQuery=a.$=n),n});\r\n","/*! vex.js, vex.dialog.js 2.0.1 */\r\n(function(){var a;a=function(a){var b,c;return b=!1,a(function(){var d;return d=(document.body||document.documentElement).style,b=void 0!==d.animation||void 0!==d.WebkitAnimation||void 0!==d.MozAnimation||void 0!==d.MsAnimation||void 0!==d.OAnimation,a(window).bind(\"keyup.vex\",function(a){return 27===a.keyCode?c.closeByEscape():void 0})}),c={globalID:1,animationEndEvent:\"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend\",baseClassNames:{vex:\"vex\",content:\"vex-content\",overlay:\"vex-overlay\",close:\"vex-close\",closing:\"vex-closing\",open:\"vex-open\"},defaultOptions:{content:\"\",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:\"body\",className:\"\",css:{},overlayClassName:\"\",overlayCSS:{},contentClassName:\"\",contentCSS:{},closeClassName:\"\",closeCSS:{}},open:function(b){return b=a.extend({},c.defaultOptions,b),b.id=c.globalID,c.globalID+=1,b.$vex=a(\"<div>\").addClass(c.baseClassNames.vex).addClass(b.className).css(b.css).data({vex:b}),b.$vexOverlay=a(\"<div>\").addClass(c.baseClassNames.overlay).addClass(b.overlayClassName).css(b.overlayCSS).data({vex:b}),b.overlayClosesOnClick&&b.$vexOverlay.bind(\"click.vex\",function(b){return b.target===this?c.close(a(this).data().vex.id):void 0}),b.$vex.append(b.$vexOverlay),b.$vexContent=a(\"<div>\").addClass(c.baseClassNames.content).addClass(b.contentClassName).css(b.contentCSS).append(b.content).data({vex:b}),b.$vex.append(b.$vexContent),b.showCloseButton&&(b.$closeButton=a(\"<div>\").addClass(c.baseClassNames.close).addClass(b.closeClassName).css(b.closeCSS).data({vex:b}).bind(\"click.vex\",function(){return c.close(a(this).data().vex.id)}),b.$vexContent.append(b.$closeButton)),a(b.appendLocation).append(b.$vex),c.setupBodyClassName(b.$vex),b.afterOpen&&b.afterOpen(b.$vexContent,b),setTimeout(function(){return b.$vexContent.trigger(\"vexOpen\",b)},0),b.$vexContent},getAllVexes:function(){return a(\".\"+c.baseClassNames.vex+':not(\".'+c.baseClassNames.closing+'\") .'+c.baseClassNames.content)},getVexByID:function(b){return c.getAllVexes().filter(function(){return a(this).data().vex.id===b})},close:function(a){var b;if(!a){if(b=c.getAllVexes().last(),!b.length)return!1;a=b.data().vex.id}return c.closeByID(a)},closeAll:function(){var b;return b=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=b?b.length:void 0)?(a.each(b.reverse(),function(a,b){return c.closeByID(b)}),!0):!1},closeByID:function(d){var e,f,g,h,i;return f=c.getVexByID(d),f.length?(e=f.data().vex.$vex,i=a.extend({},f.data().vex),g=function(){return i.beforeClose?i.beforeClose(f,i):void 0},h=function(){return f.trigger(\"vexClose\",i),e.remove(),i.afterClose?i.afterClose(f,i):void 0},b?(g(),e.unbind(c.animationEndEvent).bind(c.animationEndEvent,function(){return h()}).addClass(c.baseClassNames.closing)):(g(),h()),!0):void 0},closeByEscape:function(){var b,d,e;return e=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=e?e.length:void 0)?(d=Math.max.apply(Math,e),b=c.getVexByID(d),b.data().vex.escapeButtonCloses!==!0?!1:c.closeByID(d)):!1},setupBodyClassName:function(b){return b.bind(\"vexOpen.vex\",function(){return a(\"body\").addClass(c.baseClassNames.open)}).bind(\"vexClose.vex\",function(){return c.getAllVexes().length?void 0:a(\"body\").removeClass(c.baseClassNames.open)})},hideLoading:function(){return a(\".vex-loading-spinner\").remove()},showLoading:function(){return c.hideLoading(),a(\"body\").append('<div class=\"vex-loading-spinner '+c.defaultOptions.className+'\"></div>')}}},\"function\"==typeof define&&define.amd?define([\"jquery\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\")):window.vex=a(jQuery)}).call(this),function(){var a;a=function(a,b){var c,d;return null==b?a.error(\"Vex is required to use vex.dialog\"):(c=function(b){var c;return c={},a.each(b.serializeArray(),function(){return c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||\"\")):c[this.name]=this.value||\"\"}),c},d={},d.buttons={YES:{text:\"OK\",type:\"submit\",className:\"vex-dialog-button-primary\"},NO:{text:\"Cancel\",type:\"button\",className:\"vex-dialog-button-secondary\",click:function(a){return a.data().vex.value=!1,b.close(a.data().vex.id)}}},d.defaultOptions={callback:function(){},afterOpen:function(){},message:\"Message\",input:'<input name=\"vex\" type=\"hidden\" value=\"_vex-empty-value\" />',value:!1,buttons:[d.buttons.YES,d.buttons.NO],showCloseButton:!1,onSubmit:function(e){var f,g;return f=a(this),g=f.parent(),e.preventDefault(),e.stopPropagation(),g.data().vex.value=d.getFormValueOnSubmit(c(f)),b.close(g.data().vex.id)},focusFirstInput:!0},d.defaultAlertOptions={message:\"Alert\",buttons:[d.buttons.YES]},d.defaultConfirmOptions={message:\"Confirm\"},d.open=function(c){var e;return c=a.extend({},b.defaultOptions,d.defaultOptions,c),c.content=d.buildDialogForm(c),c.beforeClose=function(a){return c.callback(a.data().vex.value)},e=b.open(c),c.focusFirstInput&&e.find('input[type=\"submit\"], textarea, input[type=\"date\"], input[type=\"datetime\"], input[type=\"datetime-local\"], input[type=\"email\"], input[type=\"month\"], input[type=\"number\"], input[type=\"password\"], input[type=\"search\"], input[type=\"tel\"], input[type=\"text\"], input[type=\"time\"], input[type=\"url\"], input[type=\"week\"]').first().focus(),e},d.alert=function(b){return\"string\"==typeof b&&(b={message:b}),b=a.extend({},d.defaultAlertOptions,b),d.open(b)},d.confirm=function(b){return\"string\"==typeof b?a.error(\"dialog.confirm(options) requires options.callback.\"):(b=a.extend({},d.defaultConfirmOptions,b),d.open(b))},d.prompt=function(b){var c;return\"string\"==typeof b?a.error(\"dialog.prompt(options) requires options.callback.\"):(c={message:'<label for=\"vex\">'+(b.label||\"Prompt:\")+\"</label>\",input:'<input name=\"vex\" type=\"text\" class=\"vex-dialog-prompt-input\" placeholder=\"'+(b.placeholder||\"\")+'\"  value=\"'+(b.value||\"\")+'\" />'},b=a.extend({},c,b),d.open(b))},d.buildDialogForm=function(b){var c,e,f;return c=a('<form class=\"vex-dialog-form\" />'),f=a('<div class=\"vex-dialog-message\" />'),e=a('<div class=\"vex-dialog-input\" />'),c.append(f.append(b.message)).append(e.append(b.input)).append(d.buttonsToDOM(b.buttons)).bind(\"submit.vex\",b.onSubmit),c},d.getFormValueOnSubmit=function(a){return a.vex||\"\"===a.vex?\"_vex-empty-value\"===a.vex?!0:a.vex:a},d.buttonsToDOM=function(c){var d;return d=a('<div class=\"vex-dialog-buttons\" />'),a.each(c,function(e,f){return d.append(a('<input type=\"'+f.type+'\" />').val(f.text).addClass(f.className+\" vex-dialog-button \"+(0===e?\"vex-first \":\"\")+(e===c.length-1?\"vex-last \":\"\")).bind(\"click.vex\",function(c){return f.click?f.click(a(this).parents(\".\"+b.baseClassNames.content),c):void 0}))}),d},d)},\"function\"==typeof define&&define.amd?define([\"jquery\",\"vex\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\"),require(\"vex\")):window.vex.dialog=a(window.jQuery,window.vex)}.call(this);","/*! jQuery UI - v1.11.4 - 2016-04-09\r\n* http://jqueryui.com\r\n* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, tabs.js, tooltip.js\r\n* Copyright jQuery Foundation and other contributors; Licensed MIT */\r\n\r\n(function(t){\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)})(function(t){function e(e,s){var n,a,o,r=e.nodeName.toLowerCase();return\"area\"===r?(n=e.parentNode,a=n.name,e.href&&a&&\"map\"===n.nodeName.toLowerCase()?(o=t(\"img[usemap='#\"+a+\"']\")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:\"a\"===r?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return\"hidden\"===t.css(this,\"visibility\")}).length}function s(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css(\"position\"),(\"absolute\"===e||\"relative\"===e||\"fixed\"===e)&&(i=parseInt(t.css(\"zIndex\"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId=\"ui-datepicker-div\",this._inlineClass=\"ui-datepicker-inline\",this._appendClass=\"ui-datepicker-append\",this._triggerClass=\"ui-datepicker-trigger\",this._dialogClass=\"ui-datepicker-dialog\",this._disableClass=\"ui-datepicker-disabled\",this._unselectableClass=\"ui-datepicker-unselectable\",this._currentClass=\"ui-datepicker-current-day\",this._dayOverClass=\"ui-datepicker-days-cell-over\",this.regional=[],this.regional[\"\"]={closeText:\"Done\",prevText:\"Prev\",nextText:\"Next\",currentText:\"Today\",monthNames:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],monthNamesShort:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],dayNames:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],dayNamesShort:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],dayNamesMin:[\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\"],weekHeader:\"Wk\",dateFormat:\"mm/dd/yy\",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:\"\"},this._defaults={showOn:\"focus\",showAnim:\"fadeIn\",showOptions:{},defaultDate:null,appendText:\"\",buttonText:\"...\",buttonImage:\"\",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:\"c-10:c+10\",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:\"+10\",minDate:null,maxDate:null,duration:\"fast\",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:\"\",altFormat:\"\",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[\"\"]),this.regional.en=t.extend(!0,{},this.regional[\"\"]),this.regional[\"en-US\"]=t.extend(!0,{},this.regional.en),this.dpDiv=a(t(\"<div id='\"+this._mainDivId+\"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\"))}function a(e){var i=\"button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a\";return e.delegate(i,\"mouseout\",function(){t(this).removeClass(\"ui-state-hover\"),-1!==this.className.indexOf(\"ui-datepicker-prev\")&&t(this).removeClass(\"ui-datepicker-prev-hover\"),-1!==this.className.indexOf(\"ui-datepicker-next\")&&t(this).removeClass(\"ui-datepicker-next-hover\")}).delegate(i,\"mouseover\",o)}function o(){t.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(t(this).parents(\".ui-datepicker-calendar\").find(\"a\").removeClass(\"ui-state-hover\"),t(this).addClass(\"ui-state-hover\"),-1!==this.className.indexOf(\"ui-datepicker-prev\")&&t(this).addClass(\"ui-datepicker-prev-hover\"),-1!==this.className.indexOf(\"ui-datepicker-next\")&&t(this).addClass(\"ui-datepicker-next-hover\"))}function r(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}function h(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger(\"change\")}}t.ui=t.ui||{},t.extend(t.ui,{version:\"1.11.4\",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css(\"position\"),s=\"absolute\"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var e=t(this);return s&&\"static\"===e.css(\"position\")?!1:n.test(e.css(\"overflow\")+e.css(\"overflow-y\")+e.css(\"overflow-x\"))}).eq(0);return\"fixed\"!==i&&a.length?a:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id=\"ui-id-\"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\\d+$/.test(this.id)&&t(this).removeAttr(\"id\")})}}),t.extend(t.expr[\":\"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,\"tabindex\")))},tabbable:function(i){var s=t.attr(i,\"tabindex\"),n=isNaN(s);return(n||s>=0)&&e(i,!n)}}),t(\"<a>\").outerWidth(1).jquery||t.each([\"Width\",\"Height\"],function(e,i){function s(e,i,s,a){return t.each(n,function(){i-=parseFloat(t.css(e,\"padding\"+this))||0,s&&(i-=parseFloat(t.css(e,\"border\"+this+\"Width\"))||0),a&&(i-=parseFloat(t.css(e,\"margin\"+this))||0)}),i}var n=\"Width\"===i?[\"Left\",\"Right\"]:[\"Top\",\"Bottom\"],a=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn[\"inner\"+i]=function(e){return void 0===e?o[\"inner\"+i].call(this):this.each(function(){t(this).css(a,s(this,e)+\"px\")})},t.fn[\"outer\"+i]=function(e,n){return\"number\"!=typeof e?o[\"outer\"+i].call(this,e):this.each(function(){t(this).css(a,s(this,e,!0,n)+\"px\")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t(\"<a>\").data(\"a-b\",\"a\").removeData(\"a-b\").data(\"a-b\")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,s){return\"number\"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),s&&s.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t=\"onselectstart\"in document.createElement(\"div\")?\"selectstart\":\"mousedown\";return function(){return this.bind(t+\".ui-disableSelection\",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(\".ui-disableSelection\")},zIndex:function(e){if(void 0!==e)return this.css(\"zIndex\",e);if(this.length)for(var i,s,n=t(this[0]);n.length&&n[0]!==document;){if(i=n.css(\"position\"),(\"absolute\"===i||\"relative\"===i||\"fixed\"===i)&&(s=parseInt(n.css(\"zIndex\"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),t.ui.plugin={add:function(e,i,s){var n,a=t.ui[e].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,a=t.plugins[e];if(a&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)t.options[a[n][0]]&&a[n][1].apply(t.element,i)}};var l=0,u=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=t._data(n,\"events\"),s&&s.remove&&t(n).triggerHandler(\"remove\")}catch(o){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,a,o,r,h={},l=e.split(\".\")[0];return e=e.split(\".\")[1],n=l+\"-\"+e,s||(s=i,i=t.Widget),t.expr[\":\"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[l]=t[l]||{},a=t[l][e],o=t[l][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new o(t,e)},t.extend(o,a,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(s,function(e,s){return t.isFunction(s)?(h[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,a=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=a,e}}(),void 0):(h[e]=s,void 0)}),o.prototype=t.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||e:e},h,{constructor:o,namespace:l,widgetName:e,widgetFullName:n}),a?(t.each(a._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+\".\"+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(n){var a=\"string\"==typeof n,o=u.call(arguments,1),r=this;return a?this.each(function(){var i,a=t.data(this,s);return\"instance\"===n?(r=a,!1):a?t.isFunction(a[n])&&\"_\"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):t.error(\"no such method '\"+n+\"' for \"+e+\" widget instance\"):t.error(\"cannot call methods on \"+e+\" prior to initialization; \"+\"attempted to call method '\"+n+\"'\")}):(o.length&&(n=t.widget.extend.apply(null,[n].concat(o))),this.each(function(){var e=t.data(this,s);e?(e.option(n||{}),e._init&&e._init()):t.data(this,s,new i(n,this))})),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:\"widget\",widgetEventPrefix:\"\",defaultElement:\"<div>\",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=l++,this.eventNamespace=\".\"+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger(\"create\",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr(\"aria-disabled\").removeClass(this.widgetFullName+\"-disabled \"+\"ui-state-disabled\"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass(\"ui-state-hover\"),this.focusable.removeClass(\"ui-state-focus\")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,a,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if(\"string\"==typeof e)if(o={},s=e.split(\".\"),e=s.shift(),s.length){for(n=o[e]=t.widget.extend({},this.options[e]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,\"disabled\"===t&&(this.widget().toggleClass(this.widgetFullName+\"-disabled\",!!e),e&&(this.hoverable.removeClass(\"ui-state-hover\"),this.focusable.removeClass(\"ui-state-focus\"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,s){var n,a=this;\"boolean\"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,o){function r(){return e||a.options.disabled!==!0&&!t(this).hasClass(\"ui-state-disabled\")?(\"string\"==typeof o?a[o]:o).apply(a,arguments):void 0}\"string\"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||t.guid++);var h=s.match(/^([\\w:-]*)\\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(e,i){i=(i||\"\").split(\" \").join(this.eventNamespace+\" \")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return(\"string\"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass(\"ui-state-hover\")},mouseleave:function(e){t(e.currentTarget).removeClass(\"ui-state-hover\")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass(\"ui-state-focus\")},focusout:function(e){t(e.currentTarget).removeClass(\"ui-state-focus\")}})},_trigger:function(e,i,s){var n,a,o=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:\"fadeIn\",hide:\"fadeOut\"},function(e,i){t.Widget.prototype[\"_\"+e]=function(s,n,a){\"string\"==typeof n&&(n={effect:n});var o,r=n?n===!0||\"number\"==typeof n?i:n.effect||i:e;n=n||{},\"number\"==typeof n&&(n={duration:n}),o=!t.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){t(this)[e](),a&&a.call(s[0]),i()})}}),t.widget;var c=!1;t(document).mouseup(function(){c=!1}),t.widget(\"ui.mouse\",{version:\"1.11.4\",options:{cancel:\"input,textarea,button,select,option\",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind(\"mousedown.\"+this.widgetName,function(t){return e._mouseDown(t)}).bind(\"click.\"+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+\".preventClickEvent\")?(t.removeData(i.target,e.widgetName+\".preventClickEvent\"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind(\".\"+this.widgetName),this._mouseMoveDelegate&&this.document.unbind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).unbind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!c){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,n=\"string\"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+\".preventClickEvent\")&&t.removeData(e.target,this.widgetName+\".preventClickEvent\"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).bind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate),e.preventDefault(),c=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).unbind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+\".preventClickEvent\",!0),this._mouseStop(e)),c=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,c=/[\\+\\-]\\d+(\\.[\\d]+)?%?/,d=/^\\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t(\"<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>\"),a=s.children()[0];return t(\"body\").append(s),e=a.offsetWidth,s.css(\"overflow\",\"scroll\"),i=a.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?\"\":e.element.css(\"overflow-x\"),s=e.isWindow||e.isDocument?\"\":e.element.css(\"overflow-y\"),n=\"scroll\"===i||\"auto\"===i&&e.width<e.element[0].scrollWidth,a=\"scroll\"===s||\"auto\"===s&&e.height<e.element[0].scrollHeight;return{width:a?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=t.extend({},n);var p,m,g,v,_,b,y=t(n.of),x=t.position.getWithinInfo(n.within),w=t.position.getScrollInfo(x),k=(n.collision||\"flip\").split(\" \"),D={};return b=s(y),y[0].preventDefault&&(n.at=\"left top\"),m=b.width,g=b.height,v=b.offset,_=t.extend({},v),t.each([\"my\",\"at\"],function(){var t,e,i=(n[this]||\"\").split(\" \");1===i.length&&(i=l.test(i[0])?i.concat([\"center\"]):u.test(i[0])?[\"center\"].concat(i):[\"center\",\"center\"]),i[0]=l.test(i[0])?i[0]:\"center\",i[1]=u.test(i[1])?i[1]:\"center\",t=c.exec(i[0]),e=c.exec(i[1]),D[this]=[t?t[0]:0,e?e[0]:0],n[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),\"right\"===n.at[0]?_.left+=m:\"center\"===n.at[0]&&(_.left+=m/2),\"bottom\"===n.at[1]?_.top+=g:\"center\"===n.at[1]&&(_.top+=g/2),p=e(D.at,m,g),_.left+=p[0],_.top+=p[1],this.each(function(){var s,l,u=t(this),c=u.outerWidth(),d=u.outerHeight(),f=i(this,\"marginLeft\"),b=i(this,\"marginTop\"),T=c+f+i(this,\"marginRight\")+w.width,S=d+b+i(this,\"marginBottom\")+w.height,M=t.extend({},_),C=e(D.my,u.outerWidth(),u.outerHeight());\"right\"===n.my[0]?M.left-=c:\"center\"===n.my[0]&&(M.left-=c/2),\"bottom\"===n.my[1]?M.top-=d:\"center\"===n.my[1]&&(M.top-=d/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},t.each([\"left\",\"top\"],function(e,i){t.ui.position[k[e]]&&t.ui.position[k[e]][i](M,{targetWidth:m,targetHeight:g,elemWidth:c,elemHeight:d,collisionPosition:s,collisionWidth:T,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(t){var e=v.left-M.left,i=e+m-c,s=v.top-M.top,a=s+g-d,h={target:{element:y,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:c,height:d},horizontal:0>i?\"left\":e>0?\"right\":\"center\",vertical:0>a?\"top\":s>0?\"bottom\":\"middle\"};c>m&&m>r(e+i)&&(h.horizontal=\"center\"),d>g&&g>r(s+a)&&(h.vertical=\"middle\"),h.important=o(r(e),r(i))>o(r(s),r(a))?\"horizontal\":\"vertical\",n.using.call(this,t,h)}),u.offset(t.extend(M,{using:l}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-a-n;e.collisionWidth>a?h>0&&0>=l?(i=t.left+h+e.collisionWidth-a-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+a-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-a-n;e.collisionHeight>a?h>0&&0>=l?(i=t.top+h+e.collisionHeight-a-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+a-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,u=l-h,c=l+e.collisionWidth-o-h,d=\"left\"===e.my[0]?-e.elemWidth:\"right\"===e.my[0]?e.elemWidth:0,p=\"left\"===e.at[0]?e.targetWidth:\"right\"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>u?(i=t.left+d+p+f+e.collisionWidth-o-a,(0>i||r(u)>i)&&(t.left+=d+p+f)):c>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||c>r(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,u=l-h,c=l+e.collisionHeight-o-h,d=\"top\"===e.my[1],p=d?-e.elemHeight:\"bottom\"===e.my[1]?e.elemHeight:0,f=\"top\"===e.at[1]?e.targetHeight:\"bottom\"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];0>u?(s=t.top+p+f+m+e.collisionHeight-o-a,(0>s||r(u)>s)&&(t.top+=p+f+m)):c>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-h,(i>0||c>r(i))&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,s,n,o,r=document.getElementsByTagName(\"body\")[0],h=document.createElement(\"div\");e=document.createElement(r?\"div\":\"body\"),s={visibility:\"hidden\",width:0,height:0,border:0,margin:0,background:\"none\"},r&&t.extend(s,{position:\"absolute\",left:\"-1000px\",top:\"-1000px\"});for(o in s)e.style[o]=s[o];e.appendChild(h),i=r||document.documentElement,i.insertBefore(e,i.firstChild),h.style.cssText=\"position: absolute; left: 10.7432222px;\",n=t(h).offset().left,a=n>10&&11>n,e.innerHTML=\"\",i.removeChild(e)}()}(),t.ui.position,t.widget(\"ui.draggable\",t.ui.mouse,{version:\"1.11.4\",widgetEventPrefix:\"drag\",options:{addClasses:!0,appendTo:\"parent\",axis:!1,connectToSortable:!1,containment:!1,cursor:\"auto\",cursorAt:!1,grid:!1,handle:!1,helper:\"original\",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:\"default\",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:\"both\",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){\"original\"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass(\"ui-draggable\"),this.options.disabled&&this.element.addClass(\"ui-draggable-disabled\"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),\"handle\"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(\".ui-draggable-dragging\")?(this.destroyOnClear=!0,void 0):(this.element.removeClass(\"ui-draggable ui-draggable-dragging ui-draggable-disabled\"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),this.helper||i.disabled||t(e.target).closest(\".ui-resizable-handle\").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(i.iframeFix===!0?\"iframe\":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t(\"<div>\").css(\"position\",\"absolute\").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&\"body\"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(s){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass(\"ui-draggable-dragging\"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css(\"position\"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return\"fixed\"===t(this).css(\"position\")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger(\"start\",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo(\"absolute\"),!i){var s=this._uiHash();if(this._trigger(\"drag\",e,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+\"px\",this.helper[0].style.top=this.position.top+\"px\",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),\"invalid\"===this.options.revert&&!s||\"valid\"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger(\"stop\",e)!==!1&&i._clear()}):this._trigger(\"stop\",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(\".ui-draggable-dragging\")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass(\"ui-draggable-handle\")},_removeHandleClassName:function(){this.handleElement.removeClass(\"ui-draggable-handle\")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):\"clone\"===i.helper?this.element.clone().removeAttr(\"id\"):this.element;return n.parents(\"body\").length||n.appendTo(\"parent\"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css(\"position\"))||n.css(\"position\",\"absolute\"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css(\"position\"))||(this.element[0].style.position=\"relative\")},_adjustOffsetFromHelper:function(e){\"string\"==typeof e&&(e=e.split(\" \")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),\"left\"in e&&(this.offset.click.left=e.left+this.margins.left),\"right\"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),\"top\"in e&&(this.offset.click.top=e.top+this.margins.top),\"bottom\"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return\"absolute\"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css(\"borderTopWidth\"),10)||0),left:e.left+(parseInt(this.offsetParent.css(\"borderLeftWidth\"),10)||0)}},_getRelativeOffset:function(){if(\"relative\"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css(\"top\"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css(\"left\"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css(\"marginLeft\"),10)||0,top:parseInt(this.element.css(\"marginTop\"),10)||0,right:parseInt(this.element.css(\"marginRight\"),10)||0,bottom:parseInt(this.element.css(\"marginBottom\"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?\"window\"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):\"document\"===n.containment?(this.containment=[0,0,t(a).width()-this.helperProportions.width-this.margins.left,(t(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):(\"parent\"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e=/(scroll|auto)/.test(i.css(\"overflow\")),this.containment=[(parseInt(i.css(\"borderLeftWidth\"),10)||0)+(parseInt(i.css(\"paddingLeft\"),10)||0),(parseInt(i.css(\"borderTopWidth\"),10)||0)+(parseInt(i.css(\"paddingTop\"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css(\"borderRightWidth\"),10)||0)-(parseInt(i.css(\"paddingRight\"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css(\"borderBottomWidth\"),10)||0)-(parseInt(i.css(\"paddingBottom\"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,e){e||(e=this.position);var i=\"absolute\"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-(\"fixed\"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-(\"fixed\"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=t.pageX,l=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),\"y\"===o.axis&&(h=this.originalPageX),\"x\"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(\"fixed\"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(\"fixed\"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}\r\n},_clear:function(){this.helper.removeClass(\"ui-draggable-dragging\"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){\"y\"!==this.options.axis&&\"auto\"!==this.helper.css(\"right\")&&(this.helper.width(this.helper.width()),this.helper.css(\"right\",\"auto\")),\"x\"!==this.options.axis&&\"auto\"!==this.helper.css(\"bottom\")&&(this.helper.height(this.helper.height()),this.helper.css(\"bottom\",\"auto\"))},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo(\"absolute\"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add(\"draggable\",\"connectToSortable\",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable(\"instance\");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger(\"activate\",e,n))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){var t=this;t.isOver?(t.isOver=0,s.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css(\"position\"),top:t.placeholder.css(\"top\"),left:t.placeholder.css(\"left\")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger(\"deactivate\",e,n))})},drag:function(e,i,s){t.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&t.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data(\"ui-sortable-item\",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},e.target=a.currentItem[0],a._mouseCapture(e,!0),a._mouseStart(e,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger(\"toSortable\",e),s.dropped=a.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(e),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger(\"out\",e,a._uiHash(a)),a._mouseStop(e,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger(\"fromSortable\",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add(\"draggable\",\"cursor\",{start:function(e,i,s){var n=t(\"body\"),a=s.options;n.css(\"cursor\")&&(a._cursor=n.css(\"cursor\")),n.css(\"cursor\",a.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t(\"body\").css(\"cursor\",n._cursor)}}),t.ui.plugin.add(\"draggable\",\"opacity\",{start:function(e,i,s){var n=t(i.helper),a=s.options;n.css(\"opacity\")&&(a._opacity=n.css(\"opacity\")),n.css(\"opacity\",a.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css(\"opacity\",n._opacity)}}),t.ui.plugin.add(\"draggable\",\"scroll\",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&\"HTML\"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&\"HTML\"!==o.tagName?(n.axis&&\"x\"===n.axis||(s.overflowOffset.top+o.offsetHeight-e.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&\"y\"===n.axis||(s.overflowOffset.left+o.offsetWidth-e.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&\"x\"===n.axis||(e.pageY-t(r).scrollTop()<n.scrollSensitivity?a=t(r).scrollTop(t(r).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<n.scrollSensitivity&&(a=t(r).scrollTop(t(r).scrollTop()+n.scrollSpeed))),n.axis&&\"y\"===n.axis||(e.pageX-t(r).scrollLeft()<n.scrollSensitivity?a=t(r).scrollLeft(t(r).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<n.scrollSensitivity&&(a=t(r).scrollLeft(t(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add(\"draggable\",\"snap\",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||\":data(ui-draggable)\":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,a,o,r,h,l,u,c,d,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,_=i.offset.top,b=_+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)h=s.snapElements[d].left-s.margins.left,l=h+s.snapElements[d].width,u=s.snapElements[d].top-s.margins.top,c=u+s.snapElements[d].height,h-m>v||g>l+m||u-m>b||_>c+m||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):(\"inner\"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(c-_),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo(\"relative\",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo(\"relative\",{top:c,left:0}).top),o&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:l}).left)),p=n||a||o||r,\"outer\"!==f.snapMode&&(n=m>=Math.abs(u-_),a=m>=Math.abs(c-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo(\"relative\",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo(\"relative\",{top:c-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=n||a||o||r||p)}}),t.ui.plugin.add(\"draggable\",\"stack\",{start:function(e,i,s){var n,a=s.options,o=t.makeArray(t(a.stack)).sort(function(e,i){return(parseInt(t(e).css(\"zIndex\"),10)||0)-(parseInt(t(i).css(\"zIndex\"),10)||0)});o.length&&(n=parseInt(t(o[0]).css(\"zIndex\"),10)||0,t(o).each(function(e){t(this).css(\"zIndex\",n+e)}),this.css(\"zIndex\",n+o.length))}}),t.ui.plugin.add(\"draggable\",\"zIndex\",{start:function(e,i,s){var n=t(i.helper),a=s.options;n.css(\"zIndex\")&&(a._zIndex=n.css(\"zIndex\")),n.css(\"zIndex\",a.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css(\"zIndex\",n._zIndex)}}),t.ui.draggable,t.widget(\"ui.droppable\",{version:\"1.11.4\",widgetEventPrefix:\"drop\",options:{accept:\"*\",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:\"default\",tolerance:\"intersect\",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(s)?s:function(t){return t.is(s)},this.proportions=function(){return arguments.length?(e=arguments[0],void 0):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass(\"ui-droppable\")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass(\"ui-droppable ui-droppable-disabled\")},_setOption:function(e,i){if(\"accept\"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if(\"scope\"===e){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger(\"activate\",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger(\"deactivate\",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger(\"over\",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger(\"out\",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(\":data(ui-droppable)\").not(\".ui-draggable-dragging\").each(function(){var i=t(this).droppable(\"instance\");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger(\"drop\",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,s,n){if(!i.offset)return!1;var a=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,r=a+e.helperProportions.width,h=o+e.helperProportions.height,l=i.offset.left,u=i.offset.top,c=l+i.proportions().width,d=u+i.proportions().height;switch(s){case\"fit\":return a>=l&&c>=r&&o>=u&&d>=h;case\"intersect\":return a+e.helperProportions.width/2>l&&c>r-e.helperProportions.width/2&&o+e.helperProportions.height/2>u&&d>h-e.helperProportions.height/2;case\"pointer\":return t(n.pageY,u,i.proportions().height)&&t(n.pageX,l,i.proportions().width);case\"touch\":return(o>=u&&d>=o||h>=u&&d>=h||u>o&&h>d)&&(a>=l&&c>=a||r>=l&&c>=r||l>a&&r>c);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{\"default\":[]},prepareOffsets:function(e,i){var s,n,a=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,r=(e.currentItem||e.element).find(\":data(ui-droppable)\").addBack();t:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||e&&!a[s].accept.call(a[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue t}a[s].visible=\"none\"!==a[s].element.css(\"display\"),a[s].visible&&(\"mousedown\"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil(\"body\").bind(\"scroll.droppable\",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=t.ui.intersect(e,this,this.options.tolerance,i),r=!o&&this.isover?\"isout\":o&&!this.isover?\"isover\":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(\":data(ui-droppable)\").filter(function(){return t(this).droppable(\"instance\").options.scope===n}),a.length&&(s=t(a[0]).droppable(\"instance\"),s.greedyChild=\"isover\"===r)),s&&\"isover\"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this[\"isout\"===r?\"isover\":\"isout\"]=!1,this[\"isover\"===r?\"_over\":\"_out\"].call(this,i),s&&\"isout\"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil(\"body\").unbind(\"scroll.droppable\"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.ui.droppable,t.widget(\"ui.resizable\",t.ui.mouse,{version:\"1.11.4\",widgetEventPrefix:\"resize\",options:{alsoResize:!1,animate:!1,animateDuration:\"slow\",animateEasing:\"swing\",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:\"e,s,se\",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,i){if(\"hidden\"===t(e).css(\"overflow\"))return!1;var s=i&&\"left\"===i?\"scrollLeft\":\"scrollTop\",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},_create:function(){var e,i,s,n,a,o=this,r=this.options;if(this.element.addClass(\"ui-resizable\"),t.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||\"ui-resizable-helper\":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t(\"<div class='ui-wrapper' style='overflow: hidden;'></div>\").css({position:this.element.css(\"position\"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css(\"top\"),left:this.element.css(\"left\")})),this.element=this.element.parent().data(\"ui-resizable\",this.element.resizable(\"instance\")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css(\"marginLeft\"),marginTop:this.originalElement.css(\"marginTop\"),marginRight:this.originalElement.css(\"marginRight\"),marginBottom:this.originalElement.css(\"marginBottom\")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css(\"resize\"),this.originalElement.css(\"resize\",\"none\"),this._proportionallyResizeElements.push(this.originalElement.css({position:\"static\",zoom:1,display:\"block\"})),this.originalElement.css({margin:this.originalElement.css(\"margin\")}),this._proportionallyResize()),this.handles=r.handles||(t(\".ui-resizable-handle\",this.element).length?{n:\".ui-resizable-n\",e:\".ui-resizable-e\",s:\".ui-resizable-s\",w:\".ui-resizable-w\",se:\".ui-resizable-se\",sw:\".ui-resizable-sw\",ne:\".ui-resizable-ne\",nw:\".ui-resizable-nw\"}:\"e,s,se\"),this._handles=t(),this.handles.constructor===String)for(\"all\"===this.handles&&(this.handles=\"n,e,s,w,se,sw,ne,nw\"),e=this.handles.split(\",\"),this.handles={},i=0;e.length>i;i++)s=t.trim(e[i]),a=\"ui-resizable-\"+s,n=t(\"<div class='ui-resizable-handle \"+a+\"'></div>\"),n.css({zIndex:r.zIndex}),\"se\"===s&&n.addClass(\"ui-icon ui-icon-gripsmall-diagonal-se\"),this.handles[s]=\".ui-resizable-\"+s,this.element.append(n);this._renderAxis=function(e){var i,s,n,a;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=[\"padding\",/ne|nw|n/.test(i)?\"Top\":/se|sw|s/.test(i)?\"Bottom\":/^e$/.test(i)?\"Right\":\"Left\"].join(\"\"),e.css(n,a),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(\".ui-resizable-handle\")),this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:\"se\")}),r.autoHide&&(this._handles.hide(),t(this.element).addClass(\"ui-resizable-autohide\").mouseenter(function(){r.disabled||(t(this).removeClass(\"ui-resizable-autohide\"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(t(this).addClass(\"ui-resizable-autohide\"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass(\"ui-resizable ui-resizable-disabled ui-resizable-resizing\").removeData(\"resizable\").removeData(\"ui-resizable\").unbind(\".resizable\").find(\".ui-resizable-handle\").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css(\"position\"),width:e.outerWidth(),height:e.outerHeight(),top:e.css(\"top\"),left:e.css(\"left\")}).insertAfter(e),e.remove()),this.originalElement.css(\"resize\",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css(\"left\")),s=this._num(this.helper.css(\"top\")),a.containment&&(i+=t(a.containment).scrollLeft()||0,s+=t(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio=\"number\"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=t(\".ui-resizable-\"+this.axis).css(\"cursor\"),t(\"body\").css(\"cursor\",\"auto\"===n?this.axis+\"-resize\":n),o.addClass(\"ui-resizable-resizing\"),this._propagate(\"start\",e),!0},_mouseDrag:function(e){var i,s,n=this.originalMousePosition,a=this.axis,o=e.pageX-n.left||0,r=e.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[e,o,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate(\"resize\",e),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger(\"resize\",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],\"left\")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css(\"left\"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css(\"top\"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(t.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t(\"body\").css(\"cursor\",\"auto\"),this.element.removeClass(\"ui-resizable-resizing\"),this._propagate(\"stop\",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+\"px\"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+\"px\"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+\"px\"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+\"px\"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,e>a.minWidth&&(a.minWidth=e),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),\"sw\"===s&&(t.left=e.left+(i.width-t.width),t.top=null),\"nw\"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,a=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(t.width=e.minWidth),o&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),a&&l&&(t.left=r-e.minWidth),s&&l&&(t.left=r-e.maxWidth),o&&u&&(t.top=h-e.minHeight),n&&u&&(t.top=h-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css(\"borderTopWidth\"),t.css(\"borderRightWidth\"),t.css(\"borderBottomWidth\"),t.css(\"borderLeftWidth\")],n=[t.css(\"paddingTop\"),t.css(\"paddingRight\"),t.css(\"paddingBottom\"),t.css(\"paddingLeft\")];4>e;e++)i[e]=parseInt(s[e],10)||0,i[e]+=parseInt(n[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t(\"<div style='overflow:hidden;'></div>\"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:\"absolute\",left:this.elementOffset.left+\"px\",top:this.elementOffset.top+\"px\",zIndex:++i.zIndex}),this.helper.appendTo(\"body\").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),\"resize\"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add(\"resizable\",\"animate\",{stop:function(e){var i=t(this).resizable(\"instance\"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],\"left\")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css(\"left\"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css(\"top\"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css(\"width\"),10),height:parseInt(i.element.css(\"height\"),10),top:parseInt(i.element.css(\"top\"),10),left:parseInt(i.element.css(\"left\"),10)};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate(\"resize\",e)}})}}),t.ui.plugin.add(\"resizable\",\"containment\",{start:function(){var e,i,s,n,a,o,r,h=t(this).resizable(\"instance\"),l=h.options,u=h.element,c=l.containment,d=c instanceof t?c.get(0):/parent/.test(c)?u.parent().get(0):c;d&&(h.containerElement=t(d),/document/.test(c)||c===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t([\"Top\",\"Right\",\"Left\",\"Bottom\"]).each(function(t,s){i[t]=h._num(e.css(\"padding\"+s))}),h.containerOffset=e.offset(),h.containerPosition=e.position(),h.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(d,\"left\")?d.scrollWidth:a,r=h._hasScroll(d)?d.scrollHeight:n,h.parentData={element:d,left:s.left,top:s.top,width:o,height:r}))},resize:function(e){var i,s,n,a,o=t(this).resizable(\"instance\"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||e.shiftKey,c={top:0,left:0},d=o.containerElement,p=!0;d[0]!==document&&/static/.test(d.css(\"position\"))&&(c=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-c.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css(\"position\")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-c.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-c.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=t(this).resizable(\"instance\"),i=e.options,s=e.containerOffset,n=e.containerPosition,a=e.containerElement,o=t(e.helper),r=o.offset(),h=o.outerWidth()-e.sizeDiff.width,l=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(a.css(\"position\"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(a.css(\"position\"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),t.ui.plugin.add(\"resizable\",\"alsoResize\",{start:function(){var e=t(this).resizable(\"instance\"),i=e.options;t(i.alsoResize).each(function(){var e=t(this);e.data(\"ui-resizable-alsoresize\",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css(\"left\"),10),top:parseInt(e.css(\"top\"),10)})})},resize:function(e,i){var s=t(this).resizable(\"instance\"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};t(n.alsoResize).each(function(){var e=t(this),s=t(this).data(\"ui-resizable-alsoresize\"),n={},a=e.parents(i.originalElement[0]).length?[\"width\",\"height\"]:[\"width\",\"height\",\"top\",\"left\"];t.each(a,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(n[e]=i||null)}),e.css(n)})},stop:function(){t(this).removeData(\"resizable-alsoresize\")}}),t.ui.plugin.add(\"resizable\",\"ghost\",{start:function(){var e=t(this).resizable(\"instance\"),i=e.options,s=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:\"block\",position:\"relative\",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass(\"ui-resizable-ghost\").addClass(\"string\"==typeof i.ghost?i.ghost:\"\"),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable(\"instance\");e.ghost&&e.ghost.css({position:\"relative\",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable(\"instance\");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add(\"resizable\",\"grid\",{resize:function(){var e,i=t(this).resizable(\"instance\"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h=\"number\"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,c=Math.round((n.width-a.width)/l)*l,d=Math.round((n.height-a.height)/u)*u,p=a.width+c,f=a.height+d,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,_=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),_&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-d):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-c):((0>=f-u||0>=p-l)&&(e=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-d):(f=u-e.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-c):(p=l-e.width,i.size.width=p,i.position.left=o.left+a.width-p))}}),t.ui.resizable,t.widget(\"ui.selectable\",t.ui.mouse,{version:\"1.11.4\",options:{appendTo:\"body\",autoRefresh:!0,distance:0,filter:\"*\",tolerance:\"touch\",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;\r\nthis.element.addClass(\"ui-selectable\"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass(\"ui-selectee\"),e.each(function(){var e=t(this),i=e.offset();t.data(this,\"selectable-item\",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass(\"ui-selected\"),selecting:e.hasClass(\"ui-selecting\"),unselecting:e.hasClass(\"ui-unselecting\")})})},this.refresh(),this.selectees=e.addClass(\"ui-selectee\"),this._mouseInit(),this.helper=t(\"<div class='ui-selectable-helper'></div>\")},_destroy:function(){this.selectees.removeClass(\"ui-selectee\").removeData(\"selectable-item\"),this.element.removeClass(\"ui-selectable ui-selectable-disabled\"),this._mouseDestroy()},_mouseStart:function(e){var i=this,s=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(s.filter,this.element[0]),this._trigger(\"start\",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(\".ui-selected\").each(function(){var s=t.data(this,\"selectable-item\");s.startselected=!0,e.metaKey||e.ctrlKey||(s.$element.removeClass(\"ui-selected\"),s.selected=!1,s.$element.addClass(\"ui-unselecting\"),s.unselecting=!0,i._trigger(\"unselecting\",e,{unselecting:s.element}))}),t(e.target).parents().addBack().each(function(){var s,n=t.data(this,\"selectable-item\");return n?(s=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass(\"ui-selected\"),n.$element.removeClass(s?\"ui-unselecting\":\"ui-selected\").addClass(s?\"ui-selecting\":\"ui-unselecting\"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger(\"selecting\",e,{selecting:n.element}):i._trigger(\"unselecting\",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=e.pageX,h=e.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=t.data(this,\"selectable-item\"),l=!1;i&&i.element!==s.element[0]&&(\"touch\"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):\"fit\"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass(\"ui-selected\"),i.selected=!1),i.unselecting&&(i.$element.removeClass(\"ui-unselecting\"),i.unselecting=!1),i.selecting||(i.$element.addClass(\"ui-selecting\"),i.selecting=!0,s._trigger(\"selecting\",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass(\"ui-selecting\"),i.selecting=!1,i.$element.addClass(\"ui-selected\"),i.selected=!0):(i.$element.removeClass(\"ui-selecting\"),i.selecting=!1,i.startselected&&(i.$element.addClass(\"ui-unselecting\"),i.unselecting=!0),s._trigger(\"unselecting\",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass(\"ui-selected\"),i.selected=!1,i.$element.addClass(\"ui-unselecting\"),i.unselecting=!0,s._trigger(\"unselecting\",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(\".ui-unselecting\",this.element[0]).each(function(){var s=t.data(this,\"selectable-item\");s.$element.removeClass(\"ui-unselecting\"),s.unselecting=!1,s.startselected=!1,i._trigger(\"unselected\",e,{unselected:s.element})}),t(\".ui-selecting\",this.element[0]).each(function(){var s=t.data(this,\"selectable-item\");s.$element.removeClass(\"ui-selecting\").addClass(\"ui-selected\"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger(\"selected\",e,{selected:s.element})}),this._trigger(\"stop\",e),this.helper.remove(),!1}}),t.widget(\"ui.sortable\",t.ui.mouse,{version:\"1.11.4\",widgetEventPrefix:\"sort\",ready:!1,options:{appendTo:\"parent\",axis:!1,connectWith:!1,containment:!1,cursor:\"auto\",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:\"original\",items:\"> *\",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:\"default\",tolerance:\"intersect\",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css(\"float\"))||/inline|table-cell/.test(t.css(\"display\"))},_create:function(){this.containerCache={},this.element.addClass(\"ui-sortable\"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),\"handle\"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(\".ui-sortable-handle\").removeClass(\"ui-sortable-handle\"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass(\"ui-sortable-handle\")})},_destroy:function(){this.element.removeClass(\"ui-sortable ui-sortable-disabled\").find(\".ui-sortable-handle\").removeClass(\"ui-sortable-handle\"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+\"-item\");return this},_mouseCapture:function(e,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||\"static\"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,a.widgetName+\"-item\")===a?(s=t(this),!1):void 0}),t.data(e.target,a.widgetName+\"-item\")===a&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find(\"*\").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css(\"position\",\"absolute\"),this.cssPosition=this.helper.css(\"position\"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&\"auto\"!==o.cursor&&(a=this.document.find(\"body\"),this.storedCursor=a.css(\"cursor\"),a.css(\"cursor\",o.cursor),this.storedStylesheet=t(\"<style>*{ cursor: \"+o.cursor+\" !important; }</style>\").appendTo(a)),o.opacity&&(this.helper.css(\"opacity\")&&(this._storedOpacity=this.helper.css(\"opacity\")),this.helper.css(\"opacity\",o.opacity)),o.zIndex&&(this.helper.css(\"zIndex\")&&(this._storedZIndex=this.helper.css(\"zIndex\")),this.helper.css(\"zIndex\",o.zIndex)),this.scrollParent[0]!==this.document[0]&&\"HTML\"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger(\"start\",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger(\"activate\",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass(\"ui-sortable-helper\"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo(\"absolute\"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&\"HTML\"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),e.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo(\"absolute\"),this.options.axis&&\"y\"===this.options.axis||(this.helper[0].style.left=this.position.left+\"px\"),this.options.axis&&\"x\"===this.options.axis||(this.helper[0].style.top=this.position.top+\"px\"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?\"next\":\"prev\"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&(\"semi-dynamic\"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===a?\"down\":\"up\",\"pointer\"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger(\"change\",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger(\"sort\",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&\"x\"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&\"y\"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),\"original\"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger(\"deactivate\",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger(\"out\",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),\"original\"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||\"id\")||\"\").match(e.expression||/(.+)[\\-=_](.+)/);i&&s.push((e.key||i[1]+\"[]\")+\"=\"+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+\"=\"),s.join(\"&\")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||\"id\")||\"\")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=t.left,o=a+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,u=this.offset.click.left,c=\"x\"===this.options.axis||s+l>r&&h>s+l,d=\"y\"===this.options.axis||e+u>a&&o>e+u,p=c&&d;return\"pointer\"===this.options.tolerance||this.options.forcePointerForContainers||\"pointer\"!==this.options.tolerance&&this.helperProportions[this.floating?\"width\":\"height\"]>t[this.floating?\"width\":\"height\"]?p:e+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e=\"x\"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i=\"y\"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),s=e&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&\"right\"===a||\"down\"===n?2:1:n&&(\"down\"===n?2:1):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?\"right\"===n&&i||\"left\"===n&&!i:s&&(\"down\"===s&&e||\"up\"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?\"down\":\"up\")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?\"right\":\"left\")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(a=t(l[s],this.document[0]),n=a.length-1;n>=0;n--)o=t.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"),o]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(\":data(\"+this.widgetName+\"-item)\");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,c=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)a=t.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(c.push([t.isFunction(a.options.items)?a.options.items.call(a.element[0],e,{item:this.currentItem}):t(a.options.items,a.element),a]),this.containers.push(a));for(i=c.length-1;i>=0;i--)for(o=c[i][1],r=c[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+\"-item\",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?\"x\"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t(\"<\"+s+\">\",e.document[0]).addClass(i||e.currentItem[0].className+\" ui-sortable-placeholder\").removeClass(\"ui-sortable-helper\");return\"tbody\"===s?e._createTrPlaceholder(e.currentItem.find(\"tr\").eq(0),t(\"<tr>\",e.document[0]).appendTo(n)):\"tr\"===s?e._createTrPlaceholder(e.currentItem,n):\"img\"===s&&n.attr(\"src\",e.currentItem.attr(\"src\")),i||n.css(\"visibility\",\"hidden\"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css(\"paddingTop\")||0,10)-parseInt(e.currentItem.css(\"paddingBottom\")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css(\"paddingLeft\")||0,10)-parseInt(e.currentItem.css(\"paddingRight\")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t(\"<td>&#160;</td>\",s.document[0]).attr(\"colspan\",t(this).attr(\"colspan\")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,a,o,r,h,l,u,c,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger(\"out\",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger(\"over\",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=d.floating||this._isFloating(this.currentItem),o=u?\"left\":\"top\",r=u?\"width\":\"height\",c=u?\"clientX\":\"clientY\",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,e[c]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(e[c]-h)&&(n=Math.abs(e[c]-h),a=this.items[s],this.direction=l?\"up\":\"down\"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger(\"over\",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(e,a,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger(\"change\",e,this._uiHash()),this.containers[p]._trigger(\"change\",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger(\"over\",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):\"clone\"===i.helper?this.currentItem.clone():this.currentItem;return s.parents(\"body\").length||t(\"parent\"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css(\"position\"),top:this.currentItem.css(\"top\"),left:this.currentItem.css(\"left\")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){\"string\"==typeof e&&(e=e.split(\" \")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),\"left\"in e&&(this.offset.click.left=e.left+this.margins.left),\"right\"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),\"top\"in e&&(this.offset.click.top=e.top+this.margins.top),\"bottom\"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return\"absolute\"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&\"html\"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css(\"borderTopWidth\"),10)||0),left:e.left+(parseInt(this.offsetParent.css(\"borderLeftWidth\"),10)||0)}},_getRelativeOffset:function(){if(\"relative\"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css(\"top\"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css(\"left\"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css(\"marginLeft\"),10)||0,top:parseInt(this.currentItem.css(\"marginTop\"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;\"parent\"===n.containment&&(n.containment=this.helper[0].parentNode),(\"document\"===n.containment||\"window\"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,\"document\"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(\"document\"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s=\"hidden\"!==t(e).css(\"overflow\"),this.containment=[i.left+(parseInt(t(e).css(\"borderLeftWidth\"),10)||0)+(parseInt(t(e).css(\"paddingLeft\"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css(\"borderTopWidth\"),10)||0)+(parseInt(t(e).css(\"paddingTop\"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css(\"borderLeftWidth\"),10)||0)-(parseInt(t(e).css(\"paddingRight\"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css(\"borderTopWidth\"),10)||0)-(parseInt(t(e).css(\"paddingBottom\"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s=\"absolute\"===e?1:-1,n=\"absolute\"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(\"fixed\"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(\"fixed\"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,a=e.pageX,o=e.pageY,r=\"absolute\"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return\"relative\"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(\"fixed\"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(\"fixed\"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],\"down\"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)(\"auto\"===this._storedCSS[s]||\"static\"===this._storedCSS[s])&&(this._storedCSS[s]=\"\");this.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger(\"receive\",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(\".ui-sortable-helper\")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger(\"update\",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger(\"remove\",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger(\"receive\",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger(\"update\",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i(\"deactivate\",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i(\"out\",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find(\"body\").css(\"cursor\",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css(\"opacity\",this._storedOpacity),this._storedZIndex&&this.helper.css(\"zIndex\",\"auto\"===this._storedZIndex?\"\":this._storedZIndex),this.dragging=!1,e||this._trigger(\"beforeStop\",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger(\"stop\",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget(\"ui.accordion\",{version:\"1.11.4\",options:{active:0,animate:{},collapsible:!1,event:\"click\",header:\"> li > :first-child,> :not(li):even\",heightStyle:\"auto\",icons:{activeHeader:\"ui-icon-triangle-1-s\",header:\"ui-icon-triangle-1-e\"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:\"hide\",borderBottomWidth:\"hide\",paddingTop:\"hide\",paddingBottom:\"hide\",height:\"hide\"},showProps:{borderTopWidth:\"show\",borderBottomWidth:\"show\",paddingTop:\"show\",paddingBottom:\"show\",height:\"show\"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass(\"ui-accordion ui-widget ui-helper-reset\").attr(\"role\",\"tablist\"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t(\"<span>\").addClass(\"ui-accordion-header-icon ui-icon \"+e.header).prependTo(this.headers),this.active.children(\".ui-accordion-header-icon\").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass(\"ui-accordion-icons\"))},_destroyIcons:function(){this.headers.removeClass(\"ui-accordion-icons\").children(\".ui-accordion-header-icon\").remove()},_destroy:function(){var t;this.element.removeClass(\"ui-accordion ui-widget ui-helper-reset\").removeAttr(\"role\"),this.headers.removeClass(\"ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top\").removeAttr(\"role\").removeAttr(\"aria-expanded\").removeAttr(\"aria-selected\").removeAttr(\"aria-controls\").removeAttr(\"tabIndex\").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass(\"ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled\").css(\"display\",\"\").removeAttr(\"role\").removeAttr(\"aria-hidden\").removeAttr(\"aria-labelledby\").removeUniqueId(),\"content\"!==this.options.heightStyle&&t.css(\"height\",\"\")},_setOption:function(t,e){return\"active\"===t?(this._activate(e),void 0):(\"event\"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),\"collapsible\"!==t||e||this.options.active!==!1||this._activate(0),\"icons\"===t&&(this._destroyIcons(),e&&this._createIcons()),\"disabled\"===t&&(this.element.toggleClass(\"ui-state-disabled\",!!e).attr(\"aria-disabled\",e),this.headers.add(this.headers.next()).toggleClass(\"ui-state-disabled\",!!e)),void 0)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),a=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(t(e.target).attr(\"tabIndex\",-1),t(a).attr(\"tabIndex\",0),a.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(\".ui-state-disabled\").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass(\"ui-accordion-header ui-state-default ui-corner-all\"),this.panels=this.headers.next().addClass(\"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom\").filter(\":not(.ui-accordion-content-active)\").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))\r\n},_refresh:function(){var e,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\").removeClass(\"ui-corner-all\"),this.active.next().addClass(\"ui-accordion-content-active\").show(),this.headers.attr(\"role\",\"tab\").each(function(){var e=t(this),i=e.uniqueId().attr(\"id\"),s=e.next(),n=s.uniqueId().attr(\"id\");e.attr(\"aria-controls\",n),s.attr(\"aria-labelledby\",i)}).next().attr(\"role\",\"tabpanel\"),this.headers.not(this.active).attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\",tabIndex:-1}).next().attr({\"aria-hidden\":\"true\"}).hide(),this.active.length?this.active.attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0}).next().attr({\"aria-hidden\":\"false\"}):this.headers.eq(0).attr(\"tabIndex\",0),this._createIcons(),this._setupEvents(i.event),\"fill\"===s?(e=n.height(),this.element.siblings(\":visible\").each(function(){var i=t(this),s=i.css(\"position\");\"absolute\"!==s&&\"fixed\"!==s&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css(\"overflow\",\"auto\")):\"auto\"===s&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css(\"height\",\"\").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return\"number\"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:\"_keydown\"};e&&t.each(e.split(\" \"),function(t,e){i[e]=\"_eventHandler\"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:\"_panelKeyDown\"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?t():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?t():n,newPanel:r};e.preventDefault(),a&&!i.collapsible||this._trigger(\"beforeActivate\",e,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?t():n,this._toggle(l),s.removeClass(\"ui-accordion-header-active ui-state-active\"),i.icons&&s.children(\".ui-accordion-header-icon\").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass(\"ui-corner-all\").addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\"),i.icons&&n.children(\".ui-accordion-header-icon\").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass(\"ui-accordion-content-active\")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({\"aria-hidden\":\"true\"}),s.prev().attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\"}),i.length&&s.length?s.prev().attr({tabIndex:-1,\"aria-expanded\":\"false\"}):i.length&&this.headers.filter(function(){return 0===parseInt(t(this).attr(\"tabIndex\"),10)}).attr(\"tabIndex\",-1),i.attr(\"aria-hidden\",\"false\").prev().attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0})},_animate:function(t,e,i){var s,n,a,o=this,r=0,h=t.css(\"box-sizing\"),l=t.length&&(!e.length||t.index()<e.index()),u=this.options.animate||{},c=l&&u.down||u,d=function(){o._toggleComplete(i)};return\"number\"==typeof c&&(a=c),\"string\"==typeof c&&(n=c),n=n||c.easing||u.easing,a=a||c.duration||u.duration,e.length?t.length?(s=t.show().outerHeight(),e.animate(this.hideProps,{duration:a,easing:n,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(this.showProps,{duration:a,easing:n,complete:d,step:function(t,i){i.now=Math.round(t),\"height\"!==i.prop?\"content-box\"===h&&(r+=i.now):\"content\"!==o.options.heightStyle&&(i.now=Math.round(s-e.outerHeight()-r),r=0)}}),void 0):e.animate(this.hideProps,a,n,d):t.animate(this.showProps,a,n,d)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass(\"ui-accordion-content-active\").prev().removeClass(\"ui-corner-top\").addClass(\"ui-corner-all\"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger(\"activate\",null,t)}}),t.widget(\"ui.menu\",{version:\"1.11.4\",defaultElement:\"<ul>\",delay:300,options:{icons:{submenu:\"ui-icon-carat-1-e\"},items:\"> *\",menus:\"ul\",position:{my:\"left-1 top\",at:\"right top\"},role:\"menu\",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass(\"ui-menu ui-widget ui-widget-content\").toggleClass(\"ui-menu-icons\",!!this.element.find(\".ui-icon\").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass(\"ui-state-disabled\").attr(\"aria-disabled\",\"true\"),this._on({\"mousedown .ui-menu-item\":function(t){t.preventDefault()},\"click .ui-menu-item\":function(e){var i=t(e.target);!this.mouseHandled&&i.not(\".ui-state-disabled\").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(\".ui-menu\").length?this.expand(e):!this.element.is(\":focus\")&&t(this.document[0].activeElement).closest(\".ui-menu\").length&&(this.element.trigger(\"focus\",[!0]),this.active&&1===this.active.parents(\".ui-menu\").length&&clearTimeout(this.timer)))},\"mouseenter .ui-menu-item\":function(e){if(!this.previousFilter){var i=t(e.currentTarget);i.siblings(\".ui-state-active\").removeClass(\"ui-state-active\"),this.focus(e,i)}},mouseleave:\"collapseAll\",\"mouseleave .ui-menu\":\"collapseAll\",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:\"_keydown\"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr(\"aria-activedescendant\").find(\".ui-menu\").addBack().removeClass(\"ui-menu ui-widget ui-widget-content ui-menu-icons ui-front\").removeAttr(\"role\").removeAttr(\"tabIndex\").removeAttr(\"aria-labelledby\").removeAttr(\"aria-expanded\").removeAttr(\"aria-hidden\").removeAttr(\"aria-disabled\").removeUniqueId().show(),this.element.find(\".ui-menu-item\").removeClass(\"ui-menu-item\").removeAttr(\"role\").removeAttr(\"aria-disabled\").removeUniqueId().removeClass(\"ui-state-hover\").removeAttr(\"tabIndex\").removeAttr(\"role\").removeAttr(\"aria-haspopup\").children().each(function(){var e=t(this);e.data(\"ui-menu-submenu-carat\")&&e.remove()}),this.element.find(\".ui-menu-divider\").removeClass(\"ui-menu-divider ui-widget-content\")},_keydown:function(e){var i,s,n,a,o=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move(\"first\",\"first\",e);break;case t.ui.keyCode.END:this._move(\"last\",\"last\",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(\".ui-state-disabled\")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=!1,s=this.previousFilter||\"\",n=String.fromCharCode(e.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(\".ui-menu-item\"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&e.preventDefault()},_activate:function(t){this.active.is(\".ui-state-disabled\")||(this.active.is(\"[aria-haspopup='true']\")?this.expand(t):this.select(t))},refresh:function(){var e,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass(\"ui-menu-icons\",!!this.element.find(\".ui-icon\").length),a.filter(\":not(.ui-menu)\").addClass(\"ui-menu ui-widget ui-widget-content ui-front\").hide().attr({role:this.options.role,\"aria-hidden\":\"true\",\"aria-expanded\":\"false\"}).each(function(){var e=t(this),i=e.parent(),s=t(\"<span>\").addClass(\"ui-menu-icon ui-icon \"+n).data(\"ui-menu-submenu-carat\",!0);i.attr(\"aria-haspopup\",\"true\").prepend(s),e.attr(\"aria-labelledby\",i.attr(\"id\"))}),e=a.add(this.element),i=e.find(this.options.items),i.not(\".ui-menu-item\").each(function(){var e=t(this);s._isDivider(e)&&e.addClass(\"ui-widget-content ui-menu-divider\")}),i.not(\".ui-menu-item, .ui-menu-divider\").addClass(\"ui-menu-item\").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(\".ui-state-disabled\").attr(\"aria-disabled\",\"true\"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:\"menuitem\",listbox:\"option\"}[this.options.role]},_setOption:function(t,e){\"icons\"===t&&this.element.find(\".ui-menu-icon\").removeClass(this.options.icons.submenu).addClass(e.submenu),\"disabled\"===t&&this.element.toggleClass(\"ui-state-disabled\",!!e).attr(\"aria-disabled\",e),this._super(t,e)},focus:function(t,e){var i,s;this.blur(t,t&&\"focus\"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.addClass(\"ui-state-focus\").removeClass(\"ui-state-active\"),this.options.role&&this.element.attr(\"aria-activedescendant\",s.attr(\"id\")),this.active.parent().closest(\".ui-menu-item\").addClass(\"ui-state-active\"),t&&\"keydown\"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(\".ui-menu\"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger(\"focus\",t,{item:e})},_scrollIntoView:function(e){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],\"borderTopWidth\"))||0,s=parseFloat(t.css(this.activeMenu[0],\"paddingTop\"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass(\"ui-state-focus\"),this.active=null,this._trigger(\"blur\",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),\"true\"===t.attr(\"aria-hidden\")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(\".ui-menu\").not(e.parents(\".ui-menu\")).hide().attr(\"aria-hidden\",\"true\"),e.show().removeAttr(\"aria-hidden\").attr(\"aria-expanded\",\"true\").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(\".ui-menu\"));s.length||(s=this.element),this._close(s),this.blur(e),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(\".ui-menu\").hide().attr(\"aria-hidden\",\"true\").attr(\"aria-expanded\",\"false\").end().find(\".ui-state-active\").not(\".ui-state-focus\").removeClass(\"ui-state-active\")},_closeOnDocumentClick:function(e){return!t(e.target).closest(\".ui-menu\").length},_isDivider:function(t){return!/[^\\-\\u2014\\u2013\\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(\".ui-menu-item\",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(\".ui-menu \").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move(\"next\",\"first\",t)},previous:function(t){this._move(\"prev\",\"last\",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(\".ui-menu-item\").length},isLastItem:function(){return this.active&&!this.active.nextAll(\".ui-menu-item\").length},_move:function(t,e,i){var s;this.active&&(s=\"first\"===t||\"last\"===t?this.active[\"first\"===t?\"prevAll\":\"nextAll\"](\".ui-menu-item\").eq(-1):this.active[t+\"All\"](\".ui-menu-item\").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(\".ui-menu-item\").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?\"last\":\"first\"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(\".ui-menu-item\").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop(\"scrollHeight\")},select:function(e){this.active=this.active||t(e.target).closest(\".ui-menu-item\");var i={item:this.active};this.active.has(\".ui-menu\").length||this.collapseAll(e,!0),this._trigger(\"select\",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\"),s=RegExp(\"^\"+i,\"i\");return this.activeMenu.find(this.options.items).filter(\".ui-menu-item\").filter(function(){return s.test(t.trim(t(this).text()))})}}),t.widget(\"ui.autocomplete\",{version:\"1.11.4\",defaultElement:\"<input>\",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:\"left top\",at:\"left bottom\",collision:\"none\"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),a=\"textarea\"===n,o=\"input\"===n;this.isMultiLine=a?!0:o?!1:this.element.prop(\"isContentEditable\"),this.valueMethod=this.element[a||o?\"val\":\"text\"],this.isNewMenu=!0,this.element.addClass(\"ui-autocomplete-input\").attr(\"autocomplete\",\"off\"),this._on(this.element,{keydown:function(n){if(this.element.prop(\"readOnly\"))return e=!0,s=!0,i=!0,void 0;e=!1,s=!1,i=!1;var a=t.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:e=!0,this._move(\"previousPage\",n);break;case a.PAGE_DOWN:e=!0,this._move(\"nextPage\",n);break;case a.UP:e=!0,this._keyEvent(\"previous\",n);break;case a.DOWN:e=!0,this._keyEvent(\"next\",n);break;case a.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(\":visible\")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(\":visible\"))&&s.preventDefault(),void 0;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move(\"previousPage\",s);break;case n.PAGE_DOWN:this._move(\"nextPage\",s);break;case n.UP:this._keyEvent(\"previous\",s);break;case n.DOWN:this._keyEvent(\"next\",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),void 0):(this._searchTimeout(t),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(t),this._change(t),void 0)}}),this._initSource(),this.menu=t(\"<ul>\").addClass(\"ui-autocomplete ui-front\").appendTo(this._appendTo()).menu({role:null}).hide().menu(\"instance\"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(\".ui-menu-item\").length||this._delay(function(){var e=this;this.document.one(\"mousedown\",function(s){s.target===e.element[0]||s.target===i||t.contains(i,s.target)||e.close()})})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),this.document.one(\"mousemove\",function(){t(e.target).trigger(e.originalEvent)}),void 0):(n=i.item.data(\"ui-autocomplete-item\"),!1!==this._trigger(\"focus\",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),s=i.item.attr(\"aria-label\")||n.value,s&&t.trim(s).length&&(this.liveRegion.children().hide(),t(\"<div>\").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(t,e){var i=e.item.data(\"ui-autocomplete-item\"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger(\"select\",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t(\"<span>\",{role:\"status\",\"aria-live\":\"assertive\",\"aria-relevant\":\"additions\"}).addClass(\"ui-helper-hidden-accessible\").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr(\"autocomplete\")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass(\"ui-autocomplete-input\").removeAttr(\"autocomplete\"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),\"source\"===t&&this._initSource(),\"appendTo\"===t&&this.menu.element.appendTo(this._appendTo()),\"disabled\"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(\".ui-front\")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):\"string\"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:\"json\",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(\":visible\"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger(\"search\",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass(\"ui-autocomplete-loading\"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass(\"ui-autocomplete-loading\")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger(\"response\",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger(\"open\")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(\":visible\")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger(\"close\",t))},_change:function(t){this.previous!==this._value()&&this._trigger(\"change\",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return\"string\"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width(\"\").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data(\"ui-autocomplete-item\",e)},_renderItem:function(e,i){return t(\"<li>\").text(i.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(\":visible\")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[t](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(\":visible\"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),\"i\");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget(\"ui.autocomplete\",t.ui.autocomplete,{options:{messages:{noResults:\"No search results.\",results:function(t){return t+(t>1?\" results are\":\" result is\")+\" available, use up and down arrow keys to navigate.\"}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t(\"<div>\").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var d,p=\"ui-button ui-widget ui-state-default ui-corner-all\",f=\"ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only\",m=function(){var e=t(this);setTimeout(function(){e.find(\":ui-button\").button(\"refresh\")},1)},g=function(e){var i=e.name,s=e.form,n=t([]);return i&&(i=i.replace(/'/g,\"\\\\'\"),n=s?t(s).find(\"[name='\"+i+\"'][type=radio]\"):t(\"[name='\"+i+\"'][type=radio]\",e.ownerDocument).filter(function(){return!this.form})),n};t.widget(\"ui.button\",{version:\"1.11.4\",defaultElement:\"<button>\",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest(\"form\").unbind(\"reset\"+this.eventNamespace).bind(\"reset\"+this.eventNamespace,m),\"boolean\"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop(\"disabled\"):this.element.prop(\"disabled\",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr(\"title\");var e=this,i=this.options,s=\"checkbox\"===this.type||\"radio\"===this.type,n=s?\"\":\"ui-state-active\";null===i.label&&(i.label=\"input\"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr(\"role\",\"button\").bind(\"mouseenter\"+this.eventNamespace,function(){i.disabled||this===d&&t(this).addClass(\"ui-state-active\")}).bind(\"mouseleave\"+this.eventNamespace,function(){i.disabled||t(this).removeClass(n)}).bind(\"click\"+this.eventNamespace,function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass(\"ui-state-focus\")},blur:function(){this.buttonElement.removeClass(\"ui-state-focus\")}}),s&&this.element.bind(\"change\"+this.eventNamespace,function(){e.refresh()}),\"checkbox\"===this.type?this.buttonElement.bind(\"click\"+this.eventNamespace,function(){return i.disabled?!1:void 0}):\"radio\"===this.type?this.buttonElement.bind(\"click\"+this.eventNamespace,function(){if(i.disabled)return!1;t(this).addClass(\"ui-state-active\"),e.buttonElement.attr(\"aria-pressed\",\"true\");var s=e.element[0];g(s).not(s).map(function(){return t(this).button(\"widget\")[0]}).removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\")}):(this.buttonElement.bind(\"mousedown\"+this.eventNamespace,function(){return i.disabled?!1:(t(this).addClass(\"ui-state-active\"),d=this,e.document.one(\"mouseup\",function(){d=null}),void 0)}).bind(\"mouseup\"+this.eventNamespace,function(){return i.disabled?!1:(t(this).removeClass(\"ui-state-active\"),void 0)}).bind(\"keydown\"+this.eventNamespace,function(e){return i.disabled?!1:((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass(\"ui-state-active\"),void 0)}).bind(\"keyup\"+this.eventNamespace+\" blur\"+this.eventNamespace,function(){t(this).removeClass(\"ui-state-active\")}),this.buttonElement.is(\"a\")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption(\"disabled\",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is(\"[type=checkbox]\")?\"checkbox\":this.element.is(\"[type=radio]\")?\"radio\":this.element.is(\"input\")?\"input\":\"button\",\"checkbox\"===this.type||\"radio\"===this.type?(t=this.element.parents().last(),e=\"label[for='\"+this.element.attr(\"id\")+\"']\",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass(\"ui-helper-hidden-accessible\"),i=this.element.is(\":checked\"),i&&this.buttonElement.addClass(\"ui-state-active\"),this.buttonElement.prop(\"aria-pressed\",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass(\"ui-helper-hidden-accessible\"),this.buttonElement.removeClass(p+\" ui-state-active \"+f).removeAttr(\"role\").removeAttr(\"aria-pressed\").html(this.buttonElement.find(\".ui-button-text\").html()),this.hasTitle||this.buttonElement.removeAttr(\"title\")},_setOption:function(t,e){return this._super(t,e),\"disabled\"===t?(this.widget().toggleClass(\"ui-state-disabled\",!!e),this.element.prop(\"disabled\",!!e),e&&(\"checkbox\"===this.type||\"radio\"===this.type?this.buttonElement.removeClass(\"ui-state-focus\"):this.buttonElement.removeClass(\"ui-state-focus ui-state-active\")),void 0):(this._resetButton(),void 0)},refresh:function(){var e=this.element.is(\"input, button\")?this.element.is(\":disabled\"):this.element.hasClass(\"ui-button-disabled\");e!==this.options.disabled&&this._setOption(\"disabled\",e),\"radio\"===this.type?g(this.element[0]).each(function(){t(this).is(\":checked\")?t(this).button(\"widget\").addClass(\"ui-state-active\").attr(\"aria-pressed\",\"true\"):t(this).button(\"widget\").removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\")}):\"checkbox\"===this.type&&(this.element.is(\":checked\")?this.buttonElement.addClass(\"ui-state-active\").attr(\"aria-pressed\",\"true\"):this.buttonElement.removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\"))},_resetButton:function(){if(\"input\"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var e=this.buttonElement.removeClass(f),i=t(\"<span></span>\",this.document[0]).addClass(\"ui-button-text\").html(this.options.label).appendTo(e.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push(\"ui-button-text-icon\"+(n?\"s\":s.primary?\"-primary\":\"-secondary\")),s.primary&&e.prepend(\"<span class='ui-button-icon-primary ui-icon \"+s.primary+\"'></span>\"),s.secondary&&e.append(\"<span class='ui-button-icon-secondary ui-icon \"+s.secondary+\"'></span>\"),this.options.text||(a.push(n?\"ui-button-icons-only\":\"ui-button-icon-only\"),this.hasTitle||e.attr(\"title\",t.trim(i)))):a.push(\"ui-button-text-only\"),e.addClass(a.join(\" \"))}}),t.widget(\"ui.buttonset\",{version:\"1.11.4\",options:{items:\"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)\"},_create:function(){this.element.addClass(\"ui-buttonset\")},_init:function(){this.refresh()},_setOption:function(t,e){\"disabled\"===t&&this.buttons.button(\"option\",t,e),this._super(t,e)},refresh:function(){var e=\"rtl\"===this.element.css(\"direction\"),i=this.element.find(this.options.items),s=i.filter(\":ui-button\");i.not(\":ui-button\").button(),s.button(\"refresh\"),this.buttons=i.map(function(){return t(this).button(\"widget\")[0]}).removeClass(\"ui-corner-all ui-corner-left ui-corner-right\").filter(\":first\").addClass(e?\"ui-corner-right\":\"ui-corner-left\").end().filter(\":last\").addClass(e?\"ui-corner-left\":\"ui-corner-right\").end().end()},_destroy:function(){this.element.removeClass(\"ui-buttonset\"),this.buttons.map(function(){return t(this).button(\"widget\")[0]}).removeClass(\"ui-corner-left ui-corner-right\").end().button(\"destroy\")}}),t.ui.button,t.extend(t.ui,{datepicker:{version:\"1.11.4\"}});var v;t.extend(n.prototype,{markerClassName:\"hasDatepicker\",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return r(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,a;s=e.nodeName.toLowerCase(),n=\"div\"===s||\"span\"===s,e.id||(this.uuid+=1,e.id=\"dp\"+this.uuid),a=this._newInst(t(e),n),a.settings=t.extend({},i||{}),\"input\"===s?this._connectDatepicker(e,a):n&&this._inlineDatepicker(e,a)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\\-])/g,\"\\\\\\\\$1\");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(t(\"<div class='\"+this._inlineClass+\" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,\"datepicker\",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,a,o=this._get(i,\"appendText\"),r=this._get(i,\"isRTL\");i.append&&i.append.remove(),o&&(i.append=t(\"<span class='\"+this._appendClass+\"'>\"+o+\"</span>\"),e[r?\"before\":\"after\"](i.append)),e.unbind(\"focus\",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,\"showOn\"),(\"focus\"===s||\"both\"===s)&&e.focus(this._showDatepicker),(\"button\"===s||\"both\"===s)&&(n=this._get(i,\"buttonText\"),a=this._get(i,\"buttonImage\"),i.trigger=t(this._get(i,\"buttonImageOnly\")?t(\"<img/>\").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):t(\"<button type='button'></button>\").addClass(this._triggerClass).html(a?t(\"<img/>\").attr({src:a,alt:n,title:n}):n)),e[r?\"before\":\"after\"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,\"autoSize\")&&!t.inline){var e,i,s,n,a=new Date(2009,11,20),o=this._get(t,\"dateFormat\");o.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},a.setMonth(e(this._get(t,o.match(/MM/)?\"monthNames\":\"monthNamesShort\"))),a.setDate(e(this._get(t,o.match(/DD/)?\"dayNames\":\"dayNamesShort\"))+20-a.getDay())),t.input.attr(\"size\",this._formatDate(t,a).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,\"datepicker\",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css(\"display\",\"block\"))},_dialogDatepicker:function(e,i,s,n,a){var o,h,l,u,c,d=this._dialogInst;return d||(this.uuid+=1,o=\"dp\"+this.uuid,this._dialogInput=t(\"<input type='text' id='\"+o+\"' style='position: absolute; top: -100px; width: 0px;'/>\"),this._dialogInput.keydown(this._doKeyDown),t(\"body\").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],\"datepicker\",d)),r(d.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+c]),this._dialogInput.css(\"left\",this._pos[0]+20+\"px\").css(\"top\",this._pos[1]+\"px\"),d.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],\"datepicker\",d),this\r\n},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,\"datepicker\");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,\"datepicker\"),\"input\"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind(\"focus\",this._showDatepicker).unbind(\"keydown\",this._doKeyDown).unbind(\"keypress\",this._doKeyPress).unbind(\"keyup\",this._doKeyUp)):(\"div\"===i||\"span\"===i)&&s.removeClass(this.markerClassName).empty(),v===n&&(v=null))},_enableDatepicker:function(e){var i,s,n=t(e),a=t.data(e,\"datepicker\");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),\"input\"===i?(e.disabled=!1,a.trigger.filter(\"button\").each(function(){this.disabled=!1}).end().filter(\"img\").css({opacity:\"1.0\",cursor:\"\"})):(\"div\"===i||\"span\"===i)&&(s=n.children(\".\"+this._inlineClass),s.children().removeClass(\"ui-state-disabled\"),s.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),a=t.data(e,\"datepicker\");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),\"input\"===i?(e.disabled=!0,a.trigger.filter(\"button\").each(function(){this.disabled=!0}).end().filter(\"img\").css({opacity:\"0.5\",cursor:\"default\"})):(\"div\"===i||\"span\"===i)&&(s=n.children(\".\"+this._inlineClass),s.children().addClass(\"ui-state-disabled\"),s.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,\"datepicker\")}catch(i){throw\"Missing instance data for this datepicker\"}},_optionDatepicker:function(e,i,s){var n,a,o,h,l=this._getInst(e);return 2===arguments.length&&\"string\"==typeof i?\"defaults\"===i?t.extend({},t.datepicker._defaults):l?\"all\"===i?t.extend({},l.settings):this._get(l,i):null:(n=i||{},\"string\"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(l,\"min\"),h=this._getMinMaxDate(l,\"max\"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),\"disabled\"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,a=t.datepicker._getInst(e.target),o=!0,r=a.dpDiv.is(\".ui-datepicker-rtl\");if(a._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return n=t(\"td.\"+t.datepicker._dayOverClass+\":not(.\"+t.datepicker._currentClass+\")\",a.dpDiv),n[0]&&t.datepicker._selectDay(e.target,a.selectedMonth,a.selectedYear,n[0]),i=t.datepicker._get(a,\"onSelect\"),i?(s=t.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(a,\"stepBigMonths\"):-t.datepicker._get(a,\"stepMonths\"),\"M\");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(a,\"stepBigMonths\"):+t.datepicker._get(a,\"stepMonths\"),\"M\");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,\"D\"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(a,\"stepBigMonths\"):-t.datepicker._get(a,\"stepMonths\"),\"M\");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,\"D\"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,\"D\"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(a,\"stepBigMonths\"):+t.datepicker._get(a,\"stepMonths\"),\"M\");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,\"D\"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,\"constrainInput\")?(i=t.datepicker._possibleChars(t.datepicker._get(n,\"dateFormat\")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||\" \">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,\"dateFormat\"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,\"input\"!==e.nodeName.toLowerCase()&&(e=t(\"input\",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,a,o,h,l,u;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,\"beforeShow\"),a=n?n.apply(e,[e,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=\"\"),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),o=!1,t(e).parents().each(function(){return o|=\"fixed\"===t(this).css(\"position\"),!o}),h={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:\"absolute\",display:\"block\",top:\"-1000px\"}),t.datepicker._updateDatepicker(i),h=t.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?\"static\":o?\"fixed\":\"absolute\",display:\"none\",left:h.left+\"px\",top:h.top+\"px\"}),i.inline||(l=t.datepicker._get(i,\"showAnim\"),u=t.datepicker._get(i,\"duration\"),i.dpDiv.css(\"z-index\",s(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,\"showOptions\"),u):i.dpDiv[l||\"show\"](l?u:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,v=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),n=s[1],a=17,r=e.dpDiv.find(\".\"+this._dayOverClass+\" a\");r.length>0&&o.apply(r.get(0)),e.dpDiv.removeClass(\"ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4\").width(\"\"),n>1&&e.dpDiv.addClass(\"ui-datepicker-multi-\"+n).css(\"width\",a*n+\"em\"),e.dpDiv[(1!==s[0]||1!==s[1]?\"add\":\"remove\")+\"Class\"](\"ui-datepicker-multi\"),e.dpDiv[(this._get(e,\"isRTL\")?\"add\":\"remove\")+\"Class\"](\"ui-datepicker-rtl\"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find(\"select.ui-datepicker-year:first\").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(\":visible\")&&!t.input.is(\":disabled\")&&!t.input.is(\":focus\")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),a=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,\"isRTL\")?n-o:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,\"isRTL\");e&&(\"hidden\"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?\"previousSibling\":\"nextSibling\"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,a,o=this._curInst;!o||e&&o!==t.data(e,\"datepicker\")||this._datepickerShowing&&(i=this._get(o,\"showAnim\"),s=this._get(o,\"duration\"),n=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,\"showOptions\"),s,n):o.dpDiv[\"slideDown\"===i?\"slideUp\":\"fadeIn\"===i?\"fadeOut\":\"hide\"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,\"onClose\"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():\"\",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:\"absolute\",left:\"0\",top:\"-100px\"}),t.blockUI&&(t.unblockUI(),t(\"body\").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(\".ui-datepicker-calendar\")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents(\"#\"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest(\".\"+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+(\"M\"===s?this._get(a,\"showCurrentAtPos\"):0),s),this._updateDatepicker(a))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,\"gotoCurrent\")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),a=this._getInst(n[0]);a[\"selected\"+(\"M\"===s?\"Month\":\"Year\")]=a[\"draw\"+(\"M\"===s?\"Month\":\"Year\")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(e,i,s,n){var a,o=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=t(\"a\",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(e,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,\"\")},_selectDate:function(e,i){var s,n=t(e),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,\"onSelect\"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger(\"change\"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],\"object\"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,a=this._get(e,\"altField\");a&&(i=this._get(e,\"altFormat\")||this._get(e,\"dateFormat\"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(a).each(function(){t(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,\"\"]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw\"Invalid arguments\";if(i=\"object\"==typeof i?\"\"+i:i+\"\",\"\"===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u=\"string\"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),c=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,d=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,_=-1,b=!1,y=function(t){var i=e.length>n+1&&e.charAt(n+1)===t;return i&&n++,i},x=function(t){var e=y(t),s=\"@\"===t?14:\"!\"===t?20:\"y\"===t&&e?4:\"o\"===t?3:2,n=\"y\"===t?s:1,a=RegExp(\"^\\\\d{\"+n+\",\"+s+\"}\"),o=i.substring(h).match(a);if(!o)throw\"Missing number at position \"+h;return h+=o[0].length,parseInt(o[0],10)},w=function(e,s,n){var a=-1,o=t.map(y(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(o,function(t,e){var s=e[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=e[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw\"Unknown name at position \"+h},k=function(){if(i.charAt(h)!==e.charAt(n))throw\"Unexpected literal at position \"+h;h++};for(n=0;e.length>n;n++)if(b)\"'\"!==e.charAt(n)||y(\"'\")?k():b=!1;else switch(e.charAt(n)){case\"d\":v=x(\"d\");break;case\"D\":w(\"D\",c,d);break;case\"o\":_=x(\"o\");break;case\"m\":g=x(\"m\");break;case\"M\":g=w(\"M\",p,f);break;case\"y\":m=x(\"y\");break;case\"@\":r=new Date(x(\"@\")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case\"!\":r=new Date((x(\"!\")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case\"'\":y(\"'\")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\\s+/.test(o)))throw\"Extra/unparsed characters found in date: \"+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),_>-1)for(g=1,v=_;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw\"Invalid date\";return r},ATOM:\"yy-mm-dd\",COOKIE:\"D, dd M yy\",ISO_8601:\"yy-mm-dd\",RFC_822:\"D, d M y\",RFC_850:\"DD, dd-M-y\",RFC_1036:\"D, d M y\",RFC_1123:\"D, d M yy\",RFC_2822:\"D, d M yy\",RSS:\"D, d M y\",TICKS:\"!\",TIMESTAMP:\"@\",W3C:\"yy-mm-dd\",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return\"\";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},l=function(t,e,i){var s=\"\"+e;if(h(t))for(;i>s.length;)s=\"0\"+s;return s},u=function(t,e,i,s){return h(t)?s[e]:i[e]},c=\"\",d=!1;if(e)for(s=0;t.length>s;s++)if(d)\"'\"!==t.charAt(s)||h(\"'\")?c+=t.charAt(s):d=!1;else switch(t.charAt(s)){case\"d\":c+=l(\"d\",e.getDate(),2);break;case\"D\":c+=u(\"D\",e.getDay(),n,a);break;case\"o\":c+=l(\"o\",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case\"m\":c+=l(\"m\",e.getMonth()+1,2);break;case\"M\":c+=u(\"M\",e.getMonth(),o,r);break;case\"y\":c+=h(\"y\")?e.getFullYear():(10>e.getYear()%100?\"0\":\"\")+e.getYear()%100;break;case\"@\":c+=e.getTime();break;case\"!\":c+=1e4*e.getTime()+this._ticksTo1970;break;case\"'\":h(\"'\")?c+=\"'\":d=!0;break;default:c+=t.charAt(s)}return c},_possibleChars:function(t){var e,i=\"\",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)\"'\"!==t.charAt(e)||n(\"'\")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case\"d\":case\"m\":case\"y\":case\"@\":i+=\"0123456789\";break;case\"D\":case\"M\":return null;case\"'\":n(\"'\")?i+=\"'\":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,\"dateFormat\"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),a=n,o=this._getFormatConfig(t);try{a=this.parseDate(i,s,o)||n}catch(r){s=e?\"\":s}t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),t.currentDay=s?a.getDate():0,t.currentMonth=s?a.getMonth():0,t.currentYear=s?a.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,\"defaultDate\"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},a=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,\"dateFormat\"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\\-]?[0-9]+)\\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||\"d\"){case\"d\":case\"D\":r+=parseInt(l[1],10);break;case\"w\":case\"W\":r+=7*parseInt(l[1],10);break;case\"m\":case\"M\":o+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(a,o));break;case\"y\":case\"Y\":a+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||\"\"===i?s:\"string\"==typeof i?a(i):\"number\"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&\"Invalid Date\"==\"\"+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,a=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),n===t.selectedMonth&&a===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?\"\":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&\"\"===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,\"stepMonths\"),s=\"#\"+e.id.replace(/\\\\\\\\/g,\"\\\\\");e.dpDiv.find(\"[data-handler]\").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,\"M\")},next:function(){t.datepicker._adjustDate(s,+i,\"M\")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute(\"data-month\"),+this.getAttribute(\"data-year\"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,\"M\"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,\"Y\"),!1}};t(this).bind(this.getAttribute(\"data-event\"),e[this.getAttribute(\"data-handler\")])})},_generateHTML:function(t){var e,i,s,n,a,o,r,h,l,u,c,d,p,f,m,g,v,_,b,y,x,w,k,D,T,S,M,C,N,P,I,A,H,z,F,E,O,W,L,R=new Date,j=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Y=this._get(t,\"isRTL\"),B=this._get(t,\"showButtonPanel\"),J=this._get(t,\"hideIfNoPrevNext\"),K=this._get(t,\"navigationAsDateFormat\"),U=this._getNumberOfMonths(t),q=this._get(t,\"showCurrentAtPos\"),V=this._get(t,\"stepMonths\"),G=1!==U[0]||1!==U[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),$=this._getMinMaxDate(t,\"min\"),Q=this._getMinMaxDate(t,\"max\"),Z=t.drawMonth-q,te=t.drawYear;if(0>Z&&(Z+=12,te--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-U[0]*U[1]+1,Q.getDate())),e=$&&$>e?$:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,\"prevText\"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-V,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?\"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='\"+i+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"e\":\"w\")+\"'>\"+i+\"</span></a>\":J?\"\":\"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='\"+i+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"e\":\"w\")+\"'>\"+i+\"</span></a>\",n=this._get(t,\"nextText\"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+V,1)),this._getFormatConfig(t)):n,a=this._canAdjustMonth(t,1,te,Z)?\"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='\"+n+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"w\":\"e\")+\"'>\"+n+\"</span></a>\":J?\"\":\"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='\"+n+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"w\":\"e\")+\"'>\"+n+\"</span></a>\",o=this._get(t,\"currentText\"),r=this._get(t,\"gotoCurrent\")&&t.currentDay?X:j,o=K?this.formatDate(o,r,this._getFormatConfig(t)):o,h=t.inline?\"\":\"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>\"+this._get(t,\"closeText\")+\"</button>\",l=B?\"<div class='ui-datepicker-buttonpane ui-widget-content'>\"+(Y?h:\"\")+(this._isInRange(t,r)?\"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>\"+o+\"</button>\":\"\")+(Y?\"\":h)+\"</div>\":\"\",u=parseInt(this._get(t,\"firstDay\"),10),u=isNaN(u)?0:u,c=this._get(t,\"showWeek\"),d=this._get(t,\"dayNames\"),p=this._get(t,\"dayNamesMin\"),f=this._get(t,\"monthNames\"),m=this._get(t,\"monthNamesShort\"),g=this._get(t,\"beforeShowDay\"),v=this._get(t,\"showOtherMonths\"),_=this._get(t,\"selectOtherMonths\"),b=this._getDefaultDate(t),y=\"\",w=0;U[0]>w;w++){for(k=\"\",this.maxRows=4,D=0;U[1]>D;D++){if(T=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),S=\" ui-corner-all\",M=\"\",G){if(M+=\"<div class='ui-datepicker-group\",U[1]>1)switch(D){case 0:M+=\" ui-datepicker-group-first\",S=\" ui-corner-\"+(Y?\"right\":\"left\");break;case U[1]-1:M+=\" ui-datepicker-group-last\",S=\" ui-corner-\"+(Y?\"left\":\"right\");break;default:M+=\" ui-datepicker-group-middle\",S=\"\"}M+=\"'>\"}for(M+=\"<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix\"+S+\"'>\"+(/all|left/.test(S)&&0===w?Y?a:s:\"\")+(/all|right/.test(S)&&0===w?Y?s:a:\"\")+this._generateMonthYearHeader(t,Z,te,$,Q,w>0||D>0,f,m)+\"</div><table class='ui-datepicker-calendar'><thead>\"+\"<tr>\",C=c?\"<th class='ui-datepicker-week-col'>\"+this._get(t,\"weekHeader\")+\"</th>\":\"\",x=0;7>x;x++)N=(x+u)%7,C+=\"<th scope='col'\"+((x+u+6)%7>=5?\" class='ui-datepicker-week-end'\":\"\")+\">\"+\"<span title='\"+d[N]+\"'>\"+p[N]+\"</span></th>\";for(M+=C+\"</tr></thead><tbody>\",P=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,P)),I=(this._getFirstDayOfMonth(te,Z)-u+7)%7,A=Math.ceil((I+P)/7),H=G?this.maxRows>A?this.maxRows:A:A,this.maxRows=H,z=this._daylightSavingAdjust(new Date(te,Z,1-I)),F=0;H>F;F++){for(M+=\"<tr>\",E=c?\"<td class='ui-datepicker-week-col'>\"+this._get(t,\"calculateWeek\")(z)+\"</td>\":\"\",x=0;7>x;x++)O=g?g.apply(t.input?t.input[0]:null,[z]):[!0,\"\"],W=z.getMonth()!==Z,L=W&&!_||!O[0]||$&&$>z||Q&&z>Q,E+=\"<td class='\"+((x+u+6)%7>=5?\" ui-datepicker-week-end\":\"\")+(W?\" ui-datepicker-other-month\":\"\")+(z.getTime()===T.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===z.getTime()&&b.getTime()===T.getTime()?\" \"+this._dayOverClass:\"\")+(L?\" \"+this._unselectableClass+\" ui-state-disabled\":\"\")+(W&&!v?\"\":\" \"+O[1]+(z.getTime()===X.getTime()?\" \"+this._currentClass:\"\")+(z.getTime()===j.getTime()?\" ui-datepicker-today\":\"\"))+\"'\"+(W&&!v||!O[2]?\"\":\" title='\"+O[2].replace(/'/g,\"&#39;\")+\"'\")+(L?\"\":\" data-handler='selectDay' data-event='click' data-month='\"+z.getMonth()+\"' data-year='\"+z.getFullYear()+\"'\")+\">\"+(W&&!v?\"&#xa0;\":L?\"<span class='ui-state-default'>\"+z.getDate()+\"</span>\":\"<a class='ui-state-default\"+(z.getTime()===j.getTime()?\" ui-state-highlight\":\"\")+(z.getTime()===X.getTime()?\" ui-state-active\":\"\")+(W?\" ui-priority-secondary\":\"\")+\"' href='#'>\"+z.getDate()+\"</a>\")+\"</td>\",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);M+=E+\"</tr>\"}Z++,Z>11&&(Z=0,te++),M+=\"</tbody></table>\"+(G?\"</div>\"+(U[0]>0&&D===U[1]-1?\"<div class='ui-datepicker-row-break'></div>\":\"\"):\"\"),k+=M}y+=k}return y+=l,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,a,o,r){var h,l,u,c,d,p,f,m,g=this._get(t,\"changeMonth\"),v=this._get(t,\"changeYear\"),_=this._get(t,\"showMonthAfterYear\"),b=\"<div class='ui-datepicker-title'>\",y=\"\";if(a||!g)y+=\"<span class='ui-datepicker-month'>\"+o[e]+\"</span>\";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+=\"<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>\",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(y+=\"<option value='\"+u+\"'\"+(u===e?\" selected='selected'\":\"\")+\">\"+r[u]+\"</option>\");y+=\"</select>\"}if(_||(b+=y+(!a&&g&&v?\"\":\"&#xa0;\")),!t.yearshtml)if(t.yearshtml=\"\",a||!v)b+=\"<span class='ui-datepicker-year'>\"+i+\"</span>\";else{for(c=this._get(t,\"yearRange\").split(\":\"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(c[0]),m=Math.max(f,p(c[1]||\"\")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,t.yearshtml+=\"<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>\";m>=f;f++)t.yearshtml+=\"<option value='\"+f+\"'\"+(f===i?\" selected='selected'\":\"\")+\">\"+f+\"</option>\";t.yearshtml+=\"</select>\",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,\"yearSuffix\"),_&&(b+=(!a&&g&&v?\"\":\"&#xa0;\")+y),b+=\"</div>\"},_adjustInstDate:function(t,e,i){var s=t.drawYear+(\"Y\"===i?e:0),n=t.drawMonth+(\"M\"===i?e:0),a=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+(\"D\"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,a)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),(\"M\"===i||\"Y\"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,\"min\"),s=this._getMinMaxDate(t,\"max\"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,\"onChangeMonthYear\");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,\"numberOfMonths\");return null==e?[1,1]:\"number\"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+\"Date\"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),a=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(t,a)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,\"min\"),a=this._getMinMaxDate(t,\"max\"),o=null,r=null,h=this._get(t,\"yearRange\");return h&&(i=h.split(\":\"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\\-].*/)&&(o+=s),i[1].match(/[+\\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!a||e.getTime()<=a.getTime())&&(!o||e.getFullYear()>=o)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,\"shortYearCutoff\");return e=\"string\"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,\"dayNamesShort\"),dayNames:this._get(t,\"dayNames\"),monthNamesShort:this._get(t,\"monthNamesShort\"),monthNames:this._get(t,\"monthNames\")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?\"object\"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,\"dateFormat\"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t(\"#\"+t.datepicker._mainDivId).length&&t(\"body\").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return\"string\"!=typeof e||\"isDisabled\"!==e&&\"getDate\"!==e&&\"widget\"!==e?\"option\"===e&&2===arguments.length&&\"string\"==typeof arguments[1]?t.datepicker[\"_\"+e+\"Datepicker\"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){\"string\"==typeof e?t.datepicker[\"_\"+e+\"Datepicker\"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker[\"_\"+e+\"Datepicker\"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new n,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version=\"1.11.4\",t.datepicker,t.widget(\"ui.dialog\",{version:\"1.11.4\",options:{appendTo:\"body\",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:\"Close\",dialogClass:\"\",draggable:!0,hide:null,height:\"auto\",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:\"center\",at:\"center\",of:window,collision:\"fit\",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css(\"top\",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr(\"title\"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr(\"title\").addClass(\"ui-dialog-content ui-widget-content\").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||\"body\").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass(\"ui-dialog-content ui-widget-content\").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr(\"title\",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,s=this;if(this._isOpen&&this._trigger(\"beforeClose\",e)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(\":focusable\").focus().length)try{i=this.document[0].activeElement,i&&\"body\"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger(\"close\",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var s=!1,n=this.uiDialog.siblings(\".ui-front:visible\").map(function(){return+t(this).css(\"z-index\")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css(\"z-index\")&&(this.uiDialog.css(\"z-index\",a+1),s=!0),s&&!i&&this._trigger(\"focus\",e),s},open:function(){var e=this;\r\nreturn this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css(\"z-index\",this.uiDialog.css(\"z-index\")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger(\"focus\")}),this._makeFocusTarget(),this._trigger(\"open\"),void 0)},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find(\"[autofocus]\")),t.length||(t=this.element.find(\":tabbable\")),t.length||(t=this.uiDialogButtonPane.find(\":tabbable\")),t.length||(t=this.uiDialogTitlebarClose.filter(\":tabbable\")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t(\"<div>\").addClass(\"ui-dialog ui-widget ui-widget-content ui-corner-all ui-front \"+this.options.dialogClass).hide().attr({tabIndex:-1,role:\"dialog\"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(\":tabbable\"),s=i.filter(\":first\"),n=i.filter(\":last\");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.focus()}),e.preventDefault()):(this._delay(function(){s.focus()}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find(\"[aria-describedby]\").length||this.uiDialog.attr({\"aria-describedby\":this.element.uniqueId().attr(\"id\")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t(\"<div>\").addClass(\"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix\").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(\".ui-dialog-titlebar-close\")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t(\"<button type='button'></button>\").button({label:this.options.closeText,icons:{primary:\"ui-icon-closethick\"},text:!1}).addClass(\"ui-dialog-titlebar-close\").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t(\"<span>\").uniqueId().addClass(\"ui-dialog-title\").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({\"aria-labelledby\":e.attr(\"id\")})},_title:function(t){this.options.title||t.html(\"&#160;\"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t(\"<div>\").addClass(\"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\"),this.uiButtonSet=t(\"<div>\").addClass(\"ui-dialog-buttonset\").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this.uiDialog.removeClass(\"ui-dialog-buttons\"),void 0):(t.each(i,function(i,s){var n,a;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:\"button\"},s),n=s.click,s.click=function(){n.apply(e.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,t(\"<button></button>\",s).button(a).appendTo(e.uiButtonSet)}),this.uiDialog.addClass(\"ui-dialog-buttons\"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:\".ui-dialog-content, .ui-dialog-titlebar-close\",handle:\".ui-dialog-titlebar\",containment:\"document\",start:function(s,n){t(this).addClass(\"ui-dialog-dragging\"),i._blockFrames(),i._trigger(\"dragStart\",s,e(n))},drag:function(t,s){i._trigger(\"drag\",t,e(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:\"left top\",at:\"left\"+(o>=0?\"+\":\"\")+o+\" \"+\"top\"+(r>=0?\"+\":\"\")+r,of:i.window},t(this).removeClass(\"ui-dialog-dragging\"),i._unblockFrames(),i._trigger(\"dragStop\",n,e(a))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css(\"position\"),o=\"string\"==typeof n?n:\"n,e,s,w,se,sw,ne,nw\";this.uiDialog.resizable({cancel:\".ui-dialog-content\",containment:\"document\",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){t(this).addClass(\"ui-dialog-resizing\"),i._blockFrames(),i._trigger(\"resizeStart\",s,e(n))},resize:function(t,s){i._trigger(\"resize\",t,e(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:\"left top\",at:\"left\"+(r>=0?\"+\":\"\")+r+\" \"+\"top\"+(h>=0?\"+\":\"\")+h,of:i.window},t(this).removeClass(\"ui-dialog-resizing\"),i._unblockFrames(),i._trigger(\"resizeStop\",n,e(a))}}).css(\"position\",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data(\"ui-dialog-instances\");return t||(t=[],this.document.data(\"ui-dialog-instances\",t)),t},_minHeight:function(){var t=this.options;return\"auto\"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(\":visible\");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,s=!1,n={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(\":data(ui-resizable)\")&&this.uiDialog.resizable(\"option\",n)},_setOption:function(t,e){var i,s,n=this.uiDialog;\"dialogClass\"===t&&n.removeClass(this.options.dialogClass).addClass(e),\"disabled\"!==t&&(this._super(t,e),\"appendTo\"===t&&this.uiDialog.appendTo(this._appendTo()),\"buttons\"===t&&this._createButtons(),\"closeText\"===t&&this.uiDialogTitlebarClose.button({label:\"\"+e}),\"draggable\"===t&&(i=n.is(\":data(ui-draggable)\"),i&&!e&&n.draggable(\"destroy\"),!i&&e&&this._makeDraggable()),\"position\"===t&&this._position(),\"resizable\"===t&&(s=n.is(\":data(ui-resizable)\"),s&&!e&&n.resizable(\"destroy\"),s&&\"string\"==typeof e&&n.resizable(\"option\",\"handles\",e),s||e===!1||this._makeResizable()),\"title\"===t&&this._title(this.uiDialogTitlebar.find(\".ui-dialog-title\")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:\"auto\",minHeight:0,maxHeight:\"none\",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:\"auto\",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i=\"number\"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):\"none\",\"auto\"===s.height?this.element.css({minHeight:e,maxHeight:i,height:\"auto\"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(\":data(ui-resizable)\")&&this.uiDialog.resizable(\"option\",\"minHeight\",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find(\"iframe\").map(function(){var e=t(this);return t(\"<div>\").css({position:\"absolute\",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(\".ui-dialog\").length?!0:!!t(e.target).closest(\".ui-datepicker\").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data(\"ui-dialog-overlays\")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t(\"<div>\").addClass(\"ui-widget-overlay ui-front\").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:\"_keepFocus\"}),this.document.data(\"ui-dialog-overlays\",(this.document.data(\"ui-dialog-overlays\")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data(\"ui-dialog-overlays\")-1;t?this.document.data(\"ui-dialog-overlays\",t):this.document.unbind(\"focusin\").removeData(\"ui-dialog-overlays\"),this.overlay.remove(),this.overlay=null}}}),t.widget(\"ui.progressbar\",{version:\"1.11.4\",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\").attr({role:\"progressbar\",\"aria-valuemin\":this.min}),this.valueDiv=t(\"<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>\").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\").removeAttr(\"role\").removeAttr(\"aria-valuemin\").removeAttr(\"aria-valuemax\").removeAttr(\"aria-valuenow\"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),void 0)},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,\"number\"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){\"max\"===t&&(e=Math.max(this.min,e)),\"disabled\"===t&&this.element.toggleClass(\"ui-state-disabled\",!!e).attr(\"aria-disabled\",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass(\"ui-corner-right\",e===this.options.max).width(i.toFixed(0)+\"%\"),this.element.toggleClass(\"ui-progressbar-indeterminate\",this.indeterminate),this.indeterminate?(this.element.removeAttr(\"aria-valuenow\"),this.overlayDiv||(this.overlayDiv=t(\"<div class='ui-progressbar-overlay'></div>\").appendTo(this.valueDiv))):(this.element.attr({\"aria-valuemax\":this.options.max,\"aria-valuenow\":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger(\"change\")),e===this.options.max&&this._trigger(\"complete\")}}),t.widget(\"ui.selectmenu\",{version:\"1.11.4\",defaultElement:\"<select>\",options:{appendTo:null,disabled:null,icons:{button:\"ui-icon-triangle-1-s\"},position:{my:\"left top\",at:\"left bottom\",collision:\"none\"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr(\"id\");this.ids={element:t,button:t+\"-button\",menu:t+\"-menu\"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this;this.label=t(\"label[for='\"+this.ids.element+\"']\").attr(\"for\",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t(\"<span>\",{\"class\":\"ui-selectmenu-button ui-widget ui-state-default ui-corner-all\",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:\"combobox\",\"aria-expanded\":\"false\",\"aria-autocomplete\":\"list\",\"aria-owns\":this.ids.menu,\"aria-haspopup\":\"true\"}).insertAfter(this.element),t(\"<span>\",{\"class\":\"ui-icon \"+this.options.icons.button}).prependTo(this.button),this.buttonText=t(\"<span>\",{\"class\":\"ui-selectmenu-text\"}).appendTo(this.button),this._setText(this.buttonText,this.element.find(\"option:selected\").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one(\"focusin\",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var e=this;this.menu=t(\"<ul>\",{\"aria-hidden\":\"true\",\"aria-labelledby\":this.ids.button,id:this.ids.menu}),this.menuWrap=t(\"<div>\",{\"class\":\"ui-selectmenu-menu ui-front\"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:\"listbox\",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data(\"ui-selectmenu-item\"),t)},focus:function(t,i){var s=i.item.data(\"ui-selectmenu-item\");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger(\"focus\",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr(\"aria-activedescendant\",e.menuItems.eq(s.index).attr(\"id\"))}}).menu(\"instance\"),this.menu.addClass(\"ui-corner-bottom\").removeClass(\"ui-corner-all\"),this.menuInstance._off(this.menu,\"mouseleave\"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find(\"option\");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find(\"li\").not(\".ui-selectmenu-optgroup\"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data(\"ui-selectmenu-item\")),this._setOption(\"disabled\",this.element.prop(\"disabled\")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(\".ui-state-focus\").removeClass(\"ui-state-focus\"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger(\"open\",t))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger(\"close\",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(e,i){var s=this,n=\"\";t.each(i,function(i,a){a.optgroup!==n&&(t(\"<li>\",{\"class\":\"ui-selectmenu-optgroup ui-menu-divider\"+(a.element.parent(\"optgroup\").prop(\"disabled\")?\" ui-state-disabled\":\"\"),text:a.optgroup}).appendTo(e),n=a.optgroup),s._renderItemData(e,a)})},_renderItemData:function(t,e){return this._renderItem(t,e).data(\"ui-selectmenu-item\",e)},_renderItem:function(e,i){var s=t(\"<li>\");return i.disabled&&s.addClass(\"ui-state-disabled\"),this._setText(s,i.label),s.appendTo(e)},_setText:function(t,e){e?t.text(e):t.html(\"&#160;\")},_move:function(t,e){var i,s,n=\".ui-menu-item\";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=\":not(.ui-state-disabled)\"),s=\"first\"===t||\"last\"===t?i[\"first\"===t?\"prevAll\":\"nextAll\"](n).eq(-1):i[t+\"All\"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?\"close\":\"open\"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(\".ui-selectmenu-menu, #\"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move(\"prev\",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move(\"next\",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move(\"prev\",e);break;case t.ui.keyCode.RIGHT:this._move(\"next\",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move(\"first\",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move(\"last\",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass(\"ui-state-disabled\")||this._select(e.data(\"ui-selectmenu-item\"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger(\"select\",e,{item:t}),t.index!==i&&this._trigger(\"change\",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr(\"id\");this.button.attr({\"aria-labelledby\":e,\"aria-activedescendant\":e}),this.menu.attr(\"aria-activedescendant\",e)},_setOption:function(t,e){\"icons\"===t&&this.button.find(\"span.ui-icon\").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),\"appendTo\"===t&&this.menuWrap.appendTo(this._appendTo()),\"disabled\"===t&&(this.menuInstance.option(\"disabled\",e),this.button.toggleClass(\"ui-state-disabled\",e).attr(\"aria-disabled\",e),this.element.prop(\"disabled\",e),e?(this.button.attr(\"tabindex\",-1),this.close()):this.button.attr(\"tabindex\",0)),\"width\"===t&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(\".ui-front\")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass(\"ui-corner-top\",this.isOpen).toggleClass(\"ui-corner-all\",!this.isOpen).attr(\"aria-expanded\",this.isOpen),this.menuWrap.toggleClass(\"ui-selectmenu-open\",this.isOpen),this.menu.attr(\"aria-hidden\",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width(\"\").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop(\"disabled\")}},_parseOptions:function(e){var i=[];e.each(function(e,s){var n=t(s),a=n.parent(\"optgroup\");i.push({element:n,index:e,value:n.val(),label:n.text(),optgroup:a.attr(\"label\")||\"\",disabled:a.prop(\"disabled\")||n.prop(\"disabled\")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr(\"for\",this.ids.element)}}),t.widget(\"ui.slider\",t.ui.mouse,{version:\"1.11.4\",widgetEventPrefix:\"slide\",options:{animate:!1,distance:0,max:100,min:0,orientation:\"horizontal\",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass(\"ui-slider ui-slider-\"+this.orientation+\" ui-widget\"+\" ui-widget-content\"+\" ui-corner-all\"),this._refresh(),this._setOption(\"disabled\",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(\".ui-slider-handle\").addClass(\"ui-state-default ui-corner-all\"),a=\"<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>\",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)o.push(a);this.handles=n.add(t(o.join(\"\")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data(\"ui-slider-handle-index\",e)})},_createRange:function(){var e=this.options,i=\"\";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass(\"ui-slider-range-min ui-slider-range-max\").css({left:\"\",bottom:\"\"}):(this.range=t(\"<div></div>\").appendTo(this.element),i=\"ui-slider-range ui-widget-header ui-corner-all\"),this.range.addClass(i+(\"min\"===e.range||\"max\"===e.range?\" ui-slider-range-\"+e.range:\"\"))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass(\"ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all\"),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,a,o,r,h,l,u=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-u.values(e));(n>i||n===i&&(e===u._lastChangedValue||u.values(e)===c.min))&&(n=i,a=t(this),o=e)}),r=this._start(e,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass(\"ui-state-active\").focus(),h=a.offset(),l=!t(e.target).parents().addBack().is(\".ui-slider-handle\"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-a.width()/2,top:e.pageY-h.top-a.height()/2-(parseInt(a.css(\"borderTopWidth\"),10)||0)-(parseInt(a.css(\"borderBottomWidth\"),10)||0)+(parseInt(a.css(\"marginTop\"),10)||0)},this.handles.hasClass(\"ui-state-hover\")||this._slide(e,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass(\"ui-state-active\"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=\"vertical\"===this.options.orientation?\"vertical\":\"horizontal\"},_normValueFromMouse:function(t){var e,i,s,n,a;return\"horizontal\"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),\"vertical\"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger(\"start\",t,i)},_slide:function(t,e,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>s||1===e&&s>i)&&(i=s),i!==this.values(e)&&(n=this.values(),n[e]=i,a=this._trigger(\"slide\",t,{handle:this.handles[e],value:i,values:n}),s=this.values(e?0:1),a!==!1&&this.values(e,i))):i!==this.value()&&(a=this._trigger(\"slide\",t,{handle:this.handles[e],value:i}),a!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger(\"stop\",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger(\"change\",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var s,n,a;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch(\"range\"===e&&this.options.range===!0&&(\"min\"===i?(this.options.value=this._values(0),this.options.values=null):\"max\"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),\"disabled\"===e&&this.element.toggleClass(\"ui-state-disabled\",!!i),this._super(e,i),e){case\"orientation\":this._detectOrientation(),this.element.removeClass(\"ui-slider-horizontal ui-slider-vertical\").addClass(\"ui-slider-\"+this.orientation),this._refreshValue(),this.handles.css(\"horizontal\"===i?\"bottom\":\"left\",\"\");break;case\"value\":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case\"values\":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case\"step\":case\"min\":case\"max\":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case\"range\":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step,s=Math.floor(+(t-e).toFixed(this._precision())/i)*i;t=s+e,this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=\"\"+t,i=e.indexOf(\".\");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u[\"horizontal\"===h.orientation?\"left\":\"bottom\"]=i+\"%\",t(this).stop(1,1)[l?\"animate\":\"css\"](u,r.animate),h.options.range===!0&&(\"horizontal\"===h.orientation?(0===s&&h.range.stop(1,1)[l?\"animate\":\"css\"]({left:i+\"%\"},r.animate),1===s&&h.range[l?\"animate\":\"css\"]({width:i-e+\"%\"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?\"animate\":\"css\"]({bottom:i+\"%\"},r.animate),1===s&&h.range[l?\"animate\":\"css\"]({height:i-e+\"%\"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u[\"horizontal\"===this.orientation?\"left\":\"bottom\"]=i+\"%\",this.handle.stop(1,1)[l?\"animate\":\"css\"](u,r.animate),\"min\"===o&&\"horizontal\"===this.orientation&&this.range.stop(1,1)[l?\"animate\":\"css\"]({width:i+\"%\"},r.animate),\"max\"===o&&\"horizontal\"===this.orientation&&this.range[l?\"animate\":\"css\"]({width:100-i+\"%\"},{queue:!1,duration:r.animate}),\"min\"===o&&\"vertical\"===this.orientation&&this.range.stop(1,1)[l?\"animate\":\"css\"]({height:i+\"%\"},r.animate),\"max\"===o&&\"vertical\"===this.orientation&&this.range[l?\"animate\":\"css\"]({height:100-i+\"%\"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(e){var i,s,n,a,o=t(e.target).data(\"ui-slider-handle-index\");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass(\"ui-state-active\"),i=this._start(e,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(e,o,n)},keyup:function(e){var i=t(e.target).data(\"ui-slider-handle-index\");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass(\"ui-state-active\"))}}}),t.widget(\"ui.spinner\",{version:\"1.11.4\",defaultElement:\"<input>\",widgetEventPrefix:\"spin\",options:{culture:null,icons:{down:\"ui-icon-triangle-1-s\",up:\"ui-icon-triangle-1-n\"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption(\"max\",this.options.max),this._setOption(\"min\",this.options.min),this._setOption(\"step\",this.options.step),\"\"!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr(\"autocomplete\")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each([\"min\",\"max\",\"step\"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:\"_stop\",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger(\"change\",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},\"mousedown .ui-spinner-button\":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass(\"ui-spinner-up\")?1:-1,e)},\"mouseup .ui-spinner-button\":\"_stop\",\"mouseenter .ui-spinner-button\":function(e){return t(e.currentTarget).hasClass(\"ui-state-active\")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass(\"ui-spinner-up\")?1:-1,e),void 0):void 0},\"mouseleave .ui-spinner-button\":\"_stop\"},_draw:function(){var t=this.uiSpinner=this.element.addClass(\"ui-spinner-input\").attr(\"autocomplete\",\"off\").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr(\"role\",\"spinbutton\"),this.buttons=t.find(\".ui-spinner-button\").attr(\"tabIndex\",-1).button().removeClass(\"ui-corner-all\"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()\r\n},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return\"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>\"},_buttonHtml:function(){return\"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon \"+this.options.icons.up+\"'>&#9650;</span>\"+\"</a>\"+\"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>\"+\"<span class='ui-icon \"+this.options.icons.down+\"'>&#9660;</span>\"+\"</a>\"},_start:function(t){return this.spinning||this._trigger(\"start\",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger(\"spin\",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=\"\"+t,i=e.indexOf(\".\");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger(\"stop\",t))},_setOption:function(t,e){if(\"culture\"===t||\"numberFormat\"===t){var i=this._parse(this.element.val());return this.options[t]=e,this.element.val(this._format(i)),void 0}(\"max\"===t||\"min\"===t||\"step\"===t)&&\"string\"==typeof e&&(e=this._parse(e)),\"icons\"===t&&(this.buttons.first().find(\".ui-icon\").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(\".ui-icon\").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),\"disabled\"===t&&(this.widget().toggleClass(\"ui-state-disabled\",!!e),this.element.prop(\"disabled\",!!e),this.buttons.button(e?\"disable\":\"enable\"))},_setOptions:h(function(t){this._super(t)}),_parse:function(t){return\"string\"==typeof t&&\"\"!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),\"\"===t||isNaN(t)?null:t},_format:function(t){return\"\"===t?\"\":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({\"aria-valuemin\":this.options.min,\"aria-valuemax\":this.options.max,\"aria-valuenow\":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null===t?!1:t===this._adjustValue(t)},_value:function(t,e){var i;\"\"!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass(\"ui-spinner-input\").prop(\"disabled\",!1).removeAttr(\"autocomplete\").removeAttr(\"role\").removeAttr(\"aria-valuemin\").removeAttr(\"aria-valuemax\").removeAttr(\"aria-valuenow\"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:h(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:h(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:h(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(h(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.widget(\"ui.tabs\",{version:\"1.11.4\",delay:300,options:{active:null,collapsible:!1,event:\"click\",heightStyle:\"content\",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,s;e=e.cloneNode(!1),i=e.href.replace(t,\"\"),s=location.href.replace(t,\"\");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return e.hash.length>1&&i===s}}(),_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass(\"ui-tabs ui-widget ui-widget-content ui-corner-all\").toggleClass(\"ui-tabs-collapsible\",i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(\".ui-state-disabled\"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===e&&(s&&this.tabs.each(function(i,n){return t(n).attr(\"aria-controls\")===s?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(\".ui-tabs-active\"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=i?!1:0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest(\"li\"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||e.metaKey||(i.attr(\"aria-selected\",\"false\"),this.tabs.eq(s).attr(\"aria-selected\",\"true\"),this.activating=this._delay(function(){this.option(\"active\",s)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return\"active\"===t?(this._activate(e),void 0):\"disabled\"===t?(this._setupDisabled(e),void 0):(this._super(t,e),\"collapsible\"===t&&(this.element.toggleClass(\"ui-tabs-collapsible\",e),e||this.options.active!==!1||this._activate(0)),\"event\"===t&&this._setupEvents(e),\"heightStyle\"===t&&this._setupHeightStyle(e),void 0)},_sanitizeSelector:function(t){return t?t.replace(/[!\"$%&'()*+,.\\/:;<=>?@\\[\\]\\^`{|}~]/g,\"\\\\$&\"):\"\"},refresh:function(){var e=this.options,i=this.tablist.children(\":has(a[href])\");e.disabled=t.map(i.filter(\".ui-state-disabled\"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({\"aria-hidden\":\"true\"}),this.active.length?(this.active.addClass(\"ui-tabs-active ui-state-active\").attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0}),this._getPanelForTab(this.active).show().attr({\"aria-hidden\":\"false\"})):this.tabs.eq(0).attr(\"tabIndex\",0)},_processTabs:function(){var e=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass(\"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\").attr(\"role\",\"tablist\").delegate(\"> li\",\"mousedown\"+this.eventNamespace,function(e){t(this).is(\".ui-state-disabled\")&&e.preventDefault()}).delegate(\".ui-tabs-anchor\",\"focus\"+this.eventNamespace,function(){t(this).closest(\"li\").is(\".ui-state-disabled\")&&this.blur()}),this.tabs=this.tablist.find(\"> li:has(a[href])\").addClass(\"ui-state-default ui-corner-top\").attr({role:\"tab\",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t(\"a\",this)[0]}).addClass(\"ui-tabs-anchor\").attr({role:\"presentation\",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,s){var n,a,o,r=t(s).uniqueId().attr(\"id\"),h=t(s).closest(\"li\"),l=h.attr(\"aria-controls\");e._isLocal(s)?(n=s.hash,o=n.substring(1),a=e.element.find(e._sanitizeSelector(n))):(o=h.attr(\"aria-controls\")||t({}).uniqueId()[0].id,n=\"#\"+o,a=e.element.find(n),a.length||(a=e._createPanel(o),a.insertAfter(e.panels[i-1]||e.tablist)),a.attr(\"aria-live\",\"polite\")),a.length&&(e.panels=e.panels.add(a)),l&&h.data(\"ui-tabs-aria-controls\",l),h.attr({\"aria-controls\":o,\"aria-labelledby\":r}),a.attr(\"aria-labelledby\",r)}),this.panels.addClass(\"ui-tabs-panel ui-widget-content ui-corner-bottom\").attr(\"role\",\"tabpanel\"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find(\"ol,ul\").eq(0)},_createPanel:function(e){return t(\"<div>\").attr(\"id\",e).addClass(\"ui-tabs-panel ui-widget-content ui-corner-bottom\").data(\"ui-tabs-destroy\",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,s=0;i=this.tabs[s];s++)e===!0||-1!==t.inArray(s,e)?t(i).addClass(\"ui-state-disabled\").attr(\"aria-disabled\",\"true\"):t(i).removeClass(\"ui-state-disabled\").removeAttr(\"aria-disabled\");this.options.disabled=e},_setupEvents:function(e){var i={};e&&t.each(e.split(\" \"),function(t,e){i[e]=\"_eventHandler\"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:\"_tabKeydown\"}),this._on(this.panels,{keydown:\"_panelKeydown\"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();\"fill\"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(\":visible\").each(function(){var e=t(this),s=e.css(\"position\");\"absolute\"!==s&&\"fixed\"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css(\"overflow\",\"auto\")):\"auto\"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height(\"\").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n.closest(\"li\"),o=a[0]===s[0],r=o&&i.collapsible,h=r?t():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):t(),u={oldTab:s,oldPanel:l,newTab:r?t():a,newPanel:h};e.preventDefault(),a.hasClass(\"ui-state-disabled\")||a.hasClass(\"ui-tabs-loading\")||this.running||o&&!i.collapsible||this._trigger(\"beforeActivate\",e,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?t():a,this.xhr&&this.xhr.abort(),l.length||h.length||t.error(\"jQuery UI Tabs: Mismatching fragment identifier.\"),h.length&&this.load(this.tabs.index(a),e),this._toggle(e,u))},_toggle:function(e,i){function s(){a.running=!1,a._trigger(\"activate\",e,i)}function n(){i.newTab.closest(\"li\").addClass(\"ui-tabs-active ui-state-active\"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest(\"li\").removeClass(\"ui-tabs-active ui-state-active\"),n()}):(i.oldTab.closest(\"li\").removeClass(\"ui-tabs-active ui-state-active\"),r.hide(),n()),r.attr(\"aria-hidden\",\"true\"),i.oldTab.attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\"}),o.length&&r.length?i.oldTab.attr(\"tabIndex\",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr(\"tabIndex\")}).attr(\"tabIndex\",-1),o.attr(\"aria-hidden\",\"false\"),i.newTab.attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(\".ui-tabs-anchor\")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return\"string\"==typeof t&&(t=this.anchors.index(this.anchors.filter(\"[href$='\"+t+\"']\"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass(\"ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible\"),this.tablist.removeClass(\"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\").removeAttr(\"role\"),this.anchors.removeClass(\"ui-tabs-anchor\").removeAttr(\"role\").removeAttr(\"tabIndex\").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){t.data(this,\"ui-tabs-destroy\")?t(this).remove():t(this).removeClass(\"ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel\").removeAttr(\"tabIndex\").removeAttr(\"aria-live\").removeAttr(\"aria-busy\").removeAttr(\"aria-selected\").removeAttr(\"aria-labelledby\").removeAttr(\"aria-hidden\").removeAttr(\"aria-expanded\").removeAttr(\"role\")}),this.tabs.each(function(){var e=t(this),i=e.data(\"ui-tabs-aria-controls\");i?e.attr(\"aria-controls\",i).removeData(\"ui-tabs-aria-controls\"):e.removeAttr(\"aria-controls\")}),this.panels.show(),\"content\"!==this.options.heightStyle&&this.panels.css(\"height\",\"\")},enable:function(e){var i=this.options.disabled;i!==!1&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setupDisabled(i))},disable:function(e){var i=this.options.disabled;if(i!==!0){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setupDisabled(i)}},load:function(e,i){e=this._getIndex(e);var s=this,n=this.tabs.eq(e),a=n.find(\".ui-tabs-anchor\"),o=this._getPanelForTab(n),r={tab:n,panel:o},h=function(t,e){\"abort\"===e&&s.panels.stop(!1,!0),n.removeClass(\"ui-tabs-loading\"),o.removeAttr(\"aria-busy\"),t===s.xhr&&delete s.xhr};this._isLocal(a[0])||(this.xhr=t.ajax(this._ajaxSettings(a,i,r)),this.xhr&&\"canceled\"!==this.xhr.statusText&&(n.addClass(\"ui-tabs-loading\"),o.attr(\"aria-busy\",\"true\"),this.xhr.done(function(t,e,n){setTimeout(function(){o.html(t),s._trigger(\"load\",i,r),h(n,e)},1)}).fail(function(t,e){setTimeout(function(){h(t,e)},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr(\"href\"),beforeSend:function(e,a){return n._trigger(\"beforeLoad\",i,t.extend({jqXHR:e,ajaxSettings:a},s))}}},_getPanelForTab:function(e){var i=t(e).attr(\"aria-controls\");return this.element.find(this._sanitizeSelector(\"#\"+i))}}),t.widget(\"ui.tooltip\",{version:\"1.11.4\",options:{content:function(){var e=t(this).attr(\"title\")||\"\";return t(\"<a>\").text(e).html()},hide:!0,items:\"[title]:not([disabled])\",position:{my:\"left top+15\",at:\"left bottom\",collision:\"flipfit flip\"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var s=(e.attr(\"aria-describedby\")||\"\").split(/\\s+/);s.push(i),e.data(\"ui-tooltip-id\",i).attr(\"aria-describedby\",t.trim(s.join(\" \")))},_removeDescribedBy:function(e){var i=e.data(\"ui-tooltip-id\"),s=(e.attr(\"aria-describedby\")||\"\").split(/\\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData(\"ui-tooltip-id\"),s=t.trim(s.join(\" \")),s?e.attr(\"aria-describedby\",s):e.removeAttr(\"aria-describedby\")},_create:function(){this._on({mouseover:\"open\",focusin:\"open\"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=t(\"<div>\").attr({role:\"log\",\"aria-live\":\"assertive\",\"aria-relevant\":\"additions\"}).addClass(\"ui-helper-hidden-accessible\").appendTo(this.document[0].body)},_setOption:function(e,i){var s=this;return\"disabled\"===e?(this[i?\"_disable\":\"_enable\"](),this.options[e]=i,void 0):(this._super(e,i),\"content\"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e.element)}),void 0)},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event(\"blur\");n.target=n.currentTarget=s.element[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is(\"[title]\")&&e.data(\"ui-tooltip-title\",e.attr(\"title\")).removeAttr(\"title\")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data(\"ui-tooltip-title\")&&e.attr(\"title\",e.data(\"ui-tooltip-title\"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data(\"ui-tooltip-id\")&&(s.attr(\"title\")&&s.data(\"ui-tooltip-title\",s.attr(\"title\")),s.data(\"ui-tooltip-open\",!0),e&&\"mouseover\"===e.type&&s.parents().each(function(){var e,s=t(this);s.data(\"ui-tooltip-open\")&&(e=t.Event(\"blur\"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr(\"title\")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr(\"title\")},s.attr(\"title\",\"\"))}),this._registerCloseHandlers(e,s),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,a=e?e.type:null;return\"string\"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){n._delay(function(){t.data(\"ui-tooltip-open\")&&(e&&(e.type=a),this._open(e,t,i))})}),i&&this._open(e,t,i),void 0)},_open:function(e,i,s){function n(t){l.of=t,o.is(\":hidden\")||o.position(l)}var a,o,r,h,l=t.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(\".ui-tooltip-content\").html(s),void 0;i.is(\"[title]\")&&(e&&\"mouseover\"===e.type?i.attr(\"title\",\"\"):i.removeAttr(\"title\")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr(\"id\")),o.find(\".ui-tooltip-content\").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr(\"id\").find(\"[id]\").removeAttr(\"id\")):h=s,t(\"<div>\").html(h).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):o.position(t.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){o.is(\":visible\")&&(n(l.of),clearInterval(r))},t.fx.interval)),this._trigger(\"open\",e,{tooltip:o})}},_registerCloseHandlers:function(e,i){var s={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var s=t.Event(e);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&\"mouseover\"!==e.type||(s.mouseleave=\"close\"),e&&\"focusin\"!==e.type||(s.focusout=\"close\"),this._on(!0,i,s)},close:function(e){var i,s=this,n=t(e?e.currentTarget:this.element),a=this._find(n);return a?(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data(\"ui-tooltip-title\")&&!n.attr(\"title\")&&n.attr(\"title\",n.data(\"ui-tooltip-title\")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData(\"ui-tooltip-open\"),this._off(n,\"mouseleave focusout keyup\"),n[0]!==this.element[0]&&this._off(n,\"remove\"),this._off(this.document,\"mousemove\"),e&&\"mouseleave\"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr(\"title\",i.title),delete s.parents[e]}),a.closing=!0,this._trigger(\"close\",e,{tooltip:i}),a.hiding||(a.closing=!1)),void 0):(n.removeData(\"ui-tooltip-open\"),void 0)},_tooltip:function(e){var i=t(\"<div>\").attr(\"role\",\"tooltip\").addClass(\"ui-tooltip ui-widget ui-corner-all ui-widget-content \"+(this.options.tooltipClass||\"\")),s=i.uniqueId().attr(\"id\");return t(\"<div>\").addClass(\"ui-tooltip-content\").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:e,tooltip:i}},_find:function(t){var e=t.data(\"ui-tooltip-id\");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr(\"id\")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event(\"blur\"),a=s.element;n.target=n.currentTarget=a[0],e.close(n,!0),t(\"#\"+i).remove(),a.data(\"ui-tooltip-title\")&&(a.attr(\"title\")||a.attr(\"title\",a.data(\"ui-tooltip-title\")),a.removeData(\"ui-tooltip-title\"))}),this.liveRegion.remove()}})});"]}