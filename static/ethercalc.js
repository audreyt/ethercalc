!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(e,this)):"object"==typeof module&&module.exports?module.exports=t.call(e,this):e.SocialCalc=t.call(e,this)}(this,function(M){var Re;return(Re=Re||{}).Constants={cellDataType:{v:"value",n:"value",t:"text",f:"formula",c:"constant"},textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"3",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;",defaultRownameClass:"",defaultRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",defaultColResizeBarClass:"col-resize-bar",defaultRowResizeBarClass:"row-resize-bar",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc_",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_statusline_sendemail:"Sending Email ",s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoHintClass:"",defaultInputEchoHintStyle:"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderClass:"tc-paneslider",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"tracklingine",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#ffffff;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#888",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonNormalBackground:"transparent",ISCButtonBorderNormal:"none",ISCButtonBorderHover:"none",ISCButtonBorderDown:"none",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Cell Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_hide_column:"Hide Column",s_loc_hide_row:"Hide Row",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column Before",s_loc_insert_row:"Insert Row Before",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_lock_cell:"Lock Cell",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge/Unmerge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unlock_cell:"Unlock Cell",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_CONCAT:"Join Together Text & Values to Create a Single Combined Text String. ",s_fdef_CONCATENATE:"Join Together Text & Values to Create a Single Combined Text String. ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SUMIFS:'Sums the numeric values of cells in the sum_range that meet the multiple criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25).  ',s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",function_classlist:["all","stat","lookup","datetime","financial","test","math","text","gui","action"],s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",s_fclass_action:"Email & Copy",s_fclass_gui:"Button & Input",lastone:null},Re.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",TDpopupElement:""},Re.ConstantsSetClasses=function(e){var t,o=Re.ConstantsDefaultClasses,i=Re.Constants;for(t in e=e||"",o)"string"==typeof o[t]?(i[t+"Class"]=e+(o[t]||t),void 0!==i[t+"Style"]&&(i[t+"Style"]="")):"object"==typeof o[t]&&(i[t+"Class"]=e+(o[t].classname||t),i[t+"Style"]=o[t].style)},Re.ConstantsSetImagePrefix=function(e){var t,o=Re.Constants;for(t in o)"string"==typeof o[t]&&(o[t]=o[t].replace(o.defaultImagePrefix,e));o.defaultImagePrefix=e},(Re=Re||{}).Callbacks={expand_wiki:null,expand_markup:function(e,t,o){return Re.default_expand_markup(e,t,o)},MakePageLink:null,NormalizeSheetName:null},Re.Cell=function(e){this.coord=e,this.datavalue="",this.datatype=null,this.formula="",this.valuetype="b",this.readonly=!1},Re.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3},Re.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"},Re.Sheet=function(){Re.ResetSheet(this),this.statuscallback=null,this.statuscallbackparams=null},Re.ResetSheet=function(e,t){e.cells={},e.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0},e.rowattribs={hide:{},height:{}},e.colattribs={width:{},hide:{}},e.names={},e.layouts=[],e.layouthash={},e.fonts=[],e.fonthash={},e.colors=[],e.colorhash={},e.borderstyles=[],e.borderstylehash={},e.cellformats=[],e.cellformathash={},e.valueformats=[],e.valueformathash={},e.matched_cells=[],e.selected_search_cell=void 0,e.copiedfrom="",e.changes=new Re.UndoStack,e.renderneeded=!1,e.changedrendervalues=!0,e.recalcchangedavalue=!1,e.hiddencolrow="",e.sci=new Re.SheetCommandInfo(e),e.ioEventTree={},e.ioParameterList={}},Re.Sheet.prototype.ResetSheet=function(){Re.ResetSheet(this)},Re.Sheet.prototype.AddCell=function(e){return this.cells[e.coord]=e},Re.Sheet.prototype.LastCol=function(){var e,t=1;for(e in this.cells){var o=Re.coordToCr(e);o.col>t&&(t=o.col)}return t},Re.Sheet.prototype.LastRow=function(){var e,t=1;for(e in this.cells){var o=Re.coordToCr(e);o.row>t&&(t=o.row)}return t},Re.Sheet.prototype.GetAssuredCell=function(e){return this.cells[e]||this.AddCell(new Re.Cell(e))},Re.Sheet.prototype.ParseSheetSave=function(e){Re.ParseSheetSave(e,this)},Re.Sheet.prototype.CellFromStringParts=function(e,t,o){return Re.CellFromStringParts(this,e,t,o)},Re.Sheet.prototype.CreateSheetSave=function(e,t){return Re.CreateSheetSave(this,e,t)},Re.Sheet.prototype.CellToString=function(e){return Re.CellToString(this,e)},Re.Sheet.prototype.CanonicalizeSheet=function(e){return Re.CanonicalizeSheet(this,e)},Re.Sheet.prototype.EncodeCellAttributes=function(e){return Re.EncodeCellAttributes(this,e)},Re.Sheet.prototype.EncodeSheetAttributes=function(){return Re.EncodeSheetAttributes(this)},Re.Sheet.prototype.DecodeCellAttributes=function(e,t,o){return Re.DecodeCellAttributes(this,e,t,o)},Re.Sheet.prototype.DecodeSheetAttributes=function(e){return Re.DecodeSheetAttributes(this,e)},Re.Sheet.prototype.ScheduleSheetCommands=function(e,t){return Re.ScheduleSheetCommands(this,e,t)},Re.Sheet.prototype.SheetUndo=function(){return Re.SheetUndo(this)},Re.Sheet.prototype.SheetRedo=function(){return Re.SheetRedo(this)},Re.Sheet.prototype.CreateAuditString=function(){return Re.CreateAuditString(this)},Re.Sheet.prototype.GetStyleNum=function(e,t){return Re.GetStyleNum(this,e,t)},Re.Sheet.prototype.GetStyleString=function(e,t){return Re.GetStyleString(this,e,t)},Re.Sheet.prototype.RecalcSheet=function(){return Re.RecalcSheet(this)},Re.ParseSheetSave=function(e,t){for(var o,i,n,r,s,a,l=e.split(/\r\n|\n/),c=[],u=Re.Constants,d=0;d<l.length;d++){switch((c=l[d].split(":"))[0]){case"cell":a=t.GetAssuredCell(c[1]),t.CellFromStringParts(a,c,o=2);break;case"col":for(r=c[1],o=2;i=c[o++];)switch(i){case"w":t.colattribs.width[r]=c[o++];break;case"hide":t.colattribs.hide[r]=c[o++];break;default:throw u.s_pssUnknownColType+" '"+i+"'"}break;case"row":for(r=+c[1],o=2;i=c[o++];)switch(i){case"h":t.rowattribs.height[r]=+c[o++];break;case"hide":t.rowattribs.hide[r]=c[o++];break;default:throw u.s_pssUnknownRowType+" '"+i+"'"}break;case"sheet":for(s=t.attribs,o=1;i=c[o++];)switch(i){case"c":s.lastcol=+c[o++];break;case"r":s.lastrow=+c[o++];break;case"w":s.defaultcolwidth=c[o++]+"";break;case"h":s.defaultrowheight=+c[o++];break;case"tf":s.defaulttextformat=+c[o++];break;case"ntf":s.defaultnontextformat=+c[o++];break;case"layout":s.defaultlayout=+c[o++];break;case"font":s.defaultfont=+c[o++];break;case"tvf":s.defaulttextvalueformat=+c[o++];break;case"ntvf":s.defaultnontextvalueformat=+c[o++];break;case"color":s.defaultcolor=+c[o++];break;case"bgcolor":s.defaultbgcolor=+c[o++];break;case"circularreferencecell":s.circularreferencecell=c[o++];break;case"recalc":s.recalc=c[o++];break;case"needsrecalc":s.needsrecalc=c[o++];break;case"usermaxcol":s.usermaxcol=+c[o++];break;case"usermaxrow":s.usermaxrow=+c[o++];break;default:o+=1}break;case"name":a=Re.decodeFromSave(c[1]).toUpperCase(),t.names[a]={desc:Re.decodeFromSave(c[2])},t.names[a].definition=Re.decodeFromSave(c[3]);break;case"layout":c=l[d].match(/^layout\:(\d+)\:(.+)$/),t.layouts[+c[1]]=c[2],t.layouthash[c[2]]=+c[1];break;case"font":t.fonts[+c[1]]=c[2],t.fonthash[c[2]]=+c[1];break;case"color":t.colors[+c[1]]=c[2],t.colorhash[c[2]]=+c[1];break;case"border":t.borderstyles[+c[1]]=c[2],t.borderstylehash[c[2]]=+c[1];break;case"cellformat":n=Re.decodeFromSave(c[2]),t.cellformats[+c[1]]=n,t.cellformathash[n]=+c[1];break;case"valueformat":n=Re.decodeFromSave(c[2]),t.valueformats[+c[1]]=n,t.valueformathash[n]=+c[1];break;case"version":break;case"copiedfrom":t.copiedfrom=c[1]+":"+c[2];break;case"clipboardrange":case"clipboard":case"":break;default:throw alert(u.s_pssUnknownLineType+" '"+c[0]+"'"),u.s_pssUnknownLineType+" '"+c[0]+"'"}c=null}},Re.CellFromStringParts=function(e,t,o,i){for(var n,r;n=o[i++];)switch(n){case"v":t.datavalue=+Re.decodeFromSave(o[i++]),t.datatype="v",t.valuetype="n";break;case"t":t.datavalue=Re.decodeFromSave(o[i++]),t.datatype="t",t.valuetype=Re.Constants.textdatadefaulttype;break;case"vt":r=o[i++],"n"==(t.valuetype=r).charAt(0)?(t.datatype="v",t.datavalue=+Re.decodeFromSave(o[i++])):(t.datatype="t",t.datavalue=Re.decodeFromSave(o[i++]));break;case"vtf":r=o[i++],"n"==(t.valuetype=r).charAt(0)?t.datavalue=+Re.decodeFromSave(o[i++]):t.datavalue=Re.decodeFromSave(o[i++]),t.formula=Re.decodeFromSave(o[i++]),t.datatype="f";break;case"vtc":r=o[i++],"n"==(t.valuetype=r).charAt(0)?t.datavalue=+Re.decodeFromSave(o[i++]):t.datavalue=Re.decodeFromSave(o[i++]),t.formula=Re.decodeFromSave(o[i++]),t.datatype="c";break;case"ro":ro=Re.decodeFromSave(o[i++]),t.readonly="yes"==ro.toLowerCase();break;case"e":t.errors=Re.decodeFromSave(o[i++]);break;case"b":t.bt=+o[i++],t.br=+o[i++],t.bb=+o[i++],t.bl=+o[i++];break;case"l":t.layout=+o[i++];break;case"f":t.font=+o[i++];break;case"c":t.color=+o[i++];break;case"bg":t.bgcolor=+o[i++];break;case"cf":t.cellformat=+o[i++];break;case"ntvf":t.nontextvalueformat=+o[i++];break;case"tvf":t.textvalueformat=+o[i++];break;case"colspan":t.colspan=+o[i++];break;case"rowspan":t.rowspan=+o[i++];break;case"cssc":t.cssc=o[i++];break;case"csss":t.csss=Re.decodeFromSave(o[i++]);break;case"mod":i+=1;break;case"comment":t.comment=Re.decodeFromSave(o[i++]);break;default:throw Re.Constants.s_cfspUnknownCellType+" '"+n+"'"}},Re.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],Re.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],Re.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"],Re.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"],Re.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"],Re.CreateSheetSave=function(e,t,o){var i,n,r,s,a,l,c,u,d=[],h=(e.CanonicalizeSheet(o||Re.Constants.doCanonicalizeSheet),e.xlt),o=t?Re.ParseRange(t):{cr1:{row:1,col:1},cr2:{row:h.maxrow,col:h.maxcol}},p=o.cr1,f=o.cr2;for(d.push("version:1.5"),n=p.row;n<=f.row;n++)for(r=p.col;r<=f.col;r++)s=Re.crToCoord(r,n),(i=e.cells[s])&&0!=(a=e.CellToString(i)).length&&d.push(a="cell:"+s+a);for(r=1;r<=h.maxcol;r++)s=Re.rcColname(r),e.colattribs.width[s]&&d.push("col:"+s+":w:"+e.colattribs.width[s]),e.colattribs.hide[s]&&d.push("col:"+s+":hide:"+e.colattribs.hide[s]);for(n=1;n<=h.maxrow;n++)e.rowattribs.height[n]&&d.push("row:"+n+":h:"+e.rowattribs.height[n]),e.rowattribs.hide[n]&&d.push("row:"+n+":hide:"+e.rowattribs.hide[n]);for(a="sheet:c:"+h.maxcol+":r:"+h.maxrow,c=0;c<Re.sheetfields.length;c++)(l=Re.encodeForSave(e.attribs[Re.sheetfields[c]]))&&(a+=":"+Re.sheetfieldsshort[c]+":"+l);for(c=0;c<Re.sheetfieldsxlat.length;c++)(l=e.attribs[Re.sheetfieldsxlat[c]])&&(a+=":"+Re.sheetfieldsxlatshort[c]+":"+h[Re.sheetfieldsxlatxlt[c]+"sxlat"][l]);for(d.push(a),c=1;c<h.newborderstyles.length;c++)d.push("border:"+c+":"+h.newborderstyles[c]);for(c=1;c<h.newcellformats.length;c++)d.push("cellformat:"+c+":"+Re.encodeForSave(h.newcellformats[c]));for(c=1;c<h.newcolors.length;c++)d.push("color:"+c+":"+h.newcolors[c]);for(c=1;c<h.newfonts.length;c++)d.push("font:"+c+":"+h.newfonts[c]);for(c=1;c<h.newlayouts.length;c++)d.push("layout:"+c+":"+h.newlayouts[c]);for(c=1;c<h.newvalueformats.length;c++)d.push("valueformat:"+c+":"+Re.encodeForSave(h.newvalueformats[c]));for(c=0;c<h.namesorder.length;c++)u=h.namesorder[c],d.push("name:"+Re.encodeForSave(u).toUpperCase()+":"+Re.encodeForSave(e.names[u].desc)+":"+Re.encodeForSave(e.names[u].definition));return t&&d.push("copiedfrom:"+Re.crToCoord(p.col,p.row)+":"+Re.crToCoord(f.col,f.row)),d.push(""),delete e.xlt,d.join("\n")},Re.CellToString=function(e,t){var o,i,n,r,s="";return t&&(o=Re.encodeForSave(t.datavalue),"v"==t.datatype?"n"==t.valuetype?s+=":v:"+o:s+=":vt:"+t.valuetype+":"+o:"t"==t.datatype?t.valuetype==Re.Constants.textdatadefaulttype?s+=":t:"+o:s+=":vt:"+t.valuetype+":"+o:(i=Re.encodeForSave(t.formula),"f"==t.datatype?s+=":vtf:"+t.valuetype+":"+o+":"+i:"c"==t.datatype&&(s+=":vtc:"+t.valuetype+":"+o+":"+i)),t.readonly&&(s+=":ro:yes"),t.errors&&(s+=":e:"+Re.encodeForSave(t.errors)),o=t.bt||"",i=t.br||"",n=t.bb||"",r=t.bl||"",e.xlt?(e=e.xlt,(o||i||n||r)&&(s+=":b:"+e.borderstylesxlat[o||0]+":"+e.borderstylesxlat[i||0]+":"+e.borderstylesxlat[n||0]+":"+e.borderstylesxlat[r||0]),t.layout&&(s+=":l:"+e.layoutsxlat[t.layout]),t.font&&(s+=":f:"+e.fontsxlat[t.font]),t.color&&(s+=":c:"+e.colorsxlat[t.color]),t.bgcolor&&(s+=":bg:"+e.colorsxlat[t.bgcolor]),t.cellformat&&(s+=":cf:"+e.cellformatsxlat[t.cellformat]),t.textvalueformat&&(s+=":tvf:"+e.valueformatsxlat[t.textvalueformat]),t.nontextvalueformat&&(s+=":ntvf:"+e.valueformatsxlat[t.nontextvalueformat])):((o||i||n||r)&&(s+=":b:"+o+":"+i+":"+n+":"+r),t.layout&&(s+=":l:"+t.layout),t.font&&(s+=":f:"+t.font),t.color&&(s+=":c:"+t.color),t.bgcolor&&(s+=":bg:"+t.bgcolor),t.cellformat&&(s+=":cf:"+t.cellformat),t.textvalueformat&&(s+=":tvf:"+t.textvalueformat),t.nontextvalueformat&&(s+=":ntvf:"+t.nontextvalueformat)),t.colspan&&(s+=":colspan:"+t.colspan),t.rowspan&&(s+=":rowspan:"+t.rowspan),t.cssc&&(s+=":cssc:"+t.cssc),t.csss&&(s+=":csss:"+Re.encodeForSave(t.csss)),t.mod&&(s+=":mod:"+t.mod),t.comment&&(s+=":comment:"+Re.encodeForSave(t.comment))),s},Re.CanonicalizeSheet=function(e,t){var o,i,n,r,s,a,l,c,u,d,h,p,f=0,m=0,g=["borderstyle","cellformat","color","font","layout","valueformat"],v={namesorder:[]};for(l in e.names)v.namesorder.push(l);if(v.namesorder.sort(),!Re.Constants.doCanonicalizeSheet||!t){for(a=0;a<g.length;a++){for(v["new"+(l=g[a])+"s"]=e[l+"s"],o=e[l+"s"].length,(u=new Array(o))[0]="",h=1;h<o;h++)u[h]=h;v[l+"sxlat"]=u}return v.maxrow=e.attribs.lastrow,v.maxcol=e.attribs.lastcol,void(e.xlt=v)}for(a=0;a<g.length;a++)v[(l=g[a])+"sUsed"]={};var b=v.colorsUsed,y=v.borderstylesUsed,C=v.fontsUsed,w=v.layoutsUsed,x=v.cellformatsUsed,_=v.valueformatsUsed;for(i in e.cells)n=Re.coordToCr(i),s=!1,(r=e.cells[i]).valuetype&&"b"!=r.valuetype&&(s=!0),r.color&&(b[r.color]=1,s=!0),r.bgcolor&&(b[r.bgcolor]=1,s=!0),r.bt&&(y[r.bt]=1,s=!0),r.br&&(y[r.br]=1,s=!0),r.bb&&(y[r.bb]=1,s=!0),r.bl&&(y[r.bl]=1,s=!0),r.layout&&(w[r.layout]=1,s=!0),r.font&&(C[r.font]=1,s=!0),r.cellformat&&(x[r.cellformat]=1,s=!0),r.textvalueformat&&(_[r.textvalueformat]=1,s=!0),r.nontextvalueformat&&(_[r.nontextvalueformat]=1,s=!0),s&&(n.row>f&&(f=n.row),n.col>m&&(m=n.col));for(h=0;h<Re.sheetfieldsxlat.length;h++)(p=e.attribs[Re.sheetfieldsxlat[h]])&&(v[Re.sheetfieldsxlatxlt[h]+"sUsed"][p]=1);for(p in l={height:1,hide:1})for(n in e.rowattribs[p])f<n&&(f=n);for(p in l={hide:1,width:1})for(i in e.colattribs[p])(n=Re.coordToCr(i+"1")).col>m&&(m=n.col);for(a=0;a<g.length;a++){for(p in c=[],v[(l=g[a])+"sUsed"])c.push(e[l+"s"][p]);for(c.sort(),c.unshift(""),u=[""],d=e[l+"hash"],h=1;h<c.length;h++)u[d[c[h]]]=h;v[l+"sxlat"]=u,v["new"+l+"s"]=c}v.maxrow=f||1,v.maxcol=m||1,e.xlt=v},Re.EncodeCellAttributes=function(e,t){function o(e){l[e]={def:!0,val:""}}function i(e){for(var t=0;t<e.length;t++)o(e[t])}function n(e,t){l[e].def=!1,l[e].val=t||""}function r(e,t){"*"!=t&&(l[e].def=!1,l[e].val=t)}var s,a,l={},c=e.GetAssuredCell(t);for(o("alignhoriz"),c.cellformat&&n("alignhoriz",e.cellformats[c.cellformat]),i(["alignvert","padtop","padright","padbottom","padleft"]),c.layout&&(r("padtop",(parts=e.layouts[c.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/))[1]),r("padright",parts[2]),r("padbottom",parts[3]),r("padleft",parts[4]),r("alignvert",parts[5])),i(["fontfamily","fontlook","fontsize"]),c.font&&(r("fontfamily",(parts=e.fonts[c.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/))[3]),r("fontsize",parts[2]),r("fontlook",parts[1])),o("textcolor"),c.color&&n("textcolor",e.colors[c.color]),o("bgcolor"),c.bgcolor&&n("bgcolor",e.colors[c.bgcolor]),i(["numberformat","textformat"]),c.nontextvalueformat&&n("numberformat",e.valueformats[c.nontextvalueformat]),c.textvalueformat&&n("textformat",e.valueformats[c.textvalueformat]),i(["colspan","rowspan"]),n("colspan",c.colspan||1),n("rowspan",c.rowspan||1),s=0;s<4;s++)a="trbl".charAt(s),o(a="b"+a),n(a,c[a]?e.borderstyles[c[a]]:""),o(a+"thickness"),o(a+"style"),o(a+"color"),c[a]&&(n(a+"thickness",(parts=e.borderstyles[c[a]].match(/(\S+)\s+(\S+)\s+(\S.+)/))[1]),n(a+"style",parts[2]),n(a+"color",parts[3]));return i(["cssc","csss","mod"]),n("cssc",c.cssc||""),n("csss",c.csss||""),n("mod",c.mod||"n"),l},Re.EncodeSheetAttributes=function(e){function o(e){s[e]={def:!0,val:""}}function t(e){for(var t=0;t<e.length;t++)o(e[t])}function i(e,t){s[e].def=!1,s[e].val=t||void 0}function n(e,t){"*"!=t&&(s[e].def=!1,s[e].val=t)}var r=e.attribs,s={};return o("colwidth"),r.defaultcolwidth&&i("colwidth",r.defaultcolwidth),o("rowheight"),r.rowheight&&i("rowheight",r.defaultrowheight),o("textalignhoriz"),r.defaulttextformat&&i("textalignhoriz",e.cellformats[r.defaulttextformat]),o("numberalignhoriz"),r.defaultnontextformat&&i("numberalignhoriz",e.cellformats[r.defaultnontextformat]),t(["alignvert","padtop","padright","padbottom","padleft"]),r.defaultlayout&&(n("padtop",(parts=e.layouts[r.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/))[1]),n("padright",parts[2]),n("padbottom",parts[3]),n("padleft",parts[4]),n("alignvert",parts[5])),t(["fontfamily","fontlook","fontsize"]),r.defaultfont&&(n("fontfamily",(parts=e.fonts[r.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/))[3]),n("fontsize",parts[2]),n("fontlook",parts[1])),o("textcolor"),r.defaultcolor&&i("textcolor",e.colors[r.defaultcolor]),o("bgcolor"),r.defaultbgcolor&&i("bgcolor",e.colors[r.defaultbgcolor]),t(["numberformat","textformat"]),r.defaultnontextvalueformat&&i("numberformat",e.valueformats[r.defaultnontextvalueformat]),r.defaulttextvalueformat&&i("textformat",e.valueformats[r.defaulttextvalueformat]),o("recalc"),r.recalc&&i("recalc",r.recalc),o("usermaxcol"),r.usermaxcol&&i("usermaxcol",r.usermaxcol),o("usermaxrow"),r.usermaxrow&&i("usermaxrow",r.usermaxrow),s},Re.DecodeCellAttributes=function(e,t,n,o){function r(e,t,o){n[e]&&(e=n[e].def?"":n[e].val)!=(t||"")&&s(o+" "+e)}function s(e){d&&(d+="\n"),d+="set "+(o||t)+" "+e,u=!0}var a,l,c=e.GetAssuredCell(t),u=!1,d="";for(r("alignhoriz",e.cellformats[c.cellformat],"cellformat"),(a=n.alignvert.def&&n.padtop.def&&n.padright.def&&n.padbottom.def&&n.padleft.def?"":"padding:"+(n.padtop.def?"* ":n.padtop.val+" ")+(n.padright.def?"* ":n.padright.val+" ")+(n.padbottom.def?"* ":n.padbottom.val+" ")+(n.padleft.def?"*":n.padleft.val)+";vertical-align:"+(n.alignvert.def?"*;":n.alignvert.val+";"))!=(e.layouts[c.layout]||"")&&s("layout "+a),(a=n.fontlook.def&&n.fontsize.def&&n.fontfamily.def?"":(n.fontlook.def?"* ":n.fontlook.val+" ")+(n.fontsize.def?"* ":n.fontsize.val+" ")+(n.fontfamily.def?"*":n.fontfamily.val))!=(e.fonts[c.font]||"")&&s("font "+a),r("textcolor",e.colors[c.color],"color"),r("bgcolor",e.colors[c.bgcolor],"bgcolor"),r("numberformat",e.valueformats[c.nontextvalueformat],"nontextvalueformat"),r("textformat",e.valueformats[c.textvalueformat],"textvalueformat"),i=0;i<4;i++)r(l="b"+"trbl".charAt(i),e.borderstyles[c[l]],l);return r("cssc",c.cssc,"cssc"),r("csss",c.csss,"csss"),n.mod&&(a=n.mod.def?"n":n.mod.val)!=(c.mod||"n")&&s("mod "+(a="n"==a?"":a)),u?d:null},Re.DecodeSheetAttributes=function(e,i){function t(e,t,o){i[e]&&(e=i[e].def?"":i[e].val)!=(t||"")&&n(o+" "+e)}function n(e){a&&(a+="\n"),a+="set sheet "+e,s=!0}var o,r=e.attribs,s=!1,a="";return t("colwidth",r.defaultcolwidth,"defaultcolwidth"),t("rowheight",r.defaultrowheight,"defaultrowheight"),t("textalignhoriz",e.cellformats[r.defaulttextformat],"defaulttextformat"),t("numberalignhoriz",e.cellformats[r.defaultnontextformat],"defaultnontextformat"),(o=i.alignvert.def&&i.padtop.def&&i.padright.def&&i.padbottom.def&&i.padleft.def?"":"padding:"+(i.padtop.def?"* ":i.padtop.val+" ")+(i.padright.def?"* ":i.padright.val+" ")+(i.padbottom.def?"* ":i.padbottom.val+" ")+(i.padleft.def?"*":i.padleft.val)+";vertical-align:"+(i.alignvert.def?"*;":i.alignvert.val+";"))!=(e.layouts[r.defaultlayout]||"")&&n("defaultlayout "+o),(o=i.fontlook.def&&i.fontsize.def&&i.fontfamily.def?"":(i.fontlook.def?"* ":i.fontlook.val+" ")+(i.fontsize.def?"* ":i.fontsize.val+" ")+(i.fontfamily.def?"*":i.fontfamily.val))!=(e.fonts[r.defaultfont]||"")&&n("defaultfont "+o),t("textcolor",e.colors[r.defaultcolor],"defaultcolor"),t("bgcolor",e.colors[r.defaultbgcolor],"defaultbgcolor"),t("numberformat",e.valueformats[r.defaultnontextvalueformat],"defaultnontextvalueformat"),t("textformat",e.valueformats[r.defaulttextvalueformat],"defaulttextvalueformat"),t("recalc",e.attribs.recalc,"recalc"),t("usermaxcol",e.attribs.usermaxcol,"usermaxcol"),t("usermaxrow",e.attribs.usermaxrow,"usermaxrow"),s?a:null},Re.SheetCommandInfo=function(e){this.sheetobj=e,this.timerobj=null,this.firsttimerdelay=50,this.timerdelay=1,this.maxtimeslice=100,this.saveundo=!1,this.CmdExtensionCallbacks={}},Re.ScheduleSheetCommands=function(e,t,o){var i=e.sci,n=new Re.Parse(t);i.sheetobj.statuscallback&&e.statuscallback(i,"cmdstart","",i.sheetobj.statuscallbackparams),o&&i.sheetobj.changes.PushChange(""),i.timerobj=M.setTimeout(function(){Re.SheetCommandsTimerRoutine(i,n,o)},i.firsttimerdelay)},Re.SheetCommandsTimerRoutine=function(e,t,o){var i,n=new Date;for(e.timerobj=null;!t.EOF();){try{i=Re.ExecuteSheetCommand(e.sheetobj,t,o)}catch(e){i=e.message}if(i&&("function"==typeof alert?alert(i):console.log(i)),t.NextLine(),new Date-n>=e.maxtimeslice)return void(e.timerobj=M.setTimeout(function(){Re.SheetCommandsTimerRoutine(e,t,o)},e.timerdelay))}e.sheetobj.statuscallback&&e.sheetobj.statuscallback(e,"cmdend","",e.sheetobj.statuscallbackparams)},Re.ExecuteSheetCommand=function(a,e,t){function o(){var e=Re.ParseRange(r);d=e.cr1,(h=e.cr2).col>P.lastcol&&(P.lastcol=h.col),h.row>P.lastrow&&(P.lastrow=h.row)}var i,n,r,s,L,l,O,c,u,d,h,p,f,z,H,m,g,v,b,B,y,U,j,V,W,G,$,Y,K,q,X,J,Z,Q,ee,te,oe,C,ie,ne,re,se,w,ae,le,ce,ue,de,he,pe,x,_,fe,S,k,T,me,ge,ve,F,E,be,ye,D,Ce,P=a.attribs,A=a.changes,I=Re.CellProperties,we=Re.Constants,xe=!1,_e="",Se=e.RestOfStringNoMove();switch(t&&a.changes.AddDo(Se),i=e.NextToken()){case"set":if(r=e.NextToken(),s=e.NextToken(),n=e.RestOfString(),c="set "+r+" "+s,"sheet"==r)switch(a.renderneeded=!0,s){case"defaultcolwidth":t&&A.AddUndo(c,P[s]),P[s]=n;break;case"defaultcolor":case"defaultbgcolor":t&&A.AddUndo(c,a.GetStyleString("color",P[s])),P[s]=a.GetStyleNum("color",n);break;case"defaultlayout":t&&A.AddUndo(c,a.GetStyleString("layout",P[s])),P[s]=a.GetStyleNum("layout",n);break;case"defaultfont":t&&A.AddUndo(c,a.GetStyleString("font",P[s])),P[s]=a.GetStyleNum("font",n="* * *"==n?"":n);break;case"defaulttextformat":case"defaultnontextformat":t&&A.AddUndo(c,a.GetStyleString("cellformat",P[s])),P[s]=a.GetStyleNum("cellformat",n);break;case"defaulttextvalueformat":case"defaultnontextvalueformat":for(p in t&&A.AddUndo(c,a.GetStyleString("valueformat",P[s])),P[s]=a.GetStyleNum("valueformat",n),a.cells)delete a.cells[p].displaystring;break;case"lastcol":case"lastrow":t&&A.AddUndo(c,+P[s]),"number"==typeof(L=+n)&&(P[s]=0<L?L:1);break;case"recalc":t&&A.AddUndo(c,P[s]),"off"==n?P.recalc=n:delete P.recalc;break;case"usermaxcol":case"usermaxrow":t&&A.AddUndo(c,+P[s]),"number"==typeof(L=+n)&&(P[s]=0<L?L:0);break;default:_e=we.s_escUnknownSheetCmd+Se}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(r))for(a.renderneeded=!0,l=(r=r.toUpperCase()).indexOf(":"),h=0<=l?(d=Re.coordToCr(r.substring(0,l)+"1"),Re.coordToCr(r.substring(l+1)+"1")):d=Re.coordToCr(r+"1"),S=d.col;S<=h.col;S++)"width"==s?(p=Re.rcColname(S),t&&A.AddUndo("set "+p+" width",a.colattribs.width[p]),0<n.length?a.colattribs.width[p]=n:delete a.colattribs.width[p]):"hide"==s&&(a.hiddencolrow="col",p=Re.rcColname(S),t&&A.AddUndo("set "+p+" hide",a.colattribs.hide[p]),0<n.length?a.colattribs.hide[p]=n:delete a.colattribs.hide[p]);else if(/^\d+(:\d+)?$/i.test(r))for(a.renderneeded=!0,l=(r=r.toUpperCase()).indexOf(":"),h=0<=l?(d=Re.coordToCr("A"+r.substring(0,l)),Re.coordToCr("A"+r.substring(l+1))):d=Re.coordToCr("A"+r),k=d.row;k<=h.row;k++)"height"==s?(t&&A.AddUndo("set "+k+" height",a.rowattribs.height[k]),0<n.length?a.rowattribs.height[k]=n:delete a.rowattribs.height[k]):"hide"==s&&(a.hiddencolrow="row",t&&A.AddUndo("set "+k+" hide",a.rowattribs.hide[k]),0<n.length?a.rowattribs.hide[k]=n:delete a.rowattribs.hide[k]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(r))for(xe=!0,o(),d.row!=h.row||d.col!=h.col||a.celldisplayneeded||a.renderneeded?(a.renderneeded=!0,a.celldisplayneeded=""):a.celldisplayneeded=Re.crToCoord(d.col,d.row),k=d.row;k<=h.row;k++)for(S=d.col;S<=h.col;S++)p=Re.crToCoord(S,k),(f=a.GetAssuredCell(p)).readonly&&"readonly"!=s||(t&&A.AddUndo("set "+p+" all",a.CellToString(f)),"value"==s?(l=n.indexOf(" "),f.datavalue=+n.substring(l+1),delete f.errors,f.datatype="v",f.valuetype=n.substring(0,l),delete f.displaystring,delete f.parseinfo,P.needsrecalc="yes"):"text"==s?(l=n.indexOf(" "),f.datavalue=Re.decodeFromSave(n.substring(l+1)),delete f.errors,f.datatype="t",f.valuetype=n.substring(0,l),delete f.displaystring,delete f.parseinfo,P.needsrecalc="yes"):"formula"==s?(f.datavalue=0,delete f.errors,f.datatype="f",Re._app&&"e#N/A"!=f.valuetype&&(f.prevvaluetype=f.valuetype),f.valuetype="e#N/A",f.formula=n,delete f.displaystring,delete f.parseinfo,P.needsrecalc="yes"):"constant"==s?(l=n.indexOf(" "),O=n.substring(l+1).indexOf(" "),f.datavalue=+n.substring(l+1,l+1+O),f.valuetype=n.substring(0,l),"e"==f.valuetype.charAt(0)?f.errors=f.valuetype.substring(1):delete f.errors,f.datatype="c",f.formula=n.substring(l+O+2),delete f.displaystring,delete f.parseinfo,P.needsrecalc="yes"):"empty"==s?(f.datavalue="",delete f.errors,f.datatype=null,f.formula="",f.valuetype="b",delete f.displaystring,delete f.parseinfo,P.needsrecalc="yes"):"all"==s?(0<n.length?(f=new Re.Cell(p),a.CellFromStringParts(f,n.split(":"),1),a.cells[p]=f):delete a.cells[p],P.needsrecalc="yes"):/^b[trbl]$/.test(s)?(f[s]=a.GetStyleNum("borderstyle",n),a.renderneeded=!0):"color"==s||"bgcolor"==s?f[s]=a.GetStyleNum("color",n):"layout"==s||"cellformat"==s?f[s]=a.GetStyleNum(s,n):"font"==s?f[s]=a.GetStyleNum("font",n="* * *"==n?"":n):"textvalueformat"==s||"nontextvalueformat"==s?(f[s]=a.GetStyleNum("valueformat",n),delete f.displaystring):"cssc"==s?(n=n.replace(/[^a-zA-Z0-9\-]/g,""),f.cssc=n):"csss"==s?(n=n.replace(/\n/g,""),f.csss=n):"mod"==s?(n=n.replace(/[^yY]/g,"").toLowerCase(),f.mod=n):"comment"==s?f.comment=Re.decodeFromSave(n):"readonly"==s?f.readonly="yes"==n.toLowerCase():_e=we.s_escUnknownSetCoordCmd+Se);break;case"merge":if(a.renderneeded=!0,r=e.NextToken(),n=e.RestOfString(),o(),(f=a.GetAssuredCell(d.coord)).readonly)break;for(k=d.row;k<=h.row;k++)for(S=d.col;S<=h.col;S++)k==d.row&&S==d.col||(quashedCellCoord=Re.crToCoord(S,k),quashedCell=a.GetAssuredCell(quashedCellCoord),t&&A.AddUndo("set "+quashedCellCoord+" all",a.CellToString(quashedCell)),delete a.cells[quashedCellCoord]);t&&A.AddUndo("unmerge "+d.coord),h.col>d.col?f.colspan=h.col-d.col+1:delete f.colspan,h.row>d.row?f.rowspan=h.row-d.row+1:delete f.rowspan,a.changedrendervalues=!0;break;case"unmerge":if(a.renderneeded=!0,r=e.NextToken(),n=e.RestOfString(),o(),(f=a.GetAssuredCell(d.coord)).readonly)break;t&&A.AddUndo("merge "+d.coord+":"+Re.crToCoord(d.col+(f.colspan||1)-1,d.row+(f.rowspan||1)-1)),delete f.colspan,delete f.rowspan,a.changedrendervalues=!0;break;case"erase":case"cut":for(a.renderneeded=!0,a.changedrendervalues=!0,r=e.NextToken(),n=e.RestOfString(),o(),t&&A.AddUndo("changedrendervalues"),"cut"==i&&(t&&A.AddUndo("loadclipboard",Re.encodeForSave(Re.Clipboard.clipboard)),Re.Clipboard.clipboard=Re.CreateSheetSave(a,r)),k=d.row;k<=h.row;k++)for(S=d.col;S<=h.col;S++)p=Re.crToCoord(S,k),(f=a.GetAssuredCell(p)).readonly||(t&&A.AddUndo("set "+p+" all",a.CellToString(f)),"all"==n?delete a.cells[p]:"formulas"==n?(f.datavalue="",f.datatype=null,f.formula="",f.valuetype="b",delete f.errors,delete f.displaystring,delete f.parseinfo,f.comment&&delete f.comment):"formats"==n&&((z=new Re.Cell(p)).datavalue=f.datavalue,z.datatype=f.datatype,z.formula=f.formula,z.valuetype=f.valuetype,f.comment&&(z.comment=f.comment),a.cells[p]=z));P.needsrecalc="yes";break;case"fillright":case"filldown":function ke(e){function t(e){return"v"==e||"c"==e}var o,i,n=Re.GetSpreadsheetControlObject().editor,r=n.range2,s=void 0;return r.hasrange&&(e&&r.bottom-r.top==1&&r.left==r.right?(o=a.GetAssuredCell(Re.crToCoord(r.left,r.top)),i=a.GetAssuredCell(Re.crToCoord(r.left,r.bottom)),t(o.datatype)&&t(i.datatype)&&(s=i.datavalue-o.datavalue)):e||r.left==r.right||(o=a.GetAssuredCell(Re.crToCoord(r.left,r.top)),i=a.GetAssuredCell(Re.crToCoord(r.right,r.top)),t(o.datatype)&&t(i.datatype)&&(s=i.datavalue-o.datavalue))),n.Range2Remove(),s}for(a.renderneeded=!0,a.changedrendervalues=!0,t&&A.AddUndo("changedrendervalues"),r=e.NextToken(),n=e.RestOfString(),o(),ge="fillright"==i?(m=d.row,g=d.col+1,ke(!(H=!0))):(m=d.row+1,g=d.col,ke(!(H=!1))),k=m;k<=h.row;k++)for(S=g;S<=h.col;S++)if(p=Re.crToCoord(S,k),!(f=a.GetAssuredCell(p)).readonly){if(t&&A.AddUndo("set "+p+" all",a.CellToString(f)),v=H?(M=Re.crToCoord(d.col,k),b=S-g+1,0):(M=Re.crToCoord(S,d.row),b=0,k-m+1),R=a.GetAssuredCell(M),"all"==n||"formats"==n)for(s in I)1!=I[s]&&(R[s],3==I[s]?delete f[s]:f[s]=R[s]);"all"!=n&&"formulas"!=n||(f.datavalue=void 0!==ge?R.datavalue+(H?b:v)*ge:R.datavalue,f.datatype=R.datatype,f.valuetype=R.valuetype,"f"==f.datatype?f.formula=Re.OffsetFormulaCoords(R.formula,b,v):f.formula=R.formula,delete f.parseinfo,f.errors=R.errors),delete f.displaystring}P.needsrecalc="yes";break;case"copy":r=e.NextToken(),n=e.RestOfString(),t&&A.AddUndo("loadclipboard",Re.encodeForSave(Re.Clipboard.clipboard)),Re.Clipboard.clipboard=Re.CreateSheetSave(a,r);break;case"loadclipboard":n=e.RestOfString(),t&&A.AddUndo("loadclipboard",Re.encodeForSave(Re.Clipboard.clipboard)),Re.Clipboard.clipboard=Re.decodeFromSave(n);break;case"clearclipboard":t&&A.AddUndo("loadclipboard",Re.encodeForSave(Re.Clipboard.clipboard)),Re.Clipboard.clipboard="";break;case"paste":if(a.renderneeded=!0,a.changedrendervalues=!0,t&&A.AddUndo("changedrendervalues"),r=e.NextToken(),n=e.RestOfString(),o(),!Re.Clipboard.clipboard)break;for((B=new Re.Sheet).ParseSheetSave(Re.Clipboard.clipboard),y=Re.ParseRange(B.copiedfrom),U=Math.max(h.col-d.col+1,y.cr2.col-y.cr1.col+1),j=Math.max(h.row-d.row+1,y.cr2.row-y.cr1.row+1),d.col+U-1>P.lastcol&&(P.lastcol=d.col+U-1),d.row+j-1>P.lastrow&&(P.lastrow=d.row+j-1),k=d.row;k<d.row+j;k++)for(S=d.col;S<d.col+U;S++)if(p=Re.crToCoord(S,k),!(f=a.GetAssuredCell(p)).readonly){t&&A.AddUndo("set "+p+" all",a.CellToString(f));var Te=y.cr1.col+(S-d.col)%(y.cr2.col-y.cr1.col+1),Fe=y.cr1.row+(k-d.row)%(y.cr2.row-y.cr1.row+1),M=Re.crToCoord(Te,Fe),R=B.GetAssuredCell(M);if("all"==n||"formats"==n)for(s in k==d.row&&(sourceColname=Re.rcColname(y.cr1.col+(S-d.col)%(y.cr2.col-y.cr1.col+1)),colWidth=B.colattribs.width[sourceColname],colHide=B.colattribs.hide[sourceColname],null!=colWidth&&(a.colattribs.width[Re.rcColname(S)]=colWidth),null!=colHide&&(a.colattribs.hide[Re.rcColname(S)]=colHide)),S==d.col&&(sourceRow=y.cr1.row+(k-d.row)%(y.cr2.row-y.cr1.row+1),null!=(rowHide=B.rowattribs.hide[sourceRow])&&(a.rowattribs.hide[k]=rowHide)),I)1!=I[s]&&(R[s],3==I[s]?delete f[s]:(V=Re.CellPropertiesTable[s])&&R[s]?f[s]=a.GetStyleNum(V,B.GetStyleString(V,R[s])):f[s]=R[s]);"all"!=n&&"formulas"!=n||(f.datavalue=R.datavalue,f.datatype=R.datatype,f.valuetype=R.valuetype,"f"==f.datatype?f.formula=Re.OffsetFormulaCoords(R.formula,S-Te,k-Fe):f.formula=R.formula,delete f.parseinfo,f.errors=R.errors,R.comment?f.comment=R.comment:f.comment&&delete f.comment),delete f.displaystring}P.needsrecalc="yes";break;case"sort":for(a.renderneeded=!0,a.changedrendervalues=!0,t&&A.AddUndo("changedrendervalues"),r=e.NextToken(),o(),ne=[],re=[],w=se=0;w<=3;w++)ne[w]=e.NextToken(),re[w]=e.NextToken(),ne[w]&&(se=w);for(le={},ae=[],ce=[],ue=[],k=d.row;k<=h.row;k++){for(S=d.col;S<=h.col;S++)p=Re.crToCoord(S,k),(f=a.cells[p])?(le[p]=a.CellToString(f),t&&A.AddUndo("set "+p+" all",le[p])):t&&A.AddUndo("set "+p+" all");for(ae.push(ae.length),ce.push([]),ue.push([]),slast=ue.length-1,w=0;w<=se;w++)p=ne[w]+k,u=(f=a.GetAssuredCell(p)).datavalue,"t"==(de=f.valuetype.charAt(0)||"b")&&(u=u.toLowerCase()),ce[slast].push(u),ue[slast].push(de)}for(ae.sort(function(e,t){for(var o,i,n,r,s=0;s<=se;s++)if(i="up"==re[s]?(o=e,t):(o=t,e),n=ue[o][s],tb=ue[i][s],"t"==n?"t"==tb?(o=ce[o][s],r=(i=ce[i][s])<o?1:o<i?-1:0):"n"==tb?r=1:"b"==tb?r="up"==re[s]?-1:1:"e"==tb&&(r=-1):"n"==n?"t"==tb?r=-1:"n"==tb?(o=+ce[o][s],r=(i=+ce[i][s])<o?1:o<i?-1:0):"b"==tb?r="up"==re[s]?-1:1:"e"==tb&&(r=-1):"e"==n?r="e"==tb?(o=ce[o][s],(i=ce[i][s])<o?1:o<i?-1:0):"b"==tb&&"up"==re[s]?-1:1:"b"==n&&(r="b"==tb?0:"up"==re[s]?1:-1),r)return r;return r=t<e?1:e<t?-1:0}),k=d.row;k<=h.row;k++)for(he=ae[k-d.row],S=d.col;S<=h.col;S++)p=Re.crToCoord(S,k),le[pe=Re.crToCoord(S,he+d.row)]?(f=new Re.Cell(p),a.CellFromStringParts(f,le[pe].split(":"),1),"f"==f.datatype&&(f.formula=Re.OffsetFormulaCoords(f.formula,0,k-d.row-he)),a.cells[p]=f):delete a.cells[p];P.needsrecalc="yes";break;case"insertcol":case"insertrow":for(a.renderneeded=!0,a.changedrendervalues=!0,a.widgetsClean=!1,r=e.NextToken(),n=e.RestOfString(),o(),"insertcol"==i?(W=d.col,v=0,$=d.col,K=d.col,Y=G=b=1,q=P.lastrow,t&&A.AddUndo("deletecol "+d.coord)):(b=0,G=d.row,$=v=W=1,K=P.lastcol,Y=d.row,q=d.row,t&&A.AddUndo("deleterow "+d.coord)),k=P.lastrow;G<=k;k--)for(S=P.lastcol;W<=S;S--)M=Re.crToCoord(S,k),p=Re.crToCoord(S+b,k+v),a.cells[M]?a.cells[p]=a.cells[M]:delete a.cells[p];for(k=Y;k<=q;k++)for(S=$;S<=K;S++)for(s in p=Re.crToCoord(S,k),f=new Re.Cell(p),a.cells[p]=f,M=Re.crToCoord(S-b,k-v),R=a.GetAssuredCell(M),I)2==I[s]&&(f[s]=R[s]);for(p in a.cells)(f=a.cells[p])&&"f"==f.datatype&&(f.formula=Re.AdjustFormulaCoords(f.formula,d.col,b,d.row,v)),f&&delete f.parseinfo;for(x in a.names)a.names[x]&&(fe="","="==(_=a.names[x].definition).charAt(0)&&(fe="=",_=_.substring(1)),a.names[x].definition=fe+Re.AdjustFormulaCoords(_,d.col,b,d.row,v));for(k=P.lastrow;G<=k&&"insertrow"==i;k--)for(s in X=k+v,a.rowattribs)u=a.rowattribs[s][k],a.rowattribs[s][X]!=u&&(u?a.rowattribs[s][X]=u:delete a.rowattribs[s][X]);for(S=P.lastcol;W<=S&&"insertcol"==i;S--)for(s in Z=Re.rcColname(S),J=Re.rcColname(S+b),a.colattribs)u=a.colattribs[s][Z],a.colattribs[s][J]!=u&&(u?a.colattribs[s][J]=u:delete a.colattribs[s][J]);(Pe=new Re.RenderContext(a)).CalculateCellSkipData();var Ee={};for(Ae in Pe.cellskip){var De=Re.coordToCr(Ae),N=Pe.cellskip[Ae];"insertcol"===i&&De.col===$&&(Ee[N]||(a.GetAssuredCell(N).colspan+=b),Ee[N]=!0),"insertrow"===i&&De.row===Y&&(Ee[N]||(a.GetAssuredCell(N).rowspan+=v),Ee[N]=!0)}P.lastcol+=b,P.lastrow+=v,P.needsrecalc="yes";break;case"deletecol":case"deleterow":for(a.renderneeded=!0,a.changedrendervalues=!0,a.widgetsClean=!1,r=e.NextToken(),n=e.RestOfString(),ee=P.lastcol,Q=P.lastrow,o(),k=m="deletecol"==i?(b=d.col-h.col-1,v=0,g=h.col+1,1):(b=0,v=d.row-h.row-1,h.row+(g=1));k<=Q-v;k++)for(S=g;S<=ee-b;S++)if(p=Re.crToCoord(S+b,k+v),(f=a.cells[p])&&f.readonly)return _e="Unable to remove "+("deletecol"==i?"column":"row")+", because cell "+f.coord+" is locked";for(k=m;k<=Q-v;k++)for(S=g;S<=ee-b;S++)p=Re.crToCoord(S+b,k+v),t&&(k<m-v||S<g-b)&&((f=a.cells[p])?A.AddUndo("set "+p+" all",a.CellToString(f)):A.AddUndo("erase "+p+" all")),M=Re.crToCoord(S,k),(f=a.cells[M])?a.cells[p]=f:delete a.cells[p];for(p in a.cells)(f=a.cells[p])&&("f"==f.datatype?(C=f.formula,f.formula=Re.AdjustFormulaCoords(C,d.col,b,d.row,v),f.formula!=C&&(delete f.parseinfo,t&&-1!=f.formula.indexOf("#REF!")&&(ie=Re.coordToCr(p),A.AddUndo("set "+Re.rcColname(ie.col-b)+(ie.row-v)+" formula "+C)))):delete f.parseinfo);for(x in a.names)a.names[x]&&(fe="","="==(_=a.names[x].definition).charAt(0)&&(fe="=",_=_.substring(1)),a.names[x].definition=fe+Re.AdjustFormulaCoords(_,d.col,b,d.row,v));for(k=m;k<=Q-v&&"deleterow"==i;k++)for(s in te=k+v,a.rowattribs)u=a.rowattribs[s][k],a.rowattribs[s][te]!=u&&(t&&A.AddUndo("set "+te+" "+s,a.rowattribs[s][te]),u?a.rowattribs[s][te]=u:delete a.rowattribs[s][te]);for(S=g;S<=ee-b&&"deletecol"==i;S++)for(s in Z=Re.rcColname(S),oe=Re.rcColname(S+b),a.colattribs)u=a.colattribs[s][Z],a.colattribs[s][oe]!=u&&(t&&A.AddUndo("set "+oe+" "+s,a.colattribs[s][oe]),u?a.colattribs[s][oe]=u:delete a.colattribs[s][oe]);(Pe=new Re.RenderContext(a)).CalculateCellSkipData();var Pe,Ae,Ie={};for(Ae in Pe.cellskip){var De=Re.coordToCr(Ae),N=Pe.cellskip[Ae],Me=Pe.coordToCR[N];"deletecol"===i&&De.col===g+b&&Me.col<De.col&&(Ie[N]||(a.GetAssuredCell(N).colspan+=b),Ie[N]=!0),"deleterow"===i&&De.row===m+v&&Me.row<De.row&&(Ie[N]||(a.GetAssuredCell(N).rowspan+=v),Ie[N]=!0)}if(t)if("deletecol"==i)for(S=d.col;S<=h.col;S++)A.AddUndo("insertcol "+Re.rcColname(d.col));else for(k=d.row;k<=h.row;k++)A.AddUndo("insertrow "+d.row);"deletecol"==i?d.col<=ee&&(h.col<=ee?P.lastcol+=b:P.lastcol=d.col-1):d.row<=Q&&(h.row<=Q?P.lastrow+=v:P.lastrow=d.row-1),P.needsrecalc="yes";break;case"movepaste":case"moveinsert":for(a.renderneeded=!0,a.changedrendervalues=!0,t&&A.AddUndo("changedrendervalues"),r=e.NextToken(),F=e.NextToken(),""==(n=e.RestOfString())&&(n="all"),o(),b=(E=Re.coordToCr(F)).col-d.col,v=E.row-d.row,U=h.col-d.col+1,j=h.row-d.row+1,ve={},k=d.row;k<=h.row;k++)for(S=d.col;S<=h.col;S++)if(p=Re.crToCoord(S,k),!(f=a.GetAssuredCell(p)).readonly&&(t&&A.AddUndo("set "+p+" all",a.CellToString(f)),a.cells[p])){for(s in ve[p]=new Re.Cell(p),I)f[s],ve[p][s]=f[s],"all"==n&&delete f[s],"formulas"!=n||1!=I[s]&&3!=I[s]||delete f[s],"formats"==n&&2==I[s]&&delete f[s];"formulas"==n&&(f.datavalue="",f.datatype=null,f.formula="",f.valuetype="b"),"all"==n&&delete a.cells[p]}if("moveinsert"==i&&(ye=be=!1,0==v&&(E.col<d.col||E.col>h.col)?be=E.col<d.col?(D=d.col-E.col,-1):(--E.col,b=E.col-h.col,D=E.col-h.col,1):0==b&&(E.row<d.row||E.row>h.row)?ye=E.row<d.row?(D=d.row-E.row,-1):(--E.row,v=E.row-h.row,D=E.row-h.row,1):i="movepaste"),Ce={},ye)for(k=0;k<D;k++)for(S=d.col;S<=h.col;S++){if(p=ye<0?(M=Re.crToCoord(S,E.row+D-k-1),Re.crToCoord(S,h.row-k)):(M=Re.crToCoord(S,E.row-D+k+1),Re.crToCoord(S,d.row+k)),R=a.GetAssuredCell(M),t&&A.AddUndo("set "+M+" all",a.CellToString(R)),f=a.GetAssuredCell(p),"all"==n||"formats"==n)for(s in I)1!=I[s]&&(R[s],3==I[s]?delete f[s]:f[s]=R[s]);"all"!=n&&"formulas"!=n||(f.datavalue=R.datavalue,f.datatype=R.datatype,f.valuetype=R.valuetype,f.formula=R.formula,delete f.parseinfo,f.errors=R.errors),delete f.displaystring,Ce[M]=p}if(be)for(S=0;S<D;S++)for(k=d.row;k<=h.row;k++){if(p=be<0?(M=Re.crToCoord(E.col+D-S-1,k),Re.crToCoord(h.col-S,k)):(M=Re.crToCoord(E.col-D+S+1,k),Re.crToCoord(d.col+S,k)),R=a.GetAssuredCell(M),t&&A.AddUndo("set "+M+" all",a.CellToString(R)),f=a.GetAssuredCell(p),"all"==n||"formats"==n)for(s in I)1!=I[s]&&(R[s],3==I[s]?delete f[s]:f[s]=R[s]);"all"!=n&&"formulas"!=n||(f.datavalue=R.datavalue,f.datatype=R.datatype,f.valuetype=R.valuetype,f.formula=R.formula,delete f.parseinfo,f.errors=R.errors),delete f.displaystring,Ce[M]=p}for(E.col+U-1>P.lastcol&&(P.lastcol=E.col+U-1),E.row+j-1>P.lastrow&&(P.lastrow=E.row+j-1),k=d.row;k<d.row+j;k++)for(S=d.col;S<d.col+U;S++)if(p=Re.crToCoord(S+b,k+v),!(f=a.GetAssuredCell(p)).readonly)if(t&&A.AddUndo("set "+p+" all",a.CellToString(f)),Ce[M=Re.crToCoord(S,k)]=p,"all"!=n||ve[M]){if(R=(R=ve[M])||a.GetAssuredCell(M),"all"==n||"formats"==n)for(s in I)1!=I[s]&&(R[s],3==I[s]?delete f[s]:f[s]=R[s]);"all"!=n&&"formulas"!=n||(f.datavalue=R.datavalue,f.datatype=R.datatype,f.valuetype=R.valuetype,f.formula=R.formula,delete f.parseinfo,f.errors=R.errors,R.comment?f.comment=R.comment:f.comment&&delete f.comment),delete f.displaystring}else delete a.cells[p];for(p in a.cells)(f=a.cells[p])&&("f"==f.datatype?(C=f.formula,f.formula=Re.ReplaceFormulaCoords(C,Ce),f.formula!=C&&(delete f.parseinfo,t&&!Ce[p]&&A.AddUndo("set "+p+" formula "+C))):delete f.parseinfo);for(x in a.names)a.names[x]&&(fe="","="==(C=_=a.names[x].definition).charAt(0)&&(fe="=",_=_.substring(1)),a.names[x].definition=fe+Re.ReplaceFormulaCoords(_,Ce),t&&a.names[x].definition!=C&&A.AddUndo("name define "+x+" "+C));P.needsrecalc="yes";break;case"name":if(r=e.NextToken(),x=e.NextToken(),n=e.RestOfString(),""==(x=x.toUpperCase().replace(/[^A-Z0-9_\.]/g,"")))break;if("define"==r){if(""==n)break;a.names[x]?(t&&A.AddUndo("name define "+x+" "+a.names[x].definition),a.names[x].definition=n):(t&&A.AddUndo("name delete "+x),a.names[x]={definition:n,desc:""})}else"desc"==r?a.names[x]&&(t&&A.AddUndo("name desc "+x+" "+a.names[x].desc),a.names[x].desc=n):"delete"==r&&(t&&(a.names[x].desc&&A.AddUndo("name desc "+x+" "+a.names[x].desc),A.AddUndo("name define "+x+" "+a.names[x].definition)),delete a.names[x]);P.needsrecalc="yes";break;case"recalc":P.needsrecalc="yes",a.recalconce=!0;break;case"redisplay":a.renderneeded=!0;break;case"changedrendervalues":a.changedrendervalues=!0;break;case"pane":if(x=e.NextToken().toUpperCase(),F=1,T=Re.GetSpreadsheetControlObject().editor,"ROW"===x.toUpperCase()){for(k=parseInt(e.NextToken(),10),void 0!==T.context.rowpanes[1]&&"number"==typeof T.context.rowpanes[1].first&&(F=T.context.rowpanes[1].first),t&&A.AddUndo("pane row "+F);"yes"==T.context.sheetobj.rowattribs.hide[k];)k++;(!k||k<=T.context.rowpanes[0].first)&&1<T.context.rowpanes.length?T.context.rowpanes.length=1:(T.context.rowpanes.length-1&&T.timeout,T.context.SetRowPaneFirstLast(0,T.context.rowpanes[0].first,k-1),T.context.SetRowPaneFirstLast(1,k,k)),T.griddiv&&(me=document.getElementById("trackingline-vertical"))&&(T.griddiv.removeChild(me),T.FitToEditTable())}else{for(S=parseInt(e.NextToken(),10),void 0!==T.context.colpanes[1]&&"number"==typeof T.context.colpanes[1].first&&(F=T.context.colpanes[1].first),t&&A.AddUndo("pane col "+F);"yes"==T.context.sheetobj.colattribs.hide[Re.rcColname(S)];)S++;(!S||S<=T.context.colpanes[0].first)&&1<T.context.colpanes.length?T.context.colpanes.length=1:(T.context.colpanes.length-1&&T.timeout,T.context.SetColPaneFirstLast(0,T.context.colpanes[0].first,S-1),T.context.SetColPaneFirstLast(1,S,S)),T.griddiv&&(me=document.getElementById("trackingline-horizon"))&&(T.griddiv.removeChild(me),T.FitToEditTable())}a.renderneeded=!0;break;case"startcmdextension":x=e.NextToken(),(F=a.sci.CmdExtensionCallbacks[x])&&F.func(x,F.data,a,e,t);break;case"settimetrigger":case"sendemail":case"submitform":break;default:_e=we.s_escUnknownCmd+Se}return Re._app&&(xe?(1==a.renderneeded&&"value"!=s&&"text"!=s&&"formula"!=s&&"constant"!=s&&"empty"!=s||"all"==s)&&(a.widgetsClean=!1):1==a.renderneeded&&(a.widgetsClean=!1)),_e},Re.SheetUndo=function(e){for(var t=e.changes.TOS(),o="",i=t?t.undo.length-1:-1;0<=i;i--)o&&(o+="\n"),o+=t.undo[i];e.changes.Undo(),e.ScheduleSheetCommands(o,!1)},Re.SheetRedo=function(e){if(e.changes.Redo()){for(var t=e.changes.TOS(),o="",i=0;t&&i<t.command.length;i++)o&&(o+="\n"),o+=t.command[i];e.ScheduleSheetCommands(o,!1)}else e.ScheduleSheetCommands("",!1)},Re.CreateAuditString=function(e){for(var t,o="",i=e.changes.stack,n=e.changes.tos,r=0;r<=n;r++)for(t=0;t<i[r].command.length;t++)o+=i[r].command[t]+"\n";return o},Re.GetStyleNum=function(e,t,o){var i;return 0==o.length?0:((i=e[t+"hash"][o])||(e[t+"s"].length<1&&e[t+"s"].push(""),i=e[t+"s"].push(o)-1,e[t+"hash"][o]=i,e.changedrendervalues=!0),i)},Re.GetStyleString=function(e,t,o){return o?e[t+"s"][o]:null},Re.OffsetFormulaCoords=function(e,t,o){var i,n,r,s,a="",l=Re.Formula;if(!l)return"Need SocialCalc.Formula";for(var c=l.TokenType,u=c.op,d=c.string,h=c.coord,p=l.TokenOpExpansion,f=l.ParseFormulaIntoTokens(e),m=0;m<f.length;m++)n=f[m].type,i=f[m].text,n==h?(s="",r=Re.coordToCr(i),"$"!=i.charAt(0)?r.col+=t:s+="$",s+=Re.rcColname(r.col),-1==i.indexOf("$",1)?r.row+=o:s+="$",s+=r.row,a+=s=r.row<1||r.col<1?"#REF!":s):n==d?0<=i.indexOf('"')?a+='"'+i.replace(/"/,'""')+'"':a+='"'+i+'"':a+=n==u&&p[i]||i;return a},Re.AdjustFormulaCoords=function(e,t,o,i,n){var r,s,a,l,c="",u=!1,d=Re.Formula;if(!d)return"Need SocialCalc.Formula";var h=d.TokenType,p=h.op,f=h.string,m=h.coord,g=d.TokenOpExpansion;for(parseinfo=Re.Formula.ParseFormulaIntoTokens(e),a=0;a<parseinfo.length;a++)r=parseinfo[a].type,s=parseinfo[a].text,r==p&&("!"==s?u=!0:":"!=s&&(u=!1),s=g[s]||s),r==m?(cr=Re.coordToCr(s),(o<0&&cr.col>=t&&cr.col<t-o||n<0&&cr.row>=i&&cr.row<i-n)&&!u&&(cr.col=0,cr.row=0),u||(cr.col>=t&&(cr.col+=o),cr.row>=i&&(cr.row+=n)),l="$"==s.charAt(0)?"$"+Re.rcColname(cr.col):Re.rcColname(cr.col),-1!=s.indexOf("$",1)?l+="$"+cr.row:l+=cr.row,s=l=cr.row<1||cr.col<1?"#REF!":l):r==f&&(s=0<=s.indexOf('"')?'"'+s.replace(/"/,'""')+'"':'"'+s+'"'),c+=s;return c},Re.ReplaceFormulaCoords=function(e,t){var o,i,n,r,s="",a=!1,l=Re.Formula;if(!l)return"Need SocialCalc.Formula";var c=l.TokenType,u=c.op,d=c.string,h=c.coord,p=l.TokenOpExpansion;for(parseinfo=Re.Formula.ParseFormulaIntoTokens(e),n=0;n<parseinfo.length;n++)o=parseinfo[n].type,i=parseinfo[n].text,o==u&&("!"==i?a=!0:":"!=i&&(a=!1),i=p[i]||i),o==h?(cr=Re.coordToCr(i),t[r=Re.crToCoord(cr.col,cr.row)]&&!a&&(cr=Re.coordToCr(t[r]),r="$"==i.charAt(0)?"$"+Re.rcColname(cr.col):Re.rcColname(cr.col),-1!=i.indexOf("$",1)?r+="$"+cr.row:r+=cr.row,i=r)):o==d&&(i=0<=i.indexOf('"')?'"'+i.replace(/"/,'""')+'"':'"'+i+'"'),s+=i;return s},Re.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(e){return!1}},Re.RecalcData=function(){this.inrecalc=!0,this.celllist=[],this.celllistitem=0,this.calclist=null,this.calclistlength=0,this.firstcalc=null,this.lastcalc=null,this.nextcalc=null,this.count=0,this.checkinfo={}},Re.RecalcCheckInfo=function(){this.oldcoord=null,this.parsepos=0,this.inrange=!1,this.inrangestart=!1,this.cr1=null,this.cr2=null,this.c1=null,this.c2=null,this.r1=null,this.r2=null,this.c=null,this.r=null},Re.RecalcSheet=function(e){var t=Re.RecalcInfo;t.currentState!=t.state.idle?t.queue.push(e):(delete e.attribs.circularreferencecell,Re.Formula.FreshnessInfoReset(),Re.RecalcClearTimeout(),t.sheet=e,t.currentState=t.state.start_calc,t.starttime=new Date,e.statuscallback&&e.statuscallback(t,"calcstart",null,e.statuscallbackparams),Re.RecalcSetTimeout())},Re.RecalcSetTimeout=function(){var e=Re.RecalcInfo;e.recalctimer=M.setTimeout(Re.RecalcTimerRoutine,e.timeslicedelay)},Re.RecalcClearTimeout=function(){var e=Re.RecalcInfo;e.recalctimer&&(M.clearTimeout(e.recalctimer),e.recalctimer=null)},Re.RecalcLoadedSheet=function(e,t,o,i){var n=Re.RecalcInfo,r=Re.Formula,e=Re.Formula.AddSheetToCache(e||r.SheetCache.waitingForLoading,t,i);o&&e&&"off"!=e.attribs.recalc&&(e.previousrecalcsheet=n.sheet,n.sheet=e,n.currentState=n.state.start_calc),r.SheetCache.waitingForLoading=null,Re.RecalcSetTimeout()},Re.RecalcTimerRoutine=function(){var e,t,o=new Date,i=0,n=Re.Formula;if(!n)return"Need SocialCalc.Formula";var r=Re.RecalcInfo,s=r.sheet;if(s){function a(e,t){s.statuscallback&&s.statuscallback(c,e,t,s.statuscallbackparams)}var l,c=s.recalcdata||(s.recalcdata={});if(Re.RecalcClearTimeout(),r.currentState==r.state.start_calc){for(t in c=new Re.RecalcData,s.recalcdata=c,s.cells)t&&c.celllist.push(t);c.calclist={},r.currentState=r.state.order}if(r.currentState==r.state.order){for(;c.celllistitem<c.celllist.length;)if(t=c.celllist[c.celllistitem++],Re.RecalcCheckCell(s,t),new Date-o>=r.maxtimeslice)return a("calcorder",{coord:t,total:c.celllist.length,count:c.celllistitem}),void Re.RecalcSetTimeout();return a("calccheckdone",c.calclistlength),c.nextcalc=c.firstcalc,r.currentState=r.state.calc,void Re.RecalcSetTimeout()}if(r.currentState==r.state.start_wait)return r.currentState=r.state.done_wait,r.LoadSheet&&r.LoadSheet(n.SheetCache.waitingForLoading)?void 0:void Re.RecalcLoadedSheet(null,"",!1);if(r.currentState==r.state.done_wait)return r.currentState=r.state.calc,void Re.RecalcSetTimeout();for(r.currentState!=r.state.calc&&alert("Recalc state error: "+r.currentState+". Error in SocialCalc code."),t=s.recalcdata.nextcalc;t;){if((l=s.cells[t]).parseinfo||(l.parseinfo=n.ParseFormulaIntoTokens(l.formula)),l.parseinfo.coord=t,e=n.evaluate_parsed_formula(l.parseinfo,s,!1),n.SheetCache.waitingForLoading)return 1!=r.firstRenderScheduled&&(Re.GetSpreadsheetControlObject().editor.ScheduleRender(!1),r.firstRenderScheduled=!0),c.nextcalc=t,c.count+=i,a("calcloading",{sheetname:n.SheetCache.waitingForLoading}),r.currentState=r.state.start_wait,void Re.RecalcSetTimeout();if(n.RemoteFunctionInfo.waitingForServer)return c.nextcalc=t,c.count+=i,a("calcserverfunc",{funcname:n.RemoteFunctionInfo.waitingForServer,coord:t,total:c.calclistlength,count:c.count}),void(r.currentState=r.state.done_wait);if(l.datavalue==e.value&&l.valuetype==e.type||(l.datavalue=e.value,l.valuetype=e.type,delete l.displaystring,s.recalcchangedavalue=!0),e.error&&(l.errors=e.error),i++,t=s.recalcdata.calclist[t],new Date-o>=r.maxtimeslice)return c.nextcalc=t,c.count+=i,a("calcstep",{coord:t,total:c.calclistlength,count:c.count}),void Re.RecalcSetTimeout()}if(c.inrecalc=!1,s.reRenderCellList=s.recalcdata.celllist,delete s.recalcdata,delete s.attribs.needsrecalc,r.sheet=s.previousrecalcsheet||null,r.sheet)return r.currentState=r.state.calc,void Re.RecalcSetTimeout();n.FreshnessInfo.recalc_completed=!0,r.currentState=r.state.idle,a("calcfinished",new Date-r.starttime),0<r.queue.length&&(s=r.queue.shift()).RecalcSheet()}},Re.RecalcCheckCell=function(e,t){var o,i,n,r,s,a,l,c,u,d=Re.Formula;if(!d)return"Need SocialCalc.Formula";var h=d.TokenType,p=h.op,f=h.name,m=h.coord,g=e.recalcdata,v=g.checkinfo,b=!1,y=null,C=t;e:for(;C;)if(c=e.cells[C],u=v[C],!c||"f"!=c.datatype||u&&"object"!=typeof u)v[C=y]&&(y=v[C].oldcoord);else{for(u||(u=new Re.RecalcCheckInfo,v[C]=u),c.errors&&delete c.errors,c.parseinfo||(c.parseinfo=d.ParseFormulaIntoTokens(c.formula)),o=c.parseinfo,n=u.parsepos;n<o.length;n++){if(u.inrange){if(u.inrangestart&&(u.cr1.col>u.cr2.col?(u.c1=u.cr2.col,u.c2=u.cr1.col):(u.c1=u.cr1.col,u.c2=u.cr2.col),u.c=u.c1-1,u.cr1.row>u.cr2.row?(u.r1=u.cr2.row,u.r2=u.cr1.row):(u.r1=u.cr1.row,u.r2=u.cr2.row),u.r=u.r1,u.inrangestart=!1),u.c+=1,u.c>u.c2){if(u.r+=1,u.r>u.r2){u.inrange=!1;continue}u.c=u.c1}if(r=Re.crToCoord(u.c,u.r),u.parsepos=n,u.oldcoord=y,y=C,v[C=r]&&"object"==typeof v[C])return c.errors=Re.Constants.s_caccCircRef+t,v[t]=!0,g.firstcalc?g.calclist[g.lastcalc]=t:g.firstcalc=t,g.lastcalc=t,g.calclistlength++,e.attribs.circularreferencecell=C+"|"+y,c.errors;continue e}if(r=o[n].type,i=o[n].text,r==p&&("!"==i?b=!0:":"!=i&&(b=!1)),r==f)if("range"==(s=d.LookupName(e,i)).type){if(-1!=(a=s.value.indexOf("|"))){u.cr1=Re.coordToCr(s.value.substring(0,a)),l=s.value.indexOf("|",a+1),u.cr2=Re.coordToCr(s.value.substring(a+1,l)),u.inrange=!0,u.inrangestart=!0,n-=1;continue}}else"coord"==s.type&&(r=m,i=s.value);if(r==m)if(2<=n&&o[n-1].type==p&&":"==o[n-1].text&&o[n-2].type==m&&!b)u.cr1=Re.coordToCr(o[n-2].text),u.cr2=Re.coordToCr(i),u.inrange=!0,u.inrangestart=!0,n-=1;else if(!b){if(-1!=i.indexOf("$")&&(i=i.replace(/\$/g,"")),u.parsepos=n+1,u.oldcoord=y,y=C,v[C=i]&&"object"==typeof v[C])return c.errors=Re.Constants.s_caccCircRef+t,v[t]=!0,g.firstcalc?g.calclist[g.lastcalc]=t:g.firstcalc=t,g.lastcalc=t,g.calclistlength++,e.attribs.circularreferencecell=C+"|"+y,c.errors;continue e}}v[C]=!(b=!1),g.firstcalc?g.calclist[g.lastcalc]=C:g.firstcalc=C,g.lastcalc=C,g.calclistlength++,y=v[C=y]?v[C].oldcoord:null}return""},Re.Parse=function(e){this.str=e,this.pos=0,this.delimiter=" ",this.lineEnd=e.indexOf("\n"),this.lineEnd<0&&(this.lineEnd=e.length)},Re.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var e=this.str.indexOf(this.delimiter,this.pos),t=this.pos;return 0<=(e=e>this.lineEnd?this.lineEnd:e)?(this.pos=e+1,this.str.substring(t,e)):(this.pos=this.lineEnd,this.str.substring(t,this.lineEnd))},Re.Parse.prototype.RestOfString=function(){var e=this.pos;return this.pos<0||this.pos>=this.lineEnd?"":(this.pos=this.lineEnd,this.str.substring(e,this.lineEnd))},Re.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)},Re.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1,this.lineEnd=this.str.indexOf("\n",this.pos),this.lineEnd<0&&(this.lineEnd=this.str.length)},Re.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length},Re.UndoStack=function(){this.stack=[],this.tos=-1,this.maxRedo=0,this.maxUndo=50},Re.UndoStack.prototype.PushChange=function(e){for(;0<this.stack.length&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:e,undo:[]}),this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift(),this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]),this.tos=this.stack.length-1},Re.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].command.push(o)}},Re.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].undo.push(o)}},Re.UndoStack.prototype.TOS=function(){return 0<=this.tos?this.stack[this.tos]:null},Re.UndoStack.prototype.Undo=function(){return 0<=this.tos&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)&&(--this.tos,!0)},Re.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1&&(this.tos+=1,!0)},Re.Clipboard={clipboard:""},Re.RenderContext=function(e){var t=e.attribs,o=Re.Constants;if(this.sheetobj=e,this.hideRowsCols=!1,this.showGrid=!1,this.showRCHeaders=!1,this.rownamewidth=o.defaultRowNameWidth,this.pixelsPerRow=o.defaultAssumedRowHeight,this.cellskip={},this.coordToCR={},this.colwidth=[],this.rowheight=[],this.totalwidth=0,this.totalheight=0,this.rowpanes=[],this.colpanes=[],this.colunhideleft=[],this.colunhideright=[],this.rowunhidetop=[],this.rowunhidebottom=[],this.maxcol=0,this.maxrow=0,this.highlights={},this.cursorsuffix="",this.highlightTypes={cursor:{style:o.defaultHighlightTypeCursorStyle,className:o.defaultHighlightTypeCursorClass},range:{style:o.defaultHighlightTypeRangeStyle,className:o.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+o.defaultImagePrefix+"cursorinsertup.gif);",className:o.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+o.defaultImagePrefix+"cursorinsertleft.gif);",className:o.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+o.defaultImagePrefix+"range2.gif);",className:""}},this.cellIDprefix=o.defaultCellIDPrefix,this.defaultlinkstyle=null,this.defaultHTMLlinkstyle={type:"html"},this.defaultfontstyle=o.defaultCellFontStyle,this.defaultfontsize=o.defaultCellFontSize,this.defaultfontfamily=o.defaultCellFontFamily,this.defaultlayout=o.defaultCellLayout,this.defaultpanedividerwidth=o.defaultPaneDividerWidth,this.defaultpanedividerheight=o.defaultPaneDividerHeight,this.gridCSS=o.defaultGridCSS,this.commentClassName=o.defaultCommentClass,this.commentCSS=o.defaultCommentStyle,this.commentNoGridClassName=o.defaultCommentNoGridClass,this.commentNoGridCSS=o.defaultCommentNoGridStyle,this.readonlyClassName=o.defaultReadonlyClass,this.readonlyCSS=o.defaultReadonlyStyle,this.readonlyNoGridClassName=o.defaultReadonlyNoGridClass,this.readonlyNoGridCSS=o.defaultReadonlyNoGridStyle,this.readonlyComment=o.defaultReadonlyComment,this.classnames={colname:o.defaultColnameClass,rowname:o.defaultRownameClass,selectedcolname:o.defaultSelectedColnameClass,selectedrowname:o.defaultSelectedRownameClass,upperleft:o.defaultUpperLeftClass,skippedcell:o.defaultSkippedCellClass,panedivider:o.defaultPaneDividerClass,unhideleft:o.defaultUnhideLeftClass,unhideright:o.defaultUnhideRightClass,unhidetop:o.defaultUnhideTopClass,unhidebottom:o.defaultUnhideBottomClass,colresizebar:o.defaultColResizeBarClass,rowresizebar:o.defaultRowResizeBarClass},this.explicitStyles={colname:o.defaultColnameStyle,rowname:o.defaultRownameStyle,selectedcolname:o.defaultSelectedColnameStyle,selectedrowname:o.defaultSelectedRownameStyle,upperleft:o.defaultUpperLeftStyle,skippedcell:o.defaultSkippedCellStyle,panedivider:o.defaultPaneDividerStyle,unhideleft:o.defaultUnhideLeftStyle,unhideright:o.defaultUnhideRightStyle,unhidetop:o.defaultUnhideTopStyle,unhidebottom:o.defaultUnhideBottomStyle},this.cellskip=null,this.needcellskip=!0,this.fonts=[],this.layouts=[],this.needprecompute=!0,!t)throw o.s_rcMissingSheet;this.rowpanes[0]={first:1,last:t.lastrow},this.colpanes[0]={first:1,last:t.lastcol},this.usermaxcol=t.usermaxcol,this.usermaxrow=t.usermaxrow},Re.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){Re.PrecomputeSheetFontsAndLayouts(this)},Re.RenderContext.prototype.CalculateCellSkipData=function(){Re.CalculateCellSkipData(this)},Re.RenderContext.prototype.CalculateColWidthData=function(){Re.CalculateColWidthData(this)},Re.RenderContext.prototype.CalculateRowHeightData=function(){Re.CalculateRowHeightData(this)},Re.RenderContext.prototype.SetRowPaneFirstLast=function(e,t,o){this.rowpanes[e]={first:t,last:o}},Re.RenderContext.prototype.SetColPaneFirstLast=function(e,t,o){this.colpanes[e]={first:t,last:o}},Re.RenderContext.prototype.CoordInPane=function(e,t,o){return Re.CoordInPane(this,e,t,o)},Re.RenderContext.prototype.CellInPane=function(e,t,o,i){return Re.CellInPane(this,e,t,o,i)},Re.RenderContext.prototype.InitializeTable=function(e){Re.InitializeTable(this,e)},Re.RenderContext.prototype.RenderSheet=function(e,t){return Re.RenderSheet(this,e,t)},Re.RenderContext.prototype.RenderColGroup=function(){return Re.RenderColGroup(this)},Re.RenderContext.prototype.RenderColHeaders=function(){return Re.RenderColHeaders(this)},Re.RenderContext.prototype.RenderSizingRow=function(){return Re.RenderSizingRow(this)},Re.RenderContext.prototype.RenderRow=function(e,t,o){return Re.RenderRow(this,e,t,o)},Re.RenderContext.prototype.RenderSpacingRow=function(){return Re.RenderSpacingRow(this)},Re.RenderContext.prototype.RenderCell=function(e,t,o,i,n,r){return Re.RenderCell(this,e,t,o,i,n,r)},Re.PrecomputeSheetFontsAndLayouts=function(e){var t,o,i,n,r,s,a=e.sheetobj,l=a.attribs;for(l.defaultfont&&(t=a.fonts[l.defaultfont].replace(/^\*/,Re.Constants.defaultCellFontStyle).replace(/(.+)\*(.+)/,"$1"+Re.Constants.defaultCellFontSize+"$2").replace(/\*$/,Re.Constants.defaultCellFontFamily).match(/^(\S+? \S+?) (\S+?) (\S.*)$/),e.defaultfontstyle=t[1],e.defaultfontsize=t[2],e.defaultfontfamily=t[3]),r=1;r<a.fonts.length;r++)(t=a.fonts[r].replace(/^\*/,e.defaultfontstyle).replace(/(.+)\*(.+)/,"$1"+e.defaultfontsize+"$2").replace(/\*$/,e.defaultfontfamily).match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/))&&(e.fonts[r]={style:t[1],weight:t[2],size:t[3],family:t[4]});for(i=Re.Constants.defaultCellLayout.match(o=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),n=l.defaultlayout?a.layouts[l.defaultlayout].match(o):["","*","*","*","*","*"],r=1;r<a.layouts.length;r++)if(t=a.layouts[r].match(o)){for(s=1;s<=5;s++)"*"==t[s]&&(t[s]=("*"!=n[s]?n:i)[s]);e.layouts[r]="padding:"+t[1]+" "+t[2]+" "+t[3]+" "+t[4]+";vertical-align:"+t[5]+";"}e.needprecompute=!1},Re.CalculateCellSkipData=function(e){var t,o,i,n,r,s,a,l,c,u=e.sheetobj;u.rowattribs,u.colattribs;for(e.maxrow=0,e.maxcol=0,e.cellskip={},t=1;t<=u.attribs.lastrow;t++)for(o=1;o<=u.attribs.lastcol;o++)if(i=Re.crToCoord(o,t),void 0!==(n=u.cells[i])&&!e.cellskip[i]&&(r=n.colspan||1,s=n.rowspan||1,1<r||1<s))for(a=t;a<t+s;a++)for(l=o;l<o+r;l++)(c=Re.crToCoord(l,a))==i?e.coordToCR[i]={row:t,col:o}:e.cellskip[c]=i,a>e.maxrow&&(maxrow=a),l>e.maxcol&&(maxcol=l);e.needcellskip=!1},Re.CalculateColWidthData=function(e){var t,o,i=e.sheetobj,n=(i.colattribs,e.showRCHeaders?+e.rownamewidth:0);for(colpane=0;colpane<e.colpanes.length;colpane++)for(t=e.colpanes[colpane].first;t<=e.colpanes[colpane].last;t++)o=Re.rcColname(t),"yes"==i.colattribs.hide[o]?e.colwidth[t]=0:("blank"!=(o=i.colattribs.width[o]||i.attribs.defaultcolwidth||Re.Constants.defaultColWidth)&&"auto"!=o||(o=""),e.colwidth[t]=o+"",n+=o&&0<+o?+o:10);e.totalwidth=n},Re.CalculateRowHeightData=function(e){var t,o,i=e.sheetobj,n=e.showRCHeaders?e.pixelsPerRow:0;for(rowpane=0;rowpane<e.rowpanes.length;rowpane++)for(t=e.rowpanes[rowpane].first;t<=e.rowpanes[rowpane].last;t++)"yes"===i.rowattribs.hide[t]?e.rowheight[t]=0:("blank"!==(o=i.rowattribs.height[t]||i.attribs.defaultrowheight||Re.Constants.defaultAssumedRowHeight)&&"auto"!==o||(o=""),e.rowheight[t]=o+"",n+=o&&0<+o?+o:10);e.totalheight=n},Re.InitializeTable=function(e,t){t.style.borderCollapse="collapse",t.cellSpacing="0",t.cellPadding="0",t.style.width=e.totalwidth+"px"},Re.RenderSheet=function(e,t,o){var i,n,r,s,a;for(e.sheetobj.changedrendervalues&&(e.needcellskip=!0,e.needprecompute=!0,e.sheetobj.changedrendervalues=!1),e.needcellskip&&e.CalculateCellSkipData(),e.needprecompute&&e.PrecomputeSheetFontsAndLayouts(),e.CalculateColWidthData(),e.CalculateRowHeightData(),r=document.createElement("table"),e.InitializeTable(r),a=e.RenderColGroup(),r.appendChild(a),(s=document.createElement("tbody")).appendChild(e.RenderSizingRow()),e.showRCHeaders&&(i=e.RenderColHeaders())&&s.appendChild(i),n=0;n<e.rowpanes.length;n++){for(rownum=e.rowpanes[n].first;rownum<=e.rowpanes[n].last;rownum++)i=e.RenderRow(rownum,n,o),s.appendChild(i);n<e.rowpanes.length-1&&(i=e.RenderSpacingRow(),s.appendChild(i))}return r.appendChild(s),t&&(a=t.parentNode)&&a.replaceChild(r,t),r},Re.RenderRow=function(e,t,o,i){var n,r,s,a,l,c,u,d=e.sheetobj,h=document.createElement("tr");for(e.showRCHeaders&&(c=document.createElement("td"),e.classnames&&(c.className=e.classnames.rowname),e.explicitStyles&&(c.style.cssText=e.explicitStyles.rowname),c.width=e.rownamewidth,c.height=e.rowheight[t],c.style.verticalAlign="top",c.innerHTML=t+"",t<e.rowpanes[e.rowpanes.length-1].last&&"yes"==d.rowattribs.hide[t+1]&&((a=document.createElement("div")).style.position="relative",l=document.createElement("div"),e.classnames&&(l.className=e.classnames.unhidetop),e.explicitStyles&&(l.style.cssText=e.explicitStyles.unhidetop),u=0===(u=+e.rowheight[t]-Re.Constants.defaultAssumedRowHeight)?4:u,l.style.bottom="-"+u+"px",e.rowunhidetop[t]=l,a.appendChild(l),c.appendChild(a)),1<t&&"yes"==d.rowattribs.hide[t-1]&&(l=document.createElement("div"),e.classnames&&(l.className=e.classnames.unhidebottom),e.explicitStyles&&(l.style.cssText=e.explicitStyles.unhidebottom),e.rowunhidebottom[t]=l,c.appendChild(l)),(u=document.createElement("div")).className=e.classnames.rowresizebar,c.appendChild(u),h.appendChild(c)),r=0;r<e.colpanes.length;r++){for(n=e.colpanes[r].first;n<=e.colpanes[r].last;n++)(c=e.RenderCell(t,n,o,r,null,i))&&h.appendChild(c);r<e.colpanes.length-1&&((c=document.createElement("td")).width=e.defaultpanedividerwidth,e.classnames.panedivider&&(c.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(c.style.cssText=e.explicitStyles.panedivider),(s=document.createElement("div")).style.width=e.defaultpanedividerwidth+"px",s.style.overflow="hidden",c.appendChild(s),h.appendChild(c))}return"yes"==d.rowattribs.hide[t]&&(h.style.cssText+=";display:none"),h},Re.RenderSpacingRow=function(e){e.sheetobj;var t,o,i,n,r=document.createElement("tr");for(e.showRCHeaders&&((o=document.createElement("td")).width=e.rownamewidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),r.appendChild(o)),i=0;i<e.colpanes.length;i++){for(t=e.colpanes[i].first;t<=e.colpanes[i].last;t++)o=document.createElement("td"),(n=e.colwidth[t])&&(o.width=n),o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),o&&r.appendChild(o);i<e.colpanes.length-1&&((o=document.createElement("td")).width=e.defaultpanedividerwidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),r.appendChild(o))}return r},Re.RenderColHeaders=function(e){var t,o=e.sheetobj,i=document.createElement("tr");if(!e.showRCHeaders)return null;for(r=document.createElement("td"),e.classnames&&(r.className=e.classnames.upperleft),e.explicitStyles&&(r.style.cssText=e.explicitStyles.upperleft),r.width=e.rownamewidth,i.appendChild(r),colpane=0;colpane<e.colpanes.length;colpane++){for(t=e.colpanes[colpane].first;t<=e.colpanes[colpane].last;t++){var n,r=document.createElement("td"),s=(e.classnames&&(r.className=e.classnames.colname),e.explicitStyles&&(r.style.cssText=e.explicitStyles.colname),"yes"==o.colattribs.hide[Re.rcColname(t)]&&(r.style.cssText+=";display:none"),r.innerHTML=Re.rcColname(t),t<e.colpanes[e.colpanes.length-1].last&&"yes"==o.colattribs.hide[Re.rcColname(t+1)]&&(n=document.createElement("div"),e.classnames&&(n.className=e.classnames.unhideleft),e.explicitStyles&&(n.style.cssText=e.explicitStyles.unhideleft),e.colunhideleft[t]=n,r.appendChild(n)),1<t&&"yes"==o.colattribs.hide[Re.rcColname(t-1)]&&(n=document.createElement("div"),e.classnames&&(n.className=e.classnames.unhideright),e.explicitStyles&&(n.style.cssText=e.explicitStyles.unhideright),e.colunhideright[t]=n,r.appendChild(n)),document.createElement("span"));s.style.height=Re.Constants.defaultAssumedRowHeight+"px",s.className=e.classnames.colresizebar,r.appendChild(s),i.appendChild(r)}colpane<e.colpanes.length-1&&((r=document.createElement("td")).width=e.defaultpanedividerwidth,e.classnames.panedivider&&(r.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(r.style.cssText=e.explicitStyles.panedivider),i.appendChild(r))}return i},Re.RenderColGroup=function(e){var t,o,i,n,r=e.sheetobj,s=document.createElement("colgroup");for(e.showRCHeaders&&((i=document.createElement("col")).width=e.rownamewidth,s.appendChild(i)),t=0;t<e.colpanes.length;t++){for(o=e.colpanes[t].first;o<=e.colpanes[t].last;o++)i=document.createElement("col"),"yes"==r.colattribs.hide[Re.rcColname(o)]?i.width="1":((n=e.colwidth[o])&&(i.width=n),s.appendChild(i));t<e.colpanes.length-1&&((i=document.createElement("col")).width=e.defaultpanedividerwidth,s.appendChild(i))}return s},Re.RenderSizingRow=function(e){var t,o,i,n,r=e.sheetobj,s=document.createElement("tr");for(e.showRCHeaders&&((i=document.createElement("td")).style.width=e.rownamewidth+"px",i.height="1",s.appendChild(i)),t=0;t<e.colpanes.length;t++){for(o=e.colpanes[t].first;o<=e.colpanes[t].last;o++)i=document.createElement("td"),"yes"==r.colattribs.hide[Re.rcColname(o)]?i.width="1":(n=e.colwidth[o])&&(i.width=n),i.height="1",s.appendChild(i);t<e.colpanes.length-1&&((i=document.createElement("td")).width=e.defaultpanedividerwidth,i.height="1",s.appendChild(i))}return s},Re.RenderCell=function(e,t,o,i,n,r,s){var a,l,c,u,d,h,p,f=e.sheetobj,m="",g=Re.crToCoord(o=+o,t=+t);if(e.cellskip[g])return e.CoordInPane(e.cellskip[g],i,n)?null:(c=r?Re.CreatePseudoElement():document.createElement("td"),e.classnames.skippedcell&&(c.className=e.classnames.skippedcell),e.explicitStyles.skippedcell&&(c.style.cssText=e.explicitStyles.skippedcell),c.innerHTML="&nbsp;",c);if(c=r?Re.CreatePseudoElement():document.createElement("td"),e.cellIDprefix&&(c.id=e.cellIDprefix+g),d=(d=f.cells[g])||new Re.Cell(g),p=f.attribs,scc=Re.Constants,1<d.colspan){for(a=u=1;a<d.colspan;a++)"yes"!=f.colattribs.hide[Re.rcColname(o+a)]&&e.CellInPane(t,o+a,i,n)&&u++;c.colSpan=u}if(1<d.rowspan){for(a=u=1;a<d.rowspan;a++)"yes"!=f.rowattribs.hide[t+a+""]&&e.CellInPane(t+a,o,i,n)&&u++;c.rowSpan=u}return null!=d.displaystring&&0!=f.widgetsClean||(d.displaystring=Re.FormatValueForDisplay(f,d.datavalue,g,s||e.defaultlinkstyle)),c.innerHTML=d.displaystring,(a=d.layout||p.defaultlayout)&&void 0!==e.layouts[a]?m+=e.layouts[a]:m+=scc.defaultCellLayout,(a=d.font||p.defaultfont)&&void 0!==e.fonts[a]?m+="font-style:"+(l=e.fonts[a]).style+";font-weight:"+l.weight+";font-size:"+l.size+";font-family:"+l.family+";":(scc.defaultCellFontSize&&(m+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(m+="font-family:"+scc.defaultCellFontFamily+";")),(a=d.color||p.defaultcolor)&&void 0!==f.colors[a]&&(m+="color:"+f.colors[a]+";"),(a=d.bgcolor||p.defaultbgcolor)&&void 0!==f.colors[a]&&(m+="background-color:"+f.colors[a]+";"),(a=d.cellformat)&&void 0!==f.cellformats[a]?m+="text-align:"+f.cellformats[a]+";":"t"==(l=d.valuetype.charAt(0))?(a=p.defaulttextformat)&&void 0!==f.cellformats[a]&&(m+="text-align:"+f.cellformats[a]+";"):"n"==l?(a=p.defaultnontextformat)&&void 0!==f.cellformats[a]?m+="text-align:"+f.cellformats[a]+";":m+="text-align:right;":m+="text-align:left;",(1<d.colspan||1<d.rowspan)&&(h=f.cells[Re.crToCoord(o+(d.colspan||1)-1,t+(d.rowspan||1)-1)]),(a=d.bt)&&void 0!==f.borderstyles[a]&&(m+="border-top:"+f.borderstyles[a]+";"),(a=(void 0!==h?h:d).br)&&void 0!==f.borderstyles[a]?m+="border-right:"+f.borderstyles[a]+";":e.showGrid&&(l=e.CellInPane(t,o+(d.colspan||1),i,n)?Re.crToCoord(o+(d.colspan||1),t):"nomatch",e.cellskip[l]&&(l=e.cellskip[l]),f.cells[l]&&f.cells[l].bl||(m+="border-right:"+e.gridCSS)),(a=(void 0!==h?h:d).bb)&&void 0!==f.borderstyles[a]?m+="border-bottom:"+f.borderstyles[a]+";":e.showGrid&&(l=e.CellInPane(t+(d.rowspan||1),o,i,n)?Re.crToCoord(o,t+(d.rowspan||1)):"nomatch",e.cellskip[l]&&(l=e.cellskip[l]),f.cells[l]&&f.cells[l].bt||(m+="border-bottom:"+e.gridCSS)),(a=d.bl)&&void 0!==f.borderstyles[a]&&(m+="border-left:"+f.borderstyles[a]+";"),d.comment&&(c.title=d.comment,e.showGrid?(e.commentClassName&&(c.className=(c.className?c.className+" ":"")+e.commentClassName),m+=e.commentCSS):(e.commentNoGridClassName&&(c.className=(c.className?c.className+" ":"")+e.commentNoGridClassName),m+=e.commentNoGridCSS)),d.readonly&&(d.comment||(c.title=e.readonlyComment),e.showGrid?(e.readonlyClassName&&(c.className=(c.className?c.className+" ":"")+e.readonlyClassName),m+=e.readonlyCSS):(e.readonlyNoGridClassName&&(c.className=(c.className?c.className+" ":"")+e.readonlyNoGridClassName),m+=e.readonlyNoGridCSS)),c.style.cssText=m,void 0!==d.cssc&&(r?c.className=(c.className?c.className+" ":"")+d.cssc:c.classList.add(d.cssc)),(l=e.highlights[g])&&("cursor"==l&&(l+=e.cursorsuffix),e.highlightTypes[l].className&&(c.className=(c.className?c.className+" ":"")+e.highlightTypes[l].className),Re.setStyles(c,e.highlightTypes[l].style)),"yes"==f.colattribs.hide[Re.rcColname(o)]&&(c.style.cssText+=";display:none"),"yes"==f.rowattribs.hide[t]&&(c.style.cssText+=";display:none"),c},Re.CoordInPane=function(e,t,o,i){var n=e.coordToCR[t];if(n&&n.row&&n.col)return e.CellInPane(n.row,n.col,o,i);throw"Bad coordToCR for "+t},Re.CellInPane=function(e,t,o,i,n){var r=e.rowpanes[i],e=e.colpanes[n];if(r&&e)return!(t<r.first||t>r.last)&&!(o<e.first||o>e.last);throw"CellInPane called with unknown panes "+i+"/"+n},Re.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}},Re.rcColname=function(e){var t=((e=(e=702<e?702:e)<1?1:e)-1)%26+65,e=Math.floor((e-1)/26);return e?String.fromCharCode(e+64)+String.fromCharCode(t):String.fromCharCode(t)},Re.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Re.crToCoord=function(e,t){t<1&&(t=1);var o=((e=702<(e=e<1?1:e)?702:e)-1)%26,e=Math.floor((e-1)/26),e=e?Re.letters[e-1]+Re.letters[o]+t:Re.letters[o]+t;return e},Re.coordToCol={},Re.coordToRow={},Re.coordToCr=function(e){var t,o,i,n=Re.coordToRow[e];if(n)return{row:n,col:Re.coordToCol[e]};for(o=n=t=0;o<e.length;o++)36!=(i=e.charCodeAt(o))&&(i<=57?n=10*n+i-48:97<=i?t=26*t+i-96:65<=i&&(t=26*t+i-64));return Re.coordToCol[e]=t,{row:Re.coordToRow[e]=n,col:t}},Re.ParseRange=function(e){var t,o,i,n;return 0<=(t=(e=(e=e||"A1:A1").toUpperCase()).indexOf(":"))?(o=e.substring(0,t),(i=Re.coordToCr(o)).coord=o,o=e.substring(t+1),(n=Re.coordToCr(o)).coord=o):((i=Re.coordToCr(e)).coord=e,(n=Re.coordToCr(e)).coord=e),{cr1:i,cr2:n}},Re.decodeFromSave=function(e){return"string"!=typeof e||-1==e.indexOf("\\")?e:e.replace(/\\c/g,":").replace(/\\n/g,"\n").replace(/\\b/g,"\\")},Re.decodeFromAjax=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;e=e.replace(/\\c/g,":");return(e=(e=e.replace(/\\n/g,"\n")).replace(/\\e/g,"]]")).replace(/\\b/g,"\\")},Re.encodeForSave=function(e){return"string"==typeof e&&-1!=(e=-1!=(e=-1!=e.indexOf("\\")?e.replace(/\\/g,"\\b"):e).indexOf(":")?e.replace(/:/g,"\\c"):e).indexOf("\n")?e.replace(/\n/g,"\\n"):e},Re.special_chars=function(e){return e=/[&<>"]/.test(e)?(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;"):e},Re.Lookup=function(e,t){for(i=0;i<t.length;i++)if(t[i]>e)return 0<i?i-1:null;return t.length-1},Re.setStyles=function(e,t){var o,i,n,r;if(t)for(o=t.split(";"),i=0;i<o.length;i++)-1!=(r=o[i].indexOf(":"))&&(n=o[i].substring(0,r),r=o[i].substring(r+1),n&&r&&(e.style[n]=r))},Re.GetViewportInfo=function(){var e={};return M.innerWidth?(e.width=M.innerWidth,e.height=M.innerHeight,e.horizontalScroll=M.pageXOffset,e.verticalScroll=M.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight,e.horizontalScroll=document.documentElement.scrollLeft,e.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(e.width=document.body.clientWidth,e.height=document.body.clientHeight,e.horizontalScroll=document.body.scrollLeft,e.verticalScroll=document.body.scrollTop),e},Re.GetElementPosition=function(e){for(var t=0,o=0;e&&"relative"!=Re.GetComputedStyle(e,"position");)t+=e.offsetLeft,o+=e.offsetTop,e=e.offsetParent;return{left:t,top:o}},Re.GetElementPositionWithScroll=function(e){e=e.getBoundingClientRect();return{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}},Re.GetElementFixedParent=function(e){for(;e&&"HTML"!=e.tagName;){if("fixed"==Re.GetComputedStyle(e,"position"))return e;e=e.parentNode}return!1},Re.GetComputedStyle=function(e,t){e=void 0!==e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null);return e[t]},Re.LookupElement=function(e,t){for(var o=0;o<t.length;o++)if(t[o].element==e)return t[o];return null},Re.AssignID=function(e,t,o){e.idPrefix&&(t.id=e.idPrefix+o)},Re.GetCellContents=function(e,t){var o="",i=e.cells[t];if(i)switch(i.datatype){case"v":o=i.datavalue+"";break;case"t":o="'"+i.datavalue;break;case"f":o="="+i.formula;break;case"c":o=i.formula}return o},Re.FormatValueForDisplay=function(e,t,o,i){var n,r=e.attribs,s=(Re.Constants,e.cells[o]),a=(t=t,h=(u=(s=s||new Re.Cell(o)).valuetype||"").substring(1),valueinputwidget=u.charAt(1),u.substring(2)),l=null,c=null,u=u.charAt(0);if(s.errors||"e"==u)return t=s.errors||h||"Error in cell";if("t"==u){if("formula"==(n=e.valueformats[+s.textvalueformat]||e.valueformats[+r.defaulttextvalueformat]||""))return t="f"==s.datatype?Re.special_chars("="+s.formula)||"&nbsp;":"c"==s.datatype?Re.special_chars("'"+s.formula)||"&nbsp;":Re.special_chars("'"+t)||"&nbsp;";var l=t,c=t=Re.format_text_for_display(t,s.valuetype,n,e,i,s.nontextvalueformat)}else if("n"==u){if(null!=(n=s.nontextvalueformat)&&""!=n||(n=r.defaultnontextvalueformat),"formula"==(n=null!=(n=e.valueformats[+n])&&"none"!=n?n:""))return t="f"==s.datatype?Re.special_chars("="+s.formula)||"&nbsp;":"c"==s.datatype?Re.special_chars("'"+s.formula)||"&nbsp;":Re.special_chars("'"+t)||"&nbsp;";if("forcetext"==n)return t="f"==s.datatype?Re.special_chars("="+s.formula)||"&nbsp;":"c"==s.datatype?Re.special_chars(s.formula)||"&nbsp;":Re.special_chars(t)||"&nbsp;";l=t,c=t=Re.format_number_for_display(t,s.valuetype,n)}else t="&nbsp;";if("i"!=valueinputwidget||null==l||null==c)return t;var d=e.ioParameterList[o],h=Re.Formula.FunctionList[a];if(h){if(g=(g=(g=(g=h[5]).replace(/<%=checked%>/g,0==l?"":"checked")).replace(/<%=formated_value%>/g,c)).replace(/<%=display_value%>/g,l),d){for(var p=0;p<d.length;p++)var f="coord"==d[p].type?e.GetAssuredCell(d[p].value).datavalue:d[p].value,m=new RegExp("<%=parameter"+p+"_value%>","g"),g=g.replace(m,f);if(d.html)for(var v=0;v<d.html.length;v++){m=new RegExp("<%=html"+v+"_value%>","g");g=g.replace(m,d.html[v])}d.css&&(g=g.replace(/^(<\w+)(\W)/,"$1 style='"+d.css+"'$2"))}return g.replace(/<%=cell_reference%>/g,o)}return"error:Widget HTML missing"},Re.format_text_for_display=function(e,t,o,i,n,r){var s,a,l,c=t.substring(1),u=e;return""!=(o=/^(text-|custom|hidden)/.test(o="none"!=o&&null!=o?o:"")?o:"")&&"General"!=o||("h"==c&&(o="text-html"),"w"!=c&&"r"!=c||(o="text-wiki"),"l"==c&&(o="text-link"),c||(o="text-plain")),"text-html"!=o&&(Re.Callbacks.expand_wiki&&/^text-wiki/.test(o)?u=Re.Callbacks.expand_wiki(u,i,n,o):"text-wiki"==o?u=Re.Callbacks.expand_markup&&Re.Callbacks.expand_markup(u,i,n)||Re.special_chars("wiki-text:"+u):"text-url"==o?(s=Re.special_chars(u),u='<a href="'+(a=encodeURI(u))+'">'+s+"</a>"):"text-link"==o?u=Re.expand_text_link(u,i,n,o):"text-image"==o?u='<img src="'+(a=encodeURI(u))+'">':"text-custom:"==o.substring(0,12)?(s=(s=(s=Re.special_chars(u)).replace(/  /g,"&nbsp; ")).replace(/\n/g,"<br>"),a=encodeURI(u),(l={}).r=u,l.s=s,l.u=a,u=(u=o.substring(12)).replace(/@(r|s|u)/g,function(e,t){return l[t]})):"custom"==o.substring(0,6)?(u=(u=(u=Re.special_chars(u)).replace(/  /g,"&nbsp; ")).replace(/\n/g,"<br>"),u+=" (custom format)"):u="hidden"==o?"&nbsp;":null!=r&&""!=r&&"none"!=i.valueformats[+r]&&""!=i.valueformats[+r]?(o=i.valueformats[r],Re.format_number_for_display(e,t,o)):(u=(u=Re.special_chars(u)).replace(/  /g,"&nbsp; ")).replace(/\n/g,"<br>")),u},Re.format_number_for_display=function(e,t,o){var i=Re.Constants,n=+e,t=t.substring(1);return"logical"==(o="Auto"!=o&&""!=o?o:"%"==t?i.defaultFormatp:"$"==t?i.defaultFormatc:"dt"==t?i.defaultFormatdt:"d"==t?i.defaultFormatd:"t"==t?i.defaultFormatt:"l"==t?"logical":"General")?n?i.defaultDisplayTRUE:i.defaultDisplayFALSE:"hidden"==o?"&nbsp;":Re.FormatNumber.formatNumberWithFormat(e,o,"")},Re.DetermineValueType=function(e){var t,o,i,n,r,s=e+"",a="t",l=s.replace(/^\s+/,"");return l=l.replace(/\s+$/,""),0==s.length?a="":s.match(/^\s+$/)||(l.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(s=+l,isNaN(s)?s=e+"":a="n"):l.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(s=+l.slice(0,-1)/100,a="n%"):l.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&l.match(/\d/)?(s=+l.replace(/\$/,""),a="n$"):l.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(s=+l.replace(/,/g,""),a="n"):l.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(s=+l.replace(/[%,]/g,"")/100,a="n%"):l.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&l.match(/\d/)?(s=+l.replace(/[\$,]/g,""),a="n$"):(e=s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(n=(n=+e[3])<1e3?n+2e3:n,s=0===navigator.language.indexOf("fr")?Re.FormatNumber.convert_date_gregorian_to_julian(n,+e[2],+e[1])-2415019:Re.FormatNumber.convert_date_gregorian_to_julian(n,+e[1],+e[2])-2415019,a="nd"):(e=s.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(n=+e[1],s=Re.FormatNumber.convert_date_gregorian_to_julian(n=n<1e3?n+2e3:n,+e[2],+e[3])-2415019,a="nd"):(e=s.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2})\s*$/))?(n=+e[1],o=+e[4],r=+e[5],s=Re.FormatNumber.convert_date_gregorian_to_julian(n=n<1e3?n+2e3:n,+e[2],+e[3])-2415019,a="nd",o<24&&r<60&&(s+=o/24+r/1440,a="ndt")):(e=s.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(n=+e[1],o=+e[4],r=+e[5],t=+e[6],s=Re.FormatNumber.convert_date_gregorian_to_julian(n=n<1e3?n+2e3:n,+e[2],+e[3])-2415019,a="nd",o<24&&r<60&&t<60&&(s+=o/24+r/1440+t/86400,a="ndt")):(e=s.match(/^(\d{1,2}):(\d{1,2})\s*$/))?(o=+e[1],r=+e[2],o<24&&r<60&&(s=o/24+r/1440,a="nt")):(e=s.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(o=+e[1],r=+e[2],t=+e[3],o<24&&r<60&&t<60&&(s=o/24+r/1440+t/86400,a="nt")):(e=s.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(n=+e[1],i=+e[2],(o=+e[3])&&0<o&&(s=n+(n<0?-i/o:i/o),a="n")):(r=Re.InputConstants[s.toUpperCase()])?(i=r.indexOf(","),s=+r.substring(0,i),a=r.substring(i+1)):7<l.length&&"http://"==l.substring(0,7).toLowerCase()?(s=l,a="tl"):l.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&(s=l,a="th")),{value:s,type:a}},Re.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},Re.default_expand_markup=function(e,t,o){return e=(e=(e=Re.special_chars(e)).replace(/  /g,"&nbsp; ")).replace(/\n/g,"<br>")},Re.expand_text_link=function(e,t,o,i){var n=Re.Constants,r="",s=Re.ParseCellLinkText(e+""),n=s.desc?Re.special_chars(s.desc):s.pagename?n.defaultPageLinkFormatString:n.defaultLinkFormatString;return 7<e.length&&"http://"==e.substring(0,7).toLowerCase()&&">"!=e.charAt(e.length-1)&&(n=n.substring(7)),e=s.newwin||!o?' target="_blank"':"",s.pagename?Re.Callbacks.MakePageLink&&(r=Re.Callbacks.MakePageLink(s.pagename,s.workspacename,o,i)):r=encodeURI(s.url),'<a href="'+r+'"'+e+">"+n+"</a>"},Re.ParseCellLinkText=function(e){var t={url:"",desc:"",newwin:!1,pagename:"",workspace:""},o=!1,i=e.length-1,n=0,r=e.lastIndexOf("<"),s=e.lastIndexOf("["),a=e.lastIndexOf("{"),l=-1;return">"==e.charAt(i)&&-1!=r||"]"==e.charAt(i)&&-1!=s||!("}"!=e.charAt(i)||"]"!=e.charAt(i-1)||-1==a||-1==s||s<a)?(">"==e.charAt(i)?(l=r-1,0<r&&"<"==e.charAt(l)&&">"==e.charAt(i-1)&&(l--,i--,t.newwin=!0)):"]"==e.charAt(i)?(l=s-1,o=!0,0<s&&"["==e.charAt(l)&&"]"==e.charAt(i-1)&&(l--,i--,t.newwin=!0)):"}"==e.charAt(i)&&(l=a-1,o=!0,i--,0<(wsend=s)&&"["==e.charAt(s-1)&&"]"==e.charAt(i-1)&&(wsend=s-1,i--,t.newwin=!0)," "==e.charAt(wsend-1)&&wsend--,t.workspace=e.substring(a+1,wsend)||"")," "==e.charAt(l)&&l--,'"'==e.charAt(n)&&'"'==e.charAt(l)&&(n++,l--)):l=++i,o?t.pagename=e.substring(s+1,i)||"":t.url=e.substring(r+1,i)||"",n<=l&&(t.desc=e.substring(n,l+1)),t},Re.ConvertSaveToOtherFormat=function(e,t,o){var i,n,r,s,a,l,c="";if("scsave"==t)return e;if(""==e)return"";if((i=new Re.Sheet).ParseSheetSave(e),o)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";if(n=i.copiedfrom?Re.ParseRange(i.copiedfrom):{cr1:{row:1,col:1},cr2:{row:i.attribs.lastrow,col:i.attribs.lastcol}},"html"==t)return e=new Re.RenderContext(i),i.copiedfrom&&(e.rowpanes[0]={first:n.cr1.row,last:n.cr2.row},e.colpanes[0]={first:n.cr1.col,last:n.cr2.col}),o=document.createElement("div"),r=e.RenderSheet(null,e.defaultHTMLlinkstyle),o.appendChild(r),delete e,delete i,c=o.innerHTML,delete r,delete o,c;for(s=n.cr1.row;s<=n.cr2.row;s++){for(a=n.cr1.col;a<=n.cr2.col;a++)l=Re.crToCoord(a,s),l=(l=i.GetAssuredCell(l)).errors||l.datavalue+"","csv"==t?(-1!=l.indexOf('"')&&(l=l.replace(/"/g,'""')),/[, \n"]/.test(l)&&(l='"'+l+'"'),a>n.cr1.col&&(l=","+l)):"tab"==t&&(-1!=l.indexOf("\n")&&(l='"'+(l=-1!=l.indexOf('"')?l.replace(/"/g,'""'):l)+'"'),a>n.cr1.col&&(l="\t"+l)),c+=l;c+="\n"}return c},Re.ConvertOtherFormatToSave=function(e,t){function o(){f<++h&&(f=h),p=Re.crToCoord(h,d),Re.SetConvertedCell(i,p,a),a=""}var i,n,r,s,a,l,c,u,d,h,p,f,m="";if("scsave"==t)return e;if(i=new Re.Sheet,n=e.split(/\r\n|\n/),f=0,"csv"==t){for(l=!1,r=d=0;r<n.length&&(r!=n.length-1||""!=n[r]);r++)for(l?a+="\n":(a="",d++,h=0),s=n[r],c=0;c<s.length;c++)'"'==(u=s.charAt(c))?l?c<s.length-1&&'"'==s.charAt(c+1)?(c++,a+='"'):(l=!1,c==s.length-1&&o()):l=!0:(","!=u||l?a+=u:o(),c!=s.length-1||l||o());0<f&&(i.attribs.lastrow=d,i.attribs.lastcol=f,m=i.CreateSheetSave("A1:"+Re.crToCoord(f,d)))}if("tab"==t){for(l=!1,r=d=0;r<n.length&&(r!=n.length-1||""!=n[r]);r++)for(l?a+="\n":(a="",d++,h=0),s=n[r],c=0;c<s.length;c++){if('"'==(u=s.charAt(c))){if(l){c<s.length-1?'"'==s.charAt(c+1)?(c++,a+='"'):"\t"==s.charAt(c+1)&&(c++,l=!1,o()):(l=!1,o());continue}if(""==a){l=!0;continue}}"\t"!=u||l?a+=u:o(),c!=s.length-1||l||o()}0<f&&(i.attribs.lastrow=d,i.attribs.lastcol=f,m=i.CreateSheetSave("A1:"+Re.crToCoord(f,d)))}return m},Re.SetConvertedCell=function(e,t,o){e=e.GetAssuredCell(t),t=Re.DetermineValueType(o);"n"==t.type&&t.value==o?(e.datatype="v",e.valuetype="n",e.datavalue=t.value):"t"==t.type.charAt(0)?(e.datatype="t",e.valuetype=t.type,e.datavalue=t.value):(e.datatype="c",e.valuetype=t.type,e.datavalue=t.value,e.formula=o)},(Re=Re||{}).TableEditor=function(e){var t=Re.Constants;this.context=e,this.toplevel=null,this.fullgrid=null,this.noEdit=!1,this.width=null,this.tablewidth=null,this.height=null,this.tableheight=null,this.inputBox=null,this.inputEcho=null,this.verticaltablecontrol=null,this.horizontaltablecontrol=null,this.logo=null,this.cellhandles=null,this.timeout=null,this.busy=!1,this.ensureecell=!1,this.deferredCommands=[],this.deferredEmailCommands=[],this.gridposition=null,this.headposition=null,this.firstscrollingrow=null,this.firstscrollingrowtop=null,this.lastnonscrollingrow=null,this.lastvisiblerow=null,this.firstscrollingcol=null,this.firstscrollingcolleft=null,this.lastnonscrollingcol=null,this.lastvisiblecol=null,this.rowpositions=[],this.colpositions=[],this.rowheight=[],this.colwidth=[],this.ecell=null,this.state="start",this.workingvalues={},this.imageprefix=t.defaultImagePrefix,this.idPrefix=t.defaultTableEditorIDPrefix,this.pageUpDnAmount=t.defaultPageUpDnAmount,this.recalcFunction=function(e){if(!e.context.sheetobj.RecalcSheet)return null;e.context.sheetobj.RecalcSheet(Re.EditorSheetStatusCallback,e)},this.ctrlkeyFunction=function(i,e){var t,o,n,r,s,a;switch(e){case"[ctrl-a]":return i.MoveECell("A1"),i.RangeAnchor("A1"),i.RangeExtend(Re.crToCoord(i.context.sheetobj.attribs.lastcol,i.context.sheetobj.attribs.lastrow)),!1;case"[ctrl-c]":case"[ctrl-x]":return(t=i.pasteTextarea).value="",(o=Re.GetEditorCellElement(i,i.ecell.row,i.ecell.col))&&(n=Re.GetElementPosition(o.element),t.style.left=n.left-1+"px",t.style.top=n.top-1+"px"),s=i.range.hasrange?Re.crToCoord(i.range.left,i.range.top)+":"+Re.crToCoord(i.range.right,i.range.bottom):i.ecell.coord,a=Re.ConvertSaveToOtherFormat(Re.CreateSheetSave(i.context.sheetobj,s),"tab"),r="[ctrl-c]"==e||i.noEdit||i.ECellReadonly()?"copy "+s+" formulas":"cut "+s+" formulas",i.EditorScheduleSheetCommands(r,!0,!1),t.style.display="block",t.value=a,t.focus(),t.select(),M.setTimeout(function(){var e=i.pasteTextarea;e.blur(),e.style.display="none",Re.KeyboardFocus()},200),!0;case"[ctrl-v]":return i.noEdit||i.ECellReadonly()?!0:((t=i.pasteTextarea).value="",(o=Re.GetEditorCellElement(i,i.ecell.row,i.ecell.col))&&(n=Re.GetElementPosition(o.element),t.style.left=n.left-1+"px",t.style.top=n.top-1+"px"),t.style.display="block",t.value="",t.focus(),M.setTimeout(function(){var e,t=i.pasteTextarea,o=t.value,t=(t.blur(),t.style.display="none","");i.pastescclipboard?i.pastescclipboard=!1:(e=Re.ConvertSaveToOtherFormat(Re.Clipboard.clipboard,"tab"),(o=o.replace(/\r\n/g,"\n"))==e||o.length-e.length==1&&o.substring(0,o.length-1)==e||(t="loadclipboard "+Re.encodeForSave(Re.ConvertOtherFormatToSave(o,"tab"))+"\n")),e=i.range.hasrange?((e=new Re.Sheet).ParseSheetSave(Re.Clipboard.clipboard),null!==(o=e.copiedfrom.match(/(.+):(.+)/))&&o[1]===o[2]?Re.crToCoord(i.range.left,i.range.top)+":"+Re.crToCoord(i.range.right,i.range.bottom):Re.crToCoord(i.range.left,i.range.top)):i.ecell.coord,i.EditorScheduleSheetCommands(t+="paste "+e+" formulas",!0,!1),Re.KeyboardFocus()},200),!0);case"[ctrl-z]":return i.EditorScheduleSheetCommands("undo",!0,!1),!1;case"[ctrl-s]":if(Re.Constants.AllowCtrlS)return M.setTimeout(function(){var e=i.context.sheetobj,t=e.GetAssuredCell(i.ecell.coord),e=t.nontextvalueformat&&e.valueformats[+t.nontextvalueformat]||"",t=M.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",e);if(null!=t){if(t.match(/^cmd:/))r=t.substring(4);else{if(t.match(/^edit:/))return r=t.substring(5),void(Re.CtrlSEditor&&Re.CtrlSEditor(r));s=i.range.hasrange?Re.crToCoord(i.range.left,i.range.top)+":"+Re.crToCoord(i.range.right,i.range.bottom):i.ecell.coord,r="set "+s+" nontextvalueformat "+t}i.EditorScheduleSheetCommands(r,!0,!1)}},200),!1}return!0},e.sheetobj.statuscallback=Re.EditorSheetStatusCallback,(e.sheetobj.statuscallbackparams=this).StatusCallback={},this.MoveECellCallback={},this.RangeChangeCallback={},this.SettingsCallbacks={},this.ecell={coord:"A1",row:1,col:1},e.highlights[this.ecell.coord]="cursor",this.range={hasrange:!1},this.range2={hasrange:!1}},Re.TableEditor.prototype.CreateTableEditor=function(e,t){return Re.CreateTableEditor(this,e,t)},Re.TableEditor.prototype.ResizeTableEditor=function(e,t){return Re.ResizeTableEditor(this,e,t)},Re.TableEditor.prototype.SaveEditorSettings=function(){return Re.SaveEditorSettings(this)},Re.TableEditor.prototype.LoadEditorSettings=function(e,t){return Re.LoadEditorSettings(this,e,t)},Re.TableEditor.prototype.EditorRenderSheet=function(){Re.EditorRenderSheet(this)},Re.TableEditor.prototype.EditorScheduleSheetCommands=function(e,t,o){Re.EditorScheduleSheetCommands(this,e,t,o)},Re.TableEditor.prototype.ScheduleSheetCommands=function(e,t){this.context.sheetobj.ScheduleSheetCommands(e,t)},Re.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()},Re.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()},Re.TableEditor.prototype.EditorStepSet=function(e,t){Re.EditorStepSet(this,e,t)},Re.TableEditor.prototype.GetStatuslineString=function(e,t,o){return Re.EditorGetStatuslineString(this,e,t,o)},Re.TableEditor.prototype.EditorMouseRegister=function(){return Re.EditorMouseRegister(this)},Re.TableEditor.prototype.EditorMouseUnregister=function(){return Re.EditorMouseUnregister(this)},Re.TableEditor.prototype.EditorMouseRange=function(e){return Re.EditorMouseRange(this,e)},Re.TableEditor.prototype.EditorProcessKey=function(e,t){return Re.EditorProcessKey(this,e,t)},Re.TableEditor.prototype.EditorAddToInput=function(e,t){return Re.EditorAddToInput(this,e,t)},Re.TableEditor.prototype.DisplayCellContents=function(){return Re.EditorDisplayCellContents(this)},Re.TableEditor.prototype.EditorSaveEdit=function(e){return Re.EditorSaveEdit(this,e)},Re.TableEditor.prototype.EditorApplySetCommandsToRange=function(e,t){return Re.EditorApplySetCommandsToRange(this,e,t)},Re.TableEditor.prototype.MoveECellWithKey=function(e){return Re.MoveECellWithKey(this,e)},Re.TableEditor.prototype.MoveECell=function(e){return Re._app?"A1":Re.MoveECell(this,e)},Re.TableEditor.prototype.ReplaceCell=function(e,t,o){Re.ReplaceCell(this,e,t,o)},Re.TableEditor.prototype.UpdateCellCSS=function(e,t,o){Re.UpdateCellCSS(this,e,t,o)},Re.TableEditor.prototype.SetECellHeaders=function(e){Re.SetECellHeaders(this,e)},Re.TableEditor.prototype.EnsureECellVisible=function(){Re.EnsureECellVisible(this)},Re.TableEditor.prototype.ECellReadonly=function(e){return Re.ECellReadonly(this,e)},Re.TableEditor.prototype.RangeAnchor=function(e){Re.RangeAnchor(this,e)},Re.TableEditor.prototype.RangeExtend=function(e){Re.RangeExtend(this,e)},Re.TableEditor.prototype.RangeRemove=function(){Re.RangeRemove(this)},Re.TableEditor.prototype.Range2Remove=function(){Re.Range2Remove(this)},Re.TableEditor.prototype.FitToEditTable=function(){Re.FitToEditTable(this)},Re.TableEditor.prototype.CalculateEditorPositions=function(){Re.CalculateEditorPositions(this)},Re.TableEditor.prototype.ScheduleRender=function(){this.ScheduleRender(!0)},Re.TableEditor.prototype.ScheduleRender=function(e){Re._app&&1==e&&(this.context.sheetobj.widgetsClean=!1),Re.ScheduleRender(this)},Re.TableEditor.prototype.DoRenderStep=function(){Re.DoRenderStep(this)},Re.TableEditor.prototype.SchedulePositionCalculations=function(){Re.SchedulePositionCalculations(this)},Re.TableEditor.prototype.DoPositionCalculations=function(){Re.DoPositionCalculations(this)},Re.TableEditor.prototype.CalculateRowPositions=function(e,t,o){return Re.CalculateRowPositions(this,e,t,o)},Re.TableEditor.prototype.CalculateColPositions=function(e,t,o){return Re.CalculateColPositions(this,e,t,o)},Re.TableEditor.prototype.ScrollRelative=function(e,t){Re.ScrollRelative(this,e,t)},Re.TableEditor.prototype.ScrollRelativeBoth=function(e,t){Re.ScrollRelativeBoth(this,e,t)},Re.TableEditor.prototype.PageRelative=function(e,t){Re.PageRelative(this,e,t)},Re.TableEditor.prototype.LimitLastPanes=function(){Re.LimitLastPanes(this)},Re.TableEditor.prototype.ScrollTableUpOneRow=function(){return Re.ScrollTableUpOneRow(this)},Re.TableEditor.prototype.ScrollTableDownOneRow=function(){return Re.ScrollTableDownOneRow(this)},Re.TableEditor.prototype.ScrollTableLeftOneCol=function(){return Re.ScrollTableLeftOneCol(this)},Re.TableEditor.prototype.ScrollTableRightOneCol=function(){return Re.ScrollTableRightOneCol(this)},Re.TableEditor.prototype.StopPropagation=function(){return Re.StopPropagation(this)},Re.TableEditor.prototype.SetMouseMoveUp=function(){return Re.SetMouseMoveUp(this)},Re.TableEditor.prototype.RemoveMouseMoveUp=function(){return Re.RemoveMouseMoveUp(this)},Re.CreateTableEditor=function(e,t,o){var i=Re.Constants,n=Re.AssignID;return e.toplevel=document.createElement("div"),e.toplevel.style.position="relative",n(e,e.toplevel,"toplevel"),e.width=t,e.height=o,e.griddiv=document.createElement("div"),e.tablewidth=Math.max(0,t-i.defaultTableControlThickness),e.tableheight=Math.max(0,o-i.defaultTableControlThickness),e.griddiv.style.width=e.tablewidth+"px",e.griddiv.style.height=e.tableheight+"px",e.griddiv.style.overflow="hidden",e.griddiv.style.cursor="default",i.cteGriddivClass&&(e.griddiv.className=i.cteGriddivClass),n(e,e.griddiv,"griddiv"),e.FitToEditTable(),e.EditorRenderSheet(),e.griddiv.appendChild(e.fullgrid),e.verticaltablecontrol=new Re.TableControl(e,!0,e.tableheight),e.verticaltablecontrol.CreateTableControl(),n(e,e.verticaltablecontrol.main,"tablecontrolv"),e.horizontaltablecontrol=new Re.TableControl(e,!1,e.tablewidth),e.horizontaltablecontrol.CreateTableControl(),n(e,e.horizontaltablecontrol.main,"tablecontrolh"),t=document.createElement("table"),(e.layouttable=t).cellSpacing=0,t.cellPadding=0,n(e,t,"layouttable"),o=document.createElement("tbody"),t.appendChild(o),i=document.createElement("tr"),o.appendChild(i),(t=document.createElement("td")).appendChild(e.griddiv),i.appendChild(t),1!=Re._app&&((t=document.createElement("td")).appendChild(e.verticaltablecontrol.main),i.appendChild(t)),i=document.createElement("tr"),o.appendChild(i),1!=Re._app&&((t=document.createElement("td")).appendChild(e.horizontaltablecontrol.main),i.appendChild(t)),t=document.createElement("td"),Re._app?t.style.background="url("+e.imageprefix+"logo.gif) no-repeat right center":t.style.background="url("+e.imageprefix+"logo.gif) no-repeat center center",t.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+e.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>",i.appendChild(t),e.logo=t,n(e,e.logo,"logo"),t.firstChild.firstChild.title="SocialCalc",e.toplevel.appendChild(e.layouttable),e.noEdit||(e.inputEcho=new Re.InputEcho(e),n(e,e.inputEcho.main,"inputecho")),e.cellhandles=new Re.CellHandles(e),o=document.createElement("textarea"),Re.setStyles(o,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);"),o.value="",e.pasteTextarea=o,n(e,e.pasteTextarea,"pastetextarea"),navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(M.removeEventListener("beforepaste",Re.SafariPasteFunction,!1),M.addEventListener("beforepaste",Re.SafariPasteFunction,!1),M.removeEventListener("beforecopy",Re.SafariPasteFunction,!1),M.addEventListener("beforecopy",Re.SafariPasteFunction,!1),M.removeEventListener("beforecut",Re.SafariPasteFunction,!1),M.addEventListener("beforecut",Re.SafariPasteFunction,!1)),e.toplevel.appendChild(e.pasteTextarea),Re.MouseWheelRegister(e.toplevel,{WheelMove:Re.EditorProcessMouseWheel,editor:e}),Re.KeyboardSetFocus(e),Re.EditorSheetStatusCallback(null,"startup",null,e),e.toplevel},Re.SafariPasteFunction=function(e){e.preventDefault()},Re.ResizeTableEditor=function(e,t,o){var i=Re.Constants;e.width=t,e.height=o,e.toplevel.style.width=t+"px",e.toplevel.style.height=o+"px",Re._app?e.tablewidth=Math.max(0,t):e.tablewidth=Math.max(0,t-i.defaultTableControlThickness),e.tableheight=Math.max(0,o-i.defaultTableControlThickness),e.griddiv.style.width=e.tablewidth+"px",e.griddiv.style.height=e.tableheight+"px",e.verticaltablecontrol.main.style.height=e.tableheight+"px",e.horizontaltablecontrol.main.style.width=e.tablewidth+"px",e.FitToEditTable(),e.ScheduleRender()},Re.SaveEditorSettings=function(e){var t,o,i=e.context,n=e.range,r="";for(r+="version:1.0\n",t=0;t<i.rowpanes.length;t++)r+="rowpane:"+t+":"+i.rowpanes[t].first+":"+i.rowpanes[t].last+"\n";for(t=0;t<i.colpanes.length;t++)r+="colpane:"+t+":"+i.colpanes[t].first+":"+i.colpanes[t].last+"\n";for(o in e.ecell&&(r+="ecell:"+e.ecell.coord+"\n"),n.hasrange&&(r+="range:"+n.anchorcoord+":"+n.top+":"+n.bottom+":"+n.left+":"+n.right+"\n"),e.SettingsCallbacks)r+=e.SettingsCallbacks[o].save(e,o);return r},Re.LoadEditorSettings=function(e,t,o){var i,n,r,s,a,l,c,u,d,h,p=t.split(/\r\n|\n/),f=e.context;for(f.rowpanes=[{first:1,last:1}],f.colpanes=[{first:1,last:1}],e.ecell=null,e.range={hasrange:!1},e.range2={hasrange:!1},h=e.range,f.highlights={},d=f.highlights,r=0;r<p.length;r++)switch(u=(i=(n=p[r]).split(":"))[0]){case"version":break;case"rowpane":f.rowpanes[+i[1]]={first:+i[2],last:+i[3]};break;case"colpane":f.colpanes[+i[1]]={first:+i[2],last:+i[3]};break;case"ecell":e.ecell=Re.coordToCr(i[1]),e.ecell.coord=i[1],d[i[1]]="cursor";break;case"range":for(h.hasrange=!0,h.anchorcoord=i[1],s=Re.coordToCr(h.anchorcoord),h.anchorrow=s.row,h.anchorcol=s.col,h.top=+i[2],h.bottom=+i[3],h.left=+i[4],h.right=+i[5],a=h.top;a<=h.bottom;a++)for(l=h.left;l<=h.right;l++)"cursor"!=d[c=Re.crToCoord(l,a)]&&(d[c]="range");break;default:e.SettingsCallbacks[u]&&e.SettingsCallbacks[u].load(e,u,n,o)}},Re.EditorRenderSheet=function(e){e.EditorMouseUnregister();var t=e.context.sheetobj;if(null!=t.reRenderCellList&&Re._app&&!0===t.widgetsClean){for(var o in t.reRenderCellList){var o=t.reRenderCellList[o],i=t.cells[o].valuetype;"i"==i.charAt(1)&&i==t.cells[o].prevvaluetype||(cr=Re.coordToCr(o),null!=(cell=Re.GetEditorCellElement(e,cr.row,cr.col))&&e.ReplaceCell(cell,cr.row,cr.col))}t.reRenderCellList=[]}else e.fullgrid=e.context.RenderSheet(e.fullgrid),null!=t.reRenderCellList&&Re._app&&(t.widgetsClean=!0,t.reRenderCellList=[]);e.ecell&&e.SetECellHeaders("selected"),Re.AssignID(e,e.fullgrid,"fullgrid"),Re._app||(e.fullgrid.className="te_download"),e.EditorMouseRegister()},Re.EditorScheduleSheetCommands=function(e,t,o,i){if("start"==e.state||i)if(e.busy&&!i)e.deferredCommands.push({cmdstr:t,saveundo:o});else{var n=t.split(" ");switch(n[0]){case"recalc":case"redisplay":e.context.sheetobj.ScheduleSheetCommands(t,!1);break;case"undo":Re._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetUndo();break;case"redo":Re._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetRedo();break;case"setemailparameters":Re.TriggerIoAction.Email(n[1],n[2]);break;default:e.context.sheetobj.ScheduleSheetCommands(t,o)}}},Re.EditorSheetStatusCallback=function(e,t,o,i){function n(e){for(r in i.StatusCallback)i.StatusCallback[r].func&&i.StatusCallback[r].func(i,e,o,i.StatusCallback[r].params)}var r,s,a,l=i.context.sheetobj;switch(t){case"startup":break;case"cmdstart":i.busy=!0,l.celldisplayneeded="";break;case"cmdextension":break;case"cmdend":if(n(t),l.changedrendervalues&&(i.context.PrecomputeSheetFontsAndLayouts(),i.context.CalculateCellSkipData(),l.changedrendervalues=!1),l.celldisplayneeded&&!l.renderneeded&&l.cells[l.celldisplayneeded]&&"e#N/A"!=l.cells[l.celldisplayneeded].valuetype&&(cr=Re.coordToCr(l.celldisplayneeded),a=Re.GetEditorCellElement(i,cr.row,cr.col),i.ReplaceCell(a,cr.row,cr.col)),i.deferredCommands.length)return s=i.deferredCommands.shift(),void i.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0);if(l.attribs.needsrecalc&&("off"!=l.attribs.recalc||l.recalconce)&&i.recalcFunction?(i.FitToEditTable(),l.renderneeded=!1,l.recalconce&&delete l.recalconce,i.recalcFunction(i)):l.renderneeded?(i.FitToEditTable(),l.renderneeded=!1,i.ScheduleRender(!1)):i.SchedulePositionCalculations(),"col"==l.hiddencolrow&&null!==i.ecell){for(var c=i.ecell.col;"yes"==l.colattribs.hide[Re.rcColname(c)];)c++;var u=Re.crToCoord(c,i.ecell.row);i.MoveECell(u),l.hiddencolrow=""}if("row"==l.hiddencolrow&&null!==i.ecell){for(var d=i.ecell.row;"yes"==l.rowattribs.hide[d];)d++;u=Re.crToCoord(i.ecell.col,d);i.MoveECell(u),l.hiddencolrow=""}return;case"calcstart":i.busy=!0;break;case"calccheckdone":case"calcorder":case"calcstep":case"calcloading":case"calcserverfunc":break;case"calcfinished":return n(t),void i.ScheduleRender(!1);case"schedrender":i.busy=!0;break;case"renderdone":break;case"schedposcalc":i.busy=!0;break;case"doneposcalc":return i.deferredEmailCommands.length?(n(t),a=i.deferredEmailCommands.shift(),void i.EditorScheduleSheetCommands(a.cmdstr,a.saveundo,!0)):void(i.deferredCommands.length?(n(t),s=i.deferredCommands.shift(),i.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0)):(i.busy=!1,n(t),"start"==i.state&&i.DisplayCellContents()));case"emailing":case"confirmemailsent":break;default:alert("Unknown status: "+t)}n(t)},Re.EditorGetStatuslineString=function(e,t,o,i){var n,r,s,a,l,c,u=Re.Constants,d="";switch(t){case"moveecell":case"rangechange":case"startup":break;case"cmdstart":i.command=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",d=u.s_statusline_executing;break;case"cmdextension":d="Command Extension: "+o;break;case"cmdend":i.command=!1;break;case"schedrender":d=u.s_statusline_displaying;break;case"renderdone":d=" ";break;case"schedposcalc":d=u.s_statusline_displaying;break;case"cmdendnorender":case"doneposcalc":document.body.style.cursor="default",e.griddiv.style.cursor="default","sent"==i.emailing&&(d=i.emailreponse,i.emailreponse="",i.emailing="done");break;case"calcorder":d=u.s_statusline_ordering+Math.floor(100*o.count/(o.total||1))+"%";break;case"calcstep":d=u.s_statusline_calculating+Math.floor(100*o.count/(o.total||1))+"%";break;case"calcloading":d=u.s_statusline_calculatingls+": "+o.sheetname;break;case"calcserverfunc":d=u.s_statusline_calculating+Math.floor(100*o.count/(o.total||1))+"%, "+u.s_statusline_doingserverfunc+o.funcname+u.s_statusline_incell+o.coord;break;case"calcstart":i.calculating=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",d=u.s_statusline_calcstart;break;case"calccheckdone":break;case"calcfinished":i.calculating=!1;break;case"emailing":i.emailing="sending",i.emailreponse="";break;case"confirmemailsent":i.emailing="sent",void 0===i.emailreponse&&(i.emailreponse=""),i.emailreponse+=o;break;default:d=t}if("sending"==i.emailing&&(d+=u.s_statusline_sendemail),"sent"==i.emailing&&(d+=i.emailreponse),!d&&i.calculating&&(d=u.s_statusline_calculating),!i.calculating&&!i.command&&!d&&e.range.hasrange&&(e.range.left!=e.range.right||e.range.top!=e.range.bottom)){for(c=0,s=e.range.top;s<=e.range.bottom;s++)for(a=e.range.left;a<=e.range.right;a++)(l=e.context.sheetobj.cells[Re.crToCoord(a,s)])&&l.valuetype&&"n"==l.valuetype.charAt(0)&&(c+=+l.datavalue);c=Re.FormatNumber.formatNumberWithFormat(c,"[,]General",""),d=Re.crToCoord(e.range.left,e.range.top)+":"+Re.crToCoord(e.range.right,e.range.bottom)+" ("+(e.range.right-e.range.left+1)+"x"+(e.range.bottom-e.range.top+1)+") "+u.s_statusline_sum+"="+c+" "+d}return n=(e.ecell||{}).coord+" &nbsp; "+d,i.calculating||"yes"!=e.context.sheetobj.attribs.needsrecalc||(n+=" &nbsp; "+u.s_statusline_recalcneeded),(r=e.context.sheetobj.attribs.circularreferencecell)&&(r=r.replace(/\|/," referenced by "),n+=" &nbsp; "+u.s_statusline_circref+r+"</span>"),n+=""},Re.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null},Re.EditorMouseRegister=function(e){for(var t=Re.EditorMouseInfo,o=e.fullgrid,i=0;i<t.registeredElements.length;i++)if(t.registeredElements[i].editor==e){if(t.registeredElements[i].element==o)return;break}if(i<t.registeredElements.length?t.registeredElements[i].element=o:t.registeredElements.push({element:o,editor:e}),o.addEventListener)o.addEventListener("mousedown",Re.ProcessEditorMouseDown,!1),o.addEventListener("dblclick",Re.ProcessEditorDblClick,!1);else{if(!o.attachEvent)throw"Browser not supported";o.attachEvent("onmousedown",Re.ProcessEditorMouseDown),o.attachEvent("ondblclick",Re.ProcessEditorDblClick)}t.ignore=!1},Re.EditorMouseUnregister=function(e){for(var t,o=Re.EditorMouseInfo,i=(e.fullgrid,0);i<o.registeredElements.length&&o.registeredElements[i].editor!=e;i++);i<o.registeredElements.length&&((t=o.registeredElements[i].element).removeEventListener?(t.removeEventListener("mousedown",Re.ProcessEditorMouseDown,!1),t.removeEventListener("dblclick",Re.ProcessEditorDblClick,!1)):t.detachEvent&&(t.detachEvent("onmousedown",Re.ProcessEditorMouseDown),t.detachEvent("ondblclick",Re.ProcessEditorDblClick)),o.registeredElements.splice(i,1))},Re.StopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},Re.SetMouseMoveUp=function(e,t,o,i){document.addEventListener?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",t,!0)):o.attachEvent&&(o.setCapture(),o.attachEvent("onmousemove",e),o.attachEvent("onmouseup",t),o.attachEvent("onlosecapture",t)),Re.StopPropagation(i)},Re.RemoveMouseMoveUp=function(e,t,o,i){Re.StopPropagation(i),document.removeEventListener?(document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",t,!0)):o.detachEvent&&(o.detachEvent("onlosecapture",t),o.detachEvent("onmouseup",t),o.detachEvent("onmousemove",e),o.releaseCapture())},Re.ProcessEditorMouseDown=function(e){var t,o,i=e||M.event,n=Re.EditorMouseInfo,r=i.target||i.srcElement,s=r;if(3==s.nodeType&&(s=s.parentNode),!n.ignore){for(o=null;!o&&r;r=r.parentNode)o=Re.LookupElement(r,n.registeredElements);if(o){t=o.editor,n.element=r;var a=t.range,l=Re.GetElementPositionWithScroll(t.toplevel),c=i.clientX-l.left,l=i.clientY-l.top;if(c=Re.GridMousePosition(t,c,l))if(n.editor=t,c.rowheader)c.rowselect?Re.ProcessEditorRowselectMouseDown(e,r,c):Re.ProcessEditorRowsizeMouseDown(e,r,c);else if(c.colheader)c.colselect?Re.ProcessEditorColselectMouseDown(e,r,c):Re.ProcessEditorColsizeMouseDown(e,r,c);else if(c.coord)if(a.hasrange||e.shiftKey&&t.RangeAnchor(),l=t.MoveECell(c.coord),1==Re._app)Re.CmdGotFocus(!0);else{var c=t.context.sheetobj.cells[l];if(c)if("i"==c.valuetype.charAt(1))return c=c.valuetype.substring(2)+"_"+l,void(s&&c==s.id&&(s=document.getElementById(c),Re.CmdGotFocus(s)));a.hasrange&&(e.shiftKey?t.RangeExtend():t.RangeRemove()),n.mousedowncoord=l,n.mouselastcoord=l,t.EditorMouseRange(l),Re.KeyboardSetFocus(t),"start"!=t.state&&t.inputBox&&t.inputBox.element.focus(),Re.SetMouseMoveUp(Re.ProcessEditorMouseMove,Re.ProcessEditorMouseUp,r,i)}}else n.editor=null}},Re.EditorMouseRange=function(e,t){var o,i,n=e.range;switch(e.state){case"input":o=e.inputBox.GetText(),i=e.workingvalues,(0<="(+-*/,:!&<>=^".indexOf(o.slice(-1))&&"="==o.slice(0,1)||"="==o)&&(i.partialexpr=o),i.partialexpr?t&&(n.hasrange?e.inputBox.SetText(i.partialexpr+Re.crToCoord(n.left,n.top)+":"+Re.crToCoord(n.right,n.bottom)):e.inputBox.SetText(i.partialexpr+t)):(e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null));break;case"inputboxdirect":e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null)}},Re.ProcessEditorMouseMove=function(e){var t,o,i=e||M.event,n=Re.EditorMouseInfo,r=n.editor;r&&!n.ignore&&(n.element,t=Re.GetElementPositionWithScroll(r.toplevel),o=i.clientX-t.left,t=i.clientY-t.top,(o=Re.GridMousePosition(r,o,t))&&(o&&!o.coord?Re.SetDragAutoRepeat(r,o):(Re.SetDragAutoRepeat(r,null),o.coord&&(o.coord!=n.mouselastcoord&&(e.shiftKey||r.range.hasrange||r.RangeAnchor(n.mousedowncoord),r.MoveECell(o.coord),r.RangeExtend()),n.mouselastcoord=o.coord,r.EditorMouseRange(o.coord),Re.StopPropagation(i)))))},Re.ProcessEditorMouseUp=function(e){var e=e||M.event,t=Re.EditorMouseInfo,o=t.editor;if(o&&!t.ignore){var i=t.element,n=Re.GetElementPositionWithScroll(o.toplevel),r=e.clientX-n.left,n=e.clientY-n.top,r=Re.GridMousePosition(o,r,n);if(Re.SetDragAutoRepeat(o,null),r)return r.coord||(r.coord=o.ecell.coord),o.range.hasrange?(o.MoveECell(r.coord),o.RangeExtend()):r.coord&&r.coord!=t.mousedowncoord&&(o.RangeAnchor(t.mousedowncoord),o.MoveECell(r.coord),o.RangeExtend()),o.EditorMouseRange(r.coord),t.editor=null,Re.RemoveMouseMoveUp(Re.ProcessEditorMouseMove,Re.ProcessEditorMouseUp,i,e),!1}},Re.ProcessEditorColsizeMouseDown=function(e,t,o){var e=e||M.event,i=Re.EditorMouseInfo,n=i.editor,r=Re.GetElementPositionWithScroll(n.toplevel),r=e.clientX-r.left;i.mouseresizecolnum=o.coltoresize,i.mouseresizecol=Re.rcColname(o.coltoresize),i.mousedownclientx=r,i.mousecoltounhide=o.coltounhide,o.coltoresize&&(r=document.createElement("div"),(i.mouseresizedisplay=r).style.width="auto",r.style.position="absolute",r.style.zIndex=100,r.style.top=n.headposition.top+"px",r.style.left=n.colpositions[o.coltoresize]+"px",r.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(n.context.colwidth[i.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+n.context.colwidth[i.mouseresizecolnum]+"</div></td></tr></table>",Re.setStyles(r.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;"),n.toplevel.appendChild(r)),Re.SetMouseMoveUp(Re.ProcessEditorColsizeMouseMove,Re.ProcessEditorColsizeMouseUp,n.toplevel,e)},Re.ProcessEditorColsizeMouseMove=function(e){var t,e=e||M.event,o=Re.EditorMouseInfo,i=o.editor;i&&(o.mouseresizecolnum&&(t=Re.GetElementPositionWithScroll(i.toplevel),t=e.clientX-t.left,(i=+i.context.colwidth[o.mouseresizecolnum]+(t-o.mousedownclientx))<Re.Constants.defaultMinimumColWidth&&(i=Re.Constants.defaultMinimumColWidth),(t=o.mouseresizedisplay).innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(i-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+i+"</div></td></tr></table>",Re.setStyles(t.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;")),Re.StopPropagation(e))},Re.ProcessEditorColsizeMouseUp=function(e){var t,e=e||M.event,o=Re.EditorMouseInfo,i=o.editor;if(i)return element=o.element,t=Re.GetElementPositionWithScroll(i.toplevel),t=e.clientX-t.left,Re.RemoveMouseMoveUp(Re.ProcessEditorColsizeMouseMove,Re.ProcessEditorColsizeMouseUp,i.toplevel,e),o.mousecoltounhide?i.EditorScheduleSheetCommands("set "+Re.rcColname(o.mousecoltounhide)+" hide",!0,!1):o.mouseresizecolnum&&((e=+i.context.colwidth[o.mouseresizecolnum]+(t-o.mousedownclientx))<Re.Constants.defaultMinimumColWidth&&(e=Re.Constants.defaultMinimumColWidth),i.EditorScheduleSheetCommands("set "+o.mouseresizecol+" width "+e,!0,!1),i.timeout&&M.clearTimeout(i.timeout),i.timeout=M.setTimeout(Re.FinishColRowSize,1)),!1},Re.FinishColRowSize=function(){var e=Re.EditorMouseInfo,t=e.editor;t&&(t.toplevel.removeChild(e.mouseresizedisplay),e.mouseresizedisplay=null,e.editor=null)},Re.ProcessEditorRowselectMouseDown=function(e,t,o){var e=e||M.event,i=Re.EditorMouseInfo.editor,n=Re.GetSpreadsheetControlObject().sheet;coord1=Re.crToCoord(1,o.row),coord2=Re.crToCoord(n.LastCol(),o.row),coord3=Re.crToCoord(i.firstscrollingcol,o.row),i.RangeAnchor(coord1),i.RangeExtend(coord2),i.MoveECell(coord3),Re.SetMouseMoveUp(Re.ProcessEditorRowselectMouseMove,Re.ProcessEditorRowselectMouseUp,i.toplevel,e)},Re.ProcessEditorRowselectMouseMove=function(e){var t,o,e=e||M.event,i=Re.EditorMouseInfo.editor,n=Re.GetSpreadsheetControlObject().sheet;i&&(t=Re.GetElementPositionWithScroll(i.toplevel),o=e.clientX-t.left,e=e.clientY-t.top,result=Re.GridMousePosition(i,o,e),coord2=Re.crToCoord(n.LastCol(),result.row),coord3=Re.crToCoord(i.firstscrollingcol,result.row),i.RangeExtend(coord2),i.MoveECell(coord3))},Re.ProcessEditorRowselectMouseUp=function(e){e||M.event;var t=Re.EditorMouseInfo.editor;t&&Re.RemoveMouseMoveUp(Re.ProcessEditorRowselectMouseMove,Re.ProcessEditorRowselectMouseUp,t.toplevel,e)},Re.ProcessEditorColselectMouseDown=function(e,t,o){var e=e||M.event,i=Re.EditorMouseInfo.editor,n=Re.GetSpreadsheetControlObject().sheet;coord1=Re.crToCoord(o.col,1),coord2=Re.crToCoord(o.col,n.LastRow()),coord3=Re.crToCoord(o.col,i.firstscrollingrow),i.RangeAnchor(coord1),i.RangeExtend(coord2),i.MoveECell(coord3),Re.SetMouseMoveUp(Re.ProcessEditorColselectMouseMove,Re.ProcessEditorColselectMouseUp,i.toplevel,e)},Re.ProcessEditorColselectMouseMove=function(e){var t,o,e=e||M.event,i=Re.EditorMouseInfo.editor,n=Re.GetSpreadsheetControlObject().sheet;i&&(t=Re.GetElementPositionWithScroll(i.toplevel),o=e.clientX-t.left,e=e.clientY-t.top,result=Re.GridMousePosition(i,o,e),coord2=Re.crToCoord(result.col,n.LastRow()),coord3=Re.crToCoord(result.col,i.firstscrollingrow),i.RangeExtend(coord2),i.MoveECell(coord3))},Re.ProcessEditorColselectMouseUp=function(e){e||M.event;var t=Re.EditorMouseInfo.editor;t&&Re.RemoveMouseMoveUp(Re.ProcessEditorColselectMouseMove,Re.ProcessEditorColselectMouseUp,t.toplevel,e)},Re.ProcessEditorRowsizeMouseDown=function(e,t,o){var e=e||M.event,i=Re.EditorMouseInfo,n=i.editor,r=Re.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,r=e.clientY-r;i.mouseresizerownum=o.rowtoresize,i.mouseresizerow=o.rowtoresize,i.mousedownclienty=r,i.mouserowtounhide=o.rowtounhide,o.rowtoresize&&(r=document.createElement("div"),(i.mouseresizedisplay=r).style.width=n.context.totalwidth+"px",r.style.height=n.rowpositions[o.rowtoresize]+"px",r.style.position="absolute",r.style.zIndex=100,r.style.top=n.rowpositions[o.rowtoresize]+"px",r.style.left=n.headposition.left+"px",r.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100pxborder:1px dashed black;background-color:white;height:'+(n.context.rowheight[i.mouseresizerownum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+n.context.rowheight[i.mouseresizerownum]+"</div></td></tr></table>",Re.setStyles(r.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;"),n.toplevel.appendChild(r)),Re.SetMouseMoveUp(Re.ProcessEditorRowsizeMouseMove,Re.ProcessEditorRowsizeMouseUp,n.toplevel,e)},Re.ProcessEditorRowsizeMouseMove=function(e){var t,e=e||M.event,o=Re.EditorMouseInfo,i=o.editor;i&&(o.mouseresizerownum&&(t=Re.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,t=e.clientY-t,(i=+i.context.rowheight[o.mouseresizerownum]+(t-o.mousedownclienty))<Re.Constants.defaultAssumedRowHeight&&(i=Re.Constants.defaultAssumedRowHeight),(t=o.mouseresizedisplay).innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100px;border:1px dashed black;background-color:white;height:'+(i-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+i+"</div></td></tr></table>",Re.setStyles(t.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;")),Re.StopPropagation(e))},Re.ProcessEditorRowsizeMouseUp=function(e){var t,e=e||M.event,o=Re.EditorMouseInfo,i=o.editor;if(i)return element=o.element,t=Re.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,t=e.clientY-t,Re.RemoveMouseMoveUp(Re.ProcessEditorRowsizeMouseMove,Re.ProcessEditorRowsizeMouseUp,i.toplevel,e),o.mouserowtounhide?i.EditorScheduleSheetCommands("set "+o.mouserowtounhide+" hide",!0,!1):o.mouseresizerownum&&((e=+i.context.rowheight[o.mouseresizerownum]+(t-o.mousedownclienty))<Re.Constants.defaultAssumedRowHeight&&(e=Re.Constants.defaultAssumedRowHeight),i.EditorScheduleSheetCommands("set "+o.mouseresizerownum+" height "+e,!0,!1),i.timeout&&M.clearTimeout(i.timeout),i.timeout=M.setTimeout(Re.FinishColRowSize,1)),!1},Re.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1e3,editor:null,repeatcallback:null},Re.SetDragAutoRepeat=function(e,t,o){var i,n,r=Re.AutoRepeatInfo;if(r.repeatcallback=o,!t)return r.timer&&(M.clearTimeout(r.timer),r.timer=null),void(r.mouseinfo=null);if(r.editor=e,r.mouseinfo&&(t.rowheader||t.rowfooter?t.row!=r.mouseinfo.row&&(i=Re.crToCoord(e.ecell.col,t.row),r.repeatcallback?(n=t.row<r.mouseinfo.row?"left":t.row>r.mouseinfo.row?"right":"",r.repeatcallback(i,n)):(e.MoveECell(i),e.MoveECell(i),e.RangeExtend(),e.EditorMouseRange(i))):(t.colheader||t.colfooter)&&t.col!=r.mouseinfo.col&&(i=Re.crToCoord(t.col,e.ecell.row),r.repeatcallback?(n=t.row<r.mouseinfo.row?"left":t.row>r.mouseinfo.row?"right":"",r.repeatcallback(i,n)):(e.MoveECell(i),e.RangeExtend(),e.EditorMouseRange(i)))),(r.mouseinfo=t).distance<5)r.repeatinterval=333;else if(t.distance<10)r.repeatinterval=250;else if(t.distance<25)r.repeatinterval=100;else{if(!(t.distance<35))return void(r.timer&&(M.clearTimeout(r.timer),r.timer=null));r.repeatinterval=75}r.timer||(r.timer=M.setTimeout(Re.DragAutoRepeat,r.repeatinterval))},Re.DragAutoRepeat=function(){var e,t,o=Re.AutoRepeatInfo,i=o.mouseinfo;i.rowheader?e="left":i.rowfooter?e="right":i.colheader?e="up":i.colfooter&&(e="down"),o.repeatcallback?(i=Re.coordToCr(o.editor.ecell.coord),"left"==e&&1<i.col?i.col--:"right"==e?i.col++:"up"==e&&1<i.row?i.row--:"down"==e&&i.row++,t=Re.crToCoord(i.col,i.row),o.repeatcallback(t,e)):(t=o.editor.MoveECellWithKey("[a"+e+"]shifted"))&&o.editor.EditorMouseRange(t),o.timer=M.setTimeout(Re.DragAutoRepeat,o.repeatinterval)},Re.ProcessEditorDblClick=function(e){var t,o,i,n,e=e||M.event,r=Re.EditorMouseInfo,s=e.target||e.srcElement;if(!r.ignore){for(t=null;!t&&s;s=s.parentNode)t=Re.LookupElement(s,r.registeredElements);t?(o=t.editor,i=Re.GetElementPositionWithScroll(o.toplevel),n=e.clientX-i.left,i=e.clientY-i.top,(n=Re.GridMousePosition(o,n,i))&&n.coord&&(r.editor=o,r.element=s,o.range,sheetobj=o.context.sheetobj,"start"===o.state&&Re.EditorOpenCellEdit(o),Re.StopPropagation(e))):r.editor=null}},Re.EditorOpenCellEdit=function(e){var t;return!e.ecell||(!e.inputBox||(!!e.inputBox.element.disabled||(e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(""),e.inputBox.DisplayCellContents(),e.inputBox.Select("end"),(t=e.workingvalues).partialexpr="",t.ecoord=e.ecell.coord,t.erow=e.ecell.row,void(t.ecol=e.ecell.col))))},Re.EditorProcessKey=function(e,t,o){e.context.sheetobj;var i,n,r,s=e.workingvalues,a=e.range;switch("string"!=typeof t&&(t=""),e.state){case"start":if(o.shiftKey&&"[a"==t.substr(0,2)&&(t+="shifted"),"[a"==(t="[tab]"==(t="[enter]"==t?"[adown]":t)?o.shiftKey?"[aleft]":"[aright]":t).substr(0,2)||"[pg"==t.substr(0,3)||"[home]"==t)return!e.MoveECellWithKey(t);if("[del]"==t||"[backspace]"==t){e.noEdit||e.ECellReadonly()||e.EditorApplySetCommandsToRange("empty","");break}if("[esc]"==t){if(a.hasrange)for(r in e.RangeRemove(),e.MoveECell(a.anchorcoord),e.StatusCallback)e.StatusCallback[r].func(e,"specialkey",t,e.StatusCallback[r].params);return!1}if("[f2]"==t)return!(!e.noEdit&&!e.ECellReadonly())||(Re.EditorOpenCellEdit(e),!(e.state="inputboxdirect"));if(1<t.length&&"["==t.substr(0,1)||0==t.length)return!(e.ctrlkeyFunction&&0<t.length)||e.ctrlkeyFunction(e,t);if(!e.ecell)return!0;if(!e.inputBox)return!0;if(e.ECellReadonly())return!0;e.inputBox.element.disabled=!1,e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(t),e.inputBox.Select("end"),s.partialexpr="",s.ecoord=e.ecell.coord,s.erow=e.ecell.row,s.ecol=e.ecell.col,e.RangeRemove();break;case"input":if(n=e.inputBox.GetText(),e.inputBox.skipOne)return!1;if("[esc]"==t||"[enter]"==t||"[tab]"==t||t&&"[a"==t.substr(0,2)){if((0<="(+-*/,:!&<>=^".indexOf(n.slice(-1))&&"="==n.slice(0,1)||"="==n)&&(s.partialexpr=n),s.partialexpr&&(o.shiftKey&&"[a"==t.substr(0,2)&&(t+="shifted"),i=e.MoveECellWithKey(t)))return a.hasrange?e.inputBox.SetText(s.partialexpr+Re.crToCoord(a.left,a.top)+":"+Re.crToCoord(a.right,a.bottom)):e.inputBox.SetText(s.partialexpr+i),!1;e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"!=t?(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[a"==(t="[tab]"==(t="[enter]"==t?"[adown]":t)?o.shiftKey?"[aleft]":"[aright]":t).substr(0,2)&&e.MoveECellWithKey(t)):(e.inputBox.DisplayCellContents(),e.RangeRemove(),e.MoveECell(s.ecoord));break}return s.partialexpr&&"[backspace]"==t?(e.inputBox.SetText(s.partialexpr),s.partialexpr="",e.RangeRemove(),e.MoveECell(s.ecoord),e.inputBox.ShowInputBox(!0),!1):"[f2]"==t?!(e.state="inputboxdirect"):(a.hasrange&&e.RangeRemove(),e.MoveECell(s.ecoord),s.partialexpr&&(e.inputBox.ShowInputBox(!0),s.partialexpr=""),!0);case"inputboxdirect":if(n=e.inputBox.GetText(),"[esc]"!=t&&"[enter]"!=t&&"[tab]"!=t)return"[f2]"!=t||!(e.state="input");e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"==t?e.inputBox.DisplayCellContents():(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[a"==(t="[tab]"==(t="[enter]"==t?"[adown]":t)?o.shiftKey?"[aleft]":"[aright]":t).substr(0,2)&&e.MoveECellWithKey(t));break;case"skip-and-start":return e.state="start",e.cellhandles.ShowCellHandles(!0),!1;default:return!0}return!1},Re.EditorAddToInput=function(e,t,o){var i=e.workingvalues;if(!e.noEdit&&!e.ECellReadonly())switch(e.state){case"start":e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.element.disabled=!1,e.inputBox.Focus(),e.inputBox.SetText((o||"")+t),e.inputBox.Select("end"),i.partialexpr="",i.ecoord=e.ecell.coord,i.erow=e.ecell.row,i.ecol=e.ecell.col,e.RangeRemove();break;case"input":case"inputboxdirect":e.inputBox.element.focus(),i.partialexpr&&(e.inputBox.SetText(i.partialexpr),i.partialexpr="",e.RangeRemove(),e.MoveECell(i.ecoord)),e.inputBox.SetText(e.inputBox.GetText()+t)}},Re.EditorDisplayCellContents=function(e){e.inputBox&&e.inputBox.DisplayCellContents()},Re.EditorSaveEdit=function(e,t){var o,i,n=e.context.sheetobj,r=e.workingvalues,s="text t",t="string"==typeof t?t:e.inputBox.GetText();t!=Re.GetCellContents(n,r.ecoord)+""&&("="==(i=t.charAt(0))&&-1==t.indexOf("\n")?(s="formula",t=t.substring(1)):"'"==i?(s="text t",t=t.substring(1),"t"==(o=Re.DetermineValueType(t)).type.charAt(0)&&(s="text "+o.type)):s=0==t.length?"empty":"n"==(o=Re.DetermineValueType(t)).type&&t==o.value+""?"value n":"t"==o.type.charAt(0)?"text "+o.type:""==o.type?"text t":"constant "+o.type+" "+o.value,"t"==s.charAt(0)&&(t=Re.encodeForSave(t)),i="set "+r.ecoord+" "+s+" "+t,e.EditorScheduleSheetCommands(i,!0,!1),void 0!==n.ioEventTree&&void 0!==n.ioParameterList&&void 0!==n.ioEventTree[r.ecoord]&&Re.EditedTriggerCell(n.ioEventTree[r.ecoord],r.ecoord,e,n))},Re.EditedTriggerCell=function(e,t,o,i){for(var n in e){var r=i.ioParameterList[n];if(void 0!==r)switch(r.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":cmdline="setemailparameters "+n+" "+t,o.deferredEmailCommands.push({cmdstr:cmdline,saveundo:!1})}}},Re.EditorApplySetCommandsToRange=function(e,t){e.context.sheetobj;var o=e.ecell,i=e.range;i=i.hasrange?"set "+(coord=Re.crToCoord(i.left,i.top)+":"+Re.crToCoord(i.right,i.bottom))+" "+t:"set "+o.coord+" "+t,e.EditorScheduleSheetCommands(i,!0,!1);e.DisplayCellContents()},Re.EditorProcessMouseWheel=function(e,t,o,i){i.functionobj.editor.busy||(0<t&&i.functionobj.editor.ScrollRelative(!0,Math.floor(1.5*-t)),t<0&&i.functionobj.editor.ScrollRelative(!0,Math.ceil(1.5*-t)))},Re.GridMousePosition=function(e,t,o){for(var i,n,r,s,a,l={},c=1;c<e.rowpositions.length&&!(e.rowheight[c]&&e.rowpositions[c]+e.rowheight[c]>o);c++);for(n=1;n<e.colpositions.length&&!(e.colwidth[n]&&e.colpositions[n]+e.colwidth[n]>t);n++);if(l.row=c,l.col=n,e.headposition&&1!=Re._app){if(t<e.headposition.left&&t>=e.gridposition.left){for(l.rowheader=!0,l.distance=e.headposition.left-t,l.rowtoresize=!1,l.rowselect=!1,s=1;s<e.rowpositions.length;s++)if(e.rowheight[s]&&e.rowpositions[s]+e.rowheight[s]-3<=o&&e.rowpositions[s]+e.rowheight[s]+3>=o){l.rowtoresize=s;break}if((unhide=e.context.rowunhidetop[c])&&t>=(pos=Re.GetElementPosition(unhide)).left&&t<pos.left+unhide.offsetWidth&&o>=e.rowpositions[c]+e.rowheight[c]-unhide.offsetHeight&&o<e.rowpositions[c]+e.rowheight[c]&&(l.rowtounhide=c+1),(unhide=e.context.rowunhidebottom[c])&&t>=(pos=Re.GetElementPosition(unhide)).left&&t<pos.left+unhide.offsetWidth&&o>=e.rowpositions[c]&&o<e.rowpositions[c]+unhide.offsetHeight&&(l.rowtounhide=c-1),null==l.rowtounhide){for(i=0;i<e.context.rowpanes.length;i++)if(l.rowtoresize>=e.context.rowpanes[i].first&&l.rowtoresize<=e.context.rowpanes[i].last)return l;l.rowselect=!0}return delete l.rowtoresize,l}if(o<e.headposition.top&&o>e.gridposition.top){for(l.colheader=!0,l.distance=e.headposition.top-o,l.coltoresize=!1,l.colselect=!1,a=1;a<e.colpositions.length;a++)if(e.colwidth[a]&&e.colpositions[a]+e.colwidth[a]-3<=t&&e.colpositions[a]+e.colwidth[a]+3>=t){l.coltoresize=a;break}if((unhide=e.context.colunhideleft[n])&&t>=(pos=Re.GetElementPosition(unhide)).left&&t<pos.left+unhide.offsetWidth&&o>=pos.top&&o<pos.top+unhide.offsetHeight&&(l.coltounhide=n+1),(unhide=e.context.colunhideright[n])&&t>=(pos=Re.GetElementPosition(unhide)).left&&t<pos.left+unhide.offsetWidth&&o>=pos.top&&o<pos.top+unhide.offsetHeight&&(l.coltounhide=n-1),null==l.coltounhide){for(r=0;r<e.context.colpanes.length;r++)if(l.coltoresize>=e.context.colpanes[r].first&&l.coltoresize<=e.context.colpanes[r].last)return l;l.colselect=!0}return delete l.coltoresize,l}return t>=e.verticaltablecontrol.controlborder?(l.rowfooter=!0,l.distance=t-e.verticaltablecontrol.controlborder):o>=e.horizontaltablecontrol.controlborder?(l.colfooter=!0,l.distance=o-e.horizontaltablecontrol.controlborder):t<e.gridposition.left?(l.rowheader=!0,l.distance=e.headposition.left-t):o<=e.gridposition.top?(l.colheader=!0,l.distance=e.headposition.top-o):(l.coord=Re.crToCoord(l.col,l.row),e.context.cellskip[l.coord]&&(l.coord=e.context.cellskip[l.coord])),l}return null},Re.GetEditorCellElement=function(e,t,o){for(var i,n,r,s=0,a=0,l=(0==e.context.showRCHeaders&&(a=s=-1),0),c=0,u=0;u<e.context.rowpanes.length;u++){if(t>=e.context.rowpanes[u].first&&t<=e.context.rowpanes[u].last)for(i=0;i<e.context.colpanes.length;i++){if(o>=e.context.colpanes[i].first&&o<=e.context.colpanes[i].last){for(l+=t-e.context.rowpanes[u].first+2,n=e.context.colpanes[i].first;n<=o;n++)(r=e.context.cellskip[Re.crToCoord(n,t)])&&e.context.CoordInPane(r,u,i)||c++;return{element:e.griddiv.firstChild.lastChild.childNodes[l+a].childNodes[c+s],rowpane:u,colpane:i}}for(n=e.context.colpanes[i].first;n<=e.context.colpanes[i].last;n++)(r=e.context.cellskip[Re.crToCoord(n,t)])&&e.context.CoordInPane(r,u,i)||c++;c+=1}l+=e.context.rowpanes[u].last-e.context.rowpanes[u].first+1+1}return null},Re.MoveECellWithKey=function(e,t){var o,i,n,r=!1,s=1;if(!e.ecell)return null;switch("shifted"==t.slice(-7)&&(t=t.slice(0,-7),r=!0),o=e.ecell.row,i=e.ecell.col,n=e.context.sheetobj.cells[e.ecell.coord],t){case"[adown]":o+=n&&n.rowspan||1;break;case"[aup]":o--,s=-1;break;case"[pgdn]":o+=e.pageUpDnAmount-1+(n&&n.rowspan||1);break;case"[pgup]":o-=e.pageUpDnAmount,s=-1;break;case"[aright]":i+=n&&n.colspan||1;break;case"[aleft]":i--,s=-1;break;case"[home]":i=o=1;break;default:return null}for(e.context.sheetobj.attribs.usermaxcol&&(i=Math.min(e.context.sheetobj.attribs.usermaxcol,i)),e.context.sheetobj.attribs.usermaxrow&&(o=Math.min(e.context.sheetobj.attribs.usermaxrow,o));"yes"==e.context.sheetobj.colattribs.hide[Re.rcColname(i)];)(i+=s)<1&&(s=-s,i=1);for(;"yes"==e.context.sheetobj.rowattribs.hide[o];)(o+=s)<1&&(s=-s,o=1);return e.range.hasrange||r&&e.RangeAnchor(),t=e.MoveECell(Re.crToCoord(i,o)),e.range.hasrange&&(r?e.RangeExtend():e.RangeRemove()),t},Re.MoveECell=function(e,t){var o,i,n=e.context.highlights,r=Re.coordToCr(t);if(e.context.sheetobj.attribs.usermaxcol&&r.col>e.context.sheetobj.attribs.usermaxcol&&(r.col=e.context.sheetobj.attribs.usermaxcol),e.context.sheetobj.attribs.usermaxrow&&r.row>e.context.sheetobj.attribs.usermaxrow&&(r.row=e.context.sheetobj.attribs.usermaxrow),t=Re.crToCoord(r.col,r.row),e.ecell){if(e.ecell.coord==t)return t;o=Re.GetEditorCellElement(e,e.ecell.row,e.ecell.col),delete n[e.ecell.coord],e.range2.hasrange&&e.ecell.row>=e.range2.top&&e.ecell.row<=e.range2.bottom&&e.ecell.col>=e.range2.left&&e.ecell.col<=e.range2.right&&(n[e.ecell.coord]="range2"),e.UpdateCellCSS(o,e.ecell.row,e.ecell.col),e.SetECellHeaders(""),e.cellhandles&&e.cellhandles.ShowCellHandles(!1)}for(i in t=e.context.cellskip[t]||t,e.ecell=Re.coordToCr(t),e.ecell.coord=t,o=Re.GetEditorCellElement(e,e.ecell.row,e.ecell.col),n[t]="cursor",e.MoveECellCallback)e.MoveECellCallback[i](e);for(i in e.UpdateCellCSS(o,e.ecell.row,e.ecell.col),e.SetECellHeaders("selected"),e.StatusCallback)e.StatusCallback[i].func(e,"moveecell",t,e.StatusCallback[i].params);return e.busy?e.ensureecell=!0:(e.ensureecell=!1,e.EnsureECellVisible()),t},Re.EnsureECellVisible=function(e){var t=0,o=0;e.ecell.row>e.lastnonscrollingrow&&(e.ecell.row<e.firstscrollingrow?t=e.ecell.row-e.firstscrollingrow-Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2):e.ecell.row+1>e.lastvisiblerow&&(t=e.ecell.row-e.lastvisiblerow+Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2))),e.ecell.col>e.lastnonscrollingcol&&(e.ecell.col<e.firstscrollingcol?o=e.ecell.col-e.firstscrollingcol-Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2):e.ecell.col+1>e.lastvisiblecol&&(o=e.ecell.col-e.lastvisiblecol+Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2))),0!=t||0!=o?e.ScrollRelativeBoth(t,o):e.cellhandles.ShowCellHandles(!0)},Re.ReplaceCell=function(e,t,o,i){var n,r;if(t&&(n=e.context.RenderCell(o,i,t.rowpane,t.colpane,!0,null))&&t.element)for(r in t.element.innerHTML=n.innerHTML,t.element.style.cssText="",t.element.className=n.className,n.style)"cssText"!=n.style[r]&&(t.element.style[r]=n.style[r])},Re.UpdateCellCSS=function(e,t,o,i){var n,r;if(t&&(n=e.context.RenderCell(o,i,t.rowpane,t.colpane,!0,null)))for(r in t.element.style.cssText="",t.element.className=n.className,n.style)"cssText"!=n.style[r]&&(t.element.style[r]=n.style[r])},Re.SetECellHeaders=function(e,t){if(!1!==e.context.showRCHeaders){var o,i,n,r=e.ecell,s=e.context,a=0,l=0;if(r){for(;"yes"==s.sheetobj.colattribs.hide[Re.rcColname(r.col)];)r.col++;for(;"yes"==s.sheetobj.rowattribs.hide[r.row];)r.row++;for(r.coord=Re.crToCoord(r.col,r.row),o=0;o<s.rowpanes.length;o++){var c,u=s.rowpanes[o].first,d=s.rowpanes[o].last;r.row>=u&&r.row<=d&&(c=2+a+r.row-u,null!==e.fullgrid&&0<=c&&(n=e.fullgrid.childNodes[1].childNodes[c].childNodes[0])&&(s.classnames&&(n.className=s.classnames[t+"rowname"]),s.explicitStyles&&(n.style.cssText=s.explicitStyles[t+"rowname"]),n.style.verticalAlign="top")),a+=d-u+1+1}for(i=0;i<s.colpanes.length;i++)u=s.colpanes[i].first,d=s.colpanes[i].last,r.col>=u&&r.col<=d&&(c=1+l+r.col-u,null!==e.fullgrid&&0<=c&&(n=e.fullgrid.childNodes[1].childNodes[1].childNodes[c])&&(s.classnames&&(n.className=s.classnames[t+"colname"]),s.explicitStyles&&(n.style.cssText=s.explicitStyles[t+"colname"]))),l+=d-u+1+1}}},Re.ECellReadonly=function(e,t){if(!(t=!t&&e.ecell?e.ecell.coord:t))return!1;e=e.context.sheetobj.cells[t];return e&&e.readonly},Re.RangeAnchor=function(e,t){e.range.hasrange&&e.RangeRemove(),e.RangeExtend(t)},Re.RangeExtend=function(e,t){var o,i,n,r,s,a,l,c=e.context.highlights,u=e.range,d=e.range2;if(t?(l=Re.coordToCr(t)).coord=t:l=e.ecell,l){for(n in u.hasrange||(u.anchorcoord=l.coord,u.anchorrow=l.row,u.top=l.row,u.bottom=l.row,u.anchorcol=l.col,u.left=l.col,u.right=l.col,u.hasrange=!0),u.anchorrow<l.row?(u.top=u.anchorrow,u.bottom=l.row):(u.top=l.row,u.bottom=u.anchorrow),u.anchorcol<l.col?(u.left=u.anchorcol,u.right=l.col):(u.left=l.col,u.right=u.anchorcol),c)switch(c[n]){case"range":c[n]="unrange";break;case"range2":c[n]="unrange2"}for(r=u.top;r<=u.bottom;r++)for(s=u.left;s<=u.right;s++)switch(c[n=Re.crToCoord(s,r)]){case"unrange":c[n]="range";break;case"cursor":break;default:c[n]="newrange"}for(r=d.top;d.hasrange&&r<=d.bottom;r++)for(s=d.left;s<=d.right;s++)switch(c[n=Re.crToCoord(s,r)]){case"unrange2":c[n]="range2";break;case"range":case"newrange":case"cursor":break;default:c[n]="newrange2"}for(n in c){switch(c[n]){case"unrange":delete c[n];break;case"newrange":c[n]="range";break;case"newrange2":c[n]="range2";break;case"range":case"range2":case"cursor":continue}i=Re.coordToCr(n),o=Re.GetEditorCellElement(e,i.row,i.col),e.UpdateCellCSS(o,i.row,i.col)}for(a in e.RangeChangeCallback)e.RangeChangeCallback[a](e);for(a in n=Re.crToCoord(e.range.left,e.range.top),e.range.left==e.range.right&&e.range.top==e.range.bottom||(n+=":"+Re.crToCoord(e.range.right,e.range.bottom)),e.StatusCallback)e.StatusCallback[a].func(e,"rangechange",n,e.StatusCallback[a].params)}},Re.RangeRemove=function(e){var t,o,i,n,r,s,a=e.context.highlights,l=e.range,c=e.range2;if(l.hasrange||c.hasrange){for(n=c.top;c.hasrange&&n<=c.bottom;n++)for(r=c.left;r<=c.right;r++)switch(a[i=Re.crToCoord(r,n)]){case"range":a[i]="newrange2";break;case"range2":case"cursor":break;default:a[i]="newrange2"}for(i in a){switch(a[i]){case"range":delete a[i];break;case"newrange2":a[i]="range2";break;case"cursor":continue}o=Re.coordToCr(i),t=Re.GetEditorCellElement(e,o.row,o.col),e.UpdateCellCSS(t,o.row,o.col)}for(s in l.hasrange=!1,e.RangeChangeCallback)e.RangeChangeCallback[s](e);for(s in e.StatusCallback)e.StatusCallback[s].func(e,"rangechange","",e.StatusCallback[s].params)}},Re.Range2Remove=function(e){var t,o,i,n=e.context.highlights,r=e.range2;if(r.hasrange){for(i in n){switch(n[i]){case"range2":delete n[i];break;case"range":case"cursor":continue}o=Re.coordToCr(i),t=Re.GetEditorCellElement(e,o.row,o.col),e.UpdateCellCSS(t,o.row,o.col)}r.hasrange=!1}},Re.FitToEditTable=function(e){var t,o,i,n,r,s,a,l=e.context,c=l.sheetobj,u=(c.colattribs,l.showRCHeaders?+l.rownamewidth:0);for(colpane=0;colpane<l.colpanes.length-1;colpane++)for(t=l.colpanes[colpane].first;t<=l.colpanes[colpane].last;t++)o=Re.rcColname(t),"yes"!=c.colattribs.hide[o]&&(u+=(i="blank"!=(i=c.colattribs.width[o]||c.attribs.defaultcolwidth||Re.Constants.defaultColWidth)&&"auto"!=i?i:"")&&0<+i?+i:10);for(t=l.colpanes[colpane].first;t<=1e4&&(o=Re.rcColname(t),"yes"!=c.colattribs.hide[o]&&(u+=(i="blank"!=(i=c.colattribs.width[o]||c.attribs.defaultcolwidth||Re.Constants.defaultColWidth)&&"auto"!=i?i:"")&&0<+i?+i:10),!(u>e.tablewidth));t++);l.colpanes[colpane].last=l.sheetobj.attribs.usermaxcol||t;for(var d=l.rowpanes[0].first,h=l.sheetobj.attribs.lastrow;"yes"==c.rowattribs.hide[d]&&d<h;)d++;for(l.rowpanes[0].first=d,n=l.showRCHeaders?1:0,s=0;s<l.rowpanes.length-1;s++)for(n+=l.rowpanes[s].last-l.rowpanes[s].first+1,r=l.rowpanes[s].first;r<=l.rowpanes[s].last;r++)"yes"==c.rowattribs.hide[r]&&n--;a=e.tableheight-n*l.pixelsPerRow,l.rowpanes[s].last=l.sheetobj.attribs.usermaxrow||l.rowpanes[s].first+Math.floor(a/l.pixelsPerRow)+1},Re.CalculateEditorPositions=function(e){e.gridposition=Re.GetElementPosition(e.griddiv);var t,o,i,n=e.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];for(e.headposition=Re.GetElementPosition(n),e.headposition.left+=n.offsetWidth,e.headposition.top+=n.offsetHeight,e.rowpositions=[],t=0;t<e.context.rowpanes.length;t++)e.CalculateRowPositions(t,e.rowpositions,e.rowheight);for(i=0;i<e.rowpositions.length&&!(e.rowpositions[i]>e.gridposition.top+e.tableheight);i++);for(e.lastvisiblerow=i-1,e.colpositions=[],o=0;o<e.context.colpanes.length;o++)e.CalculateColPositions(o,e.colpositions,e.colwidth);for(i=0;i<e.colpositions.length&&!(e.colpositions[i]>e.gridposition.left+e.tablewidth);i++);for(e.lastvisiblecol=i-1,e.firstscrollingrow=e.context.rowpanes[e.context.rowpanes.length-1].first;"yes"==e.context.sheetobj.rowattribs.hide[e.firstscrollingrow];)e.firstscrollingrow++;for(e.firstscrollingrowtop=e.rowpositions[e.firstscrollingrow]||e.headposition.top,e.lastnonscrollingrow=0<e.context.rowpanes.length-1?e.context.rowpanes[e.context.rowpanes.length-2].last:0,e.firstscrollingcol=e.context.colpanes[e.context.colpanes.length-1].first;"yes"==e.context.sheetobj.colattribs.hide[Re.rcColname(e.firstscrollingcol)];)e.firstscrollingcol++;e.firstscrollingcolleft=e.colpositions[e.firstscrollingcol]||e.headposition.left,e.lastnonscrollingcol=0<e.context.colpanes.length-1?e.context.colpanes[e.context.colpanes.length-2].last:0,e.verticaltablecontrol.ComputeTableControlPositions(),e.horizontaltablecontrol.ComputeTableControlPositions()},Re.ScheduleRender=function(e){1!=e.ignoreRender&&(e.timeout&&M.clearTimeout(e.timeout),Re.EditorSheetStatusCallback(null,"schedrender",null,e),e.timeout=M.setTimeout(function(){Re.DoRenderStep(e)},1))},Re.DoRenderStep=function(e){e.timeout=null,e.EditorRenderSheet(),Re.EditorSheetStatusCallback(null,"renderdone",null,e),Re.EditorSheetStatusCallback(null,"schedposcalc",null,e),e.timeout=M.setTimeout(function(){Re.DoPositionCalculations(e)},1)},Re.SchedulePositionCalculations=function(e){Re.EditorSheetStatusCallback(null,"schedposcalc",null,e),e.timeout=M.setTimeout(function(){Re.DoPositionCalculations(e)},1)},Re.DoPositionCalculations=function(e){e.timeout=null,e.CalculateEditorPositions(),e.verticaltablecontrol.PositionTableControlElements(),e.horizontaltablecontrol.PositionTableControlElements(),Re.EditorSheetStatusCallback(null,"doneposcalc",null,e),e.ensureecell&&e.ecell&&!e.deferredCommands.length&&(e.ensureecell=!1,e.EnsureECellVisible()),e.cellhandles.ShowCellHandles(!0)},Re.CalculateRowPositions=function(e,t,o,i){var n,r,s,a,l,c,u=e.context;u.sheetobj;if(u.showRCHeaders){for(c=e.fullgrid.lastChild,n=2,r=0;r<t;r++)n+=u.rowpanes[r].last-u.rowpanes[r].first+2;for(a=0,s=u.rowpanes[r].first;s<=u.rowpanes[r].last;s++)l=c.childNodes[n+a],a++,!l||o[s]||(o[s]=l.firstChild.offsetTop,i[s]=l.firstChild.offsetHeight)}},Re.CalculateColPositions=function(e,t,o,i){var n,r,s,a,l,c,u=e.context;u.sheetobj;if(u.showRCHeaders){for(e=e.fullgrid.lastChild,n=1,r=0;r<t;r++)n+=u.colpanes[r].last-u.colpanes[r].first+2;for(l=e.childNodes[1],a=0,s=u.colpanes[r].first;s<=u.colpanes[r].last;s++)c=Re.GetElementPosition(l.childNodes[n+a]),o[s]||(o[s]=c.left,l.childNodes[n+a]&&(i[s]=l.childNodes[n+a].offsetWidth)),a++}},Re.ScrollRelative=function(e,t,o){t?e.ScrollRelativeBoth(o,0):e.ScrollRelativeBoth(0,o)},Re.ScrollRelativeBoth=function(e,t,o){var i=e.context,n=0<t?1:-1,r=0<o?1:-1,s=i.rowpanes.length,a=1<s?i.rowpanes[s-2].last+1:1,l=(i.rowpanes[s-1].first+t<a&&(t=-i.rowpanes[s-1].first+a),i.colpanes.length),a=1<l?i.colpanes[l-2].last+1:1;for(i.colpanes[l-1].first+o<a&&(o=-i.colpanes[l-1].first+a);"yes"==i.sheetobj.colattribs.hide[Re.rcColname(i.colpanes[l-1].first+o)];)if((o+=r)<1){o=0;break}for(;"yes"==i.sheetobj.rowattribs.hide[i.rowpanes[s-1].first+t];)if((t+=n)<1){t=0;break}if((1==t||-1==t)&&0==o)return 1==t?e.ScrollTableUpOneRow():e.ScrollTableDownOneRow(),e.ecell&&e.SetECellHeaders("selected"),void e.SchedulePositionCalculations();0==t&&0==o||(i.rowpanes[s-1].first+=t,i.rowpanes[s-1].last+=t,i.colpanes[l-1].first+=o,i.colpanes[l-1].last+=o,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender())},Re.PageRelative=function(e,t,o){var i,n,r,s=e.context,a=t?"rowpanes":"colpanes",s=s[a][s[a].length-1],a=t?"lastvisiblerow":"lastvisiblecol",l=t?e.rowheight:e.colwidth,c=t?Re.Constants.defaultAssumedRowHeight:Re.Constants.defaultColWidth;if(0<o)(n=e[a])==s.first&&(n+=1);else{for(r=t?e.tableheight-(e.firstscrollingrowtop-e.gridposition.top):e.tablewidth-(e.firstscrollingcolleft-e.gridposition.left),r-=0<l[e[a]]?l[e[a]]:c,n=s.first-1;0<n&&!(r<(i=0<l[n]?l[n]:c));n--)r-=i;(n=(o=s.first)<=n?o-1:n)<1&&(n=1)}s.first=n,s.last=n+1,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender()},Re.LimitLastPanes=function(e){var e=e.context,t=e.rowpanes.length;1<t&&e.rowpanes[t-1].first<=e.rowpanes[t-2].last&&(e.rowpanes[t-1].first=e.rowpanes[t-2].last+1),e.sheetobj.attribs.usermaxrow&&e.rowpanes[t-1].first>e.sheetobj.attribs.usermaxrow&&(e.rowpanes[t-1].first=e.sheetobj.attribs.usermaxrow),1<(t=e.colpanes.length)&&e.colpanes[t-1].first<=e.colpanes[t-2].last&&(e.colpanes[t-1].first=e.colpanes[t-2].last+1),e.sheetobj.attribs.usermaxcol&&e.colpanes[t-1].first>e.sheetobj.attribs.usermaxcol&&(e.colpanes[t-1].first=e.sheetobj.attribs.usermaxcol)},Re.ScrollTableUpOneRow=function(e){for(var t,o,i,n,r,s,a,l,c={},u=e.context,d=u.sheetobj,h=e.fullgrid,p=h.lastChild,f=u.showRCHeaders?2:1,m=0;m<u.rowpanes.length-1;m++)f+=u.rowpanes[m].last-u.rowpanes[m].first+2;if(u.sheetobj.attribs.usermaxrow&&u.sheetobj.attribs.usermaxrow-u.rowpanes[m].first<1)return h;for(p.removeChild(p.childNodes[f]),u.rowpanes[m].first++,u.rowpanes[m].last++,e.FitToEditTable(),u.CalculateColWidthData(),u.sheetobj.attribs.usermaxrow&&u.rowpanes[m].last==u.sheetobj.attribs.usermaxrow||(e=u.RenderRow(u.rowpanes[m].last,m),p.appendChild(e)),maxrowspan=1,r=u.rowpanes[m].first-1,i=0;i<u.colpanes.length;i++)for(o=u.colpanes[i].first;o<=u.colpanes[i].last;o++)coord=Re.crToCoord(o,r),u.cellskip[coord]||(n=d.cells[coord])&&n.rowspan>maxrowspan&&(maxrowspan=n.rowspan);if(1<maxrowspan)for(t=1;t<maxrowspan&&!(t+r>=u.rowpanes[m].last);t++)s=u.RenderRow(t+r,m),a=p.childNodes[f+t-1],p.replaceChild(s,a);for(l=u.rowpanes[m].last,i=0;i<u.colpanes.length;i++)for(o=u.colpanes[i].first;o<=u.colpanes[i].last;o++)!(coord=u.cellskip[Re.crToCoord(o,l)])||(t=+u.coordToCR[coord].row)==u.rowpanes[m].last||t<u.rowpanes[m].first||(n=d.cells[coord])&&1<n.rowspan&&(c[t]=!0);for(t in c)s=u.RenderRow(t,m),a=p.childNodes[f+(t-u.rowpanes[m].first)],p.replaceChild(s,a);return h},Re.ScrollTableDownOneRow=function(e){for(var t,o,i,n,r,s,a,l,c={},u=e.context,d=u.sheetobj,h=e.fullgrid,p=h.lastChild,f=u.showRCHeaders?2:1,m=0;m<u.rowpanes.length-1;m++)f+=u.rowpanes[m].last-u.rowpanes[m].first+2;for(u.sheetobj.attribs.usermaxrow||p.removeChild(p.childNodes[f+(u.rowpanes[m].last-u.rowpanes[m].first)]),u.rowpanes[m].first--,u.rowpanes[m].last--,e.FitToEditTable(),u.CalculateColWidthData(),s=u.RenderRow(u.rowpanes[m].first,m),p.insertBefore(s,p.childNodes[f]),maxrowspan=1,r=u.rowpanes[m].first,i=0;i<u.colpanes.length;i++)for(o=u.colpanes[i].first;o<=u.colpanes[i].last;o++)coord=Re.crToCoord(o,r),u.cellskip[coord]||(n=d.cells[coord])&&n.rowspan>maxrowspan&&(maxrowspan=n.rowspan);if(1<maxrowspan)for(t=1;t<maxrowspan&&!(t+r>u.rowpanes[m].last);t++)s=u.RenderRow(t+r,m),a=p.childNodes[f+t],p.replaceChild(s,a);for(l=u.rowpanes[m].last,i=0;i<u.colpanes.length;i++)for(o=u.colpanes[i].first;o<=u.colpanes[i].last;o++)coord=Re.crToCoord(o,l),(n=d.cells[coord])&&1<n.rowspan?c[l]=!0:!(coord=u.cellskip[Re.crToCoord(o,l)])||(t=+u.coordToCR[coord].row)==l||t<u.rowpanes[m].first||(n=d.cells[coord])&&1<n.rowspan&&(c[t]=!0);for(t in c)s=u.RenderRow(t,m),a=p.childNodes[f+(t-u.rowpanes[m].first)],p.replaceChild(s,a);return h},Re.InputBox=function(e,t){e&&(this.element=e,this.editor=t,this.inputEcho=null,t.inputBox=this,e.onmousedown=Re.InputBoxOnMouseDown,t.MoveECellCallback.formulabar=function(e){"start"==e.state&&t.inputBox.DisplayCellContents(e.ecell.coord)})},Re.InputBox.prototype.DisplayCellContents=function(e){Re.InputBoxDisplayCellContents(this,e)},Re.InputBox.prototype.ShowInputBox=function(e){this.editor.inputEcho.ShowInputEcho(e)},Re.InputBox.prototype.GetText=function(){return this.element.value},Re.InputBox.prototype.SetText=function(e){this.element&&(this.element.value=e,this.editor.inputEcho.SetText(e+"_"))},Re.InputBox.prototype.Focus=function(){Re.InputBoxFocus(this)},Re.InputBox.prototype.Blur=function(){return this.element.blur()},Re.InputBox.prototype.Select=function(e){if(this.element&&"end"===e)if(document.selection&&document.selection.createRange)try{var t=document.selection.createRange().duplicate();t.moveToElementText(this.element),t.collapse(!1),t.select()}catch(e){null!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else null!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)},Re.InputBoxDisplayCellContents=function(e,t){var o=Re.Constants;if(e){if(!t){if(!e.editor)return;if(!e.editor.ecell)return;t=e.editor.ecell.coord}t=Re.GetCellContents(e.editor.context.sheetobj,t);-1!=t.indexOf("\n")?(t=o.s_inputboxdisplaymultilinetext,e.element.disabled=!0):e.editor.ECellReadonly()?e.element.disabled=!0:e.element.disabled=!1,e.SetText(t)}},Re.InputBoxFocus=function(e){var t;e&&(e.element.focus(),(e=e.editor).state="input",(t=e.workingvalues).partialexpr="",t.ecoord=e.ecell.coord,t.erow=e.ecell.row,t.ecol=e.ecell.col)},Re.InputBoxOnMouseDown=function(e){var t=Re.Keyboard.focusTable;if(!t)return!0;var o=t.workingvalues;switch(t.state){case"start":t.state="inputboxdirect",o.partialexpr="",o.ecoord=t.ecell.coord,o.erow=t.ecell.row,o.ecol=t.ecell.col,t.inputEcho.ShowInputEcho(!0);break;case"input":o.partialexpr="",t.MoveECell(o.ecoord),t.state="inputboxdirect",Re.KeyboardFocus()}},Re.InputEcho=function(e){var t=Re.Constants;this.editor=e,this.text="",this.interval=null,this.container=null,this.main=null,this.prompt=null,this.hint=null,this.functionbox=null,this.container=document.createElement("div"),Re.setStyles(this.container,"display:none;position:absolute;zIndex:10;"),this.main=document.createElement("div"),t.defaultInputEchoClass&&(this.main.className=t.defaultInputEchoClass),t.defaultInputEchoStyle&&Re.setStyles(this.main,t.defaultInputEchoStyle),this.main.innerHTML="&nbsp;",this.hint=document.createElement("div"),t.defaultInputEchoHintClass&&(this.hint.className=t.defaultInputEchoHintClass),t.defaultInputEchoHintStyle&&Re.setStyles(this.hint,t.defaultInputEchoHintStyle),this.hint.innerHTML="",this.container.appendChild(this.hint),this.container.appendChild(this.main),this.prompt=document.createElement("div"),t.defaultInputEchoPromptClass&&(this.prompt.className=t.defaultInputEchoPromptClass),t.defaultInputEchoPromptStyle&&Re.setStyles(this.prompt,t.defaultInputEchoPromptStyle),this.prompt.innerHTML="",this.container.appendChild(this.prompt),Re.DragRegister(this.main,!0,!0,{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null,positionobj:this.container},this.editor.toplevel),e.toplevel.appendChild(this.container)},Re.InputEcho.prototype.ShowInputEcho=function(e){return Re.ShowInputEcho(this,e)},Re.InputEcho.prototype.SetText=function(e){return Re.SetInputEchoText(this,e)},Re.ShowInputEcho=function(e,t){var o=e.editor;o&&(t?(o.cellhandles.ShowCellHandles(!1),(t=Re.GetEditorCellElement(o,o.ecell.row,o.ecell.col))&&(t=Re.GetElementPosition(t.element),e.container.style.left=t.left-1+"px",e.container.style.top=t.top-1+"px"),e.hint.innerHTML=o.ecell.coord,e.container.style.display="block",e.interval&&M.clearInterval(e.interval),e.interval=M.setInterval(Re.InputEchoHeartbeat,50)):(e.interval&&M.clearInterval(e.interval),e.container.style.display="none"))},Re.SetInputEchoText=function(e,t){var o=Re.Constants,i=(i=Re.special_chars(t)).replace(/\n/g,"<br>"),i=(e.text!=i&&(e.main.innerHTML=i,e.text=i),t.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-Za-z][\w\.]*?)\([^\)]*$/));"="==t.charAt(0)&&i?(t=i[1].toUpperCase(),i=Re.Formula.FunctionList[t]?(Re.Formula.FillFunctionInfo(),Re.special_chars(t+"("+Re.Formula.FunctionArgString(t)+")")):o.ietUnknownFunction+t,e.prompt.innerHTML!=i&&(e.prompt.innerHTML=i,e.prompt.style.display="block")):"none"!=e.prompt.style.display&&(e.prompt.innerHTML="",e.prompt.style.display="none")},Re.InputEchoHeartbeat=function(){var e=Re.Keyboard.focusTable;if(!e)return!0;e.inputEcho.SetText(e.inputBox.GetText()+"_")},Re.InputEchoMouseDown=function(e){e||M.event;e=Re.Keyboard.focusTable;if(!e)return!0;e.inputBox.element.focus()},Re.CellHandles=function(e){Re.Constants;if(!e.noEdit){this.editor=e,this.noCursorSuffix=!1,this.movedmouse=!1,this.draghandle=document.createElement("div"),Re.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;"),this.draghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.draghandle),Re.AssignID(e,this.draghandle,"draghandle");var t="png";if(navigator.userAgent.match(/MSIE 6\.0/)&&(t="gif"),this.dragpalette=document.createElement("div"),Re.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+Re.Constants.defaultImagePrefix+"drag-handles."+t+");"),this.dragpalette.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragpalette),Re.AssignID(e,this.dragpalette,"dragpalette"),this.dragtooltip=document.createElement("div"),Re.setStyles(this.dragtooltip,"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;"),this.dragtooltip.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragtooltip),Re.AssignID(e,this.dragtooltip,"dragtooltip"),this.fillinghandle=document.createElement("div"),Re.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;"),this.fillinghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.fillinghandle),Re.AssignID(e,this.fillinghandle,"fillinghandle"),this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",Re.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",Re.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",Re.CellHandlesMouseMoveOnHandle,!1);else{if(!this.draghandle.attachEvent)throw"Browser not supported";this.draghandle.attachEvent("onmousemove",Re.CellHandlesMouseMoveOnHandle),this.dragpalette.attachEvent("onmousedown",Re.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",Re.CellHandlesMouseMoveOnHandle)}}},Re.CellHandles.prototype.ShowCellHandles=function(e,t){return Re.ShowCellHandles(this,e,t)},Re.ShowCellHandles=function(e,t,o){var i,n,r,s=e.editor,a=!1,l=1,c=1;if(s&&s.ecell){do{if(!t)break;if(n=s.ecell.row,r=s.ecell.col,"start"!=s.state)break;if(n>=s.lastvisiblerow)break;if(r>=s.lastvisiblecol)break;if(n<s.firstscrollingrow)break;if(r<s.firstscrollingcol)break;for(;"yes"==s.context.sheetobj.colattribs.hide[Re.rcColname(r+l)];)l++;for(;"yes"==s.context.sheetobj.rowattribs.hide[n+c];)c++}while((void 0!==(i=s.context.sheetobj.cells[Re.crToCoord(r+l-1,n+c-1)])&&(l+=(i.colspan||1)-1,c+=(i.rowspan||1)-1),!(s.rowpositions[n+c]+20>s.horizontaltablecontrol.controlborder))&&(!(s.rowpositions[n+c]-10<s.headposition.top)&&(!(s.colpositions[r+l]+20>s.verticaltablecontrol.controlborder)&&(!(s.colpositions[r+l]-30<s.headposition.left)&&(e.draghandle.style.left=s.colpositions[r+l]-1+"px",e.draghandle.style.top=s.rowpositions[n+c]-1+"px",e.draghandle.style.display="block",o&&(e.draghandle.style.display="none",e.dragpalette.style.left=s.colpositions[r+l]-45+"px",e.dragpalette.style.top=s.rowpositions[n+c]-45+"px",e.dragpalette.style.display="block",e.dragtooltip.style.left=s.colpositions[r+l]-45+"px",e.dragtooltip.style.top=s.rowpositions[n+c]+45+"px",e.dragtooltip.style.display="none"),a=!0,0)))));a||(e.draghandle.style.display="none"),o||(e.dragpalette.style.display="none",e.dragtooltip.style.display="none")}},Re.CellHandlesMouseMoveOnHandle=function(e){var t=Re.Constants,e=e||M.event,o=e.target||e.srcElement,i=Re.Keyboard.focusTable;if(!i)return!0;var n=i.cellhandles;if(!n.editor)return!0;var r=Re.GetElementPositionWithScroll(i.toplevel),s=e.clientX-r.left,e=e.clientY-r.top;if(!i.cellhandles.mouseDown){if(i.cellhandles.ShowCellHandles(!0,!0),o==n.dragpalette)if(0==Re.SegmentDivHit([t.CH_radius1,t.CH_radius2],i.cellhandles.dragpalette,s,e))return void Re.CellHandlesHoverTimeout();n.timer&&(M.clearTimeout(n.timer),n.timer=null),n.timer=M.setTimeout(Re.CellHandlesHoverTimeout,3e3)}},Re.SegmentDivHit=function(e,t,o,i){var n=t.offsetWidth,r=t.offsetHeight,s=t.offsetLeft,a=t.offsetTop,l=0,c=e,t=Math.sqrt(Math.pow(o-s-(n/2-.5),2)+Math.pow(i-a-(r/2-.5),2));if(2==c.length)return s<=o&&o<s+n/2&&a<=i&&i<a+r/2&&(t<=e[0]?l=-1:t<=e[1]&&(l=1)),s+n/2<=o&&o<s+n&&a<=i&&i<a+r/2&&(t<=e[0]?l=-2:t<=e[1]&&(l=2)),s+n/2<=o&&o<s+n&&a+r/2<=i&&i<a+r&&(t<=e[0]?l=-3:t<=e[1]&&(l=3)),s<=o&&o<s+n/2&&a+r/2<=i&&i<a+r&&(t<=e[0]?l=-4:t<=e[1]&&(l=4)),l;for(;;)if(s<=o&&o<s+n/2&&a<=i&&i<a+r/2){if(quadrant+="1","number"==typeof(l=c[0]))break;c=l,n/=2,r/=2}else if(s+n/2<=o&&o<s+n&&a<=i&&i<a+r/2){if(quadrant+="2","number"==typeof(l=c[1]))break;c=l,s+=n/=2,r/=2}else if(s+n/2<=o&&o<s+n&&a+r/2<=i&&i<a+r){if(quadrant+="3","number"==typeof(l=c[2]))break;c=l,s+=n/=2,a+=r/=2}else{if(!(s<=o&&o<s+n/2&&a+r/2<=i&&i<a+r))return 0;if(quadrant+="4","number"==typeof(l=c[3]))break;c=l,n/=2,a+=r/=2}return l},Re.CellHandlesHoverTimeout=function(){if(!(editor=Re.Keyboard.focusTable))return!0;var e=editor.cellhandles;e.timer&&(M.clearTimeout(e.timer),e.timer=null),editor.cellhandles.ShowCellHandles(!0,!1)},Re.CellHandlesMouseDown=function(e){var t,o=Re.Constants,e=e||M.event,i=Re.EditorMouseInfo,n=Re.Keyboard.focusTable;if(!n)return!0;if(!n.busy){var r=n.cellhandles,s=(r.movedmouse=!1,Re.GetElementPositionWithScroll(n.toplevel)),a=e.clientX-s.left,s=e.clientY-s.top,l=(r.timer&&(M.clearTimeout(r.timer),r.timer=null),r.dragtooltip.innerHTML="&nbsp;",r.dragtooltip.style.display="none",t=n.range,Re.SegmentDivHit([o.CH_radius1,o.CH_radius2],n.cellhandles.dragpalette,a,s));if(1==l||-1==l||0==l)r.ShowCellHandles(!0,!1);else{switch(i.ignore=!0,-3==l?(r.dragtype="Fill",r.noCursorSuffix=!1):3==l?(r.dragtype="FillC",r.noCursorSuffix=!1):-2==l?(r.dragtype="Move",r.noCursorSuffix=!0):-4==l?(r.dragtype="MoveI",r.noCursorSuffix=!1):2==l?(r.dragtype="MoveC",r.noCursorSuffix=!0):4==l&&(r.dragtype="MoveIC",r.noCursorSuffix=!1),r.filltype=null,r.dragtype){case"Fill":case"FillC":t.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0;break;case"Move":case"MoveI":case"MoveC":case"MoveIC":t.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0,n.RangeRemove();break;default:return}r.fillinghandle.style.left=a+"px",r.fillinghandle.style.top=s-17+"px",r.fillinghandle.innerHTML=o.s_CHindicatorOperationLookup[r.dragtype]+(o.s_CHindicatorDirectionLookup[n.cellhandles.filltype]||""),r.fillinghandle.style.display="block",r.ShowCellHandles(!0,!1),r.mouseDown=!0,l=(i.editor=n).ecell.coord,r.startingcoord=l,r.startingX=a,r.startingY=s,i.mouselastcoord=l,Re.KeyboardSetFocus(n),document.addEventListener?(document.addEventListener("mousemove",Re.CellHandlesMouseMove,!0),document.addEventListener("mouseup",Re.CellHandlesMouseUp,!0)):r.draghandle.attachEvent&&(r.draghandle.setCapture(),r.draghandle.attachEvent("onmousemove",Re.CellHandlesMouseMove),r.draghandle.attachEvent("onmouseup",Re.CellHandlesMouseUp),r.draghandle.attachEvent("onlosecapture",Re.CellHandlesMouseUp)),Re.StopPropagation(e)}}},Re.CellHandlesMouseMove=function(e){var t,o,i,n,r=Re.Constants,e=e||M.event,s=Re.EditorMouseInfo,a=s.editor;if(a){var l,c=a.cellhandles,u=(s.element,Re.GetElementPositionWithScroll(a.toplevel)),d=e.clientX-u.left,h=e.clientY-u.top;if(l=Re.GridMousePosition(a,d,h))if(l&&!l.coord)Re.SetDragAutoRepeat(a,l,Re.CellHandlesDragAutoRepeat);else if(Re.SetDragAutoRepeat(a,null),l.coord){switch(t=Re.coordToCr(a.cellhandles.startingcoord),o=Re.coordToCr(l.coord),c.movedmouse=!0,c.dragtype){case"Fill":case"FillC":l.coord==c.startingcoord?(c.filltype=null,c.startingX=d,c.startingY=h):c.filltype?"Down"==c.filltype?(o.col=t.col,o.row<t.row&&(o.row=t.row)):(o.row=t.row,o.col<t.col&&(o.col=t.col)):(10<Math.abs(h-c.startingY)?c.filltype="Down":10<Math.abs(d-c.startingX)&&(c.filltype="Right"),o.col=t.col,o.row=t.row),l.coord=Re.crToCoord(o.col,o.row),l.coord!=s.mouselastcoord&&(a.MoveECell(l.coord),a.RangeExtend());break;case"Move":case"MoveC":l.coord!=s.mouselastcoord&&(a.MoveECell(l.coord),i=a.range2.right-a.range2.left+l.col,n=a.range2.bottom-a.range2.top+l.row,a.RangeAnchor(Re.crToCoord(i,n)),a.RangeExtend());break;case"MoveI":case"MoveIC":l.coord==c.startingcoord?(c.filltype=null,c.startingX=d,c.startingY=h):c.filltype?"Vertical"==c.filltype?(o.col=a.range2.left,o.row>=a.range2.top&&o.row<=a.range2.bottom+1&&(o.row=a.range2.bottom+2)):(o.row=a.range2.top,o.col>=a.range2.left&&o.col<=a.range2.right+1&&(o.col=a.range2.right+2)):(10<Math.abs(h-c.startingY)?c.filltype="Vertical":10<Math.abs(d-c.startingX)&&(c.filltype="Horizontal"),o.col=t.col,o.row=t.row),l.coord=Re.crToCoord(o.col,o.row),l.coord!=s.mouselastcoord&&(a.MoveECell(l.coord),c.filltype?(i=a.range2.right-a.range2.left+o.col,n=a.range2.bottom-a.range2.top+o.row,a.RangeAnchor(Re.crToCoord(i,n)),a.RangeExtend()):a.RangeRemove())}c.fillinghandle.style.left=d+"px",c.fillinghandle.style.top=h-17+"px",c.fillinghandle.innerHTML=r.s_CHindicatorOperationLookup[c.dragtype]+(r.s_CHindicatorDirectionLookup[a.cellhandles.filltype]||""),c.fillinghandle.style.display="block",s.mouselastcoord=l.coord,Re.StopPropagation(e)}}},Re.CellHandlesDragAutoRepeat=function(e,t){var o=Re.EditorMouseInfo,i=o.editor;if(i){var n,r,s,a=i.cellhandles,l=Re.coordToCr(i.cellhandles.startingcoord),c=Re.coordToCr(e),u=0,d=0;switch("left"==t?d=-1:"right"==t?d=1:"up"==t?u=-1:"down"==t&&(u=1),i.ScrollRelativeBoth(u,d),a.dragtype){case"Fill":case"FillC":a.filltype?"Down"==a.filltype?(c.col=l.col,c.row<l.row&&(c.row=l.row)):(c.row=l.row,c.col<l.col&&(c.col=l.col)):(c.col=l.col,c.row=l.row),(n=Re.crToCoord(c.col,c.row))!=o.mouselastcoord&&(i.MoveECell(e),i.RangeExtend());break;case"Move":case"MoveC":e!=o.mouselastcoord&&(i.MoveECell(e),r=i.range2.right-i.range2.left+i.ecell.col,s=i.range2.bottom-i.range2.top+i.ecell.row,i.RangeAnchor(Re.crToCoord(r,s)),i.RangeExtend());break;case"MoveI":case"MoveIC":a.filltype?"Vertical"==a.filltype?(c.col=i.range2.left,c.row>=i.range2.top&&c.row<=i.range2.bottom+1&&(c.row=i.range2.bottom+2)):(c.row=i.range2.top,c.col>=i.range2.left&&c.col<=i.range2.right+1&&(c.col=i.range2.right+2)):(c.col=l.col,c.row=l.row),(n=Re.crToCoord(c.col,c.row))!=o.mouselastcoord&&(i.MoveECell(n),r=i.range2.right-i.range2.left+c.col,s=i.range2.bottom-i.range2.top+c.row,i.RangeAnchor(Re.crToCoord(r,s)),i.RangeExtend())}o.mouselastcoord=n}},Re.CellHandlesMouseUp=function(e){var t,o,i,n,r,s,e=e||M.event,a=Re.EditorMouseInfo,l=a.editor;if(l){var c=l.cellhandles,u=(a.element,a.ignore=!1,Re.GetElementPositionWithScroll(l.toplevel)),d=e.clientX-u.left,u=e.clientY-u.top,h=Re.GridMousePosition(l,d,u);switch(Re.SetDragAutoRepeat(l,null),c.mouseDown=!1,c.noCursorSuffix=!1,c.fillinghandle.style.display="none",(h=h||{}).coord||(h.coord=l.ecell.coord),c.dragtype){case"Fill":case"Move":case"MoveI":t=" all";break;case"FillC":case"MoveC":case"MoveIC":t=" formulas"}switch(c.movedmouse||(c.dragtype="Nothing"),c.dragtype){case"Nothing":l.Range2Remove(),l.RangeRemove();break;case"Fill":case"FillC":o=Re.coordToCr(c.startingcoord),i=Re.coordToCr(h.coord),c.filltype&&("Down"==c.filltype?i.col=o.col:i.row=o.row),h.coord=Re.crToCoord(i.col,i.row),l.MoveECell(h.coord),l.RangeExtend(),o="fill"+("Right"==l.cellhandles.filltype?"right":"down")+" "+Re.crToCoord(l.range.left,l.range.top)+":"+Re.crToCoord(l.range.right,l.range.bottom)+t,l.EditorScheduleSheetCommands(o,!0,!1);break;case"Move":case"MoveC":l.context.cursorsuffix="",o="movepaste "+Re.crToCoord(l.range2.left,l.range2.top)+":"+Re.crToCoord(l.range2.right,l.range2.bottom)+" "+l.ecell.coord+t,l.EditorScheduleSheetCommands(o,!0,!1),l.Range2Remove();break;case"MoveI":case"MoveIC":l.context.cursorsuffix="",i=l.range2.right-l.range2.left,n=l.range2.bottom-l.range2.top,r=l.ecell.col-l.range2.left,s=l.ecell.row-l.range2.top,o="moveinsert "+Re.crToCoord(l.range2.left,l.range2.top)+":"+Re.crToCoord(l.range2.right,l.range2.bottom)+" "+l.ecell.coord+t,l.EditorScheduleSheetCommands(o,!0,!1),l.Range2Remove(),l.RangeRemove()," Horizontal"==l.cellhandles.filltype&&0<r?l.MoveECell(Re.crToCoord(l.ecell.col-i-1,l.ecell.row)):" Vertical"==l.cellhandles.filltype&&0<s&&l.MoveECell(Re.crToCoord(l.ecell.col,l.ecell.row-n-1)),l.RangeAnchor(Re.crToCoord(l.ecell.col+i,l.ecell.row+n)),l.RangeExtend()}return Re.RemoveMouseMoveUp(Re.CellHandlesMouseMove,Re.CellHandlesMouseUp,c.draghandle,e),a.editor=null,!1}},Re.TableControl=function(e,t,o){var i=Re.Constants;this.editor=e,this.vertical=t,this.size=o,this.main=null,this.endcap=null,this.paneslider=null,this.lessbutton=null,this.morebutton=null,this.scrollarea=null,this.thumb=null,this.controlborder=null,this.endcapstart=null,this.panesliderstart=null,this.lessbuttonstart=null,this.morebuttonstart=null,this.scrollareastart=null,this.scrollareaend=null,this.scrollareasize=null,this.thumbpos=null,this.controlthickness=i.defaultTableControlThickness,this.sliderthickness=i.defaultTCSliderThickness,this.buttonthickness=i.defaultTCButtonThickness,this.thumbthickness=i.defaultTCThumbThickness,this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20},Re.TableControl.prototype.CreateTableControl=function(){return Re.CreateTableControl(this)},Re.TableControl.prototype.PositionTableControlElements=function(){Re.PositionTableControlElements(this)},Re.TableControl.prototype.ComputeTableControlPositions=function(){Re.ComputeTableControlPositions(this)},Re.CreateTableControl=function(e){var t,o,i=Re.AssignID,n=Re.setStyles,r=Re.Constants,s=e.editor.imageprefix,a=e.vertical?"v":"h",l=Re.LocalizeString;return e.main=document.createElement("div"),(t=e.main.style).height=(e.vertical?e.size:e.controlthickness)+"px",t.width=(e.vertical?e.controlthickness:e.size)+"px",t.zIndex=0,n(e.main,r.TCmainStyle),t.backgroundImage="url("+s+"main-"+a+".gif)",r.TCmainClass&&(e.main.className=r.TCmainClass),e.main.style.display="none",e.endcap=document.createElement("div"),(t=e.endcap.style).height=e.controlthickness+"px",t.width=e.controlthickness+"px",t.zIndex=1,t.overflow="hidden",t.position="absolute",n(e.endcap,r.TCendcapStyle),t.backgroundImage="url("+s+"endcap-"+a+".gif)",r.TCendcapClass&&(e.endcap.className=r.TCendcapClass),i(e.editor,e.endcap,"endcap"+a),e.main.appendChild(e.endcap),e.paneslider=document.createElement("div"),(t=e.paneslider.style).height=(e.vertical?e.sliderthickness:e.controlthickness)+"px",t.overflow="hidden",t.width=(e.vertical?e.controlthickness:e.sliderthickness)+"px",t.position="absolute",t[e.vertical?"top":"left"]="4px",t.zIndex=3,t.backgroundImage="url("+s+"paneslider-"+a+".gif)",r.TCpanesliderClass&&(e.paneslider.className=r.TCpanesliderClass),i(e.editor,e.paneslider,"paneslider"+a),e.paneslider.title=l(e.vertical?"Drag to lock pane horizontally":"Drag to lock pane vertically"),(l={MouseDown:Re.TCPSDragFunctionStart,MouseMove:Re.TCPSDragFunctionMove,MouseUp:Re.TCPSDragFunctionStop,Disabled:function(){return e.editor.busy}}).control=e,1!=Re._app&&Re.DragRegister(e.paneslider,e.vertical,!e.vertical,l,e.editor.toplevel),e.main.appendChild(e.paneslider),e.lessbutton=document.createElement("div"),(t=e.lessbutton.style).height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",t.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",t.zIndex=2,t.overflow="hidden",t.position="absolute",n(e.lessbutton,r.TClessbuttonStyle),t.backgroundImage="url("+s+"less-"+a+"n.gif)",r.TClessbuttonClass&&(e.lessbutton.className=r.TClessbuttonClass),i(e.editor,e.lessbutton,"lessbutton"+a),o={repeatwait:r.TClessbuttonRepeatWait,repeatinterval:r.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+s+"less-"+a+"n.gif);",downstyle:"backgroundImage:url("+s+"less-"+a+"d.gif);",hoverstyle:"backgroundImage:url("+s+"less-"+a+"h.gif);"},Re.ButtonRegister(e.editor,e.lessbutton,o,l={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Disabled:function(){return e.editor.busy}}),e.main.appendChild(e.lessbutton),e.morebutton=document.createElement("div"),(t=e.morebutton.style).height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",t.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",t.zIndex=2,t.overflow="hidden",t.position="absolute",n(e.morebutton,r.TCmorebuttonStyle),t.backgroundImage="url("+s+"more-"+a+"n.gif)",r.TCmorebuttonClass&&(e.morebutton.className=r.TCmorebuttonClass),i(e.editor,e.morebutton,"morebutton"+a),o={repeatwait:r.TCmorebuttonRepeatWait,repeatinterval:r.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+s+"more-"+a+"n.gif);",downstyle:"backgroundImage:url("+s+"more-"+a+"d.gif);",hoverstyle:"backgroundImage:url("+s+"more-"+a+"h.gif);"},Re.ButtonRegister(e.editor,e.morebutton,o,l={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Disabled:function(){return e.editor.busy}}),e.main.appendChild(e.morebutton),e.scrollarea=document.createElement("div"),(t=e.scrollarea.style).height=e.controlthickness+"px",t.width=e.controlthickness+"px",t.zIndex=1,t.overflow="hidden",t.position="absolute",n(e.scrollarea,r.TCscrollareaStyle),t.backgroundImage="url("+s+"scrollarea-"+a+".gif)",r.TCscrollareaClass&&(e.scrollarea.className=r.TCscrollareaClass),i(e.editor,e.scrollarea,"scrollarea"+a),o={repeatwait:r.TCscrollareaRepeatWait,repeatinterval:r.TCscrollareaRepeatWait},(l={MouseDown:Re.ScrollAreaClick,Repeat:Re.ScrollAreaClick,Disabled:function(){return e.editor.busy}}).control=e,Re.ButtonRegister(e.editor,e.scrollarea,o,l),e.main.appendChild(e.scrollarea),e.thumb=document.createElement("div"),(t=e.thumb.style).height=(e.vertical?e.thumbthickness:e.controlthickness)+"px",t.width=(e.vertical?e.controlthickness:e.thumbthickness)+"px",t.zIndex=2,t.overflow="hidden",t.position="absolute",n(e.thumb,r.TCthumbStyle),e.thumb.style.backgroundImage="url("+s+"thumb-"+a+"n.gif)",r.TCthumbClass&&(e.thumb.className=r.TCthumbClass),i(e.editor,e.thumb,"thumb"+a),(l={MouseDown:Re.TCTDragFunctionStart,MouseMove:Re.TCTDragFunctionMove,MouseUp:Re.TCTDragFunctionStop,Disabled:function(){return e.editor.busy}}).control=e,1!=Re._app&&Re.DragRegister(e.thumb,e.vertical,!e.vertical,l,e.editor.toplevel),Re.ButtonRegister(e.editor,e.thumb,{normalstyle:"backgroundImage:url("+s+"thumb-"+a+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+s+"thumb-"+a+"d.gif)",hoverstyle:"backgroundImage:url("+s+"thumb-"+a+"h.gif)"},null),e.main.appendChild(e.thumb),e.main},Re.ScrollAreaClick=function(e,t,o){var o=o.functionobj.control,i=Re.GetElementPositionWithScroll(o.editor.toplevel),t=o.vertical?t.clientY-i.top:t.clientX-i.left;o.editor.busy||o.editor.PageRelative(o.vertical,t>o.thumbpos?1:-1)},Re.PositionTableControlElements=function(e){var t,o,i,n=e.editor;e.vertical?(t=e.controlborder+"px",e.endcap.style.top=e.endcapstart+"px",e.endcap.style.left=t,e.paneslider.style.top=e.panesliderstart+"px",e.paneslider.style.left=t,e.lessbutton.style.top=e.lessbuttonstart+"px",e.lessbutton.style.left=t,e.morebutton.style.top=e.morebuttonstart+"px",e.morebutton.style.left=t,e.scrollarea.style.top=e.scrollareastart+"px",e.scrollarea.style.left=t,e.scrollarea.style.height=e.scrollareasize+"px",o=Math.max(n.context.sheetobj.attribs.lastrow,n.firstscrollingrow+1),i=(n.firstscrollingrow-(n.lastnonscrollingrow+1))*(e.scrollareasize-3*e.thumbthickness)/(o-(n.lastnonscrollingrow+1))+e.scrollareastart-1,i=Math.floor(i),e.thumb.style.top=i+"px",e.thumb.style.left=t):(t=e.controlborder+"px",e.endcap.style.left=e.endcapstart+"px",e.endcap.style.top=t,e.paneslider.style.left=e.panesliderstart+"px",e.paneslider.style.top=t,e.lessbutton.style.left=e.lessbuttonstart+"px",e.lessbutton.style.top=t,e.morebutton.style.left=e.morebuttonstart+"px",e.morebutton.style.top=t,e.scrollarea.style.left=e.scrollareastart+"px",e.scrollarea.style.top=t,e.scrollarea.style.width=e.scrollareasize+"px",o=Math.max(n.context.sheetobj.attribs.lastcol,n.firstscrollingcol+1),i=(n.firstscrollingcol-(n.lastnonscrollingcol+1))*(e.scrollareasize-e.thumbthickness)/(o-n.lastnonscrollingcol)+e.scrollareastart-1,i=Math.floor(i),e.thumb.style.left=i+"px",e.thumb.style.top=t),e.thumbpos=i,e.main.style.display="block"},Re.ComputeTableControlPositions=function(e){var t=e.editor;if(!t.gridposition||!t.headposition)throw"Can't compute table control positions before editor positions";e.vertical?(e.controlborder=t.gridposition.left+t.tablewidth,e.endcapstart=t.gridposition.top,e.panesliderstart=t.firstscrollingrowtop-e.sliderthickness,e.lessbuttonstart=t.firstscrollingrowtop-1,e.morebuttonstart=t.gridposition.top+t.tableheight-e.buttonthickness,e.scrollareastart=t.firstscrollingrowtop-1+e.buttonthickness):(e.controlborder=t.gridposition.top+t.tableheight,e.endcapstart=t.gridposition.left,e.panesliderstart=t.firstscrollingcolleft-e.sliderthickness,e.lessbuttonstart=t.firstscrollingcolleft-1,e.morebuttonstart=t.gridposition.left+t.tablewidth-e.buttonthickness,e.scrollareastart=t.firstscrollingcolleft-1+e.buttonthickness),e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1},Re.TCPSDragFunctionStart=function(e,t,o){var i=o.functionobj.control.editor,n=Re.Constants;Re.DragFunctionStart(e,t,o),t.trackingline=document.createElement("div"),t.trackingline.style.height=o.vertical?n.TCPStrackinglineThickness:i.tableheight-(i.headposition.top-i.gridposition.top)+"px",t.trackingline.style.width=o.vertical?i.tablewidth-(i.headposition.left-i.gridposition.left)+"px":n.TCPStrackinglineThickness,t.trackingline.style.backgroundImage="url("+i.imageprefix+"trackingline-"+(o.vertical?"v":"h")+".gif)",n.TCPStrackinglineClass&&(t.trackingline.className=n.TCPStrackinglineClass),Re.setStyles(t.trackingline,n.TCPStrackinglineStyle),o.vertical?(row=Re.Lookup(t.clientY+o.functionobj.control.sliderthickness,i.rowpositions),t.trackingline.style.top=(i.rowpositions[row]||i.headposition.top)+"px",t.trackingline.style.left=i.headposition.left+"px",t.trackingline.id="trackingline-vertical",i.context.rowpanes.length-1&&(i.context.SetRowPaneFirstLast(1,i.context.rowpanes[0].last+1,i.context.rowpanes[0].last+1),i.FitToEditTable(),i.ScheduleRender())):(col=Re.Lookup(t.clientX+o.functionobj.control.sliderthickness,i.colpositions),t.trackingline.style.top=i.headposition.top+"px",t.trackingline.style.left=(i.colpositions[col]||i.headposition.left)+"px",t.trackingline.id="trackingline-horizon",i.context.colpanes.length-1&&(i.context.SetColPaneFirstLast(1,i.context.colpanes[0].last+1,i.context.colpanes[0].last+1),i.FitToEditTable(),i.ScheduleRender())),i.griddiv.appendChild(t.trackingline)},Re.TCPSDragFunctionMove=function(e,t,o){var i,n,r,s,a=o.functionobj.control,l=a.sliderthickness,c=a.editor;if(o.vertical){for(r=a.morebuttonstart-a.minscrollingpanesize-t.offsetY,t.clientY>r&&(t.clientY=r),s=c.headposition.top-l-t.offsetY,t.clientY<s&&(t.clientY=s),i=Re.Lookup(t.clientY+l,c.rowpositions);"yes"==c.context.sheetobj.rowattribs.hide[i];)i++;t.trackingline.style.top=(c.rowpositions[i]||c.headposition.top)+"px"}else{for(r=a.morebuttonstart-a.minscrollingpanesize-t.offsetX,t.clientX>r&&(t.clientX=r),s=c.headposition.left-l-t.offsetX,t.clientX<s&&(t.clientX=s),n=Re.Lookup(t.clientX+l,c.colpositions);"yes"==c.context.sheetobj.colattribs.hide[Re.rcColname(n)];)n++;t.trackingline.style.left=(c.colpositions[n]||c.headposition.left)+"px"}Re.DragFunctionPosition(e,t,o)},Re.TCPSDragFunctionStop=function(e,t,o){var i,n,r,s,a=o.functionobj.control,l=a.sliderthickness,c=a.editor;if(o.vertical){for(r=a.morebuttonstart-a.minscrollingpanesize-t.offsetY,t.clientY>r&&(t.clientY=r),s=c.headposition.top-l-t.offsetY,t.clientY<s&&(t.clientY=s),(i=Re.Lookup(t.clientY+l,c.rowpositions))>c.context.sheetobj.attribs.lastrow&&(i=c.context.sheetobj.attribs.lastrow);"yes"==c.context.sheetobj.rowattribs.hide[i];)i++;c.EditorScheduleSheetCommands("pane row "+i,!0,!1)}else{for(r=a.morebuttonstart-a.minscrollingpanesize-t.offsetX,t.clientX>r&&(t.clientX=r),s=c.headposition.left-l-t.offsetX,t.clientX<s&&(t.clientX=s),(n=Re.Lookup(t.clientX+l,c.colpositions))>c.context.sheetobj.attribs.lastcol&&(n=c.context.sheetobj.attribs.lastcol);"yes"==c.context.sheetobj.colattribs.hide[Re.rcColname(n)];)n++;c.EditorScheduleSheetCommands("pane col "+n,!0,!1)}},Re.TCTDragFunctionStart=function(e,t,o){var i=o.functionobj.control,n=i.editor,r=Re.Constants;Re.DragFunctionStart(e,t,o),t.thumbstatus&&(t.thumbstatus.rowmsgele&&(t.thumbstatus.rowmsgele=null),t.thumbstatus.rowpreviewele&&(t.thumbstatus.rowpreviewele=null),n.toplevel.removeChild(t.thumbstatus),t.thumbstatus=null),t.thumbstatus=document.createElement("div"),o.vertical?(r.TCTDFSthumbstatusvClass&&(t.thumbstatus.className=r.TCTDFSthumbstatusvClass),Re.setStyles(t.thumbstatus,r.TCTDFSthumbstatusvStyle),t.thumbstatus.style.top=t.clientY+r.TCTDFStopOffsetv+"px",t.thumbstatus.style.left=i.controlborder-10-n.tablewidth/2+"px",t.thumbstatus.style.width=n.tablewidth/2+"px",t.thumbcontext=new Re.RenderContext(n.context.sheetobj),t.thumbcontext.showGrid=!0,t.thumbcontext.rowpanes=[{first:1,last:1}],e=n.context.colpanes[n.context.colpanes.length-1],t.thumbcontext.colpanes=[{first:e.first,last:e.last}],t.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+r.TCTDFSthumbstatusrownumStyle+'" class="'+r.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>',t.thumbstatus.rowmsgele=t.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,t.thumbstatus.rowpreviewele=t.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,n.toplevel.appendChild(t.thumbstatus),Re.TCTDragFunctionRowSetStatus(t,n,n.firstscrollingrow||1)):(r.TCTDFSthumbstatushClass&&(t.thumbstatus.className=r.TCTDFSthumbstatushClass),Re.setStyles(t.thumbstatus,r.TCTDFSthumbstatushStyle),t.thumbstatus.style.top=i.controlborder+r.TCTDFStopOffseth+"px",t.thumbstatus.style.left=t.clientX+r.TCTDFSleftOffseth+"px",n.toplevel.appendChild(t.thumbstatus),t.thumbstatus.innerHTML=r.s_TCTDFthumbstatusPrefixh+Re.rcColname(n.firstscrollingcol))},Re.TCTDragFunctionRowSetStatus=function(e,t,o){var i=Re.Constants.s_TCTDFthumbstatusPrefixv+o+" ";e.thumbstatus.rowmsgele.innerHTML=i,e.thumbcontext.rowpanes=[{first:o,last:o}],e.thumbrowshown=o,e.thumbcontext.RenderSheet(e.thumbstatus.rowpreviewele.firstChild,{type:"html"})},Re.TCTDragFunctionMove=function(e,t,o){var i,n=o.functionobj.control,r=(n.thumbthickness,n.editor),s=Re.Constants;o.vertical?(t.clientY>n.scrollareaend-t.offsetY-n.thumbthickness+2&&(t.clientY=n.scrollareaend-t.offsetY-n.thumbthickness+2),t.clientY<n.scrollareastart-t.offsetY-1&&(t.clientY=n.scrollareastart-t.offsetY-1),t.thumbstatus.style.top=t.clientY+"px",i=(t.clientY+t.offsetY-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastrow-r.lastnonscrollingrow)+r.lastnonscrollingrow+1,(i=(i=(i=Math.floor(i))<=r.lastnonscrollingrow?r.lastnonscrollingrow+1:i)>r.context.sheetobj.attribs.lastrow?r.context.sheetobj.attribs.lastrow:i)!=t.thumbrowshown&&Re.TCTDragFunctionRowSetStatus(t,r,i)):(t.clientX>n.scrollareaend-t.offsetX-n.thumbthickness+2&&(t.clientX=n.scrollareaend-t.offsetX-n.thumbthickness+2),t.clientX<n.scrollareastart-t.offsetX-1&&(t.clientX=n.scrollareastart-t.offsetX-1),t.thumbstatus.style.left=t.clientX+"px",i=(t.clientX+t.offsetX-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastcol-r.lastnonscrollingcol)+r.lastnonscrollingcol+1,(i=(i=Math.floor(i))<=r.lastnonscrollingcol?r.lastnonscrollingcol+1:i)>r.context.sheetobj.attribs.lastcol&&(i=r.context.sheetobj.attribs.lastcol),n=s.s_TCTDFthumbstatusPrefixh+Re.rcColname(i),t.thumbstatus.innerHTML=n),Re.DragFunctionPosition(e,t,o)},Re.TCTDragFunctionStop=function(e,t,o){var i,n=o.functionobj.control,r=n.editor;o.vertical?(i=(t.clientY+t.offsetY-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastrow-r.lastnonscrollingrow)+r.lastnonscrollingrow+1,(i=(i=Math.floor(i))<=r.lastnonscrollingrow?r.lastnonscrollingrow+1:i)>r.context.sheetobj.attribs.lastrow&&(i=r.context.sheetobj.attribs.lastrow),r.context.SetRowPaneFirstLast(r.context.rowpanes.length-1,i,i+1)):(i=(t.clientX+t.offsetX-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastcol-r.lastnonscrollingcol)+r.lastnonscrollingcol+1,(i=(i=Math.floor(i))<=r.lastnonscrollingcol?r.lastnonscrollingcol+1:i)>r.context.sheetobj.attribs.lastcol&&(i=r.context.sheetobj.attribs.lastcol),r.context.SetColPaneFirstLast(r.context.colpanes.length-1,i,i+1)),r.FitToEditTable(),t.thumbstatus.rowmsgele&&(t.thumbstatus.rowmsgele=null),t.thumbstatus.rowpreviewele&&(t.thumbstatus.rowpreviewele=null),r.toplevel.removeChild(t.thumbstatus),t.thumbstatus=null,r.ScheduleRender()},Re.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}},Re.DragRegister=function(e,t,o,i,n){var r=Re.DragInfo;if(i=i||{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null},r.registeredElements.push({element:e,vertical:t,horizontal:o,functionobj:i,parent:n}),e.addEventListener)e.addEventListener("mousedown",Re.DragMouseDown,!1);else{if(!e.attachEvent)throw Re.Constants.s_BrowserNotSupported;e.attachEvent("onmousedown",Re.DragMouseDown)}},Re.DragUnregister=function(e){var t,o=Re.DragInfo;if(e)for(t=0;t<o.registeredElements.length;t++)if(o.registeredElements[t].element==e)return o.registeredElements.splice(t,1),void(e.removeEventListener?e.removeEventListener("mousedown",Re.DragMouseDown,!1):e.detachEvent("onmousedown",Re.DragMouseDown))},Re.DragMouseDown=function(e){var e=e||M.event,t=Re.DragInfo,o=Re.LookupElement(e.target||e.srcElement,t.registeredElements);if(o&&!(o&&o.functionobj&&o.functionobj.Disabled&&o.functionobj.Disabled(e,t,o)))return(t.draggingElement=o).parent&&(t.relativeOffset=Re.GetElementPositionWithScroll(o.parent)),t.clientX=e.clientX-t.relativeOffset.left,t.clientY=e.clientY-t.relativeOffset.top,t.startX=t.clientX,t.startY=t.clientY,t.startZ=o.element.style.zIndex,t.offsetX=0,t.offsetY=0,o.element.style.zIndex="100",Re.SetMouseMoveUp(Re.DragMouseMove,Re.DragMouseUp,o.element,e),o&&o.functionobj&&o.functionobj.MouseDown&&o.functionobj.MouseDown(e,t,o),!1},Re.DragMouseMove=function(e){var e=e||M.event,t=Re.DragInfo,o=t.draggingElement;return t.clientX=e.clientX-t.relativeOffset.left,t.clientY=e.clientY-t.relativeOffset.top,Re.StopPropagation(e),o&&o.functionobj&&o.functionobj.MouseMove&&o.functionobj.MouseMove(e,t,o),!1},Re.DragMouseUp=function(e){var e=e||M.event,t=Re.DragInfo,o=t.draggingElement;return t.clientX=e.clientX-t.relativeOffset.left,t.clientY=e.clientY-t.relativeOffset.top,o.element.style.zIndex=t.startZ,o&&o.functionobj&&o.functionobj.MouseUp&&o.functionobj.MouseUp(e,t,o),Re.RemoveMouseMoveUp(Re.DragMouseMove,Re.DragMouseUp,o.element,e),t.draggingElement=null,!1},Re.DragFunctionStart=function(e,t,o){o=o.functionobj.positionobj||o.element;t.offsetY=parseInt(o.style.top)-t.clientY,t.offsetX=parseInt(o.style.left)-t.clientX},Re.DragFunctionPosition=function(e,t,o){var i=o.functionobj.positionobj||o.element;o.vertical&&(i.style.top=t.clientY+t.offsetY+"px"),o.horizontal&&(i.style.left=t.clientX+t.offsetX+"px")},Re.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0},Re.ButtonRegister=function(e,t,o,i){if(Re.ButtonInfo.registeredElements.push({name:(o=o||{}).name,element:t,editor:e,normalstyle:o.normalstyle,hoverstyle:o.hoverstyle,downstyle:o.downstyle,repeatwait:o.repeatwait,repeatinterval:o.repeatinterval,functionobj:i}),t.addEventListener)t.addEventListener("mousedown",Re.ButtonMouseDown,!1),t.addEventListener("mouseover",Re.ButtonMouseOver,!1),t.addEventListener("mouseout",Re.ButtonMouseOut,!1);else{if(!t.attachEvent)throw Re.Constants.s_BrowserNotSupported;t.attachEvent("onmousedown",Re.ButtonMouseDown),t.attachEvent("onmouseover",Re.ButtonMouseOver),t.attachEvent("onmouseout",Re.ButtonMouseOut)}},Re.ButtonMouseOver=function(e){var e=e||M.event,t=Re.ButtonInfo,o=Re.LookupElement(e.target||e.srcElement,t.registeredElements);o&&(t.buttonDown?t.buttonElement==o&&(t.doingHover=!0):(t.buttonElement&&t.buttonElement!=o&&t.doingHover&&Re.setStyles(t.buttonElement.element,t.buttonElement.normalstyle),t.buttonElement=o,t.doingHover=!0,Re.setStyles(o.element,o.hoverstyle),o&&o.functionobj&&o.functionobj.MouseOver&&o.functionobj.MouseOver(e,t,o)))},Re.ButtonMouseOut=function(e){var t,e=e||M.event,o=Re.ButtonInfo;o.buttonDown?o.doingHover=!1:(t=Re.LookupElement(e.target||e.srcElement,o.registeredElements),o.doingHover&&(o.buttonElement&&Re.setStyles(o.buttonElement.element,o.buttonElement.normalstyle),o.buttonElement=null,o.doingHover=!1),t&&t.functionobj&&t.functionobj.MouseOut&&t.functionobj.MouseOut(e,o,t))},Re.ButtonMouseDown=function(e){var e=e||M.event,t=Re.ButtonInfo,o=(Re.GetViewportInfo(),Re.LookupElement(e.target||e.srcElement,t.registeredElements));!o||o&&o.functionobj&&o.functionobj.Disabled&&o.functionobj.Disabled(e,t,o)||(t.buttonElement=o,t.buttonDown=!0,Re.setStyles(o.element,t.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",Re.ButtonMouseUp,!0):o.element.attachEvent&&(o.element.setCapture(),o.element.attachEvent("onmouseup",Re.ButtonMouseUp),o.element.attachEvent("onlosecapture",Re.ButtonMouseUp)),Re.StopPropagation(e),t.relativeOffset=Re.GetElementPositionWithScroll(o.editor.toplevel),t.clientX=e.clientX-t.relativeOffset.left,t.clientY=e.clientY-t.relativeOffset.top,o&&o.functionobj&&o.functionobj.MouseDown&&o.functionobj.MouseDown(e,t,o),o.repeatwait&&(t.timer=M.setTimeout(Re.ButtonRepeat,o.repeatwait)))},Re.ButtonMouseUp=function(e){var e=e||M.event,t=Re.ButtonInfo,o=t.buttonElement;t.timer&&(M.clearTimeout(t.timer),t.timer=null),t.buttonDown&&(Re.StopPropagation(e),document.removeEventListener?document.removeEventListener("mouseup",Re.ButtonMouseUp,!0):document.detachEvent&&(o.element.detachEvent("onlosecapture",Re.ButtonMouseUp),o.element.detachEvent("onmouseup",Re.ButtonMouseUp),o.element.releaseCapture()),t.buttonElement.downstyle&&(t.doingHover?Re.setStyles(o.element,t.buttonElement.hoverstyle):Re.setStyles(o.element,t.buttonElement.normalstyle)),t.buttonDown=!1,o&&o.functionobj&&o.functionobj.MouseUp&&o.functionobj.MouseUp(e,t,o))},Re.ButtonRepeat=function(){var e=Re.ButtonInfo,t=e.buttonElement;t&&(t&&t.functionobj&&t.functionobj.Repeat&&t.functionobj.Repeat(null,e,t),e.timer=M.setTimeout(Re.ButtonRepeat,t.repeatinterval||100))},Re.MouseWheelInfo={registeredElements:[]},Re.MouseWheelRegister=function(e,t){if(Re.MouseWheelInfo.registeredElements.push({element:e,functionobj:t}),e.addEventListener)e.addEventListener("DOMMouseScroll",Re.ProcessMouseWheel,!1),e.addEventListener("mousewheel",Re.ProcessMouseWheel,!1);else{if(!e.attachEvent)throw Re.Constants.s_BrowserNotSupported;e.attachEvent("onmousewheel",Re.ProcessMouseWheel)}},Re.ProcessMouseWheel=function(e){var t,e=e||M.event;if(!Re.Keyboard.passThru){for(var o=Re.MouseWheelInfo,i=e.target||e.srcElement,n=null;!n&&i;i=i.parentNode)n=Re.LookupElement(i,o.registeredElements);n&&(t=(t=e.wheelDelta?e.wheelDelta/120:-e.detail/3)||0,n.functionobj&&n.functionobj.WheelMove&&n.functionobj.WheelMove(e,t,o,n),e.preventDefault&&e.preventDefault(),e.returnValue=!1)}},Re.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{65:"[ctrl-a]",67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{65:"[ctrl-a]",67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{97:"[ctrl-a]",99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{97:"[ctrl-a]",99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}},Re.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""},Re.KeyboardSetFocus=function(e){Re.Keyboard.focusTable=e,Re.Keyboard.areListener||(document.onkeydown=Re.ProcessKeyDown,document.onkeypress=Re.ProcessKeyPress,Re.Keyboard.areListener=!0),Re.Keyboard.passThru&&(Re.Keyboard.passThru.blur&&Re.Keyboard.passThru.blur(),Re.Keyboard.passThru=null),M.focus()},Re.KeyboardFocus=function(){Re.Keyboard.passThru=null,M.focus()},Re.ProcessKeyDown=function(e){var t=Re.keyboardTables,o=(t.didProcessKey=!1,t.statusFromProcessKey=!1,""),i=!(t.repeatingKeyPress=!1);if(!Re._app&&!Re.Keyboard.passThru){if(null==(e=e||M.event).which){if(!(o=t.specialKeysCommon[e.keyCode])&&!(o=e.ctrlKey?t.controlKeysIE[e.keyCode]:o))return!0;(i=Re.ProcessKey(o,e))||(e.preventDefault&&e.preventDefault(),e.returnValue=!1)}else{if(!(o=t.specialKeysCommon[e.keyCode])&&!(o=e.ctrlKey||e.metaKey?t.controlKeysIE[e.keyCode]:o))return!0;i=Re.ProcessKey(o,e),t.didProcessKey=!0,t.statusFromProcessKey=i,t.chForProcessKey=o}return i}},Re.ProcessKeyPress=function(e){var t=Re.keyboardTables,o="";if(e=e||M.event,!Re._app&&!Re.Keyboard.passThru){if(t.didProcessKey)return t.repeatingKeyPress?Re.ProcessKey(t.chForProcessKey,e):(t.repeatingKeyPress=!0,t.statusFromProcessKey);if(null==e.which)o=String.fromCharCode(e.keyCode);else{if(!e.which)return!1;if(null==e.charCode){if(0==e.which)return!0;if(e.which<32||144==e.which){if(o=t.specialKeysOpera[e.which])return!0}else o=e.ctrlKey?t.controlKeysOpera[e.keyCode]:String.fromCharCode(e.which)}else{if(0==e.keyCode&&0==e.charCode)return;if(e.keyCode==e.charCode){if(!(o=t.specialKeysSafari[e.keyCode])){if(t.ignoreKeysSafari[e.keyCode])return!0;o=e.metaKey?t.controlKeysSafari[e.keyCode]:String.fromCharCode(e.which)}}else{if(t.specialKeysFirefox[e.keyCode])return!0;o=String.fromCharCode(e.which),(e.ctrlKey||e.metaKey)&&(o=t.controlKeysFirefox[e.which])}}}t=Re.ProcessKey(o,e);return t||(e.preventDefault&&e.preventDefault(),e.returnValue=!1),t}},Re.ProcessKey=function(e,t){var o=Re.Keyboard.focusTable;return!o||o.EditorProcessKey(e,t)},(Re=Re||{}).FormatNumber={},Re.FormatNumber.format_definitions={},Re.FormatNumber.separatorchar=",",Re.FormatNumber.decimalchar=".",Re.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Re.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Re.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Re.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"],Re.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},Re.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},Re.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},Re.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600},Re.FormatNumber.formatNumberWithFormat=function(e,t,o){var i,n,r,s,a,l,c,L,u,d,h,p,f,m,g,v,b,y,O,z,C,w,x,_,H,S,k,B,T,F,U,j,E,V,D=Re.Constants,P=Re.FormatNumber,A="";if("string"==typeof e&&!e.length)return"";if(N=+e,!isFinite(N))return"string"==typeof e?P.formatTextWithFormat(e,t):"NaN";var I=(e=N)<0?1:0,M=0==(N=I?-N:N)?1:0;if(o=o||D.FormatNumber_DefaultCurrency,P.parse_format_string(P.format_definitions,t),!(m=P.format_definitions[t]))throw"Format not parsed error!";if(g=m.sectioninfo.length-1,m.hascomparison)for(O=v=g=0;;O++){if(i=m.operators[O],n=m.operands[O],!i){v&&(P.parse_format_string(P.format_definitions,t="General"),m=P.format_definitions[t],g=0);break}if(i==P.commands.section){if(!v)break;v=0,g++}else if(i==P.commands.comparison){if(w=n.indexOf(":"),b=n.substring(0,w),y=+n.substring(w+1),"<"==b&&e<y||"<="==b&&e<=y||"="==b&&e==y||"<>"==b&&e!=y||">="==b&&y<=e||">"==b&&y<e)break;v=1}}else 0<g&&(1==g?g=I?(I=0,1):0:2!=g&&3!=g||(g=I?(I=0,1):M?2:0));if(0<(C=m.sectioninfo[g]).commas)for(w=0;w<C.commas;w++)N/=1e3;if(0<C.percent)for(w=0;w<C.percent;w++)N*=100;for(x=1,w=0;w<C.fractiondigits;w++)x*=10;if(o=Math.floor(N*x+.5),"number"!=typeof(o/=x))return"NaN";if(!isFinite(o))return"NaN";if(0==o&&(C.fractiondigits||C.integerdigits)&&(I=0),0<=(_=o+"").indexOf("e"))return e+"";if(!(H=_.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/)))return"NaN";if((S=H[1])&&"0"!=S||(S=""),k=(k=H[2])||"",C.hasdate){if(e<0)return"??-???-??&nbsp;??:??:??";for(M=(e-Math.floor(e))*P.datevalues.seconds_in_a_day,o=e*P.datevalues.seconds_in_a_day,a=Math.floor(M/P.datevalues.seconds_in_an_hour),L=Math.floor(o/P.datevalues.seconds_in_an_hour),M-=a*P.datevalues.seconds_in_an_hour,l=Math.floor(M/60),u=Math.floor(o/60),c=M-60*l,x=1,w=0;w<C.fractiondigits;w++)x*=10;for(c=Math.floor(c*x+.5),c/=x,d=Math.floor(o*x+.5),d/=x,60<=c&&(c=0,u++,60<=++l&&(l=0,L++,24<=++a&&(a=0,e++))),k=(k=c-Math.floor(c)+"").substring(2),p=Re.FormatNumber.convert_date_julian_to_gregorian(Math.floor(e+P.datevalues.julian_offset)),f=0,mspos=C.sectionstart;(i=m.operators[mspos],n=m.operands[mspos],i)&&i!=P.commands.section;mspos++)i==P.commands.date?("am/pm"!=n.toLowerCase()&&"a/p"!=n.toLowerCase()||h||(h=12<=a?(a-=12,"a/p"==n.toLowerCase()?D.s_FormatNumber_pm1:D.s_FormatNumber_pm):"a/p"==n.toLowerCase()?D.s_FormatNumber_am1:D.s_FormatNumber_am,n.indexOf(h)<0&&(h=h.toLowerCase())),!f||"m"!=n&&"mm"!=n||(m.operands[mspos]+="in"),f="h"==n.charAt(0)?1:0):i!=P.commands.copy&&(f=0);for(f=0,--mspos;(i=m.operators[mspos],n=m.operands[mspos],i)&&i!=P.commands.section;mspos--)i==P.commands.date?(!f||"m"!=n&&"mm"!=n||(m.operands[mspos]+="in"),f="ss"==n?1:0):i!=P.commands.copy&&(f=0)}for(j=U="",(F=T=B=0)<=(E=D.FormatNumber_separatorchar).indexOf(" ")&&(E=E.replace(/ /g,"&nbsp;")),0<=(V=D.FormatNumber_decimalchar).indexOf(" ")&&(V=V.replace(/ /g,"&nbsp;")),z=C.sectionstart;i=m.operators[z];)if(n=m.operands[z++],i==P.commands.copy)A+=n;else if(i==P.commands.color)U=n;else if(i==P.commands.style)j=n;else if(i==P.commands.integer_placeholder){if(I&&(A+="-",I=0),1==++B&&S.length>C.integerdigits)for(;T<S.length-C.integerdigits;T++)A+=S.charAt(T),C.thousandssep&&2<(r=S.length-T-1)&&r%3==0&&(A+=E);S.length<C.integerdigits&&B<=C.integerdigits-S.length?"0"!=n&&"?"!=n||(A+="0"==n?"0":"&nbsp;",C.thousandssep&&2<(r=C.integerdigits-B)&&r%3==0&&(A+=E)):(A+=S.charAt(T),C.thousandssep&&2<(r=S.length-T-1)&&r%3==0&&(A+=E),T++)}else if(i==P.commands.fraction_placeholder)F>=k.length?"0"!=n&&"?"!=n||(A+="0"==n?"0":"&nbsp;"):A+=k.charAt(F),F++;else if(i==P.commands.decimal)I&&(A+="-",I=0),A+=V;else if(i==P.commands.currency)I&&(A+="-",I=0),A+=n;else if(i==P.commands.general){if(0!=N){var R=Math.floor(Math.LOG10E*Math.log(N)),R=Math.pow(10,13-R),N=Math.floor(R*N+.5)/R;if(!isFinite(N))return"NaN"}if(I&&(A+="-"),0<=(_=N+"").indexOf("e"))A+=_;else{if((S=(H=_.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/))[1])&&"0"!=S||(S=""),k=(k=H[2])||"",F=T=0,S.length)for(;T<S.length;T++)A+=S.charAt(T),C.thousandssep&&2<(r=S.length-T-1)&&r%3==0&&(A+=E);else A+="0";if(k.length)for(A+=V;F<k.length;F++)A+=k.charAt(F)}}else if(i==P.commands.date)"y"==(R=n.toLowerCase())||"yy"==R?A+=(p.year+"").substring(2):"yyyy"==R?A+=p.year+"":"d"==R?A+=p.day+"":"dd"==R?A+=((s=1e3+p.day)+"").substr(2):"ddd"==R?(s=Math.floor(e+6)%7,A+=D.s_FormatNumber_daynames3[s]):"dddd"==R?(s=Math.floor(e+6)%7,A+=D.s_FormatNumber_daynames[s]):"m"==R?A+=p.month+"":"mm"==R?A+=((s=1e3+p.month)+"").substr(2):"mmm"==R?A+=D.s_FormatNumber_monthnames3[p.month-1]:"mmmm"==R?A+=D.s_FormatNumber_monthnames[p.month-1]:"mmmmm"==R?A+=D.s_FormatNumber_monthnames[p.month-1].charAt(0):"h"==R?A+=a+"":"h]"==R?A+=L+"":"mmin"==R?A+=(s=1e3+l+"").substr(2):"mm]"==R?A+=u<100?(s=1e3+u+"").substr(2):u+"":"min"==R?A+=l+"":"m]"==R?A+=u+"":"hh"==R?A+=(s=1e3+a+"").substr(2):"s"==R?A+=(s=Math.floor(c))+"":"ss"==R?A+=(s=1e3+Math.floor(c)+"").substr(2):"am/pm"==R||"a/p"==R?A+=h:"ss]"==R&&(A+=d<100?(s=1e3+Math.floor(d)+"").substr(2):(s=Math.floor(d))+"");else{if(i==P.commands.section)break;i!=P.commands.comparison&&(A+="!! Parse error !!")}return U&&(A='<span style="color:'+U+';">'+A+"</span>"),A=j?'<span style="'+j+';">'+A+"</span>":A},Re.FormatNumber.formatTextWithFormat=function(e,t){Re.Constants;var o,i,n=Re.FormatNumber,r=e+"",s="",a="",l="";if(n.parse_format_string(n.format_definitions,t),!(thisformat=n.format_definitions[t]))throw"Format not parsed error!";if(0==(e=thisformat.sectioninfo.length-1))e=0;else{if(3!=e)return r;e=3}for(o=thisformat.sectioninfo[e].sectionstart;op=thisformat.operators[o];)i=thisformat.operands[o++],op==n.commands.copy?s+="@"==i?r:i.replace(/ /g,"&nbsp;"):op==n.commands.color?a=i:op==n.commands.style&&(l=i);return a&&(s='<span style="color:'+a+';">'+s+"</span>"),s=l?'<span style="'+l+';">'+s+"</span>":s},Re.FormatNumber.parse_format_string=function(e,t){var o,i,n,r,s,a,l,c,u,d,h,p,f,m,g,v,b=Re.FormatNumber,y=1;if(!e[t]){for(e[t]=o={operators:[],operands:[],sectioninfo:[{}]},(sectioninfo=o.sectioninfo[i=0]).sectionstart=0,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,g=sectioninfo.percent=0;g<t.length;g++)if(v=t.charAt(g),l)'"'==v?(l=0,o.operators.push(b.commands.copy),o.operands.push(c)):c+=v;else if(u)"]"==v?(u=0,(f=Re.FormatNumber.parse_format_bracket(d)).operator==b.commands.separator?sectioninfo.thousandssep=1:(f.operator==b.commands.date&&(sectioninfo.hasdate=1),f.operator==b.commands.comparison&&(o.hascomparison=1),o.operators.push(f.operator),o.operands.push(f.operand))):d+=v;else if(r)o.operators.push(b.commands.copy),o.operands.push(v),r=!1;else if(s)o.operators.push(b.commands.copy),o.operands.push(v+v+v+v+v),s=!1;else if(a)o.operators.push(b.commands.copy),o.operands.push("&nbsp;"),a=!1;else{if(h){if("general".charAt(h)==v.toLowerCase()){7==++h&&(o.operators.push(b.commands.general),o.operands.push(v),h=0);continue}h=0}if(m){if(m.charAt(0)==v){m+=v;continue}o.operators.push(b.commands.date),o.operands.push(m),sectioninfo.hasdate=1,m=""}p?(f=(p+=v).toLowerCase())!="am/pm".substring(0,f.length)&&f!="a/p".substring(0,f.length)?ampstr="":"am/pm"!=f&&"a/p"!=f||(o.operators.push(b.commands.date),o.operands.push(p),p=""):"#"==v||"0"==v||"?"==v?(y?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=0),n=1,o.operators.push(b.commands.integer_placeholder)):(sectioninfo.fractiondigits++,n=1,o.operators.push(b.commands.fraction_placeholder)),o.operands.push(v)):"."==v?(n=0,o.operators.push(b.commands.decimal),o.operands.push(v),y=0):"$"==v?(n=0,o.operators.push(b.commands.currency),o.operands.push(v)):","==v?n?sectioninfo.commas++:(o.operators.push(b.commands.copy),o.operands.push(v)):"%"==v?(n=0,sectioninfo.percent++,o.operators.push(b.commands.copy),o.operands.push(v)):'"'==v?(n=0,l=1,c=""):"["==v?(n=0,u=1,d=""):"\\"==v?(r=1,n=0):"*"==v?(s=1,n=0):"_"==v?(a=1,n=0):";"==v?(i++,o.sectioninfo[i]={},(sectioninfo=o.sectioninfo[i]).sectionstart=1+o.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,y=1,n=sectioninfo.percent=0,o.operators.push(b.commands.section),o.operands.push(v)):"g"==v.toLowerCase()?(h=1,n=0):"a"==v.toLowerCase()?(p=v,n=0):0<="dmyhHs".indexOf(v)?m=v:(n=0,o.operators.push(b.commands.copy),o.operands.push(v))}m&&(o.operators.push(b.commands.date),o.operands.push(m),sectioninfo.hasdate=1)}},Re.FormatNumber.parse_format_bracket=function(e){var t,o=Re.FormatNumber,i=Re.Constants,n={};return"$"==e.charAt(0)?(n.operator=o.commands.currency,t=e.match(/^\$(.+?)(\-.+?){0,1}$/),n.operand=t?t[1]||i.FormatNumber_defaultCurrency||"$":e.substring(1)||i.FormatNumber_defaultCurrency||"$"):"?$"==e?(n.operator=o.commands.currency,n.operand="[?$]"):o.allowedcolors[e.toUpperCase()]?(n.operator=o.commands.color,n.operand=o.allowedcolors[e.toUpperCase()]):(t=e.match(/^style=([^"]*)$/))?(n.operator=o.commands.style,n.operand=t[1]):","==e?(n.operator=o.commands.separator,n.operand=e):o.alloweddates[e.toUpperCase()]?(n.operator=o.commands.date,n.operand=o.alloweddates[e.toUpperCase()]):(t=e.match(/^[<>=]/))?(t=e.match(/^([<>=]+)(.+)$/),n.operator=o.commands.comparison,n.operand=t[1]+":"+t[2]):(n.operator=o.commands.copy,n.operand="["+e+"]"),n},Re.FormatNumber.convert_date_gregorian_to_julian=function(e,t,o){o=o-32075+Re.intFunc(1461*(e+4800+Re.intFunc((t-14)/12))/4);return(o+=Re.intFunc(367*(t-2-12*Re.intFunc((t-14)/12))/12))-Re.intFunc(3*Re.intFunc((e+4900+Re.intFunc((t-14)/12))/100)/4)},Re.FormatNumber.convert_date_julian_to_gregorian=function(e){var t,o,i,e=e+68569,n=Math.floor(4*e/146097);return e-=Math.floor((146097*n+3)/4),t=Math.floor(4e3*(1+e)/1461001),e=e-Math.floor(1461*t/4)+31,o=Math.floor(80*e/2447),i=e-Math.floor(2447*o/80),{year:100*(n-49)+t+(e=Math.floor(o/11)),month:o+2-12*e,day:i}},Re.intFunc=function(e){return e<0?-Math.floor(-e):Math.floor(e)},(Re=Re||{}).Formula={},Re.TriggerIoAction={},Re.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9},Re.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7},Re.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10},Re.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5},Re.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"},Re.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},Re.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9},Re.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"},Re.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","n*":"|ni:1|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|","t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}},Re.Formula.ParseFormulaIntoTokens=function(e){for(var t,o,i,n,r,s,a,l=Re.Formula,c=Re.Constants,u=l.ParseState,d=l.TokenType,h=l.CharClass,p=l.CharClassTable,f=l.UpperCaseTable,m=l.ParsePushToken,g=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,v=[],b="",y=0,C=!1,w=0;w<=e.length;w++)o=w<e.length?p[t=e.charAt(w)]:(t="",h.eof),y==u.num&&(o==h.num?b+=t:o!=h.numstart||C?y="E"==t||"e"==t?(b+=t,C=!1,u.numexp1):(m(v,b,d.num,0),C=!1,0):(C=!0,b+=t)),y==u.numexp1&&(o==u.num?y=u.numexp2:"+"!=t&&"-"!=t||"E"!=f[b.charAt(b.length-1)]?"E"!=t&&"e"!=t&&(m(v,c.s_parseerrexponent,d.error,0),y=0):b+=t),y==u.numexp2&&(o==h.num?b+=t:(m(v,b,d.num,0),y=0)),y==u.alpha&&(o==h.num?y=u.coord:o==h.alpha||"."==t?b+=t:y=o==h.incoord?u.coord:(o==h.op||o==h.numstart||o==h.space||o==h.eof?m(v,b.toUpperCase(),d.name,0):m(v,c.s_parseerrchar,d.error,0),0)),y==u.coord&&(o==h.num||o==h.incoord?b+=t:y=o==h.alpha?u.alphanumeric:(o==h.op||o==h.numstart||o==h.eof||o==h.space?(s=g.test(b)?d.coord:d.name,m(v,b.toUpperCase(),s,0)):m(v,c.s_parseerrchar,d.error,0),0)),y==u.alphanumeric&&(o==h.num||o==h.alpha?b+=t:y=(o==h.op||o==h.numstart||o==h.space||o==h.eof?m(v,b.toUpperCase(),d.name,0):m(v,c.s_parseerrchar,d.error,0),0)),y==u.string?o==h.quote?y=u.stringquote:o==h.eof?(m(v,c.s_parseerrstring,d.error,0),y=0):b+=t:y==u.stringquote?y=o==h.quote?(b+=t,u.string):(m(v,b,d.string,0),0):y==u.specialvalue&&("!"==b.charAt(b.length-1)?(m(v,b,d.name,0),y=0):o==h.eof?(m(v,c.s_parseerrspecialvalue,d.error,0),y=0):b+=t),0==y&&(o==h.num?(b=t,y=u.num):o==h.numstart?(b=t,C=!0,y=u.num):o==h.alpha||o==h.incoord?(b=t,y=u.alpha):o==h.specialstart?(b=t,y=u.specialvalue):o==h.op?(b=t,0<v.length?(n=(i=v[v.length-1]).type,r=i.text,n!=h.op||"<="!=(a=r+b)&&">="!=a&&"<>"!=a||(b=r+b,v.pop(),r=0<v.length?(n=(i=v[v.length-1]).type,i.text):(n=h.eof,"EOF"))):(n=h.eof,r="EOF"),s=d.op,0==v.length||n==h.op&&")"!=r&&"%"!=r?"-"==b?t=b="M":"+"==b?t=b="P":")"==b&&"("==r||"("!=b&&(s=d.error,b=c.s_parseerrtwoops):1<b.length&&(">="==b?t=b="G":"<="==b?t=b="L":"<>"==b?t=b="N":(s=d.error,b=c.s_parseerrtwoops)),m(v,b,s,t),y=0):o==h.quote?(b="",y=u.string):o!=h.space&&o!=h.eof&&m(v,c.s_parseerrchar,d.error,0));return v},Re.Formula.ParsePushToken=function(e,t,o,i){e.push({text:t,type:o,opcode:i})},Re.Formula.evaluate_parsed_formula=function(e,t,o){var i=Re.Formula,n=(i.TokenType,i.ConvertInfixToPolish(e));return i.EvaluatePolish(e,n,t,o)},Re.Formula.ConvertInfixToPolish=function(e){for(var t,o,i,n,r,s=Re.Formula,a=Re.Constants,l=s.TokenType,c=s.TokenPrecedence,u=[],d=[],h="",p=0;p<e.length;p++)if(o=(t=e[p]).type,i=t.text,o==l.num||o==l.coord||o==l.string)u.push(p);else if(o==l.name)d.push(p),u.push(-1);else if(o!=l.space)if(","==i){for(;d.length&&"("!=e[d[d.length-1]].text;)u.push(d.pop());if(0==d.length){h=a.s_parseerrmissingopenparen;break}}else if("("==i)d.push(p);else if(")"==i){for(;d.length&&"("!=e[d[d.length-1]].text;)u.push(d.pop());if(0==d.length){h=a.s_parseerrcloseparennoopen;break}d.pop(),d.length&&e[d[d.length-1]].type==l.name&&u.push(d.pop())}else{if(o!=l.op){if(o==l.error){h=i;break}h="Internal error while processing parsed formula. ";break}for(d.length&&e[d[d.length-1]].type==l.name&&u.push(d.pop());d.length&&e[d[d.length-1]].type==l.op&&"("!=e[d[d.length-1]].text&&(n=c[t.opcode],r=c[e[d[d.length-1]].opcode],!(0<=n&&n<r))&&!(n<0&&(n=-n)<=(r=r<0?-r:r));)u.push(d.pop());d.push(p)}for(;0<d.length;){if("("==e[d[d.length-1]].text){h=a.s_parseerrmissingcloseparen;break}u.push(d.pop())}return h||u},void 0===Re.debug_log&&(Re.debug_log=[]),Re.DebugLog=function(e){},Re.Formula.EvaluatePolish=function(e,t,o,i){function n(e,t){F.push({type:e,value:t})}var r,s,a,l,c,u,d,h,p,f,m=Re.Formula,g=Re.Constants,v=m.TokenType,b=m.LookupResultType,y=m.TypeLookupTable,C=m.OperandAsNumber,w=m.OperandAsText,x=m.OperandValueAndType,_=m.OperandsAsCoordOnSheet,S=Re.format_number_for_display||function(e,t,o){return e+""},k="",T={value:"",type:"e#VALUE!",error:g.s_parseerrmissingoperand},F=[];if(!(e.length&&t instanceof Array))return{value:"",type:"e#VALUE!",error:"string"==typeof t?t:""};for(var E=[],D=0;D<t.length;D++)if(-1==(u=t[D]))n("start",0);else if(r=(u=e[u]).type,s=u.text,E.push(u),r==v.num)n("n",+s);else if(r==v.coord)n("coord",s);else if(r==v.string)n("t",s);else if(r==v.op){if(F.length<=0)return T;if("M"==s)n(b((a=C(o,F)).type,a.type,y.unaryminus),-a.value);else if("P"==s)n(b((a=C(o,F)).type,a.type,y.unaryplus),a.value);else if("%"==s)n(b((a=C(o,F)).type,a.type,y.unarypercent),.01*a.value);else if("&"==s){if(F.length<=1)return T;l=w(o,F),n(b((a=w(o,F)).type,a.type,y.concat),a.value+l.value)}else if(":"==s){if(F.length<=1)return T;(a=m.OperandsAsRangeOnSheet(o,F)).error&&(k=k||a.error),n(a.type,a.value)}else if("!"==s){if(F.length<=1)return T;(a=_(o,F)).error&&(k=k||a.error),n(a.type,a.value)}else if("<"==s||"L"==s||"="==s||"G"==s||">"==s||"N"==s){if(F.length<=1){k=g.s_parseerrmissingoperand;break}l=x(o,F),"n"==(a=x(o,F)).type.charAt(0)&&"n"==l.type.charAt(0)?(h=0,"<"==s?h=a.value<l.value?1:0:"L"==s?h=a.value<=l.value?1:0:"="==s?h=a.value==l.value?1:0:"G"==s?h=a.value>=l.value?1:0:">"==s?h=a.value>l.value?1:0:"N"==s&&(h=a.value!=l.value?1:0),n("nl",h)):"e"==a.type.charAt(0)?n(a.type,0):"e"==l.type.charAt(0)?n(l.type,0):(c=a.type.charAt(0),u=l.type.charAt(0),"n"==c?a.value=S(a.value,"n",""):"b"==c&&(a.value=""),"n"==u?l.value=S(l.value,"n",""):"b"==u&&(l.value=""),h=0,a.value=a.value.toLowerCase(),l.value=l.value.toLowerCase(),"<"==s?h=a.value<l.value?1:0:"L"==s?h=a.value<=l.value?1:0:"="==s?h=a.value==l.value?1:0:"G"==s?h=a.value>=l.value?1:0:">"==s?h=a.value>l.value?1:0:"N"==s&&(h=a.value!=l.value?1:0),n("nl",h))}else{if(F.length<=1){k=g.s_parseerrmissingoperand;break}"+"==s?(l=x(o,F),n(b((a=x(o,F)).type,l.type,y.plus),a.value+l.value)):(l=C(o,F),a=C(o,F)),"-"==s?n(b(a.type,l.type,y.plus),a.value-l.value):"*"==s?n(b(a.type,l.type,y.plus),a.value*l.value):"/"==s?0!=l.value?n("n",a.value/l.value):n("e#DIV/0!",0):"^"==s&&(a.value=Math.pow(a.value,l.value),a.type="n",isNaN(a.value)&&(a.value=0,a.type="e#NUM!"),n(a.type,a.value))}}else{if(r!=v.name){k=g.s_InternalError+"Unknown token "+r+" ("+s+"). ";break}if(k=m.CalculateFunction(s,F,o,e.coord))break}return value=F[0]?F[0].value:"","name"==(c=F[0]?F[0].type:"")&&(a=Re.Formula.LookupName(o,value),value=a.value,c=a.type,k=k||a.error),"coord"==c&&(a=x(o,F),value=a.value,"b"==(c=a.type)&&(c="n",value=0)),1<F.length&&!k&&(k+=g.s_parseerrerrorinformula),"e"==(d=c).charAt(0)?k=k||c.substring(1)||g.s_calcerrerrorvalueinformula:"range"==c&&(f=(p=value.match(/^(.*)\|(.*)\|/))[1].indexOf("!"),p[1]=0<=f?p[1].substring(f+1)+"!"+p[1].substring(0,f).toUpperCase():p[1].toUpperCase(),value=p[1]+":"+p[2].toUpperCase(),i||(k=g.s_formularangeresult+" "+value)),k&&"e"!=d.charAt(0)&&(value=k,d="e"),"n"!=d.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,d="e#NUM!",k=isNaN(value)?g.s_calcerrnumericnan:g.s_calcerrnumericoverflow),{value:value,type:d,error:k}},Re.Formula.LookupResultType=function(e,t,o){var i,n,r=o[e];return(r=r||o[e.charAt(0)+"*"])?0<=(o=r.indexOf("|"+t+":"))?(i=r.indexOf("|",o+1))<0?"e#VALUE! (internal error, incorrect LookupResultType "+r+")":"1"==(n=r.substring(o+t.length+2,i))?e:"2"==n?t:n:0<=(o=r.indexOf("|"+t.charAt(0)+"*:"))?(i=r.indexOf("|",o+1))<0?"e#VALUE! (internal error, incorrect LookupResultType "+r+")":"1"==(n=r.substring(o+4,i))?e:"2"==n?t:n:"e#VALUE!":"e#VALUE! (internal error, missing LookupResultType "+e.charAt(0)+"*)"},Re.Formula.TopOfStackValueAndType=function(e,t){var o=Re.Formula,i={type:"",value:""},n=t.length;return n?(i.value=t[n-1].value,i.type=t[n-1].type,t.pop(),"name"==i.type?o.LookupName(e,i.value):i):(i.error=Re.Constants.s_InternalError+"no operand on stack",i)},Re.Formula.OperandAsNumber=function(e,t){var e=Re.Formula.OperandValueAndType(e,t),t=e.type.charAt(0);return"n"==t?e.value=+e.value:"b"==t?(e.type="n",e.value=0):"e"==t?e.value=0:("n"==(t=Re.DetermineValueType?Re.DetermineValueType(e.value):{value:+e.value,type:"n"}).type.charAt(0)?e.value=+t.value:e.value=0,e.type=t.type),e},Re.Formula.OperandAsText=function(e,t){var e=Re.Formula.OperandValueAndType(e,t),o=e.type.charAt(0);return"t"!=o&&("n"==o?(e.value=Re.format_number_for_display?Re.format_number_for_display(e.value,e.type,""):e.value=e.value+"",e.type="t"):"b"==o?(e.value="",e.type="t"):"e"==o?e.value="":(t.value=e.value+"",t.type="t")),e},Re.Formula.OperandValueAndType=function(e,t){var o,i=Re.Formula,n={type:"",value:""},r=t.length;if(!r)return n.error=Re.Constants.s_InternalError+"no operand on stack",n;if(n.value=t[r-1].value,n.type=t[r-1].type,t.pop(),"coord"==(n="range"==(n="name"==n.type?i.LookupName(e,n.value):n).type?i.StepThroughRangeDown(t,n.value):n).type){if(r=e,-1!=(t=n.value.indexOf("!"))){if(null==(r=i.FindInSheetCache(n.value.substring(t+1))))return n.type="e#REF!",n.error=Re.Constants.s_sheetunavailable+" "+n.value.substring(t+1),n.value=0,n;n.value=n.value.substring(0,t)}r?(e=r.cells[Re.Formula.PlainCoord(n.value)])?(o=e.valuetype,n.value=e.datavalue):o="b":(o="e#N/A",n.value=0),n.type=o||"b","b"==n.type&&(n.value=0)}return n},Re.Formula.OperandAsCoord=function(e,t){return Re.Formula.OperandAsType(e,t,"coord")},Re.Formula.OperandAsRange=function(e,t){return Re.Formula.OperandAsType(e,t,"range")},Re.Formula.OperandAsType=function(e,t,o){Re.Formula;var i={type:"",value:""},n=t.length;return i.value=t[n-1].value,i.type=t[n-1].type,t.pop(),(i="name"==i.type?Re.Formula.LookupName(e,i.value):i).type!=o&&(i.value=Re.Constants.s_calcerrcellrefmissing,i.type="e#REF!"),i},Re.Formula.OperandsAsCoordOnSheet=function(e,t){var o={},i={},n=Re.Formula,r=t.length;return o.value=t[r-1].value,o.type=t[r-1].type,t.pop(),r=n.OperandAsSheetName(e,t),null==(e=n.FindInSheetCache(r.value))?(i.type="e#REF!",i.value=0,i.error=Re.Constants.s_sheetunavailable+" "+r.value):("name"==o.type&&(o=n.LookupName(e,o.value)),i.type=o.type,"coord"==o.type?i.value=o.value+"!"+r.value:"range"==o.type?(t=o.value.indexOf("|"),n=o.value.indexOf("|",t+1),i.value=o.value.substring(0,t)+"!"+r.value+"|"+o.value.substring(t+1,n)+"|"):"e"==o.type.charAt(0)?i.value=o.value:(i.error=Re.Constants.s_calcerrcellrefmissing,i.type="e#REF!",i.value=0)),i},Re.Formula.OperandsAsRangeOnSheet=function(e,t){var o,i={},n=Re.Formula,r=Re.Constants,s=t.length;return i.value=t[s-1].value,i.type=t[s-1].type,t.pop(),"coord"!=(s=n.OperandAsCoord(e,t)).type?{value:0,type:"e#REF!"}:(t=e,-1!=(e=s.value.indexOf("!"))&&((o=s.value.indexOf("|",e+1))<0&&(o=s.value.length),null==(t=n.FindInSheetCache(s.value.substring(e+1,o))))?{value:0,type:"e#REF!",errortext:r.s_sheetunavailable+" "+s.value.substring(e+1,o)}:"coord"==(i="name"==i.type?n.LookupName(t,i.value,"end"):i).type?{value:s.value+"|"+i.value+"|",type:"range"}:{value:r.s_calcerrcellrefmissing,type:"e#REF!"})},Re.Formula.OperandAsSheetName=function(e,t){Re.Formula;var o={type:"",value:""},i=t.length;if(o.value=t[i-1].value,o.type=t[i-1].type,t.pop(),"name"==o.type){if(!(i=Re.Formula.LookupName(e,o.value)).value)return o;o.value=i.value,o.type=i.type}return"coord"==o.type&&((t=e.cells[Re.Formula.PlainCoord(o.value)])?(o.value=t.datavalue,o.type=t.valuetype):(o.value="",o.type="b")),"t"!=o.type.charAt(0)&&(o.value="",o.error=Re.Constants.s_calcerrsheetnamemissing),o},Re.Formula.LookupName=function(e,t,o){var i,n=e.names,r={},s=!1;if(n[t.toUpperCase()]){if(r.value=n[t.toUpperCase()].definition,"="==r.value.charAt(0)){if(e.checknamecirc){if(e.checknamecirc[t])return r.type="e#NAME?",r.error=Re.Constants.s_circularnameref+' "'+t+'".',r}else e.checknamecirc={},s=!0;if(e.checknamecirc[t]=!0,n=Re.Formula.ParseFormulaIntoTokens(r.value.substring(1)),r=Re.Formula.evaluate_parsed_formula(n,e,1),delete e.checknamecirc[t],s&&delete e.checknamecirc,"range"!=r.type)return r}return-1!=(i=r.value.indexOf(":"))?(r.type="range",r.value=r.value.substring(0,i)+"|"+r.value.substring(i+1)+"|"):r.type="coord",r.value=r.value.toUpperCase(),r}return(n=Re.Formula.SpecialConstants[t.toUpperCase()])?(i=n.indexOf(","),r.value=+n.substring(0,i),r.type=n.substring(i+1)):/^[a-zA-Z][a-zA-Z]?$/.test(t)?(r.type="coord",r.value=t.toUpperCase()+(o?e.attribs.lastrow:1)):(r.value="",r.type="e#NAME?",r.error=Re.Constants.s_calcerrunknownname+' "'+t+'"'),r},Re.Formula.StepThroughRangeDown=function(e,t){var o,i,n,r,s,a=Re.Formula,l=t.indexOf("|"),c=t.indexOf("|",l+1),u=t.substring(0,l),d=t.substring(l+1,c),h=+t.substring(c+1);for(-1!=(l=u.indexOf("!"))?(o=u.substring(l),u=u.substring(0,l)):o="",-1!=(l=d.indexOf("!"))&&(d=d.substring(0,l)),s=0,r=(i=a.OrderRangeParts(u,d)).r1;r<=i.r2;r++)for(n=i.c1;n<=i.c2;n++)if(h<++s)return r==i.r2&&n==i.c2||a.PushOperand(e,"range",u+o+"|"+d+"|"+s),{value:Re.crToCoord(n,r)+o,type:"coord"}},Re.Formula.DecodeRangeParts=function(e,t){var o,i=Re.Formula,n=t.indexOf("|"),r=t.indexOf("|",n+1),s=t.substring(0,n),t=t.substring(n+1,r);return-1!=(n=s.indexOf("!"))?(o=s.substring(n+1),s=s.substring(0,n)):o="",-1!=(n=t.indexOf("!"))&&(t=t.substring(0,n)),r=e,o&&null==(r=i.FindInSheetCache(o))?null:{sheetdata:r,sheetname:o,col1num:(n=i.OrderRangeParts(s,t)).c1,ncols:n.c2-n.c1+1,row1num:n.r1,nrows:n.r2-n.r1+1}},Re.Formula.FunctionList||(Re.Formula.FunctionList={}),Re.Formula.FunctionClasses=null,Re.Formula.FunctionArgDefs={},Re.Formula.StoreIoEventFormula=function(e,t,o,i,n){var r,s,a=[];if(Re.Formula.Clone(a,o),a.reverse(),0!=a.length){if(void 0===i.ioEventTree&&(i.ioEventTree={}),void 0===i.ioParameterList&&(i.ioParameterList={}),void 0===i.ioTimeTriggerList&&(i.ioTimeTriggerList={}),void 0===i.radioGroupList&&(i.radioGroupList={}),void 0===i.ioParameterList[t]&&(i.ioParameterList[t]={}),i.ioParameterList[t]=a,i.ioParameterList[t].function_name=e,"TimeTrigger"==n){function l(e,t,o){o=o.cells[t];void 0!==o&&"n"==o.valuetype.charAt(0)&&e.push(o.datavalue)}var o=Re.Formula.PlainCoord(a[0].value),c=[];if("range"==a[0].type)for(var u=Re.Formula.DecodeRangeParts(i,o),d=0;d<u.ncols;d++)for(var h=0;h<u.nrows;h++)l(c,Re.crToCoord(u.col1num+d,u.row1num+h),i);if("coord"==a[0].type&&l(c,o,i),"n"==a[0].type.charAt(0)&&c.push(a[0].value),void 0===i.ioTimeTriggerList[t]||0==Re.Formula.ArrayValuesEqual(i.ioTimeTriggerList[t],c)){i.ioTimeTriggerList[t]=c;for(var p=(new Date).getTimezoneOffset(),f=[],m=0;m<c.length;++m)f[m]=Math.floor(24*(c[m]-25569)*60+p);i.ScheduleSheetCommands("settimetrigger "+t+" "+f.toString())}}if("EventTree"==n&&("coord"==a[0].type||"range"==a[0].type)){function g(e,t,o){void 0===e[t]&&(e[t]={}),e[t][o]=o}o=a[0].value.replace(/\$/g,"");if("range"==a[0].type)for(u=Re.Formula.DecodeRangeParts(i,o),d=0;d<u.ncols;d++)for(h=0;h<u.nrows;h++){var v=Re.crToCoord(u.col1num+d,u.row1num+h);g(i.ioEventTree,v,t)}"coord"==a[0].type&&g(i.ioEventTree,o,t)}"Input"!=n||null!=(o=(null!=Re.CurrentSpreadsheetControlObject?Re.CurrentSpreadsheetControlObject:Re.CurrentSpreadsheetViewerObject).formDataViewer)&&1==o.loaded&&(null==o.formFields&&Re.Formula.LoadFormFields(),n=(e+t).toLowerCase(),(r=null)==o.formFields[n]&&(s=o.formFields[n]=2+o.formFieldsLength++,r="set "+Re.crToCoord(s,1)+" text t "+Re.encodeForSave(e.toLowerCase()+t)),"t"!=a[0].type.charAt(0)&&"n"!=a[0].type.charAt(0)||(s=Re.crToCoord(o.formFields[n],2),null!=o.sheet.cells[s]&&o.sheet.cells[s].datavalue==a[0].value||(e="set "+s+" text t "+Re.encodeForSave(a[0].value),r=null!=r?r+"\n"+e:e)),null!=r&&o.sheet.ScheduleSheetCommands(r,!1))}},Re.Formula.ArrayValuesEqual=function(e,t){var o=e.length;if(o!=t.length)return!1;for(;o--;)if(e[o]!==t[o])return!1;return!0},Re.Formula.Clone=function(e,t){for(var o in t)"object"==typeof t[o]&&null!==t[o]&&e[o]?Re.Formula.Clone(e[o],t[o]):e[o]=t[o]},Re.Formula.LoadFormFields=function(){for(var e=(null!=Re.CurrentSpreadsheetControlObject?Re.CurrentSpreadsheetControlObject:Re.CurrentSpreadsheetViewerObject).formDataViewer,t=(e.formFields={},null==e.sheet.cells.A1&&e.sheet.ScheduleSheetCommands("set A1 text t "+Re.encodeForSave("FieldName:"),!1),null==e.sheet.cells.A2&&e.sheet.ScheduleSheetCommands("set A2 text t "+Re.encodeForSave("Pending:"),!1),2);;){var o=Re.crToCoord(t,1),o=e.sheet.cells[o];if(!o)break;e.formFields[o.datavalue.toLowerCase()]=t,t++}e.formFieldsLength=t-2},Re.Formula.CalculateFunction=function(e,t,o,i){var n,r,s,a=Re.Formula,l="",c=a.FunctionList[e];if(c){if(r=c[0],s=c[1],a.CopyFunctionArgs(t,n=[]),c[6]&&""!=c[6]&&(Re.DebugLog("action:"+e),a.StoreIoEventFormula(e,i,n,o,c[6])),100!=s)if(s<0){if(n.length<-s)return l=a.FunctionArgsError(e,t)}else if(n.length!=s)return l=a.FunctionArgsError(e,t);l=r(e,t,n,o,i)}else c=e,t.length&&"start"==t[t.length-1].type?(t.pop(),a.PushOperand(t,"name",c)):l=Re.Constants.s_sheetfuncunknownfunction+" "+c+". ";return l},Re.Formula.PushOperand=function(e,t,o){e.push({type:t,value:o})},Re.Formula.CopyFunctionArgs=function(e,t){for(Re.Formula;0<e.length&&"start"!=e[e.length-1].type;)t.push(e.pop());e.pop()},Re.Formula.FunctionArgsError=function(e,t){e=Re.Constants.s_calcerrincorrectargstofunction+" "+e+". ";return Re.Formula.PushOperand(t,"e#VALUE!",e),e},Re.Formula.FunctionSpecificError=function(e,t,o,i){return Re.Formula.PushOperand(t,o,i),i},Re.Formula.CheckForErrorValue=function(e,t){return"e"==t.type.charAt(0)&&(e.push(t),!0)},Re.Formula.FillFunctionInfo=function(){var e,t,o,i,n,r=Re.Formula,s=Re.Constants;if(!r.FunctionClasses){for(e in r.FunctionList)(t=r.FunctionList[e])[2]&&(r.FunctionArgDefs[t[2]]=s["s_farg_"+t[2]]||""),t[3]||s["s_fdef_"+e]&&(r.FunctionList[e][3]=s["s_fdef_"+e]);for(r.FunctionClasses={},n=0;n<s.function_classlist.length;n++)i=s.function_classlist[n],r.FunctionClasses[i]={name:s["s_fclass_"+i],items:[]};for(e in r.FunctionList)for((o=(t=r.FunctionList[e])[4]?t[4].split(","):[]).push("all"),n=0;n<o.length;n++)i=o[n],r.FunctionClasses[i].items.push(e);for(i in r.FunctionClasses)r.FunctionClasses[i].items.sort()}},Re.Formula.FunctionArgString=function(e){var t,o,i,n=Re.Formula,e=n.FunctionList[e],r=e[2];if(!r){if(0!=(t=e[1])){if(0<t){for(i="v1",o=2;o<=t;o++)i+=", v"+o;return i}if(t<0){for(i="v1",o=2;o<-t;o++)i+=", v"+o;return i+", ..."}return"nargs: "+t}r=" "}return i=n.FunctionArgDefs[r]||r},Re.Formula.SeriesFunctions=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}for(var r,s,a,l,c,u,d,h,p=Re.Formula,f=p.OperandValueAndType,m=p.LookupResultType,g=p.TypeLookupTable.plus,v="",b=0,y="",C=0,w=0,x=0,_=1;0<t.length;)"n"==(s=(r=f(i,t)).type.charAt(0))&&(C+=1),"b"!=s&&(w+=1),"b"==s&&(x+=1),"e"!=s&&"b"!=s&&(v+=r.value),"n"==s?(b+=c=+r.value,_*=c,a=null==a||a<c?c:a,l=null==l||c<l?c:l,1==C?(d=c,h=0):(h=u=h+(c-d)*(c-(c=d+(c-d)/C)),d=c),y=m(r.type,y||r.type,g)):"e"==s&&"e"!=y.charAt(0)&&(y=r.type);switch(y=y||"n",e){case"CONCAT":case"CONCATENATE":n("t",v);break;case"SUM":n(y,b);break;case"PRODUCT":n(y,_);break;case"MIN":n(y,l||0);break;case"MAX":n(y,a||0);break;case"COUNT":n("n",C);break;case"COUNTA":n("n",w);break;case"COUNTBLANK":n("n",x);break;case"AVERAGE":0<C?n(y,b/C):n("e#DIV/0!",0);break;case"STDEV":1<C?n(y,Math.sqrt(u/(C-1))):n("e#DIV/0!",0);break;case"STDEVP":1<C?n(y,Math.sqrt(u/C)):n("e#DIV/0!",0);break;case"VAR":1<C?n(y,u/(C-1)):n("e#DIV/0!",0);break;case"VARP":1<C?n(y,u/C):n("e#DIV/0!",0)}return null},Re.Formula.FunctionList.AVERAGE=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.CONCAT=[Re.Formula.SeriesFunctions,-1,"vn",null,"text"],Re.Formula.FunctionList.CONCATENATE=[Re.Formula.SeriesFunctions,-1,"vn",null,"text"],Re.Formula.FunctionList.COUNT=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.COUNTA=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.COUNTBLANK=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.MAX=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.MIN=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.PRODUCT=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.STDEV=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.STDEVP=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.SUM=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.VAR=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.FunctionList.VARP=[Re.Formula.SeriesFunctions,-1,"vn",null,"stat"],Re.Formula.SumProductFunction=function(e,o,t,n){function r(e,t){o.push({type:e,value:t})}for(var s,a=[],l=0,c=Re.Formula,u=0,d=0;0<t.length;){if("range"!=(s=c.TopOfStackValueAndType(n,t)).type)return void r("e#VALUE!",0);if(rangeinfo=c.DecodeRangeParts(n,s.value),u){if(u!=rangeinfo.ncols)return void r("e#VALUE!",0)}else u=rangeinfo.ncols;if(d){if(d!=rangeinfo.nrows)return void r("e#VALUE!",0)}else d=rangeinfo.nrows;for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=Re.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,a[k]=(void 0!==a[k]?a[k]:1)*value}for(i=0;i<a.length;i++)l+=a[i];r("n",l)},Re.Formula.FunctionList.SUMPRODUCT=[Re.Formula.SumProductFunction,-1,"rangen","","stat"],Re.Formula.DSeriesFunctions=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}var r,s,a,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_=Re.Formula,S=(_.OperandValueAndType,_.LookupResultType),k=_.TypeLookupTable.plus,T={},F=0,E="",D=0,P=0,A=0,I=1,M=_.TopOfStackValueAndType(i,t),R=_.OperandValueAndType(i,t),t=_.TopOfStackValueAndType(i,t);if("range"!=M.type||"range"!=t.type)return _.FunctionArgsError(e,o);if(r=_.DecodeRangeParts(i,M.value),s=_.DecodeRangeParts(i,t.value),(M=_.FieldToColnum(r.sheetdata,r.col1num,r.ncols,r.row1num,R.value,R.type))<=0)n("e#VALUE!",0);else{for(a=r.col1num+M-1,h=[],l=0;l<s.ncols;l++){if(d=s.sheetdata.GetAssuredCell(Re.crToCoord(s.col1num+l,s.row1num)),(criterianum=_.FieldToColnum(r.sheetdata,r.col1num,r.ncols,r.row1num,d.datavalue,d.valuetype))<=0)return void n("e#VALUE!",0);h.push(r.col1num+criterianum-1)}for(l=1;l<r.nrows;l++){p=!1;e:for(c=1;c<s.nrows;c++){for(u=0;u<s.ncols;u++)if(f=Re.crToCoord(s.col1num+u,s.row1num+c),("string"!=typeof(f=(d=s.sheetdata.GetAssuredCell(f)).datavalue)||0!=f.length)&&(m=h[u],m=Re.crToCoord(m,r.row1num+l),d=r.sheetdata.GetAssuredCell(m),!_.TestCriteria(d.datavalue,d.valuetype||"b",f)))continue e;p=!0;break}p&&(g=Re.crToCoord(a,r.row1num+l),d=r.sheetdata.GetAssuredCell(g),T.value=d.datavalue,T.type=d.valuetype,A+=1,"n"==(g=T.type.charAt(0))&&(D+=1),"b"!=g&&(P+=1),"b"==g&&0,"n"==g?(F+=v1=+T.value,I*=v1,v=null==v||v1>v?v1:v,b=null==b||v1<b?v1:b,1==D?(w=v1,x=0):(y=w+(v1-w)/D,x=C=x+(v1-w)*(v1-y),w=y),E=S(T.type,E||T.type,k)):"e"==g&&"e"!=E.charAt(0)&&(E=T.type))}switch(E=E||"n",e){case"DSUM":n(E,F);break;case"DPRODUCT":n(E,I);break;case"DMIN":n(E,b||0);break;case"DMAX":n(E,v||0);break;case"DCOUNT":n("n",D);break;case"DCOUNTA":n("n",P);break;case"DAVERAGE":0<D?n(E,F/D):n("e#DIV/0!",0);break;case"DSTDEV":1<D?n(E,Math.sqrt(C/(D-1))):n("e#DIV/0!",0);break;case"DSTDEVP":1<D?n(E,Math.sqrt(C/D)):n("e#DIV/0!",0);break;case"DVAR":1<D?n(E,C/(D-1)):n("e#DIV/0!",0);break;case"DVARP":1<D?n(E,C/D):n("e#DIV/0!",0);break;case"DGET":1==A?n(T.type,T.value):n(0==A?"e#VALUE!":"e#NUM!",0)}}},Re.Formula.FunctionList.DAVERAGE=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DCOUNT=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DCOUNTA=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DGET=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DMAX=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DMIN=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DPRODUCT=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DSTDEV=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DSTDEVP=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DSUM=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DVAR=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FunctionList.DVARP=[Re.Formula.DSeriesFunctions,3,"dfunc","","stat"],Re.Formula.FieldToColnum=function(e,t,o,i,n,r){var s;if("n"==r.charAt(0))return(s=+n)<=0||o<s?0:Math.floor(s);if("t"!=r.charAt(0))return 0;for(n=n?n.toLowerCase():"",s=0;s<o;s++)if((e.GetAssuredCell(Re.crToCoord(t+s,i)).datavalue+"").toLowerCase()==n)return s+1;return 0},Re.Formula.LookupFunctions=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}var r,s,a,l,c,u,d,h,p,f,m,g,v,b,y,C=Re.Formula,w=C.OperandValueAndType;C.LookupResultType,C.TypeLookupTable.plus;if("string"==typeof(y=w(i,t)).value&&(y.value=y.value.toLowerCase()),w=C.TopOfStackValueAndType(i,t),r=1,"MATCH"==e){if(t.length){if("n"!=(r=C.OperandAsNumber(i,t)).type.charAt(0))return void n("e#VALUE!",0);if(t.length)return C.FunctionArgsError(e,o),0;r=+r.value}}else{if("n"!=(s=C.OperandAsNumber(i,t)).type.charAt(0))return void n("e#VALUE!",0);if(s=Math.floor(s.value),t.length){if("n"!=(r=C.OperandAsNumber(i,t)).type.charAt(0))return void n("e#VALUE!",0);if(t.length)return C.FunctionArgsError(e,o),0;r=r.value?1:0}}if(y.type=y.type.charAt(0),"n"==y.type&&(y.value=+y.value),"range"!=w.type)return C.FunctionArgsError(e,o),0;if(a=C.DecodeRangeParts(i,w.value,w.type)){if(d=u=c=l=0,"HLOOKUP"==e){if(u=1,s>a.nrows)return void n("e#REF!",0)}else if("VLOOKUP"==e){if(d=1,s>a.ncols)return void n("e#REF!",0)}else{if("MATCH"!=e)return C.FunctionArgsError(e,o),0;if(1<a.ncols){if(1<a.nrows)return void n("e#N/A",0);u=1}else d=1}if(s<1&&"MATCH"!=e)return n("e#VALUE!",0),0;for(;;){if(b=Re.crToCoord(a.col1num+l,a.row1num+c),g=(m=a.sheetdata.GetAssuredCell(b)).datavalue,"n"==(v=m.valuetype?m.valuetype.charAt(0):"b")&&(g=+g),r){if("n"==y.type&&"n"==v){if(y.value==g)break;if(0<r&&y.value>g||r<0&&y.value<g)h=1,p=l,f=c;else if(h){h=2;break}}else if("t"==y.type&&"t"==v){if(g="string"==typeof g?g.toLowerCase():"",y.value==g)break;if(0<r&&y.value>g||r<0&&y.value<g)h=1,p=l,f=c;else if(h){h=2;break}}}else if("n"==y.type&&"n"==v){if(y.value==g)break}else if("t"==y.type&&"t"==v&&(g="string"==typeof g?g.toLowerCase():"",y.value==g))break;if(l+=u,(c+=d)>=a.nrows||l>=a.ncols){if(h){h=2;break}return void n("e#N/A",0)}}2==h&&(c=f,l=p),n(v="MATCH"==e?(g=l+c+1,"n"):(b=Re.crToCoord(a.col1num+l+("VLOOKUP"==e?s-1:0),a.row1num+c+("HLOOKUP"==e?s-1:0)),g=(m=a.sheetdata.GetAssuredCell(b)).datavalue,m.valuetype),g)}else n("e#REF!",0)},Re.Formula.FunctionList.HLOOKUP=[Re.Formula.LookupFunctions,-3,"hlookup","","lookup"],Re.Formula.FunctionList.MATCH=[Re.Formula.LookupFunctions,-2,"match","","lookup"],Re.Formula.FunctionList.VLOOKUP=[Re.Formula.LookupFunctions,-3,"vlookup","","lookup"],Re.Formula.IndexFunction=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}var r,s,a,l,c=Re.Formula,u=c.TopOfStackValueAndType(i,t);if("range"!=u.type)return c.FunctionArgsError(e,o),0;if(r=(u=c.DecodeRangeParts(i,u.value,u.type)).sheetname?"!"+u.sheetname:"",s={value:0},a={value:0},t.length){if("n"!=(s=c.OperandAsNumber(i,t)).type.charAt(0)||s.value<0)return void n("e#VALUE!",0);if(t.length){if("n"!=(a=c.OperandAsNumber(i,t)).type.charAt(0)||a.value<0)return void n("e#VALUE!",0);if(t.length)return c.FunctionArgsError(e,o),0}else 1==u.nrows&&(a.value=s.value,s.value=0)}s.value>u.nrows||a.value>u.ncols?n("e#REF!",0):n(0==s.value?0==a.value?1==u.nrows&&1==u.ncols?(l=Re.crToCoord(u.col1num,u.row1num)+r,"coord"):(l=Re.crToCoord(u.col1num,u.row1num)+r+"|"+Re.crToCoord(u.col1num+u.ncols-1,u.row1num+u.nrows-1)+"|","range"):1==u.nrows?(l=Re.crToCoord(u.col1num+a.value-1,u.row1num)+r,"coord"):(l=Re.crToCoord(u.col1num+a.value-1,u.row1num)+r+"|"+Re.crToCoord(u.col1num+a.value-1,u.row1num+u.nrows-1)+"|","range"):0==a.value?1==u.ncols?(l=Re.crToCoord(u.col1num,u.row1num+s.value-1)+r,"coord"):(l=Re.crToCoord(u.col1num,u.row1num+s.value-1)+r+"|"+Re.crToCoord(u.col1num+u.ncols-1,u.row1num+s.value-1)+"|","range"):(l=Re.crToCoord(u.col1num+a.value-1,u.row1num+s.value-1)+r,"coord"),l)},Re.Formula.FunctionList.INDEX=[Re.Formula.IndexFunction,-1,"index","","lookup"],Re.Formula.CountifSumifFunctions=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}var r,s,a,l,c=0,u="",d=0,h=Re.Formula,p=h.OperandValueAndType,f=h.LookupResultType,m=h.TypeLookupTable.plus,g=h.TopOfStackValueAndType(i,t),v=h.OperandAsText(i,t);if("SUMIF"==e)if(1==t.length)r=h.TopOfStackValueAndType(i,t);else{if(0!=t.length)return h.FunctionArgsError(e,o),0;r={value:g.value,type:g.type}}else r={value:g.value,type:g.type};if("n"==v.type.charAt(0)?v.value=v.value+"":"e"!=v.type.charAt(0)&&"b"!=v.type.charAt(0)||(v.value=null),"coord"!=g.type&&"range"!=g.type)return h.FunctionArgsError(e,o),0;if("SUMIF"==e&&"coord"!=r.type&&"range"!=r.type)return h.FunctionArgsError(e,o),0;for(t.push(g),(s=[]).push(r);t.length;)a=p(i,t),l=p(i,s),h.TestCriteria(a.value,a.type,v.value)&&(d+=1,"n"==l.type.charAt(0)?(c+=+l.value,u=f(l.type,u||l.type,m)):"e"==l.type.charAt(0)&&"e"!=u.charAt(0)&&(u=l.type));u=u||"n","SUMIF"==e?n(u,c):"COUNTIF"==e&&n("n",d)},Re.Formula.FunctionList.COUNTIF=[Re.Formula.CountifSumifFunctions,2,"rangec","","stat"],Re.Formula.FunctionList.SUMIF=[Re.Formula.CountifSumifFunctions,-2,"sumif","","stat"],Re.Formula.SumifsFunction=function(e,t,o,i){var n,r,s,a,l=0,c="",u=Re.Formula,d=u.OperandValueAndType,h=u.LookupResultType,p=u.TypeLookupTable.plus,f=u.TopOfStackValueAndType(i,o);if("coord"!=f.type&&"range"!=f.type)return u.FunctionArgsError(e,t),0;for(var m,g=[],v=[];o.length;){if(n=u.TopOfStackValueAndType(i,o),"n"==(r=u.OperandAsText(i,o)).type.charAt(0)?r.value=r.value+"":"e"!=r.type.charAt(0)&&"b"!=r.type.charAt(0)||(r.value=null),"coord"!=n.type&&"range"!=n.type)return u.FunctionArgsError(e,t),0;g.push([n]),v.push(r)}for((s=[]).push(f);s.length;){for(var b=d(i,s),y=!0,C=0;C<g.length;C++)a=d(i,g[C]),!y||u.TestCriteria(a.value,a.type,v[C].value)||(y=!1);y&&("n"==b.type.charAt(0)?(l+=+b.value,c=h(b.type,c||b.type,p)):"e"==b.type.charAt(0)&&"e"!=c.charAt(0)&&(c=b.type))}f=c=c||"n",m=l,t.push({type:f,value:m})},Re.Formula.FunctionList.SUMIFS=[Re.Formula.SumifsFunction,-3,"sum_range, criteria_range1, criteria1, [criteria_range2, criteria2, ... criteria_range_n, criteria_n]","","stat"],Re.Formula.IfFunction=function(e,t,o,i){var n=Re.Formula,i=Re.Formula.OperandValueAndType(i,o),r=i.type.charAt(0);if("n"!=r&&"b"!=r)t.push({type:"e#VALUE!",value:0});else{var s,r=o.pop();if(1==o.length)s=o.pop();else{if(0!=o.length)return void n.FunctionArgsError(e,t);s={type:"n",value:0}}t.push(i.value?r:s)}},Re.Formula.FunctionList.IF=[Re.Formula.IfFunction,-2,"iffunc","","test"],Re.Formula.DateFunction=function(e,t,o,i){var n=Re.Formula,r=0,s=n.OperandAsNumber(i,o),a=n.OperandAsNumber(i,o),i=n.OperandAsNumber(i,o),o=n.LookupResultType(s.type,a.type,n.TypeLookupTable.twoargnumeric);"n"==(o=n.LookupResultType(o,i.type,n.TypeLookupTable.twoargnumeric)).charAt(0)&&(r=Re.FormatNumber.convert_date_gregorian_to_julian(Math.floor(s.value),Math.floor(a.value),Math.floor(i.value))-Re.FormatNumber.datevalues.julian_offset,o="nd"),n.PushOperand(t,o,r)},Re.Formula.FunctionList.DATE=[Re.Formula.DateFunction,3,"date","","datetime"],Re.Formula.TimeFunction=function(e,t,o,i){var n=Re.Formula,r=0,s=n.OperandAsNumber(i,o),a=n.OperandAsNumber(i,o),i=n.OperandAsNumber(i,o),o=n.LookupResultType(s.type,a.type,n.TypeLookupTable.twoargnumeric);"n"==(o=n.LookupResultType(o,i.type,n.TypeLookupTable.twoargnumeric)).charAt(0)&&(r=(60*s.value*60+60*a.value+i.value)/86400,o="nt"),n.PushOperand(t,o,r)},Re.Formula.FunctionList.TIME=[Re.Formula.TimeFunction,3,"hms","","datetime"],Re.Formula.DMYFunctions=function(e,t,o,i){var n,r,s,a=Re.Formula,l=0,c=a.OperandAsNumber(i,o),u=a.LookupResultType(c.type,c.type,a.TypeLookupTable.oneargnumeric);if("n"==u.charAt(0))switch(n=Re.FormatNumber.convert_date_julian_to_gregorian(Math.floor(c.value+Re.FormatNumber.datevalues.julian_offset)),e){case"DAY":l=n.day;break;case"MONTH":l=n.month;break;case"YEAR":l=n.year;break;case"WEEKDAY":if(r={value:1},o.length){if("n"!=(r=a.OperandAsNumber(i,o)).type.charAt(0)||r.value<1||3<r.value)return void a.PushOperand(t,"e#VALUE!",0);if(o.length)return void a.FunctionArgsError(e,t)}s=6,1<r.value&&--s,l=Math.floor(c.value+s)%7+(r.value<3?1:0)}a.PushOperand(t,u,l)},Re.Formula.FunctionList.DAY=[Re.Formula.DMYFunctions,1,"v","","datetime"],Re.Formula.FunctionList.MONTH=[Re.Formula.DMYFunctions,1,"v","","datetime"],Re.Formula.FunctionList.YEAR=[Re.Formula.DMYFunctions,1,"v","","datetime"],Re.Formula.FunctionList.WEEKDAY=[Re.Formula.DMYFunctions,-1,"weekday","","datetime"],Re.Formula.HMSFunctions=function(e,t,o,i){var n,r,s,a=Re.Formula,l=0,i=a.OperandAsNumber(i,o),o=a.LookupResultType(i.type,i.type,a.TypeLookupTable.oneargnumeric);if("n"==o.charAt(0)){if(i.value<0)return void a.PushOperand(t,"e#NUM!",0);s=i.value-Math.floor(i.value),s*=24,n=Math.floor(s),s=(s-Math.floor(s))*60,r=Math.floor(s),s=(s-Math.floor(s))*60,s=Math.floor(s+(0<=i.value?.5:-.5)),"HOUR"==e?l=n:"MINUTE"==e?l=r:"SECOND"==e&&(l=s)}a.PushOperand(t,o,l)},Re.Formula.FunctionList.HOUR=[Re.Formula.HMSFunctions,1,"v","","datetime"],Re.Formula.FunctionList.MINUTE=[Re.Formula.HMSFunctions,1,"v","","datetime"],Re.Formula.FunctionList.SECOND=[Re.Formula.HMSFunctions,1,"v","","datetime"],Re.Formula.ExactFunction=function(e,t,o,i){var n=Re.Formula,r=0,s="nl",a=n.OperandValueAndType(i,o),l=a.type.charAt(0),i=n.OperandValueAndType(i,o),o=i.type.charAt(0);"t"==l?"t"==o?r=a.value==i.value?1:0:"b"==o?r=a.value.length?0:1:"n"==o?r=a.value==i.value+""?1:0:"e"==o?(r=i.value,s=i.type):r=0:"n"==l?"n"==o?r=+a.value==+i.value?1:0:"b"==o?r=0:"t"==o?r=a.value+""==i.value?1:0:"e"==o?(r=i.value,s=i.type):r=0:"b"==l?"t"==o?r=i.value.length?0:1:"b"==o?r=1:"n"!=o&&"e"==o?(r=i.value,s=i.type):r=0:"e"==l&&(r=a.value,s=a.type),n.PushOperand(t,s,r)},Re.Formula.FunctionList.EXACT=[Re.Formula.ExactFunction,2,"","","text"],Re.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]},Re.Formula.StringFunctions=function(e,t,o,i){for(var n,r,s,a=Re.Formula,l=0,c="e#VALUE!",u=o.length,d=a.ArgList[e],h=[],p=[],f=1;f<=u;f++){if(f>d.length)return void a.FunctionArgsError(e,t);if(0==d[f-1]?n=a.OperandAsNumber(i,o):1==d[f-1]?n=a.OperandAsText(i,o):-1==d[f-1]&&(n=a.OperandValueAndType(i,o)),h[f]=n.value,p[f]=n.type,"e"==n.type.charAt(0))return void a.PushOperand(t,n.type,l)}switch(e){case"FIND":(g=p[3]?h[3]-1:0)<0?l="Start is before string":0<=(l=h[2].indexOf(h[1],g))?(l+=1,c="n"):l="Not found";break;case"LEFT":(r=p[2]?+h[2]:1)<0?l="Negative length":(l=h[1].substring(0,r),c="t");break;case"LEN":l=h[1].length,c="n";break;case"LOWER":l=h[1].toLowerCase(),c="t";break;case"MID":m=+h[2],(r=+h[3])<1||m<1?l="Bad arguments":(l=h[1].substring(m-1,m+r-1),c="t");break;case"PROPER":l=h[1].replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),c="t";break;case"REPLACE":m=+h[2],(r=+h[3])<0||m<1?l="Bad arguments":(l=h[1].substring(0,m-1)+h[4]+h[1].substring(m-1+r),c="t");break;case"REPT":if((s=+h[2])<0)l="Negative count";else{for(l="";0<s;s--)l+=h[1];c="t"}break;case"RIGHT":(r=p[2]?+h[2]:1)<0?l="Negative length":(l=h[1].slice(-r),c="t");break;case"SUBSTITUTE":if(fulltext=h[1],oldtext=h[2],newtext=h[3],null!=h[4]){if((which=+h[4])<=0){l="Non-positive instance number";break}}else which=0;for(oldpos=s=0,l="";;){if(!(0<=(pos=fulltext.indexOf(oldtext,oldpos)))){l+=fulltext.substring(oldpos);break}if(s++,l+=fulltext.substring(oldpos,pos),0==which)l+=newtext;else{if(which==s){l+=newtext+fulltext.substring(pos+oldtext.length);break}l+=oldtext}oldpos=pos+oldtext.length}c="t";break;case"TRIM":l=(l=(l=(l=h[1]).replace(/^ */,"")).replace(/ *$/,"")).replace(/ +/g," "),c="t";break;case"HEXCODE":var m,g=(l=String(h[1])).charCodeAt(0);55296<=g&&g<=56319&&(56320<=(m=l.charCodeAt(1))&&m<=57343&&(g=1024*(g-55296)+(m-56320)+65536)),l=g.toString(16).toUpperCase(),c="t";break;case"UPPER":l=h[1].toUpperCase(),c="t"}a.PushOperand(t,c,l)},Re.Formula.FunctionList.FIND=[Re.Formula.StringFunctions,-2,"find","","text"],Re.Formula.FunctionList.LEFT=[Re.Formula.StringFunctions,-2,"tc","","text"],Re.Formula.FunctionList.LEN=[Re.Formula.StringFunctions,1,"txt","","text"],Re.Formula.FunctionList.LOWER=[Re.Formula.StringFunctions,1,"txt","","text"],Re.Formula.FunctionList.MID=[Re.Formula.StringFunctions,3,"mid","","text"],Re.Formula.FunctionList.PROPER=[Re.Formula.StringFunctions,1,"v","","text"],Re.Formula.FunctionList.REPLACE=[Re.Formula.StringFunctions,4,"replace","","text"],Re.Formula.FunctionList.REPT=[Re.Formula.StringFunctions,2,"tc","","text"],Re.Formula.FunctionList.RIGHT=[Re.Formula.StringFunctions,-1,"tc","","text"],Re.Formula.FunctionList.SUBSTITUTE=[Re.Formula.StringFunctions,-3,"subs","","text"],Re.Formula.FunctionList.TRIM=[Re.Formula.StringFunctions,1,"v","","text"],Re.Formula.FunctionList.HEXCODE=[Re.Formula.StringFunctions,1,"v","","text"],Re.Formula.FunctionList.UPPER=[Re.Formula.StringFunctions,1,"v","","text"],Re.Formula.IsFunctions=function(e,t,o,i){var n=Re.Formula,r=0,s=n.OperandValueAndType(i,o),a=s.type.charAt(0);switch(e){case"ISBLANK":r="b"==s.type?1:0;break;case"ISERR":r="e"!=a||"e#N/A"==s.type?0:1;break;case"ISERROR":r="e"==a?1:0;break;case"ISLOGICAL":r="nl"==s.type?1:0;break;case"ISNA":r="e#N/A"==s.type?1:0;break;case"ISNONTEXT":r="t"==a?0:1;break;case"ISNUMBER":r="n"==a?1:0;break;case"ISTEXT":r="t"==a?1:0}n.PushOperand(t,"nl",r)},Re.Formula.FunctionList.ISBLANK=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISERR=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISERROR=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISLOGICAL=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISNA=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISNONTEXT=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISNUMBER=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.FunctionList.ISTEXT=[Re.Formula.IsFunctions,1,"v","","test"],Re.Formula.NTVFunctions=function(e,t,o,i){var n=Re.Formula,r=0,s="e#VALUE!",a=n.OperandValueAndType(i,o),l=a.type.charAt(0);switch(e){case"N":r="n"==l?+a.value:0,s="n";break;case"T":r="t"==l?a.value+"":"",s="t";break;case"VALUE":"n"==l||"b"==l?(r=a.value||0,s="n"):"t"==l&&(s="n"!=(a=Re.DetermineValueType(a.value)).type.charAt(0)?(r=0,"e#VALUE!"):(r=+a.value,"n"))}"e"==l&&(s=a.type),n.PushOperand(t,s,r)},Re.Formula.FunctionList.N=[Re.Formula.NTVFunctions,1,"v","","math"],Re.Formula.FunctionList.T=[Re.Formula.NTVFunctions,1,"v","","text"],Re.Formula.FunctionList.VALUE=[Re.Formula.NTVFunctions,1,"v","","text"],Re.Formula.Math1Functions=function(e,t,o,i){var n,r={},s=Re.Formula,a=s.OperandAsNumber(i,o),l=a.value;if(r.type=s.LookupResultType(a.type,a.type,s.TypeLookupTable.oneargnumeric),"n"==r.type)switch(e){case"ABS":l=Math.abs(l);break;case"ACOS":-1<=l&&l<=1?l=Math.acos(l):r.type="e#NUM!";break;case"ASIN":-1<=l&&l<=1?l=Math.asin(l):r.type="e#NUM!";break;case"ATAN":l=Math.atan(l);break;case"COS":l=Math.cos(l);break;case"DEGREES":l=180*l/Math.PI;break;case"EVEN":(l=l<0?-l:l)!=Math.floor(l)?l=Math.floor(l+1)+Math.floor(l+1)%2:l+=l%2,a.value<0&&(l=-l);break;case"EXP":l=Math.exp(l);break;case"FACT":for(n=1,l=Math.floor(l);0<l;l--)n*=l;l=n;break;case"INT":l=Math.floor(l);break;case"LN":l<=0&&(r.type="e#NUM!",r.error=Re.Constants.s_sheetfunclnarg),l=Math.log(l);break;case"LOG10":l<=0&&(r.type="e#NUM!",r.error=Re.Constants.s_sheetfunclog10arg),l=Math.log(l)/Math.log(10);break;case"ODD":(l=l<0?-l:l)!=Math.floor(l)?l=Math.floor(l+1)+(1-Math.floor(l+1)%2):l+=1-l%2,a.value<0&&(l=-l);break;case"RADIANS":l=l*Math.PI/180;break;case"SIN":l=Math.sin(l);break;case"SQRT":0<=l?l=Math.sqrt(l):r.type="e#NUM!";break;case"TAN":0!=Math.cos(l)?l=Math.tan(l):r.type="e#NUM!"}return r.value=l,t.push(r),null},Re.Formula.FunctionList.ABS=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.ACOS=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.ASIN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.ATAN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.COS=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.DEGREES=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.EVEN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.EXP=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.FACT=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.INT=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.LN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.LOG10=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.ODD=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.RADIANS=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.SIN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.SQRT=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.FunctionList.TAN=[Re.Formula.Math1Functions,1,"v","","math"],Re.Formula.Math2Functions=function(e,t,o,i){var n,r,s,a={},l=Re.Formula,c=l.OperandAsNumber(i,o),u=l.OperandAsNumber(i,o);if(a.type=l.LookupResultType(c.type,u.type,l.TypeLookupTable.twoargnumeric),"n"==a.type)switch(e){case"ATAN2":0==c.value&&0==u.value?a.type="e#DIV/0!":a.value=Math.atan2(u.value,c.value);break;case"POWER":a.value=Math.pow(c.value,u.value),isNaN(a.value)&&(a.value=0,a.type="e#NUM!");break;case"MOD":0==u.value?a.type="e#DIV/0!":(n=c.value/u.value,n=Math.floor(n),a.value=c.value-n*u.value);break;case"TRUNC":if(r=1,0<=u.value){for(u.value=Math.floor(u.value),s=0;s<u.value;s++)r*=10;a.value=Math.floor(Math.abs(c.value)*r)/r}else if(u.value<0){for(u.value=Math.floor(-u.value),s=0;s<u.value;s++)r*=10;a.value=Math.floor(Math.abs(c.value)/r)*r}c.value<0&&(a.value=-a.value)}return t.push(a),null},Re.Formula.FunctionList.ATAN2=[Re.Formula.Math2Functions,2,"xy","","math"],Re.Formula.FunctionList.MOD=[Re.Formula.Math2Functions,2,"","","math"],Re.Formula.FunctionList.POWER=[Re.Formula.Math2Functions,2,"","","math"],Re.Formula.FunctionList.TRUNC=[Re.Formula.Math2Functions,2,"valpre","","math"],Re.Formula.LogFunction=function(e,t,o,i){var n,r,s={},a=Re.Formula;if(s.value=0,n=a.OperandAsNumber(i,o),s.type=a.LookupResultType(n.type,n.type,a.TypeLookupTable.oneargnumeric),1==o.length){if("n"!=(r=a.OperandAsNumber(i,o)).type.charAt(0)||r.value<=0)return a.FunctionSpecificError(e,t,"e#NUM!",Re.Constants.s_sheetfunclogsecondarg),0}else{if(0!=o.length)return a.FunctionArgsError(e,t),0;r={value:Math.E,type:"n"}}if("n"==s.type){if(n.value<=0)return a.FunctionSpecificError(e,t,"e#NUM!",Re.Constants.s_sheetfunclogfirstarg),0;s.value=Math.log(n.value)/Math.log(r.value)}t.push(s)},Re.Formula.FunctionList.LOG=[Re.Formula.LogFunction,-1,"log","","math"],Re.Formula.RoundFunction=function(e,t,o,i){var n,r,s,a=Re.Formula,l=0,c=a.OperandValueAndType(i,o),u=a.LookupResultType(c.type,c.type,a.TypeLookupTable.oneargnumeric);if(1==o.length){if("n"!=(n=a.OperandValueAndType(i,o)).type.charAt(0))return a.FunctionSpecificError(e,t,"e#NUM!",Re.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=o.length)return a.FunctionArgsError(e,t),0;n={value:0,type:"n"}}if("n"==u)if(n.value=+n.value,0==n.value)l=Math.round(c.value);else if(0<n.value){for(r=1,n.value=Math.floor(n.value),s=0;s<n.value;s++)r*=10;l=Math.round(c.value*r)/r}else if(n.value<0){for(r=1,n.value=Math.floor(-n.value),s=0;s<n.value;s++)r*=10;l=Math.round(c.value/r)*r}a.PushOperand(t,u,l)},Re.Formula.FunctionList.ROUND=[Re.Formula.RoundFunction,-1,"vp","","math"],Re.Formula.CeilingFloorFunctions=function(e,o,t,i){function n(e,t){o.push({type:e,value:t})}var r,s=Re.Formula,a=s.OperandValueAndType(i,t),l=a.type.charAt(0);if("n"!=l)n("e#VALUE!",0);else if(0==a.value)n("n",0);else{if(1==t.length){if(r=s.OperandValueAndType(i,t),"n"!=a.type.charAt(0))return void n("e#VALUE!",0)}else{if(0!=t.length)return void n("e#VALUE!",0);r={type:"n",value:0<a.value?1:-1}}if(0==r.value)n("n",0);else if(r.value*a.value<0)n("e#NUM!",0);else switch(e){case"CEILING":n("n",Math.ceil(a.value/r.value)*r.value);break;case"FLOOR":n("n",Math.floor(a.value/r.value)*r.value)}}},Re.Formula.FunctionList.CEILING=[Re.Formula.CeilingFloorFunctions,-1,"vsig","","math"],Re.Formula.FunctionList.FLOOR=[Re.Formula.CeilingFloorFunctions,-1,"vsig","","math"],Re.Formula.AndOrFunctions=function(e,t,o,i){var n,r,s=Re.Formula,a="";for("AND"==e?r=1:"OR"==e&&(r=0);o.length;)"n"==(n=s.OperandValueAndType(i,o)).type.charAt(0)?(n.value=+n.value,"AND"==e?r=0!=n.value?r:0:"OR"==e&&(r=0!=n.value?1:r),a=s.LookupResultType(n.type,a||"nl",s.TypeLookupTable.propagateerror)):"e"==n.type.charAt(0)&&"e"!=a.charAt(0)&&(a=n.type);a.length<1&&(a="e#VALUE!",r=0),s.PushOperand(t,a,r)},Re.Formula.FunctionList.AND=[Re.Formula.AndOrFunctions,-1,"vn","","test"],Re.Formula.FunctionList.OR=[Re.Formula.AndOrFunctions,-1,"vn","","test"],Re.Formula.NotFunction=function(e,t,o,i){var n=0,r=Re.Formula,i=r.OperandValueAndType(i,o),o=r.LookupResultType(i.type,i.type,r.TypeLookupTable.propagateerror);"n"==i.type.charAt(0)||"b"==i.type?(n=0!=+i.value?0:1,o="nl"):"t"==i.type.charAt(0)&&(o="e#VALUE!"),r.PushOperand(t,o,n)},Re.Formula.FunctionList.NOT=[Re.Formula.NotFunction,1,"v","","test"],Re.Formula.ChooseFunction=function(e,t,o,i){var n,r,s,a=0,l=Re.Formula,c=l.OperandAsNumber(i,o);for("n"!=c.type.charAt(0)&&(c.value=0),c.value=Math.floor(c.value),r=0;o.length;)if(s=l.TopOfStackValueAndType(i,o),c.value==(r+=1)){a=s.value,n=s.type;break}n?l.PushOperand(t,n,a):l.PushOperand(t,"e#VALUE!",0)},Re.Formula.FunctionList.CHOOSE=[Re.Formula.ChooseFunction,-2,"choose","","lookup"],Re.Formula.ColumnsRowsFunctions=function(e,t,o,i){var n=0,r=Re.Formula,o=r.TopOfStackValueAndType(i,o),o="coord"==o.type?(n=1,"n"):"range"==o.type?(i=r.DecodeRangeParts(i,o.value),"COLUMNS"==e?n=i.ncols:"ROWS"==e&&(n=i.nrows),"n"):(n=0,"e#VALUE!");r.PushOperand(t,o,n)},Re.Formula.FunctionList.COLUMNS=[Re.Formula.ColumnsRowsFunctions,1,"range","","lookup"],Re.Formula.FunctionList.ROWS=[Re.Formula.ColumnsRowsFunctions,1,"range","","lookup"],Re.Formula.ZeroArgFunctions=function(e,t,o,i){var n,r,s,a={value:0};switch(e){case"FALSE":a.type="nl",a.value=0;break;case"NA":a.type="e#N/A";break;case"NOW":r=(n=new Date).getTimezoneOffset(),n=n.getTime()/1e3,a.value=s=25569+n/86400-r/1440,a.type="ndt",Re.Formula.FreshnessInfo.volatile.NOW=!0;break;case"PI":a.type="n",a.value=Math.PI;break;case"TODAY":r=(n=new Date).getTimezoneOffset(),s=25569+(n=n.getTime()/1e3)/86400-r/1440,a.value=Math.floor(s),a.type="nd",Re.Formula.FreshnessInfo.volatile.TODAY=!0;break;case"TRUE":a.type="nl",a.value=1;break;case"RAND":a.type="n",a.value=Math.random(),Re.Formula.FreshnessInfo.volatile.RAND=!0}return t.push(a),null},Re.Formula.FunctionList.FALSE=[Re.Formula.ZeroArgFunctions,0,"","","test"],Re.Formula.FunctionList.NA=[Re.Formula.ZeroArgFunctions,0,"","","test"],Re.Formula.FunctionList.NOW=[Re.Formula.ZeroArgFunctions,0,"","","datetime"],Re.Formula.FunctionList.RAND=[Re.Formula.ZeroArgFunctions,0,"","","math"],Re.Formula.FunctionList.PI=[Re.Formula.ZeroArgFunctions,0,"","","math"],Re.Formula.FunctionList.TODAY=[Re.Formula.ZeroArgFunctions,0,"","","datetime"],Re.Formula.FunctionList.TRUE=[Re.Formula.ZeroArgFunctions,0,"","","test"],Re.Formula.DDBFunction=function(e,t,o,i){var n,r,s,a,l=Re.Formula,c=l.OperandAsNumber(i,o),u=l.OperandAsNumber(i,o),d=l.OperandAsNumber(i,o),h=l.OperandAsNumber(i,o);if(!(l.CheckForErrorValue(t,c)||l.CheckForErrorValue(t,u)||l.CheckForErrorValue(t,d)||l.CheckForErrorValue(t,h))){if(d.value<1)return l.FunctionSpecificError(e,t,"e#NUM!",Re.Constants.s_sheetfuncddblife),0;if(n={value:2,type:"n"},0<o.length&&(n=l.OperandAsNumber(i,o)),0!=o.length)return l.FunctionArgsError(e,t),0;if(!l.CheckForErrorValue(t,n)){for(s=r=0,a=1;a<=+h.value&&a<=d.value;a++)r=(c.value-s)*(n.value/d.value),s+=r=c.value-s-r<u.value?c.value-s-u.value:r;l.PushOperand(t,"n$",r)}}},Re.Formula.FunctionList.DDB=[Re.Formula.DDBFunction,-4,"ddb","","financial"],Re.Formula.SLNFunction=function(e,t,o,i){var n=Re.Formula,r=n.OperandAsNumber(i,o),s=n.OperandAsNumber(i,o),i=n.OperandAsNumber(i,o);if(!n.CheckForErrorValue(t,r)&&!n.CheckForErrorValue(t,s)&&!n.CheckForErrorValue(t,i)){if(i.value<1)return n.FunctionSpecificError(e,t,"e#NUM!",Re.Constants.s_sheetfuncslnlife),0;o=(r.value-s.value)/i.value,n.PushOperand(t,"n$",o)}},Re.Formula.FunctionList.SLN=[Re.Formula.SLNFunction,3,"csl","","financial"],Re.Formula.SYDFunction=function(e,t,o,i){var n=Re.Formula,r=n.OperandAsNumber(i,o),s=n.OperandAsNumber(i,o),a=n.OperandAsNumber(i,o),i=n.OperandAsNumber(i,o);if(!(n.CheckForErrorValue(t,r)||n.CheckForErrorValue(t,s)||n.CheckForErrorValue(t,a)||n.CheckForErrorValue(t,i))){if(a.value<1||i.value<=0)return n.PushOperand(t,"e#NUM!",0),0;o=(a.value+1)*a.value/2,r=(r.value-s.value)*(a.value-i.value+1)/o,n.PushOperand(t,"n$",r)}},Re.Formula.FunctionList.SYD=[Re.Formula.SYDFunction,4,"cslp","","financial"],Re.Formula.InterestFunctions=function(e,t,o,i){var n,r,s,a,l,c,u,d,h,p,f,m,g,v,b,y,C=Re.Formula,w=C.OperandAsNumber(i,o),x=C.OperandAsNumber(i,o),_=C.OperandAsNumber(i,o),S=C.LookupResultType(w.type,x.type,C.TypeLookupTable.twoargnumeric);if(S=C.LookupResultType(S,_.type,C.TypeLookupTable.twoargnumeric),o.length&&(r=C.OperandAsNumber(i,o),S=C.LookupResultType(S,r.type,C.TypeLookupTable.twoargnumeric),o.length&&(s=C.OperandAsNumber(i,o),S=C.LookupResultType(S,s.type,C.TypeLookupTable.twoargnumeric),o.length))){if("RATE"!=e)return C.FunctionArgsError(e,t),0;a=C.OperandAsNumber(i,o),S=C.LookupResultType(S,a.type,C.TypeLookupTable.twoargnumeric)}if("n"==S)switch(e){case"FV":v=w.value,u=x.value,d=_.value,l=null!=r?r.value:0,h=null!=s&&s.value?1:0,n=c=0==v?-l-d*u:-(l*Math.pow(1+v,u)+d*(1+v*h)*(Math.pow(1+v,u)-1)/v),S="n$";break;case"NPER":if(v=w.value,d=x.value,l=_.value,c=null!=r?r.value:0,h=null!=s&&s.value?1:0,0==v){if(0==d)return void C.PushOperand(t,"e#NUM!",0);u=(l+c)/-d}else{if(0==(p=l+(f=d*(1+v*h)/v))||v<=-1)return void C.PushOperand(t,"e#NUM!",0);if((f=(f-c)/p)<=0)return void C.PushOperand(t,"e#NUM!",0);u=Math.log(f)/Math.log(1+v)}n=u,S="n";break;case"PMT":if(v=w.value,u=x.value,l=_.value,c=null!=r?r.value:0,h=null!=s&&s.value?1:0,0==u)return void C.PushOperand(t,"e#NUM!",0);n=d=0==v?(c-l)/u:(0-c-l*Math.pow(1+v,u))/((1+v*h)*(Math.pow(1+v,u)-1)/v),S="n$";break;case"PV":if(v=w.value,u=x.value,d=_.value,c=null!=r?r.value:0,h=null!=s&&s.value?1:0,-1==v)return void C.PushOperand(t,"e#DIV/0!",0);n=l=0==v?-c-d*u:(-c-d*(1+v*h)*(Math.pow(1+v,u)-1)/v)/Math.pow(1+v,u),S="n$";break;case"RATE":for(u=w.value,d=x.value,l=_.value,c=null!=r?r.value:0,h=null!=s&&s.value?1:0,p=null!=a?a.value:.1,g=0,delta=1,epsilon=1e-7,v=p||1e-8;(0<=delta?delta:-delta)>epsilon&&v!=b;)if(delta=c+l*Math.pow(1+v,u)+d*(1+v*h)*(Math.pow(1+v,u)-1)/v,m=(null!=m?(y=(delta-m)/(v-b)||.001,b=v,v-=delta/y):(b=v,v*=1.1),delta),100<=++g)return void C.PushOperand(t,"e#NUM!",0);n=v,S="n%"}C.PushOperand(t,S,n)},Re.Formula.FunctionList.FV=[Re.Formula.InterestFunctions,-3,"fv","","financial"],Re.Formula.FunctionList.NPER=[Re.Formula.InterestFunctions,-3,"nper","","financial"],Re.Formula.FunctionList.PMT=[Re.Formula.InterestFunctions,-3,"pmt","","financial"],Re.Formula.FunctionList.PV=[Re.Formula.InterestFunctions,-3,"pv","","financial"],Re.Formula.FunctionList.RATE=[Re.Formula.InterestFunctions,-3,"rate","","financial"],Re.Formula.NPVFunction=function(e,t,o,i){var n,r,s,a,l=Re.Formula,c=l.OperandAsNumber(i,o);if(!l.CheckForErrorValue(t,c)){for(r=0,n="n",s=1;o.length;)if("n"==(a=l.OperandValueAndType(i,o)).type.charAt(0)){if(0==(s*=1+c.value))return void l.PushOperand(t,"e#DIV/0!",0);r+=a.value/s,n=l.LookupResultType(a.type,n||a.type,l.TypeLookupTable.plus)}else if("e"==a.type.charAt(0)&&"e"!=n.charAt(0)){n=a.type;break}"n"==n.charAt(0)&&(n="n$"),l.PushOperand(t,n,r)}},Re.Formula.FunctionList.NPV=[Re.Formula.NPVFunction,-2,"npv","","financial"],Re.Formula.IRRFunction=function(e,t,o,i){var n,r,s,a,l,c,u,d,h,p,f=[],m=[],g=Re.Formula;for(f.push(o.pop());f.length;)if("n"==(n=g.OperandValueAndType(i,f)).type.charAt(0))m.push(n.value);else if("e"==n.type.charAt(0))return void g.PushOperand(t,"e#VALUE!",0);if(m.length){if(r={value:0},o.length){if("n"!=(r=g.OperandAsNumber(i,o)).type.charAt(0)&&"b"!=r.type.charAt(0))return void g.PushOperand(t,"e#VALUE!",0);if(o.length)return void g.FunctionArgsError(e,t)}for(r.value=r.value||.1,a=0,l=r.value,d=1;1e-7<(0<=d?d:-d)&&l!=c;){for(h=1,p=d=0;p<m.length;p++){if(0==(h*=1+l))return void g.PushOperand(t,"e#DIV/0!",0);d+=m[p]/h}if(s=(null!=s?(u=(d-s)/(l-c),c=l,l-=d/u):(c=l,l*=1.1),d),20<=++a)return void g.PushOperand(t,"e#NUM!",0)}g.PushOperand(t,"n%",l)}else g.PushOperand(t,"e#NUM!",0)},Re.Formula.FunctionList.IRR=[Re.Formula.IRRFunction,-1,"irr","","financial"],Re.Formula.IoFunctions=function(e,t,o,i,n){var r,s,a,l=Re.Formula,c=0,u="e#VALUE!",d=o.length,h={BUTTON:[2],IMAGEBUTTON:[2],EMAIL:[14,14,14,14],EMAILIF:[13,14,14,14,14],EMAILONEDIT:[14,14,14,14,14],EMAILAT:[13,14,14,14,14],EMAILONEDITIF:[14,13,14,14,14,14],EMAILATIF:[13,13,14,14,14,14],SUBMIT:[2],TEXTBOX:[2],AUTOCOMPLETE:[2,14],SELECT:[2,14,1,1],CHECKBOX:[3],RADIOBUTTON:[2,2],COPYVALUE:[4,12,15],COPYFORMULA:[4,12,12],INSERT:[4,8,-12,-15],DELETEIF:[4,7,8],COMMAND:[4,14],COMMANDIF:[4,13,14],PANEL:[15,-12],SPLASH:[12],STYLE:[6]}[e],p=[],f=[],m=-1;for(F=1;F<=d;F++){if(-1!=m)a=Math.abs(h[s+(F-1-s)%m]);else{if(F>h.length)return void l.FunctionArgsError(e,t);(a=h[F-1])<0&&(m=h.length-(F-1),s=F-1,a=Math.abs(a))}if(1==a)r=l.OperandAsNumber(i,o);else if(2==a)r=l.OperandAsText(i,o);else if(3==a)r=l.OperandValueAndType(i,o);else{var g=o[o.length-1].type,v=!1;if(("n"==g.charAt(0)&&0!=(1&a)||"t"==g.charAt(0)&&0!=(2&a))&&(v=!0,r=l.OperandValueAndType(i,o)),"coord"==g&&0!=(4&a)&&(v=!0,(r=l.OperandAsCoord(i,o)).value=Re.Formula.PlainCoord(r.value)),"range"==g&&0!=(8&a)&&(v=!0,(r=l.OperandAsRange(i,o)).value=Re.Formula.PlainCoord(r.value)),0==v)return void l.FunctionArgsError(e,t)}if(p[F]=r.value,f[F]=r.type,"e"==r.type.charAt(0))return void l.PushOperand(t,r.type,c)}switch(e){case"STYLE":(b=i.ioParameterList[n])&&(0<(y=Re.Formula.getStandardizedList(i,{value:p[1],type:f[1]})).length&&(b.css=y[0],b.cssParameter="t"==f[1]?'"'+p[1]+'"':p[1]),c="",u="ni");break;case"SELECT":var b=i.ioParameterList[n],y=Re.Formula.getStandardizedList(i,b[1]);b.html=[],b.html[0]=1==p[4]?"multiple":"",b.html[1]=p[3]?""+p[3]:"1",0<y.length&&(y="<option>"+y.join("</option><option>")+"</option>",P=new RegExp("<option>"+p[1],""),b.html[2]=y.replace(P,"<option selected>"+p[1])),c=p[1],u="ti"+e;break;case"SUBMIT":c="Submit";case"BUTTON":case"IMAGEBUTTON":case"TEXTBOX":case"AUTOCOMPLETE":0<d&&(c=p[1]),u="ti"+e;break;case"EMAIL":case"EMAILIF":u="ti"+e,c="Send";break;case"EMAILONEDIT":case"EMAILONEDITIF":case"EMAILAT":case"EMAILATIF":u="ti"+e,c="Send Now";break;case"CHECKBOX":case"RADIOBUTTON":c="t"==f[1].charAt(0)?"TRUE"==p[1].toUpperCase()?1:0:0==p[1]?0:1,u="ni"+e;break;case"COPYVALUE":case"COPYFORMULA":case"INSERT":case"DELETEIF":case"COMMAND":case"COMMANDIF":b=i.cells[p[1]];if(void 0===b)break;c=b.datavalue,c=(c=String(c).split("/"))[c.length-1],u="t";break;case"PANEL":case"SPLASH":var C,y=2;if("SPLASH"==e){if(c="SPLASH:"+p[1],u="t",1==i.splashdone)break;i.splashdone=!0,y=1,C=[0]}else c=e+":"+(C=Re.Formula.getStandardizedList(i,{value:p[1],type:f[1]}));if(u="t",Re._app){for(var w=[],x=[],_=y;_<p.length;++_){var S,k=!1;for(S in C)if(C[S]==_-1){k=!0;break}if(!1!==k){for(var T=Re.Formula.getStandardizedCoords(i,{value:p[_],type:f[_]}),F=0;F<T.ncols;F++)x[T.col1num+F]=!0;for(var E=0;E<T.nrows;E++)w[T.row1num+E]=!0}}function D(e,t,o,i,n){for(var r=1;r<=t;r++){var s=n(r);void 0===o[s]?!0!==i[r]?(o[s]="yes",A=!0):I=r:!0===i[r]&&(delete o[s],A=!0,I=r)}}var P=M.spreadsheet,A=(null==P&&(P=M.ss),!1),I=0;D(0,i.attribs.lastrow,i.rowattribs.hide,w,function(e){return e}),D(I=0,i.attribs.lastcol,i.colattribs.hide,x,Re.rcColname),i.attribs.usermaxcol=I,A&&(i.renderneeded=!0,i.widgetsClean=!1,P.editor.context.rowpanes[0].first=1,P.editor.context.CalculateColWidthData(),P.width=P.editor.context.totalwidth,P.height=2500,P.editor.ResizeTableEditor(P.editor.context.totalwidth,2500))}}l.PushOperand(t,u,c)},Re.Formula.FunctionList.BUTTON=[Re.Formula.IoFunctions,1,"label","","gui","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],Re.Formula.FunctionList.IMAGEBUTTON=[Re.Formula.IoFunctions,1,"imageurl","","gui","<input type='image' src='<%=display_value%>' alt='Submit' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\">","ParameterList"],Re.Formula.FunctionList.EMAIL=[Re.Formula.IoFunctions,-3,"to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],Re.Formula.FunctionList.EMAILIF=[Re.Formula.IoFunctions,-4,"condition_range, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],Re.Formula.FunctionList.EMAILONEDIT=[Re.Formula.IoFunctions,-4,"editRange, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],Re.Formula.FunctionList.EMAILAT=[Re.Formula.IoFunctions,-4,"datetime_value, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],Re.Formula.FunctionList.EMAILONEDITIF=[Re.Formula.IoFunctions,-5,"editRange, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],Re.Formula.FunctionList.EMAILATIF=[Re.Formula.IoFunctions,-5,"datetime_value, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],Re.Formula.FunctionList.SUBMIT=[Re.Formula.IoFunctions,100,"[label]","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],Re.Formula.FunctionList.TEXTBOX=[Re.Formula.IoFunctions,1,"value","","gui","<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\" value='<%=display_value%>' >","Input"],Re.Formula.FunctionList.AUTOCOMPLETE=[Re.Formula.IoFunctions,2,"value, range or csv_text","","gui","<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >","Input"],Re.Formula.FunctionList.SELECT=[Re.Formula.IoFunctions,-2,"value, range or csv_text [,size]","","gui","<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\" <%=html0_value%>><%=html2_value%></select>","Input"],Re.Formula.FunctionList.CHECKBOX=[Re.Formula.IoFunctions,1,"value","","gui","<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\" >","Input"],Re.Formula.FunctionList.RADIOBUTTON=[Re.Formula.IoFunctions,2,"value, groupname","","gui","<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\"SocialCalc.CmdGotFocus(null);\" onclick=\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\" >","Input"],Re.Formula.FunctionList.COPYVALUE=[Re.Formula.IoFunctions,3,"trigger_cell, destinationCell, value_or_range","","action","","EventTree"],Re.Formula.FunctionList.COPYFORMULA=[Re.Formula.IoFunctions,3,"trigger_cell, destinationCell, formula_range","","action","","EventTree"],Re.Formula.FunctionList.INSERT=[Re.Formula.IoFunctions,-2,"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]","","action","","EventTree"],Re.Formula.FunctionList.DELETEIF=[Re.Formula.IoFunctions,-1,"trigger_cell, criteria , test_range","","action","","EventTree"],Re.Formula.FunctionList.COMMAND=[Re.Formula.IoFunctions,-1,"trigger_cell, commands","","action","","EventTree"],Re.Formula.FunctionList.COMMANDIF=[Re.Formula.IoFunctions,-1,"trigger_cell, conditions, commands","","action","","EventTree"],Re.Formula.FunctionList.PANEL=[Re.Formula.IoFunctions,-1,"showindices_range_or_csv, panel1_range [, panel2_range , ...]","","gui",""],Re.Formula.FunctionList.SPLASH=[Re.Formula.IoFunctions,-1,"splash_panel_range","","gui",""],Re.Formula.FunctionList.STYLE=[Re.Formula.IoFunctions,-1,"css","","gui",""],Re.TriggerIoAction.AddAutocomplete=function(o){var e=M.spreadsheet,e=(e=null==e?M.ss:e).sheet,t=(Re.Formula,e.ioParameterList[o]);void 0!==t&&(e=Re.Formula.getStandardizedList(e,t[1]),$.ui.autocomplete.filter=function(e,t){var o=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return o.test(e.label||e.value||e)})},$("#AUTOCOMPLETE_"+o).autocomplete({source:e,minLength:1,autoFocus:!0,select:function(e,t){$(this).val(t.item.label),Re.TriggerIoAction.AutoComplete(o)},change:function(e,t){null===t.item&&$(this).val(""),Re.TriggerIoAction.AutoComplete(o)}}))},Re.TriggerIoAction.Button=function(e){var t=M.spreadsheet,o=(t=null==t?M.ss:t).sheet;Re.Formula;if(void 0!==o.ioEventTree&&void 0!==o.ioParameterList&&"undefined"!==o.ioEventTree[e])for(var i in o.ioEventTree[e]){var n,r=o.ioParameterList[i],s=null;switch(r.function_name){case"COPYVALUE":var a=Re.Formula.getStandardizedValues(o,r[2]),l=Re.coordToCr(r[1].value),c=Re.TriggerIoAction.CopyValueToRange(a,l);t.editor.EditorScheduleSheetCommands(c,!0,!1);break;case"COPYFORMULA":var a=Re.Formula.getStandardizedValues(o,r[2]),l=Re.coordToCr(r[1].value),c=Re.TriggerIoAction.CopyFormulaToRange(a,l);t.editor.EditorScheduleSheetCommands(c,!0,!1);break;case"INSERT":if("range"!=(a=Re.Formula.getStandardizedValues(o,r[1])).type)break;1<a.ncols&&(h=1,p=0,n="insertcol"),1<a.nrows&&(h=0,p=1,n="insertrow");for(var u=a.cellcoord[h][p],c=n+" "+u,l=Re.coordToCr(u),d=2;d<r.length;)"range"!=r[d].type&&"coord"!=r[d].type&&d%2!=1||(copyCellRange=Re.Formula.getStandardizedValues(o,r[d]),c=d%2==0?c+"\n"+Re.TriggerIoAction.CopyFormulaToRange(copyCellRange,l):c+"\n"+Re.TriggerIoAction.CopyValueToRange(copyCellRange,l),1<a.nrows&&(l.col+=copyCellRange.ncols),1<a.ncols&&(l.row+=copyCellRange.nrows)),d++;t.editor.EditorScheduleSheetCommands(c,!0,!1);break;case"DELETEIF":var h,p,f,u=Re.Formula.getStandardizedValues(o,r[1]),m=Re.Formula.getStandardizedValues(o,r[2]),c="";if(1<m.ncols&&1<m.nrows)return;1<m.ncols&&(h=1,p=0,f="deletecol"),1<m.nrows&&(h=0,p=1,f="deleterow");for(var g=u.celldata[0][0].datavalue,v=m.ncols-h-1;h<=v;v--)for(var b=m.nrows-p-1;p<=b;b--){var y=m.celldata[v][b];1==Re.Formula.TestCriteria(y.datavalue,y.valuetype,g)&&(""!=c&&(c+="\n"),c=c+f+" "+m.cellcoord[v][b])}""!=c&&t.editor.EditorScheduleSheetCommands(c,!0,!1);break;case"COMMANDIF":s=Re.Formula.getStandardizedValues(o,r[1]);case"COMMAND":c="";if(null!=s){var C=Re.Formula.getStandardizedValues(o,r[2]);if(s.ncols!=C.ncols||s.nrows!=C.nrows)break}else C=Re.Formula.getStandardizedValues(o,r[1]);for(v=0;v<C.ncols;v++)for(b=0;b<C.nrows;b++){if(null!=s)if(0==s.celldata[v][b].datavalue)continue;""!=c&&(c+="\n"),c+=C.celldata[v][b].datavalue.toString().trim()}""!=c&&t.editor.EditorScheduleSheetCommands(c,!0,!1)}}},Re.TriggerIoAction.CopyFormulaToRange=function(e,t){for(var o="",i=0;i<e.ncols;i++)for(var n=0;n<e.nrows;n++){var r,s,a,l=e.celldata[i][n],c=Re.crToCoord(t.col+i,t.row+n);0==i&&0==n||(o+="\n"),o+=(void 0!==l&&"b"!=l.valuetype?(r=l.datatype,s=l.valuetype,a=l.datavalue,l=l.formula,"f"==r?(l=Re.OffsetFormulaCoords(l,t.col-e.col1num,t.row-e.row1num),s=a=""):"c"!=r&&(l=""),"set "+c+" "+Re.Constants.cellDataType[r]+" "+s+" "+Re.encodeForSave(a)+" "+l):"set "+c+" empty").trim()}return o},Re.TriggerIoAction.CopyValueToRange=function(e,t){for(var o="",i=0;i<e.ncols;i++)for(var n=0;n<e.nrows;n++){var r,s,a,l,c=e.celldata[i][n],u=Re.crToCoord(t.col+i,t.row+n);0==i&&0==n||(o+="\n"),o+=(void 0!==c&&"b"!=c.valuetype?(r=c.datatype,s=c.valuetype,a=c.datavalue,l=c.formula,"f"==r?(l="","n"!=(r=s)&&"t"!=s.charAt(0)&&(r="c",l=c.displaystring),"t"==s.charAt(0)&&(r="t")):"c"!=r&&(l=""),"set "+u+" "+Re.Constants.cellDataType[r]+" "+s+" "+Re.encodeForSave(a)+" "+l):"set "+u+" empty").trim()}return o},Re.TriggerIoAction.Email=function(e,t){t=void 0!==t?t:null;var o=Re.Formula,i=M.spreadsheet,n=(i=null==i?M.ss:i).sheet,r=n.cells[e];if(void 0!==n.ioParameterList){var s=n.ioParameterList[e];if(void 0!==s){for(var a=[],l=[],c=1,u=0;u<s.length;u++)if("t"==s[u].type.charAt(0)&&(a[u]=[String(s[u].value).replace(/ /g,"%20")]),"coord"==s[u].type&&(a[u]=[String(n.GetAssuredCell(s[u].value).datavalue).replace(/ /g,"%20")]),"range"==s[u].type){for(var d=o.DecodeRangeParts(n,s[u].value),h=(a[u]=[],l[u]=[],0),p=0;p<d.ncols;p++)for(var f=0;f<d.nrows;f++){var m=Re.crToCoord(d.col1num+p,d.row1num+f),r=d.sheetdata.GetAssuredCell(m);a[u].push(r.datavalue.toString().replace(/ /g,"%20")),l[u].push(m),h++}c<h&&(c=h)}var g=-1,v=0;switch(s.function_name){case"EMAILIF":g=0;case"EMAILAT":case"EMAILONEDIT":v=1;break;case"EMAILONEDITIF":case"EMAILATIF":g=1,v=2}switch(s.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":t&&"coord"==s[0].type&&s[0].value==t&&(t=null);break;default:t=null}for(var b,y,C,w=!1,x=[],_=c-1;-1<_;_--){if(-1!=g){var S=_>=a[g].length?0:_;if(0==a[g][S])continue}t&&t!=l[0][_]||(S=_>=a[v].length?0:_,b=_>=a[v+1].length?0:_,y=_>=a[v+2].length?0:_,C=a[v][S]+" "+a[v+1][b]+" "+a[v+2][y],n.ScheduleSheetCommands("sendemail "+C,!(w=!0)),x.push([a[v][S],a[v+1][b],a[v+2][y]]))}return w&&Re.EditorSheetStatusCallback(null,"emailing",null,i.editor),x}}},Re.TriggerIoAction.Submit=function(e){var t=(null!=Re.CurrentSpreadsheetControlObject?Re.CurrentSpreadsheetControlObject:Re.CurrentSpreadsheetViewerObject).formDataViewer;if(null!=t&&1==t.loaded){for(var o=M.spreadsheet,o=(o=null==o?M.ss:o).sheet,i=new Date,n=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),r=2;r<=t.formFieldsLength+1;r++){var s=Re.crToCoord(r,2);n+="\r"+t.sheet.cells[s].datavalue}o.ScheduleSheetCommands("submitform \r"+n,!1)}},Re.TriggerIoAction.SelectList=function(e){Re.TriggerIoAction.updateInputWidgetFormula("SELECT",e,function(e){return e.value})},Re.TriggerIoAction.AutoComplete=function(e){Re.TriggerIoAction.updateInputWidgetFormula("AUTOCOMPLETE",e,function(e){return e.value})},Re.TriggerIoAction.TextBox=function(e){Re.TriggerIoAction.updateInputWidgetFormula("TEXTBOX",e,function(e){return e.value})},Re.TriggerIoAction.CheckBox=function(e){Re.TriggerIoAction.updateInputWidgetFormula("CHECKBOX",e,function(e){return e.checked?"TRUE":"FALSE"})},Re.TriggerIoAction.RadioButton=function(e){function t(e){return e.checked?"TRUE":"FALSE"}$('input[name="'+e+'"]').each(function(){Re.TriggerIoAction.updateInputWidgetFormula("RADIOBUTTON",$(this).attr("id").replace(/RADIOBUTTON_/,""),t)})},Re.TriggerIoAction.updateInputWidgetFormula=function(e,t,o){var i=M.spreadsheet,n=(i=null==i?M.ss:i).sheet,r=(n.cells[t],n.ioParameterList[t]);if(void 0!==r){for(var n=o(document.getElementById(e+"_"+t)),s="set "+t+" formula "+e+'("'+(n=Re.encodeForSave(n))+'"',a=1;a<r.length;a++)"n"==r[a].type.charAt(0)&&(s+=","+r[a].value),"t"==r[a].type.charAt(0)&&(s+=',"'+r[a].value+'"'),"range"==r[a].type&&(s+=","+r[a].value.toString().replace(/(\$?[A-Z]+\$?[0-9]+)([!]?)([^|]*)[|](\$?[A-Z]+\$?[0-9]+)[|]/i,"$3$2$1:$4")),"coord"==r[a].type&&(s+=","+r[a].value);s+=")",r.cssParameter&&(s+="+style("+r.cssParameter+")"),i.editor.EditorScheduleSheetCommands(s,!0,!1),Re.TriggerIoAction.UpdateFormDataSheet(e,t,n)}},Re.TriggerIoAction.UpdateFormDataSheet=function(e,t,o){var i=(null!=Re.CurrentSpreadsheetControlObject?Re.CurrentSpreadsheetControlObject:Re.CurrentSpreadsheetViewerObject).formDataViewer;null!=i&&(e=(e+t).toLowerCase(),null!=i.formFields[e]&&(t=Re.crToCoord(i.formFields[e],2),i.sheet.ScheduleSheetCommands("set "+t+" text t "+o,!1)))},Re.Formula.getStandardizedValues=function(e,t){return Re.Formula.getStandardizedParameter(e,t,!0,!0)},Re.Formula.getStandardizedCoords=function(e,t){return Re.Formula.getStandardizedParameter(e,t,!0,!1)},Re.Formula.getStandardizedList=function(e,t){var o=[],i=Re.Formula.getStandardizedValues(e,t);if(1==i.ncols&&1==i.nrows)o=String(i.celldata[0][0].datavalue).split(",");else for(var n=0;n<i.ncols;n++)for(var r=0;r<i.nrows;r++){var s=i.celldata[n][r];o.push(s.datavalue.toString())}return o},Re.Formula.getStandardizedParameter=function(e,t,o,i){var n={type:t.type,value:t.value};if(i&&(n.celldata=[]),"coord"!=t.type&&"range"!=t.type)n.ncols=1,n.nrows=1,n.col1num=1,n.row1num=1,o&&(n.cellcoord=null),i&&(n.celldata[0]=[],a="n"==t.type?"v":"t"==t.type?t.type:"c",n.celldata[0][0]={coord:null,datatype:a,valuetype:t.type,datavalue:t.value});else{var r,s,a=Re.Formula;"coord"==t.type&&(r=Re.Formula.PlainCoord(t.value),s=a.DecodeRangeParts(e,r+"|"+r+"|")),"range"==t.type&&(s=a.DecodeRangeParts(e,t.value)),o&&(n.cellcoord=[]);for(var l=0;l<s.ncols;l++)for(var c=0;c<s.nrows;c++){var u=Re.crToCoord(s.col1num+l,s.row1num+c);o&&(void 0===n.cellcoord[l]&&(n.cellcoord[l]=[]),n.cellcoord[l][c]=u),i&&(void 0===n.celldata[l]&&(n.celldata[l]=[]),u=s.sheetdata.GetAssuredCell(u),n.celldata[l][c]=u)}n.ncols=s.ncols,n.nrows=s.nrows,n.col1num=s.col1num,n.row1num=s.row1num}return n},Re.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null},Re.Formula.FindInSheetCache=function(e){var t=Re.Formula.SheetCache,e=Re.Formula.NormalizeSheetName(e);return t.sheets[e]?t.sheets[e].sheet:t.waitingForLoading?null:t.loadsheet?(alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),Re.Formula.AddSheetToCache(e,t.loadsheet(e))):(t.waitingForLoading=e,null)},Re.Formula.AddSheetToCache=function(e,t,o){var i=null,n=Re.Formula.SheetCache,r=n.constants,e=Re.Formula.NormalizeSheetName(e);return t&&(i=new Re.Sheet).ParseSheetSave(t),n.sheets[e]={sheet:i,recalcstate:r.asloaded,name:e},Re.Formula.FreshnessInfo.sheets[e]=void 0===o||!1===o,i},Re.Formula.NormalizeSheetName=function(e){return Re.Callbacks.NormalizeSheetName?Re.Callbacks.NormalizeSheetName(e):e.toLowerCase()},Re.Formula.RemoteFunctionInfo={waitingForServer:null},Re.Formula.FreshnessInfo={sheets:{},volatile:{},recalc_completed:!1},Re.Formula.FreshnessInfoReset=function(){var e,t=Re.Formula.FreshnessInfo,o=Re.Formula.SheetCache;for(e in t.sheets)!1===t.sheets[e]&&delete o.sheets[e];t.sheets={},t.volatile={},t.recalc_completed=!1},Re.Formula.PlainCoord=function(e){return-1==e.indexOf("$")?e:e.replace(/\$/g,"")},Re.Formula.OrderRangeParts=function(e,t){var o={},e=Re.coordToCr(e),t=Re.coordToCr(t);return e.col>t.col?(o.c1=t.col,o.c2=e.col):(o.c1=e.col,o.c2=t.col),e.row>t.row?(o.r1=t.row,o.r2=e.row):(o.r1=e.row,o.r2=t.row),o},Re.Formula.TestCriteria=function(e,t,o){var i,n,r,s;if(null==o)return!1;if(n="="==(i=(o+="").charAt(0))||"<"==i||">"==i?o.substring(1):-1!=o.search(/([^~]\*|^\*)/)||-1!=o.search(/([^~]\?|^\?)/)?(i="regex","^"+(n="*"==o?".+":(n=(n=o.split("").reverse().join("")).replace(/\?(?=[^~])|\?$/g,"?.").replace(/\?~/g,"?\\").replace(/\*(?=[^~])|\*$/g,"*.").replace(/\*~/,"*\\")).split("").reverse().join(""))+"$"):"<="==(i=o.substring(0,2))||"<>"==i||">="==i?o.substring(2):(i="none",o),!(r=Re.DetermineValueType(n)).type){if("none"==i)return!1;if("b"==t.charAt(0)){if("="==i)return!0}else if("<>"==i)return!0;return!1}if(s=!1,"n"==r.type.charAt(0)&&"t"==t.charAt(0)&&"n"==(o=Re.DetermineValueType(e)).type.charAt(0)&&(e=o.value,t=o.type),"n"==t.charAt(0)&&"n"==r.type.charAt(0))switch(e=+e,r.value=+r.value,i){case"<":s=e<r.value;break;case"<=":s=e<=r.value;break;case"=":case"none":s=e==r.value;break;case">=":s=e>=r.value;break;case">":s=e>r.value;break;case"<>":s=e!=r.value}else if("e"==t.charAt(0))s=!1;else if("e"==r.type.charAt(0))s=!1;else{if("n"==t.charAt(0)&&(e=Re.format_number_for_display(e,"n","")),"n"==r.type.charAt(0))return!1;switch(e=e?e.toLowerCase():"",r.value=r.value?r.value.toLowerCase():"",i){case"<":s=e<r.value;break;case"<=":s=e<=r.value;break;case"=":s=e==r.value;break;case"none":s=e.substring(0,r.value.length)==r.value;break;case">=":s=e>=r.value;break;case">":s=e>r.value;break;case"<>":s=e!=r.value;break;case"regex":try{s=-1!=e.search(new RegExp(r.value))}catch(e){s=!1}}}return s},(Re=Re||{}).Popup={},Re.Popup.Types={},Re.Popup.Controls={},Re.Popup.Current={},Re.Popup.LocalizeString=function(e){return e},Re.Popup.Create=function(e,t,o){var i=Re.Popup.Types[e];i&&i.Create&&i.Create(e,t,o),Re.Popup.imagePrefix=Re.Constants.defaultImagePrefix},Re.Popup.SetValue=function(e,t){var o,i=Re.Popup,n=i.Types,i=i.Controls;i[e]?(o=n[n=i[e].type],i=i[e].data,o&&o.Create&&(o.SetValue(n,e,t),i.attribs&&i.attribs.changedcallback&&i.attribs.changedcallback(i.attribs,e,t))):alert("Unknown control "+e)},Re.Popup.SetDisabled=function(e,t){var o=Re.Popup,i=o.Types,n=o.Controls;n[e]?(n=i[i=n[e].type])&&n.Create&&(o.Current.id&&e==o.Current.id&&(n.Hide(i,o.Current.id),o.Current.id=null),n.SetDisabled(i,e,t)):alert("Unknown control "+e)},Re.Popup.GetValue=function(e){var t=Re.Popup,o=t.Types,t=t.Controls;{if(t[e])return(o=o[t=t[e].type])&&o.Create?o.GetValue(t,e):null;alert("Unknown control "+e)}},Re.Popup.Initialize=function(e,t){var o=Re.Popup,i=o.Types,o=o.Controls;o[e]?(o=i[i=o[e].type])&&o.Initialize&&o.Initialize(i,e,t):alert("Unknown control "+e)},Re.Popup.Reset=function(e){var t=Re.Popup,o=t.Types;t.Controls;o[e].Reset&&o[e].Reset(e)},Re.Popup.CClick=function(e){var t,o,i=Re.Popup,n=i.Types,r=i.Controls;r[e]?r[e].data&&r[e].data.disabled||(o=n[t=r[e].type],i.Current.id&&(n[r[i.Current.id].type].Hide(t,i.Current.id),e==i.Current.id)?i.Current.id=null:(o&&o.Show&&o.Show(t,e),i.Current.id=e)):alert("Unknown control "+e)},Re.Popup.Close=function(){var e=Re.Popup;e.Types,e.Controls;e.Current.id&&e.CClick(e.Current.id)},Re.Popup.Cancel=function(){var e=Re.Popup,t=e.Types,o=e.Controls;e.Current.id&&(t[t=o[e.Current.id].type].Cancel(t,e.Current.id),e.Current.id=null)},Re.Popup.CreatePopupDiv=function(e,t){var o,e=Re.Popup.Controls[e].data,i=document.createElement("div");return i.style.position="absolute",o=Re.GetElementPosition(e.mainele),i.style.top=o.top+e.mainele.offsetHeight+"px",i.style.left=o.left+"px",i.style.zIndex=100,i.style.backgroundColor="#FFF",i.style.border="1px solid black",t.width&&(i.style.width=t.width),e.mainele.appendChild(i),t.title&&(i.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+t.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',t.moveable&&(e.dragregistered=i.firstChild.firstChild.firstChild.firstChild,Re.DragRegister(e.dragregistered,!0,!0,{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null,positionobj:i},e.mainele))),i},Re.Popup.EnsurePosition=function(e,t){var o,e=Re.Popup.Controls[e].data,i=e.mainele.firstChild;function n(e){var t=Re.GetElementPosition(e);return t.height=e.offsetHeight,t.width=e.offsetWidth,t.bottom=t.top+t.height,t.right=t.left+t.width,t}i?(o=n(e=e.popupele),t=n(t),(i=n(i)).bottom+o.height<t.bottom&&i.left+o.width<t.right?(e.style.top=i.bottom+"px",e.style.left=i.left+"px"):i.top-o.height>t.top&&i.left+o.width<t.right?(e.style.top=i.top-o.height+"px",e.style.left=i.left+"px"):i.bottom+o.height<t.bottom&&i.right-o.width>t.left?(e.style.top=i.bottom+"px",e.style.left=i.right-o.width+"px"):i.top-o.height>t.top&&i.right-o.width>t.left?(e.style.top=i.top-o.height+"px",e.style.left=i.right-o.width+"px"):i.bottom+o.height<t.bottom&&o.width<t.width?(e.style.top=i.bottom+"px",e.style.left=t.left+Math.floor((t.width-o.width)/2)+"px"):i.top-o.height>t.top&&o.width<t.width?(e.style.top=i.top-o.height+"px",e.style.left=t.left+Math.floor((t.width-o.width)/2)+"px"):o.height<t.height&&i.right+o.width<t.right?(e.style.top=t.top+Math.floor((t.height-o.height)/2)+"px",e.style.left=i.right+"px"):o.height<t.height&&i.left-o.width>t.left&&(e.style.top=t.top+Math.floor((t.height-o.height)/2)+"px",e.style.left=i.left-o.width+"px")):alert("No main popup element firstChild.")},Re.Popup.DestroyPopupDiv=function(e,t){e&&(e.innerHTML="",Re.DragUnregister(t),e.parentNode&&e.parentNode.removeChild(e))},Re.Popup.RGBToHex=function(e){var t=Re.Popup;if(""==e)return"000000";e=e.match(/(\d+)\D+(\d+)\D+(\d+)/);return e?t.ToHex(e[1])+t.ToHex(e[2])+t.ToHex(e[3]):"000000"},Re.Popup.HexDigits="0123456789ABCDEF",Re.Popup.ToHex=function(e){var t=Re.Popup,o=Math.floor(e/16),e=e%16;return t.HexDigits.charAt(o)+t.HexDigits.charAt(e)},Re.Popup.FromHex=function(e){var t=Re.Popup,o=t.HexDigits.indexOf(e.charAt(0).toUpperCase()),t=t.HexDigits.indexOf(e.charAt(1).toUpperCase());return 16*(0<=o?o:0)+(0<=t?t:0)},Re.Popup.HexToRGB=function(e){var t=Re.Popup;return"rgb("+t.FromHex(e.substring(1,3))+","+t.FromHex(e.substring(3,5))+","+t.FromHex(e.substring(5,7))+")"},Re.Popup.makeRGB=function(e,t,o){return"rgb("+(0<e?e:0)+","+(0<t?t:0)+","+(0<o?o:0)+")"},Re.Popup.splitRGB=function(e){e=e.match(/(\d+)\D+(\d+)\D+(\d+)\D/);return e?{r:+e[1],g:+e[2],b:+e[3]}:{r:0,g:0,b:0}},Re.Popup.Types.List={},Re.Popup.Types.List.Create=function(e,t,o){var i=Re.Popup,e=(i.Types,{type:e,value:"",display:"",data:{}}),i=(i.Controls[t]=e).data,e=(i.attribs=o||{},document.getElementById(t));e?((i.mainele=e).innerHTML='<input style="cursor:pointer;width:100px;font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+t+'\');" value="">',i.options=[]):alert("Missing element "+t)},Re.Popup.Types.List.SetValue=function(e,t,i){var n,r=Re.Popup,s=(r.Types,r.Controls[t].data);for(s.value=i,s.custom=!1,n=0;n<s.options.length;n++)if(!((o=s.options[n]).a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=s.value)){s.display=o.o;break}n==s.options.length&&(s.display="Custom",s.custom=!0),s.mainele&&s.mainele.firstChild&&(s.mainele.firstChild.value=s.display)},Re.Popup.Types.List.SetDisabled=function(e,t,o){var i=Re.Popup,i=(i.Types,i.Controls[t].data);i.disabled=o,i.mainele&&i.mainele.firstChild&&(i.mainele.firstChild.disabled=o)},Re.Popup.Types.List.GetValue=function(e,t){var o=Re.Popup;o.Types;return o.Controls[t].data.value},Re.Popup.Types.List.Initialize=function(e,t,o){var i,n=Re.Popup,r=(n.Types,n.Controls[t].data);for(i in o.attribs)r.attribs[i]=o.attribs[i];r.options=o?o.options:[],o.value&&n.SetValue(t,o.value)},Re.Popup.Types.List.Reset=function(e){var t=Re.Popup,o=t.Types,i=t.Controls;t.Current.id&&i[t.Current.id].type==e&&(o[e].Hide(e,t.Current.id),t.Current.id=null)},Re.Popup.Types.List.Show=function(e,t){var o,i=Re.Popup,n=(i.Types,i.Controls[t].data),r="";n.popupele=i.CreatePopupDiv(t,n.attribs),n.custom?(r=Re.Popup.Types.List.MakeCustom(e,t),(o=document.createElement("div")).innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+r+"</div>",n.customele=o.firstChild.firstChild.childNodes[1],n.listdiv=null):(r=Re.Popup.Types.List.MakeList(e,t),(o=document.createElement("div")).innerHTML='<div style="cursor:default;padding:4px;">'+r+"</div>",n.customele=null,n.listdiv=o.firstChild),n.contentele=o,n.mainele&&n.mainele.firstChild&&(n.mainele.firstChild.disabled=!0),n.popupele.appendChild(o),n.attribs.ensureWithin&&Re.Popup.EnsurePosition(t,n.attribs.ensureWithin)},Re.Popup.Types.List.MakeList=function(e,t){var o,i,n=Re.Popup,r=(n.Types,n.Controls[t].data),s='<table cellspacing="0" cellpadding="0"><tr>',a='<td style="vertical-align:top;">';for(s+=a,r.ncols=1,o=0;o<r.options.length;o++){if((i=r.options[o]).a){if(i.a.newcol){s+="</td>"+a+"&nbsp;&nbsp;&nbsp;&nbsp;</td>"+a,r.ncols+=1;continue}if(i.a.skip){s+='<div style="font-size:x-small;white-space:nowrap;">'+i.o+"</div>";continue}}s+='<div style="font-size:x-small;white-space:nowrap;'+(i.v!=r.value||i.a&&(i.a.custom||i.a.cancel)?"":"background-color:#DDF;")+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+t+"','"+o+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+t+"',this);\">"+i.o+"</div>"}return s+="</td></tr></table>"},Re.Popup.Types.List.MakeCustom=function(e,t){var o=Re.Popup.LocalizeString,i=Re.Popup,n=(i.Types,'style="font-size:smaller;"'),i=i.Controls[t].data.value;return'<div style="white-space:nowrap;"><br><input id="customvalue" value="'+Re.special_chars(i)+'"><br><br><input '+n+' type="button" value="'+o("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+t+"');return false;\"><input "+n+' type="button" value="'+o("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+t+"');\"><input "+n+' type="button" value="'+o("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'},Re.Popup.Types.List.ItemClicked=function(e,t){var o,i,n,r=Re.Popup,r=(r.Types,r.Controls[e].data),s=r.options[t].a;if(s&&s.custom)return o=r.contentele,i=Re.Popup.Types.List.MakeCustom("List",e),(n=document.createElement("div")).innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+i+"</div>",r.customele=n.firstChild.firstChild.childNodes[1],r.listdiv=null,r.contentele=n,r.popupele.replaceChild(n,o),void(r.attribs.ensureWithin&&Re.Popup.EnsurePosition(e,r.attribs.ensureWithin));s&&s.cancel||Re.Popup.SetValue(e,r.options[t].v),Re.Popup.Close()},Re.Popup.Types.List.CustomToList=function(e){var t=Re.Popup,t=(t.Types,t.Controls[e].data),o=t.contentele,i=Re.Popup.Types.List.MakeList("List",e),n=document.createElement("div");n.innerHTML='<div style="cursor:default;padding:4px;">'+i+"</div>",t.customele=null,t.listdiv=n.firstChild,t.contentele=n,t.popupele.replaceChild(n,o),t.attribs.ensureWithin&&Re.Popup.EnsurePosition(e,t.attribs.ensureWithin)},Re.Popup.Types.List.CustomOK=function(e){var t=Re.Popup,t=(t.Types,t.Controls[e].data);Re.Popup.SetValue(e,t.customele.value),Re.Popup.Close()},Re.Popup.Types.List.MouseMove=function(e,t){var o,i=Re.Popup,n=(i.Types,i.Controls[e].data),i=n.listdiv;if(i){for(var r=i.firstChild.firstChild.firstChild,s=0;s<n.ncols;s++)for(o=0;o<r.childNodes[2*s].childNodes.length;o++)r.childNodes[2*s].childNodes[o].style.backgroundColor="#FFF";t.style.backgroundColor="#DDF"}},Re.Popup.Types.List.Hide=function(e,t){var o=Re.Popup,t=(o.Types,o.Controls[t].data);o.DestroyPopupDiv(t.popupele,t.dragregistered),t.popupele=null,t.mainele&&t.mainele.firstChild&&(t.mainele.firstChild.disabled=!1)},Re.Popup.Types.List.Cancel=function(e,t){Re.Popup.Types.List.Hide(e,t)},Re.Popup.Types.ColorChooser={},Re.Popup.Types.ColorChooser.Create=function(e,t,o){var i=Re.Popup,e=(i.Types,{type:e,value:"",display:"",data:{}}),i=(i.Controls[t]=e).data,e=(i.attribs=o||{},i.attribs),o=(i.value="",document.getElementById(t));o?(i.mainele=o).innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(e.sampleWidth||"15px")+";height:"+(e.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+t+"');\">&nbsp;</div>":alert("Missing element "+t)},Re.Popup.Types.ColorChooser.SetValue=function(e,t,o){var i,n=Re.Popup,t=(n.Types,n.Controls[t].data),r=t.attribs;t.value=o,t.custom=!1,t.mainele&&t.mainele.firstChild&&(o=t.value?(t.mainele.firstChild.style.backgroundColor=t.value,i=r.backgroundImage?"url("+n.imagePrefix+r.backgroundImage+")":"","center center"):(t.mainele.firstChild.style.backgroundColor="#FFF",r.backgroundImageDefault?(i="url("+n.imagePrefix+r.backgroundImageDefault+")","center center"):(i="url("+n.imagePrefix+"defaultcolor.gif)","left top")),t.mainele.firstChild.style.backgroundPosition=o,t.mainele.firstChild.style.backgroundImage=i)},Re.Popup.Types.ColorChooser.SetDisabled=function(e,t,o){var i=Re.Popup,n=(i.Types,i.Controls[t].data),r=n.attribs;n.disabled=o,n.mainele&&n.mainele.firstChild&&(o?(n.mainele.firstChild.style.backgroundColor="#DDD",pos=r.backgroundImageDisabled?(img="url("+i.imagePrefix+r.backgroundImageDisabled+")","center center"):(img="url("+i.imagePrefix+"defaultcolor.gif)","left top"),n.mainele.firstChild.style.backgroundPosition=pos,n.mainele.firstChild.style.backgroundImage=img):i.SetValue(t,n.value))},Re.Popup.Types.ColorChooser.GetValue=function(e,t){var o=Re.Popup;o.Types;return o.Controls[t].data.value},Re.Popup.Types.ColorChooser.Initialize=function(e,t,o){var i,n=Re.Popup,r=(n.Types,n.Controls[t].data);for(i in o.attribs)r.attribs[i]=o.attribs[i];o.value&&n.SetValue(t,o.value)},Re.Popup.Types.ColorChooser.Reset=function(e){var t=Re.Popup,o=t.Types,i=t.Controls;t.Current.id&&i[t.Current.id].type==e&&(o[e].Hide(e,t.Current.id),t.Current.id=null)},Re.Popup.Types.ColorChooser.Show=function(e,t){var o,i=Re.Popup,n=(i.Types,i.Controls[t].data);n.oldvalue=n.value,n.popupele=i.CreatePopupDiv(t,n.attribs),n.custom?(i=Re.Popup.Types.ColorChooser.MakeCustom(e,t),(o=document.createElement("div")).innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+i+"</div>",n.customele=o.firstChild.firstChild.childNodes[2]):(i=Re.Popup.Types.ColorChooser.CreateGrid(e,t),(o=document.createElement("div")).style.padding="3px",o.style.backgroundColor="#CCC",o.appendChild(i),n.customele=null),n.contentele=o,n.popupele.appendChild(o),n.attribs.ensureWithin&&Re.Popup.EnsurePosition(t,n.attribs.ensureWithin)},Re.Popup.Types.ColorChooser.MakeCustom=function(e,t){var o=Re.Popup,i=(o.Types,o.Controls[t].data),o=o.LocalizeString,n='style="font-size:smaller;"';return'<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+i.value+'"><br><br><input '+n+' type="button" value="'+o("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+t+"');return false;\"><input "+n+' type="button" value="'+o("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+t+"');\"><br></div>"},Re.Popup.Types.ColorChooser.ItemClicked=function(e,t){var o=Re.Popup;o.Types,o.Controls[e].data;Re.Popup.Close()},Re.Popup.Types.ColorChooser.CustomToList=function(e){var t=Re.Popup;t.Types,t.Controls[e].data},Re.Popup.Types.ColorChooser.CustomOK=function(e){var t=Re.Popup,o=(t.Types,t.Controls[e].data);t.SetValue(e,o.customele.value),t.Close()},Re.Popup.Types.ColorChooser.Hide=function(e,t){var o=Re.Popup,t=(o.Types,o.Controls[t].data);o.DestroyPopupDiv(t.popupele,t.dragregistered),t.popupele=null},Re.Popup.Types.ColorChooser.Cancel=function(e,t){var o=Re.Popup,i=(o.Types,o.Controls[t].data);o.SetValue(t,i.oldvalue),Re.Popup.Types.ColorChooser.Hide(e,t)},Re.Popup.Types.ColorChooser.CreateGrid=function(e,t){var o,i,n,r,s=Re.Popup,a=s.Types,l=s.Controls,c=s.LocalizeString,l=l[t].data,u=(l.grid={},l.grid),l=document.createElement("div"),d=document.createElement("table");for(d.cellSpacing=0,d.cellPadding=0,d.style.width="100px",u.table=d,d=document.createElement("tbody"),u.table.appendChild(d),u.tbody=d,o=0;o<16;o++){for(i=document.createElement("tr"),n=0;n<5;n++)u[o+","+n]=r={},(d=document.createElement("td")).style.fontSize="1px",d.innerHTML="&nbsp;",d.style.height="10px",n<=1?(d.style.width="17px",d.style.borderRight="3px solid white"):(d.style.width="20px",d.style.backgroundRepeat="no-repeat"),i.appendChild(d),r.ele=d;u.tbody.appendChild(i)}return l.appendChild(u.table),(d=document.createElement("div")).style.marginTop="3px",d.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+s.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+c("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+c("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+c("OK")+"</td></tr></table>",u.defaultbox=d.firstChild.firstChild.firstChild.childNodes[0],u.defaultbox.onclick=a.ColorChooser.DefaultClicked,u.custom=d.firstChild.firstChild.firstChild.childNodes[1],u.custom.onclick=a.ColorChooser.CustomClicked,u.msg=d.firstChild.firstChild.firstChild.childNodes[2],u.msg.onclick=a.ColorChooser.CloseOK,l.appendChild(d),u.table.onmousedown=a.ColorChooser.GridMouseDown,a.ColorChooser.DetermineColors(t),a.ColorChooser.SetColors(t),l},Re.Popup.Types.ColorChooser.gridToG=function(e,t,o){return e[t+","+o]},Re.Popup.Types.ColorChooser.DetermineColors=function(e){var t=Re.Popup,o=t.Types.ColorChooser,e=t.Controls[e].data,i=e.grid,e=t.splitRGB(e.value),n=2,r=16-Math.floor((e.r+16)/16);for(i["selectedrow"+n]=r,r=0;r<16;r++)o.gridToG(i,r,n).rgb=t.makeRGB(17*(15-r),0,0);for(n=3,r=16-Math.floor((e.g+16)/16),i["selectedrow"+n]=r,r=0;r<16;r++)o.gridToG(i,r,n).rgb=t.makeRGB(0,17*(15-r),0);for(n=4,r=16-Math.floor((e.b+16)/16),i["selectedrow"+n]=r,r=0;r<16;r++)o.gridToG(i,r,n).rgb=t.makeRGB(0,0,17*(15-r));for(n=1,r=0;r<16;r++)o.gridToG(i,r,n).rgb=t.makeRGB(17*(15-r),17*(15-r),17*(15-r));var s,a=[n=0,68,153,204,255],l=["400","310","420","440","442","340","040","042","032","044","024","004","204","314","402","414"];for(r=0;r<16;r++)s=l[r],o.gridToG(i,r,n).rgb="rgb("+a[+s.charAt(0)]+","+a[+s.charAt(1)]+","+a[+s.charAt(2)]+")"},Re.Popup.Types.ColorChooser.SetColors=function(e){for(var t,o,i=Re.Popup,n=i.Types.ColorChooser,r=i.Controls[e].data,s=r.grid,a=0;a<16;a++)for(t=0;t<5;t++)(o=n.gridToG(s,a,t)).ele.style.backgroundColor=o.rgb,o.ele.title=i.RGBToHex(o.rgb),s["selectedrow"+t]==a?o.ele.style.backgroundImage="url("+i.imagePrefix+"chooserarrow.gif)":o.ele.style.backgroundImage="";i.SetValue(e,r.value),s.msg.style.backgroundColor=r.value,(e=i.splitRGB(r.value||"rgb(255,255,255)")).r+e.g+e.b<220?s.msg.style.color="#FFF":s.msg.style.color="#000",r.value?(s.msg.style.backgroundImage="",s.msg.title=i.RGBToHex(r.value)):(s.msg.style.backgroundColor="#FFF",s.msg.style.backgroundImage="url("+i.imagePrefix+"defaultcolor.gif)",s.msg.title="Default")},Re.Popup.Types.ColorChooser.GridMouseDown=function(e){var e=e||M.event,t=Re.Popup,o=t.Types.ColorChooser,i=t.Controls,n=t.Current.id;if(n){var r=i[n].data,s=r.grid;switch(e.type){case"mousedown":s.mousedown=!0;break;case"mouseup":s.mousedown=!1;break;case"mousemove":if(s.mousedown)break;return}var i=Re.GetElementPositionWithScroll(r.mainele),a=e.clientX-i.left,e=e.clientY-i.top,l=Re.GetElementPositionWithScroll(s.table);l.left-=i.left,l.top-=i.top;var i=(i=Math.floor((e-l.top-2)/10))<0?0:i,e=Math.floor((a-l.left)/20),c=o.gridToG(s,i=i<0?0:15<i?15:i,e=e<0?0:4<e?4:e).ele.style.backgroundColor,u=t.splitRGB(c),d=t.splitRGB(r.value);switch(e){case 2:r.value=t.makeRGB(u.r,d.g,d.b);break;case 3:r.value=t.makeRGB(d.r,u.g,d.b);break;case 4:r.value=t.makeRGB(d.r,d.g,u.b);break;case 0:case 1:r.value=c}o.DetermineColors(n),o.SetColors(n)}},Re.Popup.Types.ColorChooser.ControlClicked=function(e){var t=Re.Popup,o=t.Types.ColorChooser,i=(t.Controls,t.Current.id);i&&e==i?o.CloseOK():t.CClick(e)},Re.Popup.Types.ColorChooser.DefaultClicked=function(e){e||M.event;var e=Re.Popup,t=(e.Types.ColorChooser,e.Controls),e=e.Current.id;e&&((t=t[e].data).value="",Re.Popup.SetValue(e,t.value),Re.Popup.Close())},Re.Popup.Types.ColorChooser.CustomClicked=function(e){e||M.event;var t,o,i,e=Re.Popup,n=(e.Types.ColorChooser,e.Controls),r=e.Current.id;r&&(t=(n=n[r].data).contentele,o=Re.Popup.Types.ColorChooser.MakeCustom("ColorChooser",r),(i=document.createElement("div")).innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+o+"</div>",n.customele=i.firstChild.firstChild.childNodes[2],n.contentele=i,n.popupele.replaceChild(i,t),n.customele.value=e.RGBToHex(n.value),n.attribs.ensureWithin&&Re.Popup.EnsurePosition(r,n.attribs.ensureWithin))},Re.Popup.Types.ColorChooser.CustomToGrid=function(e){var t,o,i=Re.Popup,n=(i.Types,i.Controls[e].data);Re.Popup.SetValue(e,i.HexToRGB("#"+n.customele.value)),i=n.contentele,t=Re.Popup.Types.ColorChooser.CreateGrid("ColorChooser",e),(o=document.createElement("div")).style.padding="3px",o.style.backgroundColor="#CCC",o.appendChild(t),n.customele=null,n.contentele=o,n.popupele.replaceChild(o,i),n.attribs.ensureWithin&&Re.Popup.EnsurePosition(e,n.attribs.ensureWithin)},Re.Popup.Types.ColorChooser.CustomOK=function(e){var t=Re.Popup,o=(t.Types,t.Controls[e].data);Re.Popup.SetValue(e,t.HexToRGB("#"+o.customele.value)),Re.Popup.Close()},Re.Popup.Types.ColorChooser.CloseOK=function(e){e||M.event;var e=Re.Popup,t=(e.Types.ColorChooser,e.Controls),e=e.Current.id;e&&(t=t[e].data,Re.Popup.SetValue(e,t.value),Re.Popup.Close())},Re||(alert("Main SocialCalc code module needed"),Re={}),Re.TableEditor||alert("SocialCalc TableEditor code module needed"),Re.CurrentSpreadsheetControlObject=null,Re.SpreadsheetControl=function(e){var t=Re.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.tabs=[],this.tabnums={},this.tabreplacements={},this.currentTab=-1,this.views={},this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.moverange="",this.idPrefix=e||"SocialCalc-",this.multipartBoundary="SocialCalcSpreadsheetControlSave",this.imagePrefix=t.defaultImagePrefix,this.toolbarbackground=t.SCToolbarbackground,this.tabbackground=t.SCTabbackground,this.tabselectedCSS=t.SCTabselectedCSS,this.tabplainCSS=t.SCTabplainCSS,this.toolbartext=t.SCToolbartext,this.formulabarheight=t.SCFormulabarheight,this.statuslineheight=t.SCStatuslineheight,this.statuslineCSS=t.SCStatuslineCSS,this.ExportCallback=null,void 0===Re.debug_log&&(Re.debug_log=[]),this.sheet=new Re.Sheet,this.context=new Re.RenderContext(this.sheet),this.context.showGrid=!0,this.context.showRCHeaders=!0,this.editor=new Re.TableEditor(this.context),this.editor.StatusCallback.statusline={func:Re.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}},(Re.CurrentSpreadsheetControlObject=this).editor.MoveECellCallback.movefrom=function(e){var t=Re.GetSpreadsheetControlObject();t.context.cursorsuffix="",e.range2.hasrange&&!e.cellhandles.noCursorSuffix&&(e.ecell.row==e.range2.top&&(e.ecell.col<e.range2.left||e.ecell.col>e.range2.right+1)&&(t.context.cursorsuffix="insertleft"),e.ecell.col==e.range2.left&&(e.ecell.row<e.range2.top||e.ecell.row>e.range2.bottom+1)&&(t.context.cursorsuffix="insertup"))},this.formulabuttons={formulafunctions:{image:"insertformula.png",tooltip:"Functions",command:Re.SpreadsheetControl.DoFunctionList},multilineinput:{image:"listbox.png",tooltip:"Multi-line Input Box",command:Re.SpreadsheetControl.DoMultiline},link:{image:"inserthyperlink.png",tooltip:"Link Input Box",command:Re.SpreadsheetControl.DoLink},sum:{image:"autosum.png",tooltip:"Auto Sum",command:Re.SpreadsheetControl.DoSum}},this.findbuttons={last:{image:"upsearch.png",tooltip:"Find Previous",command:Re.SpreadsheetControl.SearchUp},next:{image:"downsearch.png",tooltip:"Find Next",command:Re.SpreadsheetControl.SearchDown}},this.tabnums.edit=this.tabs.length,this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:10px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.png" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.png" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.png" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.png" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.formatpaintbrush.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;  <span id="%id.locktools"><img id="%id.button_lock" src="%img.lock.png" style="vertical-align:bottom;"> <img id="%id.button_unlock" src="%img.unlock.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;</span> <img id="%id.button_filldown" src="%img.filldown.png" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.png" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.png" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.png" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.png" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.mergecells.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrows.png" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcolumns.png" style="vertical-align:bottom;">  <img id="%id.button_deleterow" src="%img.deleterows.png" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecolumns.png" style="vertical-align:bottom;">  <img id="%id.button_hiderow" src="%img.hiderow.png" style="vertical-align:bottom;">  <img id="%id.button_hidecol" src="%img.hidecol.png" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.png" style="vertical-align:bottom;">  </div>',oncreate:null,onclick:null}),this.tabnums.settings=this.tabs.length,this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',view:"settings",onclick:function(e,t){Re.SettingsControls.idPrefix=e.idPrefix,Re.SettingControlReset();var o=e.sheet.EncodeSheetAttributes(),i=e.sheet.EncodeCellAttributes(e.editor.ecell.coord);Re.SettingsControlLoadPanel(e.views.settings.values.sheetspanel,o),Re.SettingsControlLoadPanel(e.views.settings.values.cellspanel,i),document.getElementById(e.idPrefix+"settingsecell").innerHTML=e.editor.ecell.coord,Re.SpreadsheetControlSettingsSwitch("cell"),e.views.settings.element.style.height=e.viewheight+"px",e.views.settings.element.firstChild.style.height=e.viewheight+"px",o=e.editor.range.hasrange?Re.crToCoord(e.editor.range.left,e.editor.range.top)+":"+Re.crToCoord(e.editor.range.right,e.editor.range.bottom):e.editor.ecell.coord,document.getElementById(e.idPrefix+"settings-savecell").value=Re.LocalizeString("Save to")+": "+o},onclickFocus:!0}),this.views.settings={name:"settings",values:{},oncreate:function(e,t){var o=Re.Constants;t.values.sheetspanel={colorchooser:{id:e.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"formatnumber",initialdata:o.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"formattext",initialdata:o.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"fontfamily",initialdata:o.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"fontlook",initialdata:o.SCFormatFontlook},fontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"fontsize",initialdata:o.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:e.idPrefix+"textalignhoriz",initialdata:o.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:e.idPrefix+"numberalignhoriz",initialdata:o.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"alignvert",initialdata:o.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"padtop",initialdata:o.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:e.idPrefix+"padright",initialdata:o.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"padbottom",initialdata:o.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"padleft",initialdata:o.SCFormatPadsizes},colwidth:{setting:"colwidth",type:"PopupList",id:e.idPrefix+"colwidth",initialdata:o.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:e.idPrefix+"recalc",initialdata:o.SCFormatRecalc},usermaxcol:{setting:"usermaxcol",type:"PopupList",id:e.idPrefix+"usermaxcol",initialdata:o.SCFormatUserMaxCol},usermaxrow:{setting:"usermaxrow",type:"PopupList",id:e.idPrefix+"usermaxrow",initialdata:o.SCFormatUserMaxRow}},t.values.cellspanel={name:"cell",colorchooser:{id:e.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"cformatnumber",initialdata:o.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"cformattext",initialdata:o.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"cfontfamily",initialdata:o.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"cfontlook",initialdata:o.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"cfontsize",initialdata:o.SCFormatFontsizes},calignhoriz:{setting:"alignhoriz",type:"PopupList",id:e.idPrefix+"calignhoriz",initialdata:o.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"calignvert",initialdata:o.SCFormatAlignVertical},ctextcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:e.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:e.idPrefix+"cbr"},cbb:{setting:"bb",type:"BorderSide",id:e.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:e.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"cpadtop",initialdata:o.SCFormatPadsizes},cpadright:{setting:"padright",type:"PopupList",id:e.idPrefix+"cpadright",initialdata:o.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"cpadbottom",initialdata:o.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"cpadleft",initialdata:o.SCFormatPadsizes}},Re.SettingsControlInitializePanel(t.values.sheetspanel),Re.SettingsControlInitializePanel(t.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id="%id.usermaxcol"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id="%id.usermaxrow"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'},this.tabnums.sort=this.tabs.length,this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option><option value="all">Sort All</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',onclick:Re.SpreadsheetControlSortOnclick}),this.editor.SettingsCallbacks.sort={save:Re.SpreadsheetControlSortSave,load:Re.SpreadsheetControlSortLoad},this.tabnums.audit=this.tabs.length,this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(e,t){for(var o,i=Re.LocalizeString,n='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+i("Audit Trail This Session")+":</b><br><br>",r=e.sheet.changes.stack,s=e.sheet.changes.tos,a=0;a<r.length;a++)for(a==s+1&&(n+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+i("UNDONE STEPS")+":<br>"),o=0;o<r[a].command.length;o++)n+=Re.special_chars(r[a].command[o])+"<br>";function l(e){if("string"==typeof e)return e;if(!e)return"null";if("object"==typeof e){for(var t=0,o=(l.check=l.check?l.check:new Array).length;t<o;++t)if(l.check[t]==e)return"{}";l.check.push(e)}var i,o="",n=void 0===e.length?1:0,r="";for(i in e)n&&(o="'"+i+"':"),"string"==typeof e[i]?r+=o+"'"+e[i]+"',":"object"==typeof e[i]?r+=o+l(e[i])+",":r+=o+e[i]+",";return"object"==typeof e&&l.check.pop(),n?"{"+r.slice(0,-1)+"}":"["+r.slice(0,-1)+"]"}if(void 0!==Re.debug_log)for(var c in Re.debug_log)n+=l(Re.debug_log[c])+"<br>";e.views.audit.element.innerHTML=n+"</td></tr></table>",Re.CmdGotFocus(!0)},onclickFocus:!0}),this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",html:"Audit Trail"},this.tabnums.comment=this.tabs.length,this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',view:"sheet",onclick:Re.SpreadsheetControlCommentOnclick,onunclick:Re.SpreadsheetControlCommentOnunclick}),this.tabnums.names=this.tabs.length,this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',view:"sheet",onclick:Re.SpreadsheetControlNamesOnclick,onunclick:Re.SpreadsheetControlNamesOnunclick}),this.tabnums.clipboard=this.tabs.length,this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:Re.SpreadsheetControlClipboardOnclick,onclickFocus:"clipboardtext"}),this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}},Re.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(e,t,o,i){return Re.InitializeSpreadsheetControl(this,e,t,o,i)},Re.SpreadsheetControl.prototype.DoOnResize=function(){return Re.DoOnResize(this)},Re.SpreadsheetControl.prototype.SizeSSDiv=function(){return Re.SizeSSDiv(this)},Re.SpreadsheetControl.prototype.ExecuteCommand=function(e,t){return Re.SpreadsheetControlExecuteCommand(this,e,t)},Re.SpreadsheetControl.prototype.CreateSheetHTML=function(){return Re.SpreadsheetControlCreateSheetHTML(this)},Re.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(e){return Re.SpreadsheetControlCreateSpreadsheetSave(this,e)},Re.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(e){return Re.SpreadsheetControlDecodeSpreadsheetSave(this,e)},Re.SpreadsheetControl.prototype.CreateCellHTML=function(e){return Re.SpreadsheetControlCreateCellHTML(this,e)},Re.SpreadsheetControl.prototype.CreateCellHTMLSave=function(e){return Re.SpreadsheetControlCreateCellHTMLSave(this,e)},Re.SpreadsheetControl.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},Re.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()},Re.InitializeSpreadsheetControl=function(e,t,o,i,n){var r,s,a,l,c,u,d,h,p=Re.Constants,f=Re.LocalizeString,m=Re.LocalizeSubstrings,g=e.tabs,v=e.views;for(e.requestedHeight=o,e.requestedWidth=i,e.requestedSpaceBelow=n,null==(t="string"==typeof t?document.getElementById(t):t)&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=t,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),s=t.firstChild;null!=s;s=t.firstChild)t.removeChild(s);for(r="<div>",r+='<div style="'+e.tabbackground+'"><table cellpadding="0" cellspacing="0"><tr>',a=0;a<g.length;a++)r+='  <td id="%id.'+g[a].name+'tab" style="'+(0==a?e.tabselectedCSS:e.tabplainCSS)+'" onclick="%s.SetTab(this);">'+f(g[a].text)+"</td>";for(r=r+" </tr></table></div>"+('<div style="'+e.toolbarbackground+'padding:12px 10px 10px 4px;">'),a=0;a<g.length;a++)r+=g[a].html;for(u in r=r+"</div>"+"</div>",e.currentTab=0,e.tabreplacements)r=r.replace(e.tabreplacements[u].regex,e.tabreplacements[u].replacement);for(d in r=m(r=(r=(r=(r=r.replace(/\%s\./g,"SocialCalc.")).replace(/\%id\./g,e.idPrefix)).replace(/\%tbt\./g,e.toolbartext)).replace(/\%img\./g,e.imagePrefix)),e.spreadsheetDiv.innerHTML=r,t.appendChild(e.spreadsheetDiv),e.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",command:"pasteformats"},button_lock:{tooltip:"Lock Cell",command:"lock"},button_unlock:{tooltip:"Unlock Cell",command:"unlock"},button_delete:{tooltip:"Delete Cell Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge/Unmerge Cells",command:"merge"},button_insertrow:{tooltip:"Insert Row Before",command:"insertrow"},button_insertcol:{tooltip:"Insert Column Before",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_hiderow:{tooltip:"Hide Row",command:"hiderow"},button_hidecol:{tooltip:"Hide Column",command:"hidecol"},button_recalc:{tooltip:"Recalculate",command:"recalc"}},e.Buttons)(h=document.getElementById(e.idPrefix+d))?(h.style.border="1px solid "+p.ISCButtonBorderNormal,h.title=f(e.Buttons[d].tooltip),Re.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid "+p.ISCButtonBorderNormal+";background-color:"+p.ISCButtonNormalBackground+";",hoverstyle:"border:1px solid "+p.ISCButtonBorderHover+";background-color:"+p.ISCButtonHoverBackground+";",downstyle:"border:1px solid "+p.ISCButtonBorderDown+";background-color:"+p.ISCButtonDownBackground+";"},{MouseDown:Re.DoButtonCmd,command:e.Buttons[d].command})):alert("Button "+(e.idPrefix+d)+" missing");e.formulabarDiv=document.createElement("div"),e.formulabarDiv.innerHTML='<input type="text" size="60" value="">&nbsp;',e.spreadsheetDiv.appendChild(e.formulabarDiv);new Re.InputBox(e.formulabarDiv.firstChild,e.editor);for(d in e.formulabuttons)(h=document.createElement("img")).id=e.idPrefix+d,h.src=(e.formulabuttons[d].skipImagePrefix?"":e.imagePrefix)+e.formulabuttons[d].image,h.style.verticalAlign="middle",h.style.border="1px solid #FFF",h.style.marginLeft="4px",h.title=f(e.formulabuttons[d].tooltip),Re.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.formulabuttons[d].command,Disabled:function(){return e.editor.ECellReadonly()}}),e.formulabarDiv.appendChild(h);var o=$("<input id='searchbarinput' value='' placeholder='Search sheet…'>"),b=$("<span id='searchbar'></span>");for(d in b.append("<div id='searchstatus'></div>"),b.append(o),e.findbuttons)(h=document.createElement("img")).id=e.idPrefix+d,h.src=e.imagePrefix+e.findbuttons[d].image,h.style.verticalAlign="middle",h.style.border="1px solid #FFF",h.title=f(e.findbuttons[d].tooltip),Re.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.findbuttons[d].command,Disabled:function(){return!1}}),b[0].appendChild(h);for(o.on("input",Re.SpreadsheetControl.FindInSheet),o.on("focus",function(){Re.Keyboard.passThru=!0}),o.on("blur",function(){Re.Keyboard.passThru=!1}),o.keyup(function(e){13==e.keyCode&&(e.shiftKey?Re.SpreadsheetControl.SearchUp():Re.SpreadsheetControl.SearchDown())}),e.formulabarDiv.appendChild(b[0]),a=0;a<g.length;a++)g[a].oncreate&&g[a].oncreate(e,g[a].name);Re.CalculateSheetNonViewHeight(e),e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight);i=document.createElement("div"),i.id="te_appView",i.appendChild(e.editorDiv),e.editorDiv=i,n=document.createElement("div");for(l in n.id="te_formData",n.style.display="none",e.editorDiv.appendChild(n),e.spreadsheetDiv.appendChild(e.editorDiv),e.formDataViewer=new Re.SpreadsheetViewer("te_FormData-"),e.formDataViewer.InitializeSpreadsheetViewer(n.id,180,0,200),e.formDataViewer.editor.ignoreRender=!0,v){for(u in r=v[l].html,v[l].replacements)r=r.replace(v[l].replacements[u].regex,v[l].replacements[u].replacement);r=(r=(r=(r=r.replace(/\%s\./g,"SocialCalc.")).replace(/\%id\./g,e.idPrefix)).replace(/\%tbt\./g,e.toolbartext)).replace(/\%img\./g,e.imagePrefix),c=document.createElement("div"),Re.setStyles(c,v[l].divStyle),c.style.display="none",c.style.width=e.width+"px",c.style.height=e.viewheight+"px",c.id=e.idPrefix+v[l].name+"view",r=m(r),c.innerHTML=r,e.spreadsheetDiv.appendChild(c),v[l].element=c,v[l].oncreate&&v[l].oncreate(e,v[l])}if(v.sheet={name:"sheet",element:e.editorDiv},e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-+e.statuslineDiv.style.paddingTop.slice(0,-2)-+e.statuslineDiv.style.paddingBottom.slice(0,-2)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.spreadsheetDiv.addEventListener)e.spreadsheetDiv.addEventListener("mousedown",function(){Re.SetSpreadsheetControlObject(e)},!1),e.spreadsheetDiv.addEventListener("mouseover",function(){Re.SetSpreadsheetControlObject(e)},!1);else{if(!e.spreadsheetDiv.attachEvent)throw Re.Constants.s_BrowserNotSupported;e.spreadsheetDiv.attachEvent("onmousedown",function(){Re.SetSpreadsheetControlObject(e)}),e.spreadsheetDiv.attachEvent("onmouseover",function(){Re.SetSpreadsheetControlObject(e)})}},Re.CalculateSheetNonViewHeight=function(e){e.nonviewheight=e.statuslineheight;for(var t=0;t<e.spreadsheetDiv.childNodes.length;t++)"SocialCalc-statusline"!=e.spreadsheetDiv.childNodes[t].id&&(e.nonviewheight+=e.spreadsheetDiv.childNodes[t].offsetHeight)},Re.LocalizeString=function(e){var t=Re.LocalizeStringList[e];return t||(t=Re.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,Re.LocalizeStringList[e]=t),t},Re.LocalizeStringList={},Re.LocalizeSubstrings=function(e){var i=Re.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,t,o){return"ssc"==t?Re.Constants[o]||alert("Missing constant: "+o):i(o)})},Re.GetSpreadsheetControlObject=function(){var e=null!=Re.CurrentSpreadsheetControlObject?Re.CurrentSpreadsheetControlObject:Re.CurrentSpreadsheetViewerObject;if(e)return e},Re.SetSpreadsheetControlObject=function(e){Re.CurrentSpreadsheetControlObject=e,Re.Keyboard.focusTable&&e&&(Re.Keyboard.focusTable=e.editor)},Re.DoOnResize=function(e){var t,o=e.views;if(e.SizeSSDiv()){for(vname in o)(t=o[vname].element).style.width=e.width+"px",t.style.height=e.height-e.nonviewheight+"px";e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},Re.SizeSSDiv=function(e){var t,o=!1,i=Re.GetViewportInfo(),n=Re.GetElementPosition(e.parentNode);return n.bottom=0,n.right=0,(t=e.parentNode.style).marginTop&&(n.top+=+t.marginTop.slice(0,-2)),t.marginBottom&&(n.bottom+=+t.marginBottom.slice(0,-2)),t.marginLeft&&(n.left+=+t.marginLeft.slice(0,-2)),t.marginRight&&(n.right+=+t.marginRight.slice(0,-2)),t=e.requestedHeight||i.height-(n.top+n.bottom+10)-(e.requestedSpaceBelow||0),e.height!=t&&(e.height=t,e.spreadsheetDiv.style.height=t+"px",o=!0),t=e.requestedWidth||i.width-(n.left+n.right+10)||700,e.width!=t&&(e.width=t,e.spreadsheetDiv.style.width=t+"px",o=!0),e.spreadsheetDiv.style.position="relative",o},Re.SetTab=function(e){var t,o,i,n,r,s={},a={},l=Re.GetSpreadsheetControlObject(),c=l.tabs,u=l.views,d="string"==typeof e?e:e.id.slice(l.idPrefix.length,-3);if(l.editor.busy&&(!c[l.currentTab].view||"sheet"==c[l.currentTab].view))for(n=0;n<c.length;n++)if(c[n].name==d&&c[n].view&&"sheet"!=c[n].view)return;for(l.tabs[l.currentTab].onunclick&&l.tabs[l.currentTab].onunclick(l,l.tabs[l.currentTab].name),n=0;n<c.length;n++)s[t=c[n].name]=document.getElementById(l.idPrefix+t+"tab"),a[t]=document.getElementById(l.idPrefix+t+"tools"),t==d?(o=n,a[t].style.display="block",s[t].style.cssText=l.tabselectedCSS):(a[t].style.display="none",s[t].style.cssText=l.tabplainCSS);for(r in c[l.currentTab=o].onclick&&c[o].onclick(l,d),u)!c[o].view&&"sheet"==r||c[o].view==r?(u[r].element.style.display="block",i=r):u[r].element.style.display="none";c[o].onclickFocus?("string"==typeof(e=c[o].onclickFocus)&&(e=document.getElementById(l.idPrefix+e)).focus(),Re.CmdGotFocus(e)):Re.KeyboardFocus(),u[i].needsresize&&u[i].onresize&&(u[i].needsresize=!1,u[i].onresize(l,u[i])),"sheet"==i?(l.statuslineDiv.style.display="block",l.editor.ScheduleRender()):l.statuslineDiv.style.display="none"},Re.SpreadsheetControlStatuslineCallback=function(e,t,o,i){var n,r,s=document.getElementById(i.statuslineid);switch(s&&(s.innerHTML=e.GetStatuslineString(t,o,i)),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":if(n=document.getElementById(i.recalcid1),r=document.getElementById(i.recalcid2),!n||!r)break;"yes"==e.context.sheetobj.attribs.needsrecalc?(n.style.display="inline",r.style.display="inline"):(n.style.display="none",r.style.display="none")}},Re.UpdateSortRangeProposal=function(e){var t=document.getElementById(Re.GetSpreadsheetControlObject().idPrefix+"sortlist");e.range.hasrange?t.options[0].text=Re.crToCoord(e.range.left,e.range.top)+":"+Re.crToCoord(e.range.right,e.range.bottom):t.options[0].text=Re.LocalizeString("[select range]")},Re.LoadColumnChoosers=function(e){var t,o=Re.LocalizeString,i=e.sortrange&&-1==e.sortrange.indexOf(":")?"range"==(i=Re.Formula.LookupName(e.sheet,e.sortrange||"")).type?(i=i.value.match(/^(.*)\|(.*)\|$/))[1]+":"+i[2]:"A1:A1":e.sortrange,n=Re.ParseRange(i),r=document.getElementById(e.idPrefix+"majorsort"),i=r.selectedIndex;r.options.length=0,r.options[r.options.length]=new Option(o("[None]"),"");for(var s=n.cr1.col;s<=n.cr2.col;s++)t=Re.rcColname(s),r.options[r.options.length]=new Option(o("Column ")+t,t);r.selectedIndex=1<i&&i<=n.cr2.col-n.cr1.col+1?i:1,i=(r=document.getElementById(e.idPrefix+"minorsort")).selectedIndex,r.options.length=0,r.options[r.options.length]=new Option(o("[None]"),"");for(s=n.cr1.col;s<=n.cr2.col;s++)t=Re.rcColname(s),r.options[r.options.length]=new Option(t,t);r.selectedIndex=0<i&&i<=n.cr2.col-n.cr1.col+1?i:0,i=(r=document.getElementById(e.idPrefix+"lastsort")).selectedIndex,r.options.length=0,r.options[r.options.length]=new Option(o("[None]"),"");for(s=n.cr1.col;s<=n.cr2.col;s++)t=Re.rcColname(s),r.options[r.options.length]=new Option(t,t);r.selectedIndex=0<i&&i<=n.cr2.col-n.cr1.col+1?i:0},Re.CmdGotFocus=function(e){Re.Keyboard.passThru=e},Re.DoButtonCmd=function(e,t,o){Re.DoCmd(o.element,o.functionobj.command)},Re.DoCmd=function(e,t){var o,i,n,r,s,a,l,c,u,d,h,p=Re.GetSpreadsheetControlObject(),f=p.editor;switch(t){case"undo":p.ExecuteCommand("undo","");break;case"redo":p.ExecuteCommand("redo","");break;case"fill-rowcolstuff":case"fill-text":for(n=t.substring(5),r=(s=document.getElementById(p.idPrefix+n+"list")).length=0;r<Re.SpreadsheetCmdTable[n].length;r++)s.options[r]=new Option(Re.SpreadsheetCmdTable[n][r].t);t="changed-"+n;case"changed-rowcolstuff":case"changed-text":for(n=t.substring(8),s=document.getElementById(p.idPrefix+n+"list"),a=Re.SpreadsheetCmdTable.slists[Re.SpreadsheetCmdTable[n][s.selectedIndex].s],r=(l=document.getElementById(p.idPrefix+n+"slist")).length=0;r<(a.length||0);r++)l.options[r]=new Option(a[r].t,a[r].s);return;case"ok-rowcolstuff":case"ok-text":n=t.substring(3),s=document.getElementById(p.idPrefix+n+"list"),l=document.getElementById(p.idPrefix+n+"slist"),o=Re.SpreadsheetCmdTable[n][s.selectedIndex].c,i=l[l.selectedIndex].value,Re.SpreadsheetControlExecuteCommand(e,o,i);break;case"ok-setsort":var m=document.getElementById(p.idPrefix+"sortlist");if(0==m.selectedIndex)f.range.hasrange?p.sortrange=Re.crToCoord(f.range.left,f.range.top)+":"+Re.crToCoord(f.range.right,f.range.bottom):p.sortrange=f.ecell.coord+":"+f.ecell.coord;else if("all"==m.options[m.selectedIndex].value){var g,v=-1,b=-1,y=-1,C=-1;for(g in p.sheet.cells){var w=Re.coordToCr(g);(-1==y||w.row<y)&&(y=w.row),(-1==v||w.col<v)&&(v=w.col),(-1==C||w.row>C)&&(C=w.row),(-1==b||w.col>b)&&(b=w.col)}p.sortrange=Re.crToCoord(v,y)+":"+Re.crToCoord(b,C),m.options[m.selectedIndex].text+=" ("+p.sortrange+")"}else p.sortrange=m.options[m.selectedIndex].value;return(m=document.getElementById(p.idPrefix+"sortbutton")).value=Re.LocalizeString("Sort ")+p.sortrange,m.style.visibility="visible",Re.LoadColumnChoosers(p),e&&e.blur&&e.blur(),void Re.KeyboardFocus();case"dosort":if(p.sortrange&&-1==p.sortrange.indexOf(":")){if("range"!=(h=Re.Formula.LookupName(p.sheet,p.sortrange||"")).type)return;h=(h=h.value.match(/^(.*)\|(.*)\|$/))[1]+":"+h[2]}else h=p.sortrange;if("A1:A1"==h)return;h="sort "+h+" ",d=document.getElementById(p.idPrefix+"majorsort"),c=document.getElementById(p.idPrefix+"majorsortup"),h+=d.options[d.selectedIndex].value+(c.checked?" up":" down"),0<(d=document.getElementById(p.idPrefix+"minorsort")).selectedIndex&&(c=document.getElementById(p.idPrefix+"minorsortup"),h+=" "+d.options[d.selectedIndex].value+(c.checked?" up":" down")),0<(d=document.getElementById(p.idPrefix+"lastsort")).selectedIndex&&(c=document.getElementById(p.idPrefix+"lastsortup"),h+=" "+d.options[d.selectedIndex].value+(c.checked?" up":" down")),p.ExecuteCommand(h,"");break;case"merge":o=Re.SpreadsheetCmdLookup[t]||"",i=Re.SpreadsheetCmdSLookup[t]||"",p.ExecuteCommand(o,i),f.range.hasrange&&(f.MoveECell(Re.crToCoord(f.range.left,f.range.top)),f.RangeRemove());break;case"movefrom":f.range2.hasrange?(p.context.cursorsuffix="",f.Range2Remove(),p.ExecuteCommand("redisplay","")):f.range.hasrange?(f.range2.top=f.range.top,f.range2.right=f.range.right,f.range2.bottom=f.range.bottom,f.range2.left=f.range.left,f.range2.hasrange=!0,f.MoveECell(Re.crToCoord(f.range.left,f.range.top))):(f.range2.top=f.ecell.row,f.range2.right=f.ecell.col,f.range2.bottom=f.ecell.row,f.range2.left=f.ecell.col,f.range2.hasrange=!0),h=f.range2.hasrange?"":"off",(m=document.getElementById(p.idPrefix+"button_movefrom")).src=p.imagePrefix+"movefrom"+h+".gif",(m=document.getElementById(p.idPrefix+"button_movepaste")).src=p.imagePrefix+"movepaste"+h+".gif",(m=document.getElementById(p.idPrefix+"button_moveinsert")).src=p.imagePrefix+"moveinsert"+h+".gif",f.range2.hasrange&&f.RangeRemove();break;case"movepaste":case"moveinsert":f.range2.hasrange&&(p.context.cursorsuffix="",o=t+" "+Re.crToCoord(f.range2.left,f.range2.top)+":"+Re.crToCoord(f.range2.right,f.range2.bottom)+" "+f.ecell.coord,p.ExecuteCommand(o,""),f.Range2Remove(),(m=document.getElementById(p.idPrefix+"button_movefrom")).src=p.imagePrefix+"movefromoff.gif",(m=document.getElementById(p.idPrefix+"button_movepaste")).src=p.imagePrefix+"movepasteoff.gif",(m=document.getElementById(p.idPrefix+"button_moveinsert")).src=p.imagePrefix+"moveinsertoff.gif");break;case"swapcolors":c=(d=p.sheet).GetAssuredCell(f.ecell.coord),h=d.attribs.defaultcolor?d.colors[d.attribs.defaultcolor]:"rgb(0,0,0)",m=d.attribs.defaultbgcolor?d.colors[d.attribs.defaultbgcolor]:"rgb(255,255,255)",u=c.color?d.colors[c.color]:h,d=c.bgcolor?d.colors[c.bgcolor]:m,p.ExecuteCommand("set %C color "+(d=d==h?"":d)+"%Nset %C bgcolor "+(u=u==m?"":u),"");break;default:o=Re.SpreadsheetCmdLookup[t]||"",i=Re.SpreadsheetCmdSLookup[t]||"",p.ExecuteCommand(o,i)}e&&e.blur&&e.blur(),Re.KeyboardFocus()},Re.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats",lock:"set %C readonly yes",unlock:"set %C readonly no",delete:"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center","align-right":"set %C cellformat right","align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",hiderow:"set %H hide yes",hidecol:"set %W hide yes",undo:"undo",redo:"redo",recalc:"recalc"},Re.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""},Re.SpreadsheetControlExecuteCommand=function(e,t,o){var i=Re.GetSpreadsheetControlObject().editor,n={P:"%",N:"\n"};i.range.hasrange?(n.R=Re.crToCoord(i.range.left,i.range.top)+":"+Re.crToCoord(i.range.right,i.range.bottom),n.C=n.R,n.W=Re.rcColname(i.range.left)+":"+Re.rcColname(i.range.right),n.H=i.range.top+":"+i.range.bottom):i.ecell?(n.C=i.ecell.coord,n.R=i.ecell.coord+":"+i.ecell.coord,n.W=Re.rcColname(Re.coordToCr(i.ecell.coord).col),n.H=Re.coordToCr(i.ecell.coord).row):(n.C="A1",n.R="A1:A1",n.W=Re.rcColname(Re.coordToCr("A1").col),n.H=Re.coordToCr("A1").row),n.S=o,t=(t=(t=(t=(t=(t=(t=t.replace(/%C/g,n.C)).replace(/%R/g,n.R)).replace(/%N/g,n.N)).replace(/%S/g,n.S)).replace(/%W/g,n.W)).replace(/%H/g,n.H)).replace(/%P/g,n.P),i.EditorScheduleSheetCommands(t,!0,!1)},Re.SpreadsheetControlCreateSheetHTML=function(e){var e=new Re.RenderContext(e.sheet),t=document.createElement("div"),o=e.RenderSheet(null,{type:"html"});return t.appendChild(o),delete e,e=t.innerHTML,delete o,delete t,e},Re.SpreadsheetControlCreateCellHTML=function(e,t,o){var i="",n=e.sheet.cells[t];return!n||"&nbsp;"==(i=null==n.displaystring?Re.FormatValueForDisplay(e.sheet,n.datavalue,t,o||e.context.defaultHTMLlinkstyle):n.displaystring)?"":i},Re.SpreadsheetControlCreateCellHTMLSave=function(e,t,o){var i,n,r,s,a=[],t=t?Re.ParseRange(t):{cr1:{row:1,col:1},cr2:{row:e.sheet.attribs.lastrow,col:e.sheet.attribs.lastcol}},l=t.cr1,c=t.cr2;for(a.push("version:1.0"),i=l.row;i<=c.row;i++)for(n=l.col;n<=c.col;n++)r=Re.crToCoord(n,i),(s=e.sheet.cells[r])&&"&nbsp;"!=(s=null==s.displaystring?Re.FormatValueForDisplay(e.sheet,s.datavalue,r,o||e.context.defaultHTMLlinkstyle):s.displaystring)&&a.push(r+":"+Re.encodeForSave(s));return a.push(""),a.join("\n")},Re.SpreadsheetControl.DoFunctionList=function(){var e,t=Re.Formula,o=Re.Constants.function_classlist,i=Re.GetSpreadsheetControlObject(),n=i.idPrefix+"function",r=document.getElementById(n+"dialog");if(!r){for(t.FillFunctionInfo(),s='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+n+'class" size="'+o.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">',e=0;e<o.length;e++)s+='<option value="'+o[e]+'"'+(0==e?" selected>":">")+Re.special_chars(t.FunctionClasses[o[e]].name)+"</option>";var s=(s=(s+='</select></td><td>&nbsp;&nbsp;</td><td id="'+n+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+n+'name" size="'+o.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">')+Re.SpreadsheetControl.GetFunctionNamesStr("all"))+('</td></tr><tr><td colspan="3"><div id="'+n+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+Re.SpreadsheetControl.GetFunctionInfoStr(t.FunctionClasses[o[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>'),a=document.createElement("div"),l=(a.id=n+"dialog",a.style.position="absolute",Re.GetViewportInfo()),c=Re.GetElementPositionWithScroll(i.spreadsheetDiv);a.style.top=l.height/3-c.top+"px",a.style.left=l.width/3-c.left+"px",a.style.zIndex=100,a.style.backgroundColor="#FFF",a.style.border="1px solid black",a.style.width="400px",s=Re.LocalizeSubstrings(s='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+s+"</div>"),a.innerHTML=s,Re.DragRegister(a.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null,positionobj:a},i.spreadsheetDiv),i.spreadsheetDiv.appendChild(a),(r=document.getElementById(n+"name")).focus(),Re.CmdGotFocus(r)}},Re.SpreadsheetControl.GetFunctionNamesStr=function(e){for(var t="",o=Re.Formula.FunctionClasses[e],i=0;i<o.items.length;i++)t+='<option value="'+o.items[i]+'"'+(0==i?" selected>":">")+o.items[i]+"</option>";return t},Re.SpreadsheetControl.FillFunctionNames=function(e,t){var o,i,n=Re.Formula;for(t.length=0,i=n.FunctionClasses[e],o=0;o<i.items.length;o++)t.options[o]=new Option(i.items[o],i.items[o]),0==o&&(t.options[o].selected=!0)},Re.SpreadsheetControl.GetFunctionInfoStr=function(e){var t=Re.Formula,o=t.FunctionList[e],i=Re.special_chars,t="<b>"+e+"("+i(t.FunctionArgString(e))+")</b><br>";return t+=i(o[3])},Re.SpreadsheetControl.FunctionClassChosen=function(e){var t=Re.GetSpreadsheetControlObject().idPrefix+"function",o=Re.Formula;Re.SpreadsheetControl.FillFunctionNames(e,document.getElementById(t+"name")),Re.SpreadsheetControl.FunctionChosen(o.FunctionClasses[e].items[0])},Re.SpreadsheetControl.FunctionChosen=function(e){var t=Re.GetSpreadsheetControlObject().idPrefix+"function";document.getElementById(t+"desc").innerHTML=Re.SpreadsheetControl.GetFunctionInfoStr(e)},Re.SpreadsheetControl.HideFunctions=function(){var e=Re.GetSpreadsheetControlObject(),e=document.getElementById(e.idPrefix+"functiondialog");e.innerHTML="",Re.DragUnregister(e),Re.KeyboardFocus(),e.parentNode&&e.parentNode.removeChild(e)},Re.SpreadsheetControl.DoFunctionPaste=function(){var e=Re.GetSpreadsheetControlObject(),t=e.editor,o=document.getElementById(e.idPrefix+"functionname"),e=document.getElementById(e.idPrefix+"multilinetextarea"),o=o.value+"(";Re.SpreadsheetControl.HideFunctions(),e?(e.value+=o,e.focus(),Re.CmdGotFocus(e)):t.EditorAddToInput(o,"=")},Re.SpreadsheetControl.DoMultiline=function(){var e=Re.LocalizeSubstrings,t=(Re.Constants,Re.GetSpreadsheetControlObject()),o=t.editor,i=o.workingvalues,n=(t=Re.GetSpreadsheetControlObject()).idPrefix+"multiline",r=document.getElementById(n+"dialog");if(!r){switch(o.state){case"start":i.ecoord=o.ecell.coord,i.erow=o.ecell.row,i.ecol=o.ecell.col,o.RangeRemove(),s=Re.GetCellContents(o.context.sheetobj,i.ecoord);break;case"input":case"inputboxdirect":s=o.inputBox.GetText()}o.inputBox.element.disabled=!0;var s,a='<textarea id="'+n+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+(s=Re.special_chars(s))+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+e('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>'),l=document.createElement("div"),c=(l.id=n+"dialog",l.style.position="absolute",Re.GetViewportInfo()),u=Re.GetElementPositionWithScroll(t.spreadsheetDiv);l.style.top=c.height/3-u.top+"px",l.style.left=c.width/3-u.left+"px",l.style.zIndex=100,l.style.backgroundColor="#FFF",l.style.border="1px solid black",l.style.width="400px",l.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+e("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+a+"</div>",Re.DragRegister(l.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null,positionobj:l},t.spreadsheetDiv),t.spreadsheetDiv.appendChild(l),(r=document.getElementById(n+"textarea")).focus(),Re.CmdGotFocus(r)}},Re.SpreadsheetControl.HideMultiline=function(){Re.Constants;var e=Re.GetSpreadsheetControlObject(),t=e.editor,e=document.getElementById(e.idPrefix+"multilinedialog");switch(e.innerHTML="",Re.DragUnregister(e),Re.KeyboardFocus(),e.parentNode&&e.parentNode.removeChild(e),t.state){case"start":t.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":t.inputBox.element.disabled=!1,t.inputBox.Focus()}},Re.SpreadsheetControl.DoMultilineClear=function(){var e=Re.GetSpreadsheetControlObject(),e=document.getElementById(e.idPrefix+"multilinetextarea");e.value="",e.focus()},Re.SpreadsheetControl.DoMultilinePaste=function(){var e=Re.GetSpreadsheetControlObject(),t=e.editor,o=t.workingvalues,e=document.getElementById(e.idPrefix+"multilinetextarea").value;switch(Re.SpreadsheetControl.HideMultiline(),t.state){case"start":o.partialexpr="",o.ecoord=t.ecell.coord,o.erow=t.ecell.row,o.ecol=t.ecell.col;break;case"input":case"inputboxdirect":t.inputBox.Blur(),t.inputBox.ShowInputBox(!1),t.state="start"}t.EditorSaveEdit(e)},Re.SpreadsheetControl.DoLink=function(){var e=Re.LocalizeString,t=(Re.Constants,Re.GetSpreadsheetControlObject()),o=t.editor,i=o.workingvalues,n=(t=Re.GetSpreadsheetControlObject()).idPrefix+"link",r=document.getElementById(n+"dialog");if(!r){switch(o.state){case"start":i.ecoord=o.ecell.coord,i.erow=o.ecell.row,i.ecol=o.ecell.col,o.RangeRemove(),a=Re.GetCellContents(o.context.sheetobj,i.ecoord);break;case"input":case"inputboxdirect":a=o.inputBox.GetText()}o.inputBox.element.disabled=!0,"'"==a.charAt(0)&&(a=a.slice(1));var s=Re.ParseCellLinkText(a),a=Re.special_chars(a),l=(l=t.sheet.cells[o.ecell.coord])&&l.textvalueformat?"":" checked",c=s.newwin?" checked":"",u='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+e("Description")+'</span><br><input type="text" id="'+n+'desc" style="width:380px;" value="'+Re.special_chars(s.desc)+'"><br><span style="font-size:smaller;">'+e("URL")+'</span><br><input type="text" id="'+n+'url" style="width:380px;" value="'+Re.special_chars(s.url)+'"><br>',s=(Re.Callbacks.MakePageLink&&(u+='<span style="font-size:smaller;">'+e("Page Name")+'</span><br><input type="text" id="'+n+'pagename" style="width:380px;" value="'+Re.special_chars(s.pagename)+'"><br><span style="font-size:smaller;">'+e("Workspace")+'</span><br><input type="text" id="'+n+'workspace" style="width:380px;" value="'+Re.special_chars(s.workspace)+'"><br>'),u+=Re.LocalizeSubstrings('<input type="checkbox" id="'+n+'format"'+l+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+n+'popup"'+c+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>'),document.createElement("div")),l=(s.id=n+"dialog",s.style.position="absolute",Re.GetViewportInfo()),c=Re.GetElementPositionWithScroll(t.spreadsheetDiv);s.style.top=l.height/3-c.top+"px",s.style.left=l.width/3-c.left+"px",s.style.zIndex=100,s.style.backgroundColor="#FFF",s.style.border="1px solid black",s.style.width="400px",s.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+e("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+u+"</div>",Re.DragRegister(s.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:Re.DragFunctionStart,MouseMove:Re.DragFunctionPosition,MouseUp:Re.DragFunctionPosition,Disabled:null,positionobj:s},t.spreadsheetDiv),t.spreadsheetDiv.appendChild(s),(r=document.getElementById(n+"url")).focus(),Re.CmdGotFocus(r)}},Re.SpreadsheetControl.HideLink=function(){Re.Constants;var e=Re.GetSpreadsheetControlObject(),t=e.editor,e=document.getElementById(e.idPrefix+"linkdialog");switch(e.innerHTML="",Re.DragUnregister(e),Re.KeyboardFocus(),e.parentNode&&e.parentNode.removeChild(e),t.state){case"start":t.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":t.inputBox.element.disabled=!1,t.inputBox.Focus()}},Re.SpreadsheetControl.DoLinkClear=function(){var e=Re.GetSpreadsheetControlObject(),e=(document.getElementById(e.idPrefix+"linkdesc").value="",document.getElementById(e.idPrefix+"linkpagename").value="",document.getElementById(e.idPrefix+"linkworkspace").value="",document.getElementById(e.idPrefix+"linkurl"));e.value="",e.focus()},Re.SpreadsheetControl.DoLinkPaste=function(){var e,t,o,i=Re.GetSpreadsheetControlObject(),n=i.editor,r=n.workingvalues,s=document.getElementById(i.idPrefix+"linkdesc"),a=document.getElementById(i.idPrefix+"linkurl"),l=document.getElementById(i.idPrefix+"linkpagename"),c=document.getElementById(i.idPrefix+"linkworkspace"),u=document.getElementById(i.idPrefix+"linkformat"),d="",i=document.getElementById(i.idPrefix+"linkpopup").checked?(e="<<",t=">>",o="[[","]]"):(e="<",t=">",o="[","]"),d=l&&l.value?c.value?s.value+"{"+c.value+o+l.value+i+"}":s.value+o+l.value+i:s.value+e+a.value+t;switch(Re.SpreadsheetControl.HideLink(),n.state){case"start":r.partialexpr="",r.ecoord=n.ecell.coord,r.erow=n.ecell.row,r.ecol=n.ecell.col;break;case"input":case"inputboxdirect":n.inputBox.Blur(),n.inputBox.ShowInputBox(!1),n.state="start"}u.checked&&Re.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link",""),n.EditorSaveEdit(d)},Re.SpreadsheetControl.DoSum=function(){var e,t,o,i,n,r=Re.GetSpreadsheetControlObject().editor,s=r.context.sheetobj;if(r.range.hasrange)o=Re.crToCoord(r.range.left,r.range.top)+":"+Re.crToCoord(r.range.right,r.range.bottom),o="set "+Re.crToCoord(r.range.right,r.range.bottom+1)+" formula sum("+o+")";else if(e=r.ecell.row-1,t=r.ecell.col,e<=1)o="set "+r.ecell.coord+" constant e#REF! 0 #REF!";else{for(n=!1;0<e;){if(i=Re.crToCoord(t,e),(i=s.GetAssuredCell(i)).datatype&&"t"!=i.datatype)n=!0;else if(n){e++;break}e--}o="set "+r.ecell.coord+" formula sum("+Re.crToCoord(t,e)+":"+Re.crToCoord(t,r.ecell.row-1)+")"}r.EditorScheduleSheetCommands(o,!0,!1)},Re.SpreadsheetControl.FindInSheet=function(){var e=$("#searchstatus"),t=Re.GetSpreadsheetControlObject();if(!this.value.length)return e.text(""),t.sheet.search_cells=[],void(t.sheet.selected_search_cell=void 0);var o,i=t.sheet.cells,n=new RegExp(this.value,"im"),r=[];for(o in i){var s=i[o],a=Re.coordToCr(o);"yes"!==t.sheet.rowattribs.hide[a.row]&&"yes"!==t.sheet.colattribs.hide[Re.rcColname(a.col)]&&void 0!==(a="c"===s.datatype?s.displaystring:String(s.datavalue))&&a.match(n)&&r.push(o)}(t.sheet.search_cells=r).length?(t.sheet.selected_search_cell=0,t.editor.MoveECell(r[0]),e.text("1 of "+r.length)):(t.sheet.selected_search_cell=void 0,e.text("No Matches"))},Re.SpreadsheetControl.SearchSheet=function(e){var t,o=Re.GetSpreadsheetControlObject(),i=o.sheet,n=i.search_cells;n.length&&((t=i.selected_search_cell)===(0===e?0:n.length-1)?t=0===e?n.length-1:0:t+=0===e?-1:1,e=n[t],i.selected_search_cell=t,o.editor.MoveECell(e),document.getElementById("searchstatus").textContent=String(t+1)+" of "+n.length)},Re.SpreadsheetControl.SearchUp=function(){Re.SpreadsheetControl.SearchSheet(0)},Re.SpreadsheetControl.SearchDown=function(){Re.SpreadsheetControl.SearchSheet(1)},Re.SpreadsheetControlSortOnclick=function(e,t){var o,i,n=[],r=document.getElementById(e.idPrefix+"sortlist");for(o in Re.LoadColumnChoosers(e),e.editor.RangeChangeCallback.sort=Re.UpdateSortRangeProposal,e.sheet.names)n.push(o);for(n.sort(),r.length=0,r.options[0]=new Option(Re.LocalizeString("[select range]")),r.options[1]=new Option(Re.LocalizeString("Sort All"),"all"),n_options=r.options.length,i=0;i<n.length;i++)o=n[i],r.options[i+n_options]=new Option(o,o),o==e.sortrange&&(r.options[i+n_options].selected=!0);""==e.sortrange&&(r.options[0].selected=!0),Re.UpdateSortRangeProposal(e.editor),Re.KeyboardFocus()},Re.SpreadsheetControlSortSave=function(e,t){var o=Re.GetSpreadsheetControlObject(),i="sort:"+Re.encodeForSave(o.sortrange)+":",n=document.getElementById(o.idPrefix+"majorsort"),r=document.getElementById(o.idPrefix+"majorsortup");return i+=n.selectedIndex+(r.checked?":up":":down"),0<(n=document.getElementById(o.idPrefix+"minorsort")).selectedIndex?(r=document.getElementById(o.idPrefix+"minorsortup"),i+=":"+n.selectedIndex+(r.checked?":up":":down")):i+="::",0<(n=document.getElementById(o.idPrefix+"lastsort")).selectedIndex?(r=document.getElementById(o.idPrefix+"lastsortup"),i+=":"+n.selectedIndex+(r.checked?":up":":down")):i+="::",i+"\n"},Re.SpreadsheetControlSortLoad=function(e,t,o,i){var n,r=Re.GetSpreadsheetControlObject(),o=o.split(":");return r.sortrange=Re.decodeFromSave(o[1]),n=document.getElementById(r.idPrefix+"sortbutton"),r.sortrange?(n.value=Re.LocalizeString("Sort ")+r.sortrange,n.style.visibility="visible"):n.style.visibility="hidden",Re.LoadColumnChoosers(r),(sele=document.getElementById(r.idPrefix+"majorsort")).selectedIndex=+o[2],document.getElementById(r.idPrefix+"majorsort"+o[3]).checked=!0,sele=document.getElementById(r.idPrefix+"minorsort"),o[4]?(sele.selectedIndex=+o[4],document.getElementById(r.idPrefix+"minorsort"+o[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(r.idPrefix+"minorsortup").checked=!0),sele=document.getElementById(r.idPrefix+"lastsort"),o[6]?(sele.selectedIndex=+o[6],document.getElementById(r.idPrefix+"lastsort"+o[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(r.idPrefix+"lastsortup").checked=!0),!0},Re.SpreadsheetControlCommentOnclick=function(e,t){e.editor.MoveECellCallback.comment=Re.SpreadsheetControlCommentMoveECell,Re.SpreadsheetControlCommentDisplay(e,t),Re.KeyboardFocus()},Re.SpreadsheetControlCommentDisplay=function(e,t){var o="";e.editor.ecell&&e.editor.ecell.coord&&e.sheet.cells[e.editor.ecell.coord]&&(o=e.sheet.cells[e.editor.ecell.coord].comment||""),document.getElementById(e.idPrefix+"commenttext").value=o},Re.SpreadsheetControlCommentMoveECell=function(e){Re.SpreadsheetControlCommentDisplay(Re.GetSpreadsheetControlObject(),"comment")},Re.SpreadsheetControlCommentSet=function(){var e=Re.GetSpreadsheetControlObject(),t=(e.ExecuteCommand("set %C comment "+Re.encodeForSave(document.getElementById(e.idPrefix+"commenttext").value)),Re.GetEditorCellElement(e.editor,e.editor.ecell.row,e.editor.ecell.col));e.editor.ECellReadonly()||(t.element.title=document.getElementById(e.idPrefix+"commenttext").value,e.editor.UpdateCellCSS(t,e.editor.ecell.row,e.editor.ecell.col)),Re.KeyboardFocus()},Re.SpreadsheetControlCommentOnunclick=function(e,t){delete e.editor.MoveECellCallback.comment},Re.SpreadsheetControlNamesOnclick=function(e,t){document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="",e.editor.RangeChangeCallback.names=Re.SpreadsheetControlNamesRangeChange,e.editor.MoveECellCallback.names=Re.SpreadsheetControlNamesRangeChange,Re.SpreadsheetControlNamesRangeChange(e.editor),Re.SpreadsheetControlNamesFillNameList(),Re.SpreadsheetControlNamesChangedName()},Re.SpreadsheetControlNamesFillNameList=function(){var e,t,o=Re.LocalizeString,i=[],n=Re.GetSpreadsheetControlObject(),r=document.getElementById(n.idPrefix+"nameslist"),s=document.getElementById(n.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(e in n.sheet.names)i.push(e);for(i.sort(),(r.length=0)<i.length?r.options[0]=new Option(o("[New]")):r.options[0]=new Option(o("[None]")),t=0;t<i.length;t++)e=i[t],r.options[t+1]=new Option(e,e),e==s&&(r.options[t+1].selected=!0);""==s&&(r.options[0].selected=!0)},Re.SpreadsheetControlNamesChangedName=function(){var e=Re.GetSpreadsheetControlObject(),t=document.getElementById(e.idPrefix+"nameslist"),t=t.options[t.selectedIndex].value;e.sheet.names[t]?(document.getElementById(e.idPrefix+"namesname").value=t,document.getElementById(e.idPrefix+"namesdesc").value=e.sheet.names[t].desc||"",document.getElementById(e.idPrefix+"namesvalue").value=e.sheet.names[t].definition||""):(document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="")},Re.SpreadsheetControlNamesRangeChange=function(e){var t=Re.GetSpreadsheetControlObject(),t=document.getElementById(t.idPrefix+"namesrangeproposal");e.range.hasrange?t.value=Re.crToCoord(e.range.left,e.range.top)+":"+Re.crToCoord(e.range.right,e.range.bottom):t.value=e.ecell.coord},Re.SpreadsheetControlNamesOnunclick=function(e,t){delete e.editor.RangeChangeCallback.names,delete e.editor.MoveECellCallback.names},Re.SpreadsheetControlNamesSetValue=function(){var e=Re.GetSpreadsheetControlObject();document.getElementById(e.idPrefix+"namesvalue").value=document.getElementById(e.idPrefix+"namesrangeproposal").value,Re.KeyboardFocus()},Re.SpreadsheetControlNamesSave=function(){var e=Re.GetSpreadsheetControlObject(),t=document.getElementById(e.idPrefix+"namesname").value;Re.SetTab(e.tabs[0].name),Re.KeyboardFocus(),""!=t&&e.ExecuteCommand("name define "+t+" "+document.getElementById(e.idPrefix+"namesvalue").value+"\nname desc "+t+" "+document.getElementById(e.idPrefix+"namesdesc").value)},Re.SpreadsheetControlNamesDelete=function(){var e=Re.GetSpreadsheetControlObject(),t=document.getElementById(e.idPrefix+"namesname").value;Re.SetTab(e.tabs[0].name),Re.KeyboardFocus(),""!=t&&e.ExecuteCommand("name delete "+t),Re.KeyboardFocus()},Re.SpreadsheetControlClipboardOnclick=function(e,t){e=Re.GetSpreadsheetControlObject();clipele=document.getElementById(e.idPrefix+"clipboardtext"),document.getElementById(e.idPrefix+"clipboardformat-tab").checked=!0;try{clipele.value=Re.ConvertSaveToOtherFormat(Re.Clipboard.clipboard,"tab")}catch(e){console.error(e)}},Re.SpreadsheetControlClipboardFormat=function(e){var t=Re.GetSpreadsheetControlObject();(clipele=document.getElementById(t.idPrefix+"clipboardtext")).value=Re.ConvertSaveToOtherFormat(Re.Clipboard.clipboard,e)},Re.SpreadsheetControlClipboardLoad=function(){var e=Re.GetSpreadsheetControlObject(),t="tab";Re.SetTab(e.tabs[0].name),Re.KeyboardFocus(),document.getElementById(e.idPrefix+"clipboardformat-csv").checked?t="csv":document.getElementById(e.idPrefix+"clipboardformat-scsave").checked&&(t="scsave"),e.editor.pastescclipboard=!0,e.editor.EditorScheduleSheetCommands("loadclipboard "+Re.encodeForSave(Re.ConvertOtherFormatToSave(document.getElementById(e.idPrefix+"clipboardtext").value,t)),!0,!1)},Re.SpreadsheetControlClipboardClear=function(){var e=Re.GetSpreadsheetControlObject(),t=document.getElementById(e.idPrefix+"clipboardtext");t.value="",e.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1),t.focus()},Re.SpreadsheetControlClipboardExport=function(){var e=Re.GetSpreadsheetControlObject();e.ExportCallback&&e.ExportCallback(e),Re.SetTab(e.tabs[0].name),Re.KeyboardFocus()},Re.SpreadsheetControlSettingsSwitch=function(e){Re.SettingControlReset();var t=Re.GetSpreadsheetControlObject(),o=document.getElementById(t.idPrefix+"sheetsettingstable"),i=document.getElementById(t.idPrefix+"cellsettingstable"),n=document.getElementById(t.idPrefix+"sheetsettingstoolbar"),r=document.getElementById(t.idPrefix+"cellsettingstoolbar");"sheet"==e?(o.style.display="block",i.style.display="none",n.style.display="block",r.style.display="none",Re.SettingsControlSetCurrentPanel(t.views.settings.values.sheetspanel)):(o.style.display="none",i.style.display="block",n.style.display="none",r.style.display="block",Re.SettingsControlSetCurrentPanel(t.views.settings.values.cellspanel))},Re.SettingsControlSave=function(e){var t,o,i=Re.GetSpreadsheetControlObject(),n=Re.SettingsControls.CurrentPanel,n=Re.SettingsControlUnloadPanel(n);Re.SetTab(i.tabs[0].name),Re.KeyboardFocus(),"sheet"==e?o=i.sheet.DecodeSheetAttributes(n):"cell"==e&&(i.editor.range.hasrange&&(t=Re.crToCoord(i.editor.range.left,i.editor.range.top)+":"+Re.crToCoord(i.editor.range.right,i.editor.range.bottom)),o=i.sheet.DecodeCellAttributes(i.editor.ecell.coord,n,t)),o&&i.editor.EditorScheduleSheetCommands(o,!0,!1)},Re.SpreadsheetControlCreateSpreadsheetSave=function(e,t){var o,i,n="",r="";if(t)for(o in t)i="\n"!=t[o].charAt(t[o]-1)?"\n":"",n+="--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+t[o]+i,r+="part:"+o+"\n";return"socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+e.multipartBoundary+"\n--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+r+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.CreateSheetSave()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.editor.SaveEditorSettings()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.sheet.CreateAuditString()+n+"--"+e.multipartBoundary+"--\n"},Re.SpreadsheetControlDecodeSpreadsheetSave=function(e,t){var o,i,n,r,s,a,l,c,u,d,h={},p=[],f=t.search(/^MIME-Version:\s1\.0/im);if(f<0)return h;if((o=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim).lastIndex=f,i=o.exec(t),o.lastIndex<=0)return h;if(n=i[1],(r=new RegExp("^--"+n+"(?:\r\n|\n)","mg")).lastIndex=o.lastIndex,r.exec(t),(s=/(?:\r\n|\n)(?:\r\n|\n)/gm).lastIndex=r.lastIndex,!s.exec(t))return h;if(a=s.lastIndex,r.lastIndex=a,!(i=r.exec(t)))return h;for(l=i.index,u=t.substring(a,l).split(/\r\n|\n/),c=0;c<u.length;c++)switch((d=(line=u[c]).split(":"))[0]){case"version":break;case"part":p.push(d[1])}for(pnum=0;pnum<p.length;pnum++){if(s.lastIndex=l,!s.exec(t))return h;if(a=s.lastIndex,(r=pnum==p.length-1?new RegExp("^--"+n+"--$","mg"):r).lastIndex=a,!(i=r.exec(t)))return h;l=i.index,h[p[pnum]]={start:a,end:l}}return h},Re.SettingsControls={Controls:{},CurrentPanel:null},Re.SettingsControlSetCurrentPanel=function(e){Re.SettingsControls.CurrentPanel=e,Re.SettingsControls.PopupChangeCallback({panelobj:e},"",null)},Re.SettingsControlInitializePanel=function(e){var t,o=Re.SettingsControls;for(t in e)"name"!=t&&(ctrl=o.Controls[e[t].type])&&ctrl.Initialize&&ctrl.Initialize(e,t)},Re.SettingsControlLoadPanel=function(e,t){var o,i=Re.SettingsControls;for(o in e)"name"!=o&&(ctrl=i.Controls[e[o].type])&&ctrl.SetValue&&ctrl.SetValue(e,o,t[e[o].setting])},Re.SettingsControlUnloadPanel=function(e){var t,o=Re.SettingsControls,i={};for(t in e)"name"!=t&&(ctrl=o.Controls[e[t].type])&&ctrl.GetValue&&(i[e[t].setting]=ctrl.GetValue(e,t));return i},Re.SettingsControls.PopupChangeCallback=function(e,t,o){var i=Re.Constants,n=document.getElementById("sample-text");if(n&&e&&e.panelobj){var r,s,a=Re.CurrentSpreadsheetControlObject.idPrefix,l="cell"==e.panelobj.name?"c":"",c=i.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[],u={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",i.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",c[1]],paddingRight:["padright",c[2]],paddingBottom:["padbottom",c[3]],paddingLeft:["padleft",c[4]],verticalAlign:["alignvert",c[5]]};for(s in u)r=Re.Popup.GetValue(a+l+u[s][0])||u[s][1]||"",n.style[s]=r;if("c"==l){for(s in u={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"})r=Re.SettingsControls.BorderSideGetValue(e.panelobj,u[s]),n.style[s]=r&&r.val||"";r=Re.Popup.GetValue(a+"calignhoriz"),n.style.textAlign=r||"left",n.childNodes[1].style.textAlign=r||"right"}else n.style.border="",r=Re.Popup.GetValue(a+"textalignhoriz"),n.style.textAlign=r||"left",r=Re.Popup.GetValue(a+"numberalignhoriz"),n.childNodes[1].style.textAlign=r||"right";c=(r=Re.Popup.GetValue(a+l+"fontlook"))&&r.match(/^(\S+) (\S+)$/)||[],n.style.fontStyle=c[1]||"",n.style.fontWeight=c[2]||"",r=Re.Popup.GetValue(a+l+"formatnumber")||"General",i=Re.FormatNumber.formatNumberWithFormat(9.8765,r,""),"??-???-??&nbsp;??:??:??"!=(c=Re.FormatNumber.formatNumberWithFormat(-1234.5,r,""))&&(i+="<br>"+c),n.childNodes[1].innerHTML=i}},Re.SettingsControls.PopupListSetValue=function(e,t,o){var i;o?(i=Re.Popup,o.def?i.SetValue(e[t].id,""):i.SetValue(e[t].id,o.val)):alert(t+" no value")},Re.SettingsControls.PopupListGetValue=function(e,t){e=e[t];if(!e)return null;t=Re.Popup.GetValue(e.id);return t?{def:!1,val:t}:{def:!0,val:0}},Re.SettingsControls.PopupListInitialize=function(e,t){for(var o,i,n,r=Re.SettingsControls,r=e[t].initialdata||r.Controls[e[t].type].InitialData||"",s=(r=Re.LocalizeSubstrings(r)).split(/\|/),a=[],l=0;l<(s.length||0);l++)i=(o=s[l]).indexOf(":"),-1!=(n=o.substring(0,i)).indexOf("\\")&&(n=(n=n.replace(/\\c/g,":")).replace(/\\b/g,"\\")),n=Re.special_chars(n),a[l]="[custom]"==n?{o:Re.Constants.s_PopupListCustom,v:o.substring(i+1),a:{custom:!0}}:"[cancel]"==n?{o:Re.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:"[break]"==n?{o:"-----",v:"",a:{skip:!0}}:"[newcol]"==n?{o:"",v:"",a:{newcol:!0}}:{o:n,v:o.substring(i+1)};Re.Popup.Create("List",e[t].id,{}),Re.Popup.Initialize(e[t].id,{options:a,attribs:{changedcallback:Re.SettingsControls.PopupChangeCallback,panelobj:e}})},Re.SettingsControls.PopupListReset=function(e){Re.Popup.Reset("List")},Re.SettingsControls.Controls.PopupList={SetValue:Re.SettingsControls.PopupListSetValue,GetValue:Re.SettingsControls.PopupListGetValue,Initialize:Re.SettingsControls.PopupListInitialize,OnReset:Re.SettingsControls.PopupListReset,ChangedCallback:null},Re.SettingsControls.ColorChooserSetValue=function(e,t,o){var i;o?(i=Re.Popup,o.def?i.SetValue(e[t].id,""):i.SetValue(e[t].id,o.val)):alert(t+" no value")},Re.SettingsControls.ColorChooserGetValue=function(e,t){e=Re.Popup.GetValue(e[t].id);return e?{def:!1,val:e}:{def:!0,val:0}},Re.SettingsControls.ColorChooserInitialize=function(e,t){Re.SettingsControls;Re.Popup.Create("ColorChooser",e[t].id,{}),Re.Popup.Initialize(e[t].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:Re.SettingsControls.PopupChangeCallback,panelobj:e}})},Re.SettingsControls.ColorChooserReset=function(e){Re.Popup.Reset("ColorChooser")},Re.SettingsControls.Controls.ColorChooser={SetValue:Re.SettingsControls.ColorChooserSetValue,GetValue:Re.SettingsControls.ColorChooserGetValue,Initialize:Re.SettingsControls.ColorChooserInitialize,OnReset:Re.SettingsControls.ColorChooserReset,ChangedCallback:null},Re.SettingsControls.BorderSideSetValue=function(e,t,o){Re.SettingsControls;var i,n,r,e=e[t].id;o?(i=document.getElementById(e+"-onoff-bcb"))&&(o.val?(i.checked=!0,i.value=o.val,r=o.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),Re.Popup.SetValue(n=e+"-color",r[3]),Re.Popup.SetDisabled(n,!1)):(i.checked=!1,i.value=o.val,Re.Popup.SetValue(n=e+"-color",""),Re.Popup.SetDisabled(n,!0))):alert(t+" no value")},Re.SettingsControls.BorderSideGetValue=function(e,t){Re.SettingsControls;e=e[t].id,t=document.getElementById(e+"-onoff-bcb");if(t)return t.checked?{def:!1,val:"1px solid "+(Re.Popup.GetValue(e+"-color")||"rgb(0,0,0)")}:{def:!1,val:""}},Re.SettingsControls.BorderSideInitialize=function(e,t){Re.SettingsControls;t=e[t].id;Re.Popup.Create("ColorChooser",t+"-color",{}),Re.Popup.Initialize(t+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:Re.SettingsControls.PopupChangeCallback,panelobj:e}})},Re.SettingsControlOnchangeBorder=function(e){var t,o=Re.SettingsControls,i=o.CurrentPanel,n=e.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);n&&(n[1],t=n[2],n[3],n=n[4],i=i[t].type,"bcb"===n&&(e.checked?o.Controls[i].SetValue(o.CurrentPanel,t,{def:!1,val:e.value||"1px solid rgb(0,0,0)"}):o.Controls[i].SetValue(o.CurrentPanel,t,{def:!1,val:""})))},Re.SettingsControls.Controls.BorderSide={SetValue:Re.SettingsControls.BorderSideSetValue,GetValue:Re.SettingsControls.BorderSideGetValue,OnClick:Re.SettingsControls.ColorComboOnClick,Initialize:Re.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null},Re.SettingControlReset=function(){var e,t=Re.SettingsControls;for(e in t.Controls)t.Controls[e].OnReset&&t.Controls[e].OnReset(e)},Re.OtherSaveParts={},Re.CtrlSEditor=function(e){var t,o;if(0<e.length)t=Re.special_chars(Re.OtherSaveParts[e]||"");else for(o in t="Listing of Parts\n",Re.OtherSaveParts)t+=Re.special_chars("\nPart: "+o+"\n=====\n"+Re.OtherSaveParts[o]+"\n");var i=document.createElement("div"),e=(i.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;",i.id="socialcalc-editbox",i.innerHTML=e+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+t+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+e+'\');" value="OK">',document.body.appendChild(i),document.getElementById("socialcalc-editbox-textarea"));e.focus(),Re.CmdGotFocus(e)},Re.CtrlSEditorDone=function(e,t){var o=document.getElementById(e+"-textarea").value,o=(0<t.length&&(0<o.length?Re.OtherSaveParts[t]=o:delete Re.OtherSaveParts[t]),document.getElementById(e));Re.KeyboardFocus(),o.parentNode.removeChild(o)},Re||(alert("Main SocialCalc code module needed"),Re={}),Re.TableEditor||alert("SocialCalc TableEditor code module needed"),Re.CurrentSpreadsheetViewerObject=null,Re.SpreadsheetViewer=function(e){var t=Re.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.idPrefix=e||"SocialCalc-",this.imagePrefix=t.defaultImagePrefix,this.statuslineheight=t.SVStatuslineheight,this.statuslineCSS=t.SVStatuslineCSS,this.sheet=new Re.Sheet,this.context=new Re.RenderContext(this.sheet),1!=Re._app&&1!=Re._view||(t.defaultImagePrefix=this.imagePrefix="../"+this.imagePrefix),1==Re._app?(this.context.showGrid=!1,this.context.showRCHeaders=!1,this.context.highlightTypes.range.style="",this.context.sheetobj.cells.A1=new Re.Cell("A1"),this.context.sheetobj.cells.A1.displaystring="Loading ... "):(this.context.showGrid=!0,this.context.showRCHeaders=!0),this.editor=new Re.TableEditor(this.context),this.editor.noEdit=!0,this.editor.StatusCallback.statusline={func:Re.SpreadsheetViewerStatuslineCallback,params:{}},this.hasStatusLine=!0,this.statuslineHTML='<table cellspacing="0" cellpadding="0"><tr><td width="100%" style="overflow:hidden;">{status}</td><td>&nbsp;</td></tr></table>',this.statuslineFull=!0,this.noRecalc=!0,this.repeatingMacroTimer=null,this.repeatingMacroInterval=60,this.repeatingMacroCommands="",Re.CurrentSpreadsheetViewerObject=this},Re.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(e,t,o,i){return Re.InitializeSpreadsheetViewer(this,e,t,o,i)},Re.SpreadsheetViewer.prototype.LoadSave=function(e){return Re.SpreadsheetViewerLoadSave(this,e)},Re.SpreadsheetViewer.prototype.DoOnResize=function(){return Re.DoOnResize(this)},Re.SpreadsheetViewer.prototype.SizeSSDiv=function(){return Re.SizeSSDiv(this)},Re.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(e){return Re.SpreadsheetViewerDecodeSpreadsheetSave(this,e)},Re.SpreadsheetViewer.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},Re.InitializeSpreadsheetViewer=function(e,t,o,i,n){var r;Re.Constants,Re.LocalizeString,Re.LocalizeSubstrings,e.tabs,e.views;for(e.requestedHeight=o,e.requestedWidth=i,e.requestedSpaceBelow=n,null==(t="string"==typeof t?document.getElementById(t):t)&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=t,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),r=t.firstChild;null!=r;r=t.firstChild)t.removeChild(r);t.appendChild(e.spreadsheetDiv),e.nonviewheight=e.hasStatusLine?e.statuslineheight:0,e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight),e.spreadsheetDiv.appendChild(e.editorDiv),e.hasStatusLine&&(e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-+e.statuslineDiv.style.paddingTop.slice(0,-2)-+e.statuslineDiv.style.paddingBottom.slice(0,-2)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.editor.StatusCallback.statusline={func:Re.SpreadsheetViewerStatuslineCallback,params:{spreadsheetobj:e}}),1==Re._app&&(e.formDataViewer=new Re.SpreadsheetViewer("te_FormData-"),e.formDataViewer.sheet.statuscallback=null,Re.CurrentSpreadsheetViewerObject=e)},Re.SpreadsheetViewerLoadSave=function(e,t){var o,i=e.DecodeSpreadsheetSave(t);i&&(i.sheet&&(e.sheet.ResetSheet(),e.sheet.ParseSheetSave(t.substring(i.sheet.start,i.sheet.end))),i.edit&&e.editor.LoadEditorSettings(t.substring(i.edit.start,i.edit.end)),i.startupmacro&&e.editor.EditorScheduleSheetCommands(t.substring(i.startupmacro.start,i.startupmacro.end),!1,!0),i.repeatingmacro&&0<(i=(t=(t=t.substring(i.repeatingmacro.start,i.repeatingmacro.end)).replace("\r","")).indexOf("\n"))&&(o=+t.substring(0,i),e.repeatingMacroInterval=o=o,e.repeatingMacroCommands=t.substring(i+1),0<o&&(e.repeatingMacroTimer=M.setTimeout(Re.SpreadsheetViewerDoRepeatingMacro,1e3*e.repeatingMacroInterval)))),"off"==e.editor.context.sheetobj.attribs.recalc||e.noRecalc?e.editor.ScheduleRender():e.editor.EditorScheduleSheetCommands("recalc")},Re.SpreadsheetViewerDoRepeatingMacro=function(){var e=Re.GetSpreadsheetViewerObject(),t=e.editor;e.repeatingMacroTimer=null,Re.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:Re.SpreadsheetViewerRepeatMacroCommand,data:null},t.EditorScheduleSheetCommands(e.repeatingMacroCommands)},Re.SpreadsheetViewerRepeatMacroCommand=function(e,t,o,i,n){var r=Re.GetSpreadsheetViewerObject(),i=+i.RestOfString();0<i||(i=r.repeatingMacroInterval),r.repeatingMacroInterval=i,r.repeatingMacroTimer=M.setTimeout(Re.SpreadsheetViewerDoRepeatingMacro,1e3*r.repeatingMacroInterval)},Re.SpreadsheetViewerStopRepeatingMacro=function(){var e=Re.GetSpreadsheetViewerObject();e.repeatingMacroTimer&&(M.clearTimeout(e.repeatingMacroTimer),e.repeatingMacroTimer=null)},Re.SpreadsheetViewerDoButtonCmd=function(e,t,o){var i=o.element,o=o.functionobj.command,n=Re.GetSpreadsheetViewerObject().editor;"recalc"===o&&n.EditorScheduleSheetCommands("recalc"),i&&i.blur&&i.blur(),Re.KeyboardFocus()},Re.LocalizeString=function(e){var t=Re.LocalizeStringList[e];return t||(t=Re.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,Re.LocalizeStringList[e]=t),t},Re.LocalizeStringList={},Re.LocalizeSubstrings=function(e){var i=Re.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,t,o){return"ssc"==t?Re.Constants[o]||alert("Missing constant: "+o):i(o)})},Re.GetSpreadsheetViewerObject=function(){var e=Re.CurrentSpreadsheetViewerObject;if(e)return e;throw"No current SpreadsheetViewer object."},Re.DoOnResize=function(e){var t,o=e.views;if(e.SizeSSDiv()){for(vname in o)(t=o[vname].element).style.width=e.width+"px",t.style.height=e.height-e.nonviewheight+"px";Re._app||e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},Re.SizeSSDiv=function(e){var t,o=!1,i=Re.GetViewportInfo(),n=Re.GetElementPosition(e.parentNode);return n.bottom=0,n.right=0,(t=e.parentNode.style).marginTop&&(n.top+=+t.marginTop.slice(0,-2)),t.marginBottom&&(n.bottom+=+t.marginBottom.slice(0,-2)),t.marginLeft&&(n.left+=+t.marginLeft.slice(0,-2)),t.marginRight&&(n.right+=+t.marginRight.slice(0,-2)),t=e.requestedHeight||i.height-(n.top+n.bottom+10)-(e.requestedSpaceBelow||0),e.height!=t&&(e.height=t,e.spreadsheetDiv.style.height=t+"px",o=!0),t=e.requestedWidth||i.width-(n.left+n.right+10)||700,e.width!=t&&(e.width=t,e.spreadsheetDiv.style.width=t+"px",o=!0),e.spreadsheetDiv.style.position="relative",o},Re.SpreadsheetViewerStatuslineCallback=function(e,t,o,i){var n=i.spreadsheetobj,r="";n&&n.statuslineDiv&&(r=n.statuslineFull?e.GetStatuslineString(t,o,i):e.ecell.coord,r=n.statuslineHTML.replace(/\{status\}/,r),n.statuslineDiv.innerHTML=r)},Re.CmdGotFocus=function(e){Re.Keyboard.passThru=e},Re.SpreadsheetViewerCreateSheetHTML=function(e){var e=new Re.RenderContext(e.sheet),t=document.createElement("div"),o=e.RenderSheet(null,{type:"html"});return t.appendChild(o),delete e,e=t.innerHTML,delete o,delete t,e},Re.SpreadsheetViewerDecodeSpreadsheetSave=function(e,t){var o,i,n,r,s,a,l,c,u,d,h,p={},f=[];if((o=(t=/[^\n]\r[^\n]/.test(t)?t.replace(/([^\n])\r([^\n])/g,"$1\r\n$2"):t).search(/^MIME-Version:\s1\.0/im))<0)return p;if((i=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim).lastIndex=o,n=i.exec(t),i.lastIndex<=0)return p;if(r=n[1],(s=new RegExp("^--"+r+"(?:\r\n|\n)","mg")).lastIndex=i.lastIndex,s.exec(t),(a=/(?:\r\n|\n)(?:\r\n|\n)/gm).lastIndex=s.lastIndex,!a.exec(t))return p;if(l=a.lastIndex,s.lastIndex=l,!(n=s.exec(t)))return p;for(c=n.index,d=t.substring(l,c).split(/\r\n|\n/),u=0;u<d.length;u++)switch((h=(line=d[u]).split(":"))[0]){case"version":break;case"part":f.push(h[1])}for(pnum=0;pnum<f.length;pnum++){if(a.lastIndex=c,!a.exec(t))return p;if(l=a.lastIndex,(s=pnum==f.length-1?new RegExp("^--"+r+"--$","mg"):s).lastIndex=l,!(n=s.exec(t)))return p;c=n.index,p[f[pnum]]={start:l,end:c}}return p},"undefined"==typeof document&&(Re.GetEditorCellElement=function(){},Re.ReplaceCell=function(){},Re.EditorRenderSheet=function(){},Re.SpreadsheetControlSortSave=function(){return""},Re.SpreadsheetControlStatuslineCallback=function(){},Re.DoPositionCalculations=function(e){Re.EditorSheetStatusCallback(null,"doneposcalc",null,e)}),"undefined"!=typeof self&&self.thread&&(M.setTimeout=function(e,t){t<=1&&self.thread.nextTick(e)},M.clearTimeout=function(){}),Re}),!function(){Class=function(classDefinition,classWrapper){if(!classDefinition)throw"Class requires a class definition string as its first argument";if(!classWrapper)throw"Class requires a class wrapper function as its second argument";if(!classDefinition.match(/^([\w\.]+)(?:\(\s*([\w\.]+)\s*\))?(?:\s+(.*?)\s*)?$/))throw"Can't parse Class Definition: '"+classDefinition+"'";for(var className=RegExp.$1,baseClassName=RegExp.$2||"",options=[],incValues=(RegExp.$3&&(options=RegExp.$3.split(/\s+/)),[]),strict=!0,i=0,l=options.length;i<l;i++){var option=options[i];"-nostrict"==option&&(strict=!1),option.match(/^-inc=(.+)$/)&&(incValues=RegExp.$1.split(","))}for(var parts=className.split("."),klass=Class.global,i=0;i<parts.length;i++)klass[parts[i]]||(klass[parts[i]]=function(){try{this.init()}catch(e){}}),klass=klass[parts[i]];klass.className=className,klass.isa=function(baseName){klass.baseClassName=baseName,baseName&&(klass.prototype=eval("new "+baseName+"()"),klass.prototype.superFunc=function(name){return eval(baseName).prototype[name]})},klass.isa(baseClassName),klass.global=Class.global,klass.addGlobal=function(){return this.newGlobals++,Class.global},klass.extend=function(e){if("object"!=typeof e)throw"extend requires an object of name:value pairs";for(var t in e)klass.prototype[t]=e[t]};for(var ii=0,ll=incValues.length;ii<ll;ii++){var value=incValues[ii];incValues[ii]="proto"==value?klass.prototype:"this"==value?klass:Class.global[value]}return strict?Class.eval_strict(classWrapper,klass,incValues):classWrapper.apply(klass,incValues),klass}}(),Class.global=this,Class.eval_strict=function(e,t,o){var i=0;for(n in Class.global)i++,0;t.newGlobals=0,e.apply(t,o);var n,r=0;for(n in Class.global)r++;if(i+t.newGlobals!=r)throw"Class '"+t.className+"' defines "+(r-i)+" new global JavaScript variables without using this.addGlobal()";delete t.newGlobals},Class("Document.Emitter",function(){var proto=this.prototype;proto.className="Document.Emitter",proto.instantiate=function(){return eval("new "+this.className+"()")},proto.init=function(){this.output=""},proto.content=function(){return this.output},proto.insert=function(e){this.output+=e.output}}),Class("Document.Emitter.HTML(Document.Emitter)",function(){var e=this.prototype;e.className="Document.Emitter.HTML",e.begin_node=function(e){var t=e.type;switch(t){case"asis":case"line":return;case"br":case"hr":return void(this.output+="<"+t+" />");case"html":return void(this.output+='<span class="wafl">Raw HTML section. Edit in Wiki Text mode.</span>');case"waflparagraph":case"waflphrase":case"im":if(e._wafl.match(/^image:\s*(\S+)(?:\s+size=(\w+))?/)){var o="if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/"+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'",i=RegExp.$1,n=RegExp.$2;switch(n){case"small":n="100";break;case"medium":n="300";break;case"large":n="600"}return n=n&&' width="'+n+'"',void(this.output+='<img src="'+i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" onload="'+o+'"'+n+" />")}return void(this.output+='<span class="wafl">'+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"</span>");case"a":case"wikilink":return void(this.output+='<a href="'+encodeURI(e._href)+'">');case"file":return void(this.output+='<a title="(network resource)" href="'+encodeURI(e._href)+'">');case"ul":case"ol":case"table":case"tr":return void(this.output+="<"+t+">\n");default:return void(this.output+="<"+t+">")}},e.end_node=function(e){var t=e.type;switch(t){case"asis":case"br":case"hr":case"html":case"waflparagraph":case"waflphrase":case"im":return;case"line":return void(this.output+="<br />");case"file":case"wikilink":return void(this.output+="</a>");default:return void(0==t.search(/^(?:p|ul|ol|li|h\d|table|tr|td)$/)?this.output+="</"+t+">\n":this.output+="</"+t+">")}},e.text_node=function(e){this.output+=e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}),Class("Document.Parser",function(){var proto=this.prototype;proto.className="Document.Parser",proto.init=function(){},proto.parse=function(e,t){return this.input=-1==e.search(/\n$/)?e+"\n":e,t&&(this.receiver=t),this.receiver.init(),this.grammar=this.create_grammar(),this.parse_blocks("top"),this.receiver.content()},proto.create_grammar=function(){throw"Please define create_grammar in a derived class of Document.Parser."},proto.parse_blocks=function(e){var t=this.grammar[e].blocks;if(t)for(;this.input.length;){for(var o=this.input.length,i=0;i<t.length;i++){var n=t[i],r=this.find_match("matched_block",n);if(r){this.input=this.input.substr(r.end),this.handle_match(n,r);break}}if(this.input.length>=o)throw this.classname+": Reduction error for:\n"+this.input+"\n"+JSON.stringify(this)}},proto.handle_match=function(e,t){var o=this.grammar[e],i=o.blocks?"parse_blocks":"parse_phrases";this.subparse(i,t,e,o.filter)},proto.find_match=function(e,t){var o=this.grammar[t].match;if(!o)throw"no regexp for type: "+t;o=this.input.match(o);if(o)return(e=this[e].call(this,o,this.grammar[t].lookbehind)).type=this.grammar[t].type||t,e},proto.parse_phrases=function(e){var t=this.grammar[e].phrases;if(t)for(;this.input.length;){for(var o=null,i=0;i<t.length;i++){var n=t[i],n=this.find_match("matched_phrase",n);if(n&&((!o||n.begin<o.begin)&&0==(o=n).begin))break}if(!o){this.receiver.text_node(this.input||"");break}0!=o.begin&&this.receiver.text_node(this.input.substr(0,o.begin)||""),this.input=this.input.substr(o.end),this.handle_match(o.type,o)}else this.receiver.text_node(this.input||"")},proto.subparse=function(func,match,type,filter){match.type=this.grammar[type].type,null==match.type&&(match.type=type);var filtered_text=filter?filter(match):null,parser=(match.type&&this.receiver.begin_node(match),eval("new "+this.className+"()"));parser.input=null==filtered_text?match.text:filtered_text,parser.grammar=this.grammar,parser.receiver=this.receiver.instantiate(),parser[func].call(parser,type),this.receiver.insert(parser.receiver),match.type&&this.receiver.end_node(match)},proto.matched_block=function(e){return{begin:e.index,text:e[1],end:e[0].length,1:e[2],2:e[3],3:e[4]}},proto.matched_phrase=function(e,t){return t?{text:e[2],begin:t=this.input.indexOf(e[1]),end:t+e[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}:{begin:e.index,text:e[1],end:e.index+e[0].length,1:e[2],2:e[3],3:e[4]}}}),Class("Document.Parser.Wikitext(Document.Parser)",function(){var e=this.prototype;e.className="Document.Parser.Wikitext",e.init=function(){},e.create_grammar=function(){function e(e,t){return t="\\"+(t||e),e="\\"+e,{match:new RegExp("(?:^|[^"+e+"\\w])("+e+"(?=\\S)(?!"+t+")(.*?)"+t+"(?=[^"+t+"\\w]|$))"),phrases:"\\`"==e?null:i,lookbehind:!0}}var t,o=["pre","html","hr","hx","waflparagraph","ul","ol","blockquote","p","empty","else"],i=["waflphrase","asis","wikilink","wikilink2","a","im","mail","file","tt","b","i","del","a"],n={yahoo:"yahoo",ymsgr:"yahoo",callto:"callto",callme:"callto",skype:"callto",aim:"aim"},r={aim:"AIM: %1",yahoo:"Yahoo: %1",callto:"Skype: %1"},s="(\\b(";for(t in n)s+=t+"|";function a(e,t){var o=new RegExp("(^|\n)"+t+" *","g");return{match:new RegExp("^("+e+"+ .*\n(?:[*-+#]+ .*\n)*)(?:s*\n)?"),blocks:["ul","ol","subl","li"],filter:function(e){return e.text.replace(o,"$1")}}}s=s.replace(/\|$/,")\\:([^\\s\\>\\)]+))");return{_all_blocks:o,_all_phrases:i,top:{blocks:o},ol:a("#","[*#]"),ul:a("[-+*]","[-+*#]"),blockquote:{match:/^((?:>[^\n]*\n)+)(?:\s*\n)?/,blocks:["blockquote","line"],filter:function(e){return e.text.replace(/(^|\n)>\ ?/g,"$1")}},line:{match:/([^\n]*)\n/,phrases:i},subl:{type:"li",match:/^(([^\n]*)\n[*#]+\ [^\n]*\n(?:[*#]+\ [^\n]*\n)*)(?:\s*\n)?/,blocks:["ul","ol","li2"]},li:{match:/([^\n]*)\n/,phrases:i},li2:{type:"",match:/([^\n]*)\n/,phrases:i},html:{match:/^(\.html\ *\n(?:[^\n]*\n)*?\.html)\ *\n(?:\s*\n)?/,filter:function(e){return e._html=e.text,""}},pre:{match:/^\.pre\ *\n((?:[^\n]*\n)*?)\.pre\ *\n(?:\s*\n)?/},hr:{match:/^--+(?:\s*\n)?/},hx:{match:/^((\^+) *([^\n]*?)(\s+=+)?\s*?\n+)/,phrases:i,filter:function(e){return e.type="h"+e[1].length,e[2]}},p:{match:/^((?:(?!(?:(?:\^+|\#+|\*+|\-+) |\>|\.\w+\s*\n|\{[^\}]+\}\s*\n))[^\n]*\S[^\n]*\n)+(?:(?=^|\n)\s*\n)*)/,phrases:i,filter:function(e){return e.text.replace(/\n$/,"")}},empty:{match:/^(\s*\n)/,filter:function(e){e.type=""}},else:{match:/^(([^\n]*)\n)/,phrases:[],filter:function(e){e.type="p"}},waflparagraph:{match:/^\{(.*)\}[\ \t]*\n(?:\s*\n)?/,filter:function(e){return e._wafl=e._label=e.text,""}},waflphrase:{match:/(?:^|[\s\-])((?:"([^\n]+?)")?\{([\w-]+(?=[\:\ \}])(?:\s*:)?\s*[^\n]*?\s*)\}(?=[\W_]|$))/,filter:function(e){return e._wafl=e[2],e._label=e[1]||e._wafl,""},lookbehind:!0},asis:{match:/(\{\{([^\n]*?)\}\}(\}*))/,filter:function(e){return e.type="",e[1]+e[2]}},wikilink:{match:/(?:^|[_\W])(\[()(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e.text||e[2]},lookbehind:!0},wikilink2:{type:"wikilink",match:/(?:"([^"]*)"\s*)(\[(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e[1]||e[2]}},a:{match:/((?:"([^"]*)"\s*)?<?((?:http|https|ftp|irc|file):(?:\/\/)?[\;\/\?\:\@\&\=\+\$\,\[\]\#A-Za-z0-9\-\_\.\!\~\*\'\(\)]+[A-Za-z0-9\/#])>?)/,filter:function(e){return e._href=e[2],e[1]||e[2]}},file:{match:/((?:"([^"]*)")?<(\\\\[^\s\>\)]+)>)/,filter:function(e){var t=e[2].replace(/^\\\\/,"");return e._href="file://"+t.replace(/\\/g,"/"),e[1]||t}},im:{match:new RegExp(s),filter:function(e){return e._wafl=e[1]+": "+e[2],e._label=(r[n[e[1]]]||"%1").replace(/%1/g,e[2]),""}},mail:{match:/([\w+%\-\.]+@(?:[\w\-]+\.)+[\w\-]+)/,filter:function(e){e.type="a",e._href="mailto:"+e.text.replace(/%/g,"%25")}},tt:e("`"),b:e("*"),i:e("_"),del:e("-")}}}),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(e.document)return t(e);throw new Error("jQuery requires a window with a document")}:t(e)}("undefined"!=typeof window?window:this,function(f,L){function O(e,t){return t.toUpperCase()}var d=[],u=d.slice,z=d.concat,H=d.push,B=d.indexOf,o={},U=o.toString,m=o.hasOwnProperty,j="".trim,g={},w=function(e,t){return new w.fn.init(e,t)},V=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,W=/^-ms-/,G=/-([\da-z])/gi;function $(e){var t=e.length,o=w.type(e);return"function"!==o&&!w.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===o||0===t||"number"==typeof t&&0<t&&t-1 in e))}w.fn=w.prototype={jquery:"1.11.0",constructor:w,selector:"",length:0,toArray:function(){return u.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:u.call(this)},pushStack:function(e){e=w.merge(this.constructor(),e);return e.prevObject=this,e.context=this.context,e},each:function(e,t){return w.each(this,e,t)},map:function(o){return this.pushStack(w.map(this,function(e,t){return o.call(e,t,e)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:H,sort:d.sort,splice:d.splice},w.extend=w.fn.extend=function(){var e,t,o,i,n,r=arguments[0]||{},s=1,a=arguments.length,l=!1;for("boolean"==typeof r&&(l=r,r=arguments[s]||{},s++),"object"==typeof r||w.isFunction(r)||(r={}),s===a&&(r=this,s--);s<a;s++)if(null!=(i=arguments[s]))for(o in i)n=r[o],t=i[o],r!==t&&(l&&t&&(w.isPlainObject(t)||(e=w.isArray(t)))?(n=e?(e=!1,n&&w.isArray(n)?n:[]):n&&w.isPlainObject(n)?n:{},r[o]=w.extend(l,n,t)):void 0!==t&&(r[o]=t));return r},w.extend({expando:"jQuery"+("1.11.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===w.type(e)},isArray:Array.isArray||function(e){return"array"===w.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return 0<=e-parseFloat(e)},isEmptyObject:function(e){for(var t in e)return!1;return!0},isPlainObject:function(e){if(!e||"object"!==w.type(e)||e.nodeType||w.isWindow(e))return!1;try{if(e.constructor&&!m.call(e,"constructor")&&!m.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(g.ownLast)for(var t in e)return m.call(e,t);for(t in e);return void 0===t||m.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?o[U.call(e)]||"object":typeof e},globalEval:function(e){e&&w.trim(e)&&(f.execScript||function(e){f.eval.call(f,e)})(e)},camelCase:function(e){return e.replace(W,"ms-").replace(G,O)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,o){var i,n=0,r=e.length,s=$(e);if(o){if(s)for(;n<r&&!1!==(i=t.apply(e[n],o));n++);else for(n in e)if(i=t.apply(e[n],o),!1===i)break}else if(s)for(;n<r&&!1!==(i=t.call(e[n],n,e[n]));n++);else for(n in e)if(i=t.call(e[n],n,e[n]),!1===i)break;return e},trim:j&&!j.call("\ufeff ")?function(e){return null==e?"":j.call(e)}:function(e){return null==e?"":(e+"").replace(V,"")},makeArray:function(e,t){t=t||[];return null!=e&&($(Object(e))?w.merge(t,"string"==typeof e?[e]:e):H.call(t,e)),t},inArray:function(e,t,o){var i;if(t){if(B)return B.call(t,e,o);for(i=t.length,o=o?o<0?Math.max(0,i+o):o:0;o<i;o++)if(o in t&&t[o]===e)return o}return-1},merge:function(e,t){for(var o=+t.length,i=0,n=e.length;i<o;)e[n++]=t[i++];if(o!=o)for(;void 0!==t[i];)e[n++]=t[i++];return e.length=n,e},grep:function(e,t,o){for(var i=[],n=0,r=e.length,s=!o;n<r;n++)!t(e[n],n)!=s&&i.push(e[n]);return i},map:function(e,t,o){var i,n=0,r=e.length,s=[];if($(e))for(;n<r;n++)null!=(i=t(e[n],n,o))&&s.push(i);else for(n in e)i=t(e[n],n,o),null!=i&&s.push(i);return z.apply([],s)},guid:1,proxy:function(e,t){var o,i;return"string"==typeof t&&(i=e[t],t=e,e=i),w.isFunction(e)?(o=u.call(arguments,2),(i=function(){return e.apply(t||this,o.concat(u.call(arguments)))}).guid=e.guid=e.guid||w.guid++,i):void 0},now:function(){return+new Date},support:g}),w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){o["[object "+t+"]"]=t.toLowerCase()});var e=function(m){var e,C,w,r,g,B,x,c,u,_,S,t,k,T,i,n,F,E="sizzle"+-new Date,D=m.document,P=0,v=0,y=le(),U=le(),j=le(),V=function(e,t){return e===t&&(u=!0),0},o="undefined",W={}.hasOwnProperty,s=[],G=s.pop,$=s.push,A=s.push,Y=s.slice,b=s.indexOf||function(e){for(var t=0,o=this.length;t<o;t++)if(this[t]===e)return t;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",a="[\\x20\\t\\r\\n\\f]",l="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=l.replace("w","w#"),X="\\["+a+"*("+l+")"+a+"*(?:([*^$|!~]?=)"+a+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+q+")|)|)"+a+"*\\]",J=":("+l+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+X.replace(3,8)+")*)|.*)\\)|)",I=new RegExp("^"+a+"+|((?:^|[^\\\\])(?:\\\\.)*)"+a+"+$","g"),Z=new RegExp("^"+a+"*,"+a+"*"),Q=new RegExp("^"+a+"*([>+~]|"+a+")"+a+"*"),ee=new RegExp("="+a+"*([^\\]'\"]*?)"+a+"*\\]","g"),te=new RegExp(J),oe=new RegExp("^"+q+"$"),M={ID:new RegExp("^#("+l+")"),CLASS:new RegExp("^\\.("+l+")"),TAG:new RegExp("^("+l.replace("w","w*")+")"),ATTR:new RegExp("^"+X),PSEUDO:new RegExp("^"+J),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+a+"*(even|odd|(([+-]|)(\\d*)n|)"+a+"*(?:([+-]|)"+a+"*(\\d+)|))"+a+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+a+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+a+"*((?:-\\d)?\\d*)"+a+"*\\)|)(?=[^-]|$)","i")},ie=/^(?:input|select|textarea|button)$/i,ne=/^h\d$/i,d=/^[^{]+\{\s*\[native \w/,re=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,se=/[+~]/,ae=/'|\\/g,R=new RegExp("\\\\([\\da-f]{1,6}"+a+"?|("+a+")|.)","ig"),N=function(e,t,o){var i="0x"+t-65536;return i!=i||o?t:i<0?String.fromCharCode(65536+i):String.fromCharCode(i>>10|55296,1023&i|56320)};try{A.apply(s=Y.call(D.childNodes),D.childNodes),s[D.childNodes.length].nodeType}catch(e){A={apply:s.length?function(e,t){$.apply(e,Y.call(t))}:function(e,t){for(var o=e.length,i=0;e[o++]=t[i++];);e.length=o-1}}}function L(e,t,o,i){var n,r,s,a,l,c;if((t?t.ownerDocument||t:D)!==S&&_(t),o=o||[],!e||"string"!=typeof e)return o;if(1!==(y=(t=t||S).nodeType)&&9!==y)return[];if(k&&!i){if(l=re.exec(e))if(c=l[1]){if(9===y){if(!(s=t.getElementById(c))||!s.parentNode)return o;if(s.id===c)return o.push(s),o}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(c))&&F(t,s)&&s.id===c)return o.push(s),o}else{if(l[2])return A.apply(o,t.getElementsByTagName(e)),o;if((c=l[3])&&C.getElementsByClassName&&t.getElementsByClassName)return A.apply(o,t.getElementsByClassName(c)),o}if(C.qsa&&(!T||!T.test(e))){if(a=s=E,l=t,c=9===y&&e,1===y&&"object"!==t.nodeName.toLowerCase()){for(r=O(e),(s=t.getAttribute("id"))?a=s.replace(ae,"\\$&"):t.setAttribute("id",a),a="[id='"+a+"'] ",n=r.length;n--;)r[n]=a+z(r[n]);l=se.test(e)&&de(t.parentNode)||t,c=r.join(",")}if(c)try{return A.apply(o,l.querySelectorAll(c)),o}catch(e){}finally{s||t.removeAttribute("id")}}}var u,d,h,p,f,m=e.replace(I,"$1"),g=t,v=o,b=i,y=O(m);if(!b&&1===y.length){if(2<(d=y[0]=y[0].slice(0)).length&&"ID"===(h=d[0]).type&&C.getById&&9===g.nodeType&&k&&w.relative[d[1].type]){if(!(g=(w.find.ID(h.matches[0].replace(R,N),g)||[])[0]))return v;m=m.slice(d.shift().value.length)}for(u=M.needsContext.test(m)?0:d.length;u--&&(h=d[u],!w.relative[p=h.type]);)if((f=w.find[p])&&(b=f(h.matches[0].replace(R,N),se.test(d[0].type)&&de(g.parentNode)||g))){if(d.splice(u,1),m=b.length&&z(d))break;return A.apply(v,b),v}}return B(m,y)(b,g,!k,v,se.test(m)&&de(g.parentNode)||g),v}function le(){var o=[];function i(e,t){return o.push(e+" ")>w.cacheLength&&delete i[o.shift()],i[e+" "]=t}return i}function h(e){return e[E]=!0,e}function p(e){var t=S.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function ce(e,t){for(var o=e.split("|"),i=e.length;i--;)w.attrHandle[o[i]]=t}function ue(e,t){var o=t&&e,i=o&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(i)return i;if(o)for(;o=o.nextSibling;)if(o===t)return-1;return e?1:-1}function f(s){return h(function(r){return r=+r,h(function(e,t){for(var o,i=s([],e.length,r),n=i.length;n--;)e[o=i[n]]&&(e[o]=!(t[o]=e[o]))})})}function de(e){return e&&typeof e.getElementsByTagName!==o&&e}for(e in C=L.support={},g=L.isXML=function(e){e=e&&(e.ownerDocument||e).documentElement;return!!e&&"HTML"!==e.nodeName},_=L.setDocument=function(e){var l=e?e.ownerDocument||e:D,e=l.defaultView;return l!==S&&9===l.nodeType&&l.documentElement?(t=(S=l).documentElement,k=!g(l),e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",function(){_()},!1):e.attachEvent&&e.attachEvent("onunload",function(){_()})),C.attributes=p(function(e){return e.className="i",!e.getAttribute("className")}),C.getElementsByTagName=p(function(e){return e.appendChild(l.createComment("")),!e.getElementsByTagName("*").length}),C.getElementsByClassName=d.test(l.getElementsByClassName)&&p(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),C.getById=p(function(e){return t.appendChild(e).id=E,!l.getElementsByName||!l.getElementsByName(E).length}),C.getById?(w.find.ID=function(e,t){if(typeof t.getElementById!==o&&k)return(t=t.getElementById(e))&&t.parentNode?[t]:[]},w.filter.ID=function(e){var t=e.replace(R,N);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var t=e.replace(R,N);return function(e){e=typeof e.getAttributeNode!==o&&e.getAttributeNode("id");return e&&e.value===t}}),w.find.TAG=C.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==o?t.getElementsByTagName(e):void 0}:function(e,t){var o,i=[],n=0,r=t.getElementsByTagName(e);if("*"!==e)return r;for(;o=r[n++];)1===o.nodeType&&i.push(o);return i},w.find.CLASS=C.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==o&&k?t.getElementsByClassName(e):void 0},i=[],T=[],(C.qsa=d.test(l.querySelectorAll))&&(p(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&T.push("[*^$]="+a+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||T.push("\\["+a+"*(?:value|"+K+")"),e.querySelectorAll(":checked").length||T.push(":checked")}),p(function(e){var t=l.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&T.push("name"+a+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||T.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),T.push(",.*:")})),(C.matchesSelector=d.test(n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.msMatchesSelector))&&p(function(e){C.disconnectedMatch=n.call(e,"div"),n.call(e,"[s!='']:x"),i.push("!=",J)}),T=T.length&&new RegExp(T.join("|")),i=i.length&&new RegExp(i.join("|")),e=d.test(t.compareDocumentPosition),F=e||d.test(t.contains)?function(e,t){var o=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(o.contains?o.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=e?function(e,t){if(e===t)return u=!0,0;var o=!e.compareDocumentPosition-!t.compareDocumentPosition;return o||(1&(o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!C.sortDetached&&t.compareDocumentPosition(e)===o?e===l||e.ownerDocument===D&&F(D,e)?-1:t===l||t.ownerDocument===D&&F(D,t)?1:c?b.call(c,e)-b.call(c,t):0:4&o?-1:1)}:function(e,t){if(e===t)return u=!0,0;var o,i=0,n=e.parentNode,r=t.parentNode,s=[e],a=[t];if(!n||!r)return e===l?-1:t===l?1:n?-1:r?1:c?b.call(c,e)-b.call(c,t):0;if(n===r)return ue(e,t);for(o=e;o=o.parentNode;)s.unshift(o);for(o=t;o=o.parentNode;)a.unshift(o);for(;s[i]===a[i];)i++;return i?ue(s[i],a[i]):s[i]===D?-1:a[i]===D?1:0},l):S},L.matches=function(e,t){return L(e,null,null,t)},L.matchesSelector=function(e,t){if((e.ownerDocument||e)!==S&&_(e),t=t.replace(ee,"='$1']"),!(!C.matchesSelector||!k||i&&i.test(t)||T&&T.test(t)))try{var o=n.call(e,t);if(o||C.disconnectedMatch||e.document&&11!==e.document.nodeType)return o}catch(e){}return 0<L(t,S,null,[e]).length},L.contains=function(e,t){return(e.ownerDocument||e)!==S&&_(e),F(e,t)},L.attr=function(e,t){(e.ownerDocument||e)!==S&&_(e);var o=w.attrHandle[t.toLowerCase()],o=o&&W.call(w.attrHandle,t.toLowerCase())?o(e,t,!k):void 0;return void 0!==o?o:C.attributes||!k?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},L.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},L.uniqueSort=function(e){var t,o=[],i=0,n=0;if(u=!C.detectDuplicates,c=!C.sortStable&&e.slice(0),e.sort(V),u){for(;t=e[n++];)t===e[n]&&(i=o.push(n));for(;i--;)e.splice(o[i],1)}return c=null,e},r=L.getText=function(e){var t,o="",i=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=r(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[i++];)o+=r(t);return o},(w=L.selectors={cacheLength:50,createPseudo:h,match:M,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(R,N),e[3]=(e[4]||e[5]||"").replace(R,N),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||L.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&L.error(e[0]),e},PSEUDO:function(e){var t,o=!e[5]&&e[2];return M.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:o&&te.test(o)&&(t=O(o,!0))&&(t=o.indexOf(")",o.length-t)-o.length)&&(e[0]=e[0].slice(0,t),e[2]=o.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(R,N).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=y[e+" "];return t||(t=new RegExp("(^|"+a+")"+e+"("+a+"|$)"))&&y(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==o&&e.getAttribute("class")||"")})},ATTR:function(t,o,i){return function(e){e=L.attr(e,t);return null==e?"!="===o:!o||(e+="","="===o?e===i:"!="===o?e!==i:"^="===o?i&&0===e.indexOf(i):"*="===o?i&&-1<e.indexOf(i):"$="===o?i&&e.slice(-i.length)===i:"~="===o?-1<(" "+e+" ").indexOf(i):"|="===o&&(e===i||e.slice(0,i.length+1)===i+"-"))}},CHILD:function(p,e,t,f,m){var g="nth"!==p.slice(0,3),v="last"!==p.slice(-4),b="of-type"===e;return 1===f&&0===m?function(e){return!!e.parentNode}:function(e,t,o){var i,n,r,s,a,l,c=g!=v?"nextSibling":"previousSibling",u=e.parentNode,d=b&&e.nodeName.toLowerCase(),h=!o&&!b;if(u){if(g){for(;c;){for(r=e;r=r[c];)if(b?r.nodeName.toLowerCase()===d:1===r.nodeType)return!1;l=c="only"===p&&!l&&"nextSibling"}return!0}if(l=[v?u.firstChild:u.lastChild],v&&h){for(a=(i=(n=u[E]||(u[E]={}))[p]||[])[0]===P&&i[1],s=i[0]===P&&i[2],r=a&&u.childNodes[a];r=++a&&r&&r[c]||(s=a=0)||l.pop();)if(1===r.nodeType&&++s&&r===e){n[p]=[P,a,s];break}}else if(h&&(i=(e[E]||(e[E]={}))[p])&&i[0]===P)s=i[1];else for(;(r=++a&&r&&r[c]||(s=a=0)||l.pop())&&((b?r.nodeName.toLowerCase()!==d:1!==r.nodeType)||!++s||(h&&((r[E]||(r[E]={}))[p]=[P,s]),r!==e)););return(s-=m)===f||s%f==0&&0<=s/f}}},PSEUDO:function(e,r){var t,s=w.pseudos[e]||w.setFilters[e.toLowerCase()]||L.error("unsupported pseudo: "+e);return s[E]?s(r):1<s.length?(t=[e,e,"",r],w.setFilters.hasOwnProperty(e.toLowerCase())?h(function(e,t){for(var o,i=s(e,r),n=i.length;n--;)e[o=b.call(e,i[n])]=!(t[o]=i[n])}):function(e){return s(e,0,t)}):s}},pseudos:{not:h(function(e){var i=[],n=[],a=B(e.replace(I,"$1"));return a[E]?h(function(e,t,o,i){for(var n,r=a(e,null,i,[]),s=e.length;s--;)(n=r[s])&&(e[s]=!(t[s]=n))}):function(e,t,o){return i[0]=e,a(i,null,o,n),!n.pop()}}),has:h(function(t){return function(e){return 0<L(t,e).length}}),contains:h(function(t){return function(e){return-1<(e.textContent||e.innerText||r(e)).indexOf(t)}}),lang:h(function(o){return oe.test(o||"")||L.error("unsupported lang: "+o),o=o.replace(R,N).toLowerCase(),function(e){var t;do{if(t=k?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===o||0===t.indexOf(o+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=m.location&&m.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===t},focus:function(e){return e===S.activeElement&&(!S.hasFocus||S.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return ne.test(e.nodeName)},input:function(e){return ie.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:f(function(){return[0]}),last:f(function(e,t){return[t-1]}),eq:f(function(e,t,o){return[o<0?o+t:o]}),even:f(function(e,t){for(var o=0;o<t;o+=2)e.push(o);return e}),odd:f(function(e,t){for(var o=1;o<t;o+=2)e.push(o);return e}),lt:f(function(e,t,o){for(var i=o<0?o+t:o;0<=--i;)e.push(i);return e}),gt:f(function(e,t,o){for(var i=o<0?o+t:o;++i<t;)e.push(i);return e})}}).pseudos.nth=w.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})w.pseudos[e]=function(o){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===o}}(e);function he(){}function O(e,t){var o,i,n,r,s,a,l,c=U[e+" "];if(c)return t?0:c.slice(0);for(s=e,a=[],l=w.preFilter;s;){for(r in o&&!(i=Z.exec(s))||(i&&(s=s.slice(i[0].length)||s),a.push(n=[])),o=!1,(i=Q.exec(s))&&(o=i.shift(),n.push({value:o,type:i[0].replace(I," ")}),s=s.slice(o.length)),w.filter)!(i=M[r].exec(s))||l[r]&&!(i=l[r](i))||(o=i.shift(),n.push({value:o,type:r,matches:i}),s=s.slice(o.length));if(!o)break}return t?s.length:s?L.error(e):U(e,a).slice(0)}function z(e){for(var t=0,o=e.length,i="";t<o;t++)i+=e[t].value;return i}function pe(s,e,t){var a=e.dir,l=t&&"parentNode"===a,c=v++;return e.first?function(e,t,o){for(;e=e[a];)if(1===e.nodeType||l)return s(e,t,o)}:function(e,t,o){var i,n,r=[P,c];if(o){for(;e=e[a];)if((1===e.nodeType||l)&&s(e,t,o))return!0}else for(;e=e[a];)if(1===e.nodeType||l){if((i=(n=e[E]||(e[E]={}))[a])&&i[0]===P&&i[1]===c)return r[2]=i[2];if((n[a]=r)[2]=s(e,t,o))return!0}}}function fe(n){return 1<n.length?function(e,t,o){for(var i=n.length;i--;)if(!n[i](e,t,o))return!1;return!0}:n[0]}function H(e,t,o,i,n){for(var r,s=[],a=0,l=e.length,c=null!=t;a<l;a++)!(r=e[a])||o&&!o(r,i,n)||(s.push(r),c&&t.push(a));return s}function me(p,f,m,g,v,e){return g&&!g[E]&&(g=me(g)),v&&!v[E]&&(v=me(v,e)),h(function(e,t,o,i){var n,r,s,a=[],l=[],c=t.length,u=e||function(e,t,o){for(var i=0,n=t.length;i<n;i++)L(e,t[i],o);return o}(f||"*",o.nodeType?[o]:o,[]),d=!p||!e&&f?u:H(u,a,p,o,i),h=m?v||(e?p:c||g)?[]:t:d;if(m&&m(d,h,o,i),g)for(n=H(h,l),g(n,[],o,i),r=n.length;r--;)(s=n[r])&&(h[l[r]]=!(d[l[r]]=s));if(e){if(v||p){if(v){for(n=[],r=h.length;r--;)(s=h[r])&&n.push(d[r]=s);v(null,h=[],n,i)}for(r=h.length;r--;)(s=h[r])&&-1<(n=v?b.call(e,s):a[r])&&(e[n]=!(t[n]=s))}}else h=H(h===t?h.splice(c,h.length):h),v?v(null,t,h,i):A.apply(t,h)})}function ge(g,v){function e(e,t,o,i,n){var r,s,a,l=0,c="0",u=e&&[],d=[],h=x,p=e||y&&w.find.TAG("*",n),f=P+=null==h?1:Math.random()||.1,m=p.length;for(n&&(x=t!==S&&t);c!==m&&null!=(r=p[c]);c++){if(y&&r){for(s=0;a=g[s++];)if(a(r,t,o)){i.push(r);break}n&&(P=f)}b&&((r=!a&&r)&&l--,e&&u.push(r))}if(l+=c,b&&c!==l){for(s=0;a=v[s++];)a(u,d,t,o);if(e){if(0<l)for(;c--;)u[c]||d[c]||(d[c]=G.call(i));d=H(d)}A.apply(i,d),n&&!e&&0<d.length&&1<l+v.length&&L.uniqueSort(i)}return n&&(P=f,x=h),u}var b=0<v.length,y=0<g.length;return b?h(e):e}return he.prototype=w.filters=w.pseudos,w.setFilters=new he,B=L.compile=function(e,t){var o,i=[],n=[],r=j[e+" "];if(!r){for(o=(t=t||O(e)).length;o--;)((r=function e(t){for(var i,o,n,r=t.length,s=w.relative[t[0].type],a=s||w.relative[" "],l=s?1:0,c=pe(function(e){return e===i},a,!0),u=pe(function(e){return-1<b.call(i,e)},a,!0),d=[function(e,t,o){return!s&&(o||t!==x)||((i=t).nodeType?c:u)(e,t,o)}];l<r;l++)if(o=w.relative[t[l].type])d=[pe(fe(d),o)];else{if((o=w.filter[t[l].type].apply(null,t[l].matches))[E]){for(n=++l;n<r&&!w.relative[t[n].type];n++);return me(1<l&&fe(d),1<l&&z(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(I,"$1"),o,l<n&&e(t.slice(l,n)),n<r&&e(t=t.slice(n)),n<r&&z(t))}d.push(o)}return fe(d)}(t[o]))[E]?i:n).push(r);r=j(e,ge(n,i))}return r},C.sortStable=E.split("").sort(V).join("")===E,C.detectDuplicates=!!u,_(),C.sortDetached=p(function(e){return 1&e.compareDocumentPosition(S.createElement("div"))}),p(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ce("type|href|height|width",function(e,t,o){return o?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),C.attributes&&p(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ce("value",function(e,t,o){return o||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),p(function(e){return null==e.getAttribute("disabled")})||ce(K,function(e,t,o){return o?void 0:!0===e[t]?t.toLowerCase():(o=e.getAttributeNode(t))&&o.specified?o.value:null}),L}(f),Y=(w.find=e,w.expr=e.selectors,w.expr[":"]=w.expr.pseudos,w.unique=e.uniqueSort,w.text=e.getText,w.isXMLDoc=e.isXML,w.contains=e.contains,w.expr.match.needsContext),K=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,q=/^.[^:#\[\.,]*$/;function X(e,o,i){if(w.isFunction(o))return w.grep(e,function(e,t){return!!o.call(e,t,e)!==i});if(o.nodeType)return w.grep(e,function(e){return e===o!==i});if("string"==typeof o){if(q.test(o))return w.filter(o,e,i);o=w.filter(o,e)}return w.grep(e,function(e){return 0<=w.inArray(e,o)!==i})}w.filter=function(e,t,o){var i=t[0];return o&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?w.find.matchesSelector(i,e)?[i]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,o=[],i=this,n=i.length;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<n;t++)if(w.contains(i[t],this))return!0}));for(t=0;t<n;t++)w.find(e,i[t],o);return(o=this.pushStack(1<n?w.unique(o):o)).selector=this.selector?this.selector+" "+e:e,o},filter:function(e){return this.pushStack(X(this,e||[],!1))},not:function(e){return this.pushStack(X(this,e||[],!0))},is:function(e){return!!X(this,"string"==typeof e&&Y.test(e)?w(e):e||[],!1).length}});var n,v=f.document,J=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Z=((w.fn.init=function(e,t){var o,i;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?void 0!==n.ready?n.ready(e):e(w):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this));if(!(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:J.exec(e))||!o[1]&&t)return(!t||t.jquery?t||n:this.constructor(t)).find(e);if(o[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:v,!0)),K.test(o[1])&&w.isPlainObject(t))for(o in t)w.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}if((i=v.getElementById(o[2]))&&i.parentNode){if(i.id!==o[2])return n.find(e);this.length=1,this[0]=i}return this.context=v,this.selector=e,this}).prototype=w.fn,n=w(v),/^(?:parents|prev(?:Until|All))/),Q={children:!0,contents:!0,next:!0,prev:!0};function ee(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.extend({dir:function(e,t,o){for(var i=[],n=e[t];n&&9!==n.nodeType&&(void 0===o||1!==n.nodeType||!w(n).is(o));)1===n.nodeType&&i.push(n),n=n[t];return i},sibling:function(e,t){for(var o=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&o.push(e);return o}}),w.fn.extend({has:function(e){var t,o=w(e,this),i=o.length;return this.filter(function(){for(t=0;t<i;t++)if(w.contains(this,o[t]))return!0})},closest:function(e,t){for(var o,i=0,n=this.length,r=[],s=Y.test(e)||"string"!=typeof e?w(e,t||this.context):0;i<n;i++)for(o=this[i];o&&o!==t;o=o.parentNode)if(o.nodeType<11&&(s?-1<s.index(o):1===o.nodeType&&w.find.matchesSelector(o,e))){r.push(o);break}return this.pushStack(1<r.length?w.unique(r):r)},index:function(e){return e?"string"==typeof e?w.inArray(this[0],w(e)):w.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.unique(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,o){return w.dir(e,"parentNode",o)},next:function(e){return ee(e,"nextSibling")},prev:function(e){return ee(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,o){return w.dir(e,"nextSibling",o)},prevUntil:function(e,t,o){return w.dir(e,"previousSibling",o)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return w.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:w.merge([],e.childNodes)}},function(i,n){w.fn[i]=function(e,t){var o=w.map(this,n,e);return(t="Until"!==i.slice(-5)?e:t)&&"string"==typeof t&&(o=w.filter(t,o)),1<this.length&&(Q[i]||(o=w.unique(o)),Z.test(i)&&(o=o.reverse())),this.pushStack(o)}});var t,x=/\S+/g,te={};function oe(){v.addEventListener?(v.removeEventListener("DOMContentLoaded",i,!1),f.removeEventListener("load",i,!1)):(v.detachEvent("onreadystatechange",i),f.detachEvent("onload",i))}function i(){!v.addEventListener&&"load"!==event.type&&"complete"!==v.readyState||(oe(),w.ready())}w.Callbacks=function(n){var e,o;n="string"==typeof n?te[n]||(o=te[e=n]={},w.each(e.match(x)||[],function(e,t){o[t]=!0}),o):w.extend({},n);function i(e){for(t=n.memory&&e,s=!0,l=c||0,c=0,a=u.length,r=!0;u&&l<a;l++)if(!1===u[l].apply(e[0],e[1])&&n.stopOnFalse){t=!1;break}r=!1,u&&(d?d.length&&i(d.shift()):t?u=[]:h.disable())}var r,t,s,a,l,c,u=[],d=!n.once&&[],h={add:function(){var e;return u&&(e=u.length,function i(e){w.each(e,function(e,t){var o=w.type(t);"function"===o?n.unique&&h.has(t)||u.push(t):t&&t.length&&"string"!==o&&i(t)})}(arguments),r?a=u.length:t&&(c=e,i(t))),this},remove:function(){return u&&w.each(arguments,function(e,t){for(var o;-1<(o=w.inArray(t,u,o));)u.splice(o,1),r&&(o<=a&&a--,o<=l&&l--)}),this},has:function(e){return e?-1<w.inArray(e,u):!(!u||!u.length)},empty:function(){return u=[],a=0,this},disable:function(){return u=d=t=void 0,this},disabled:function(){return!u},lock:function(){return d=void 0,t||h.disable(),this},locked:function(){return!d},fireWith:function(e,t){return!u||s&&!d||(t=[e,(t=t||[]).slice?t.slice():t],r?d.push(t):i(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},w.extend({Deferred:function(e){var r=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],n="pending",s={state:function(){return n},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var n=arguments;return w.Deferred(function(i){w.each(r,function(e,t){var o=w.isFunction(n[e])&&n[e];a[t[1]](function(){var e=o&&o.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[t[0]+"With"](this===s?i.promise():this,o?[e]:arguments)})}),n=null}).promise()},promise:function(e){return null!=e?w.extend(e,s):s}},a={};return s.pipe=s.then,w.each(r,function(e,t){var o=t[2],i=t[3];s[t[1]]=o.add,i&&o.add(function(){n=i},r[1^e][2].disable,r[2][2].lock),a[t[0]]=function(){return a[t[0]+"With"](this===a?s:this,arguments),this},a[t[0]+"With"]=o.fireWith}),s.promise(a),e&&e.call(a,a),a},when:function(e){function t(t,o,i){return function(e){o[t]=this,i[t]=1<arguments.length?u.call(arguments):e,i===n?c.notifyWith(o,i):--l||c.resolveWith(o,i)}}var n,o,i,r=0,s=u.call(arguments),a=s.length,l=1!==a||e&&w.isFunction(e.promise)?a:0,c=1===l?e:w.Deferred();if(1<a)for(n=new Array(a),o=new Array(a),i=new Array(a);r<a;r++)s[r]&&w.isFunction(s[r].promise)?s[r].promise().done(t(r,i,s)).fail(c.reject).progress(t(r,o,n)):--l;return l||c.resolveWith(i,s),c.promise()}}),w.fn.ready=function(e){return w.ready.promise().done(e),this},w.extend({isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){if(!0===e?!--w.readyWait:!w.isReady){if(!v.body)return setTimeout(w.ready);(w.isReady=!0)!==e&&0<--w.readyWait||(t.resolveWith(v,[w]),w.fn.trigger&&w(v).trigger("ready").off("ready"))}}}),w.ready.promise=function(e){if(!t)if(t=w.Deferred(),"complete"===v.readyState)setTimeout(w.ready);else if(v.addEventListener)v.addEventListener("DOMContentLoaded",i,!1),f.addEventListener("load",i,!1);else{v.attachEvent("onreadystatechange",i),f.attachEvent("onload",i);var o=!1;try{o=null==f.frameElement&&v.documentElement}catch(e){}o&&o.doScroll&&!function t(){if(!w.isReady){try{o.doScroll("left")}catch(e){return setTimeout(t,50)}oe(),w.ready()}}()}return t.promise(e)};var ie,b="undefined";for(ie in w(g))break;g.ownLast="0"!==ie,g.inlineBlockNeedsLayout=!1,w(function(){var e,t,o=v.getElementsByTagName("body")[0];o&&((e=v.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=v.createElement("div"),o.appendChild(e).appendChild(t),typeof t.style.zoom!=b&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(g.inlineBlockNeedsLayout=3===t.offsetWidth)&&(o.style.zoom=1)),o.removeChild(e))});e=v.createElement("div");if(null==g.deleteExpando){g.deleteExpando=!0;try{delete e.test}catch(e){g.deleteExpando=!1}}w.acceptData=function(e){var t=w.noData[(e.nodeName+" ").toLowerCase()],o=+e.nodeType||1;return(1===o||9===o)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var ne=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,re=/([A-Z])/g;function se(e,t,o){if(void 0===o&&1===e.nodeType){var i="data-"+t.replace(re,"-$1").toLowerCase();if("string"==typeof(o=e.getAttribute(i))){try{o="true"===o||"false"!==o&&("null"===o?null:+o+""===o?+o:ne.test(o)?w.parseJSON(o):o)}catch(e){}w.data(e,t,o)}else o=void 0}return o}function ae(e){for(var t in e)if(("data"!==t||!w.isEmptyObject(e[t]))&&"toJSON"!==t)return;return 1}function le(e,t,o,i){if(w.acceptData(e)){var n,r=w.expando,s=e.nodeType,a=s?w.cache:e,l=s?e[r]:e[r]&&r;if(l&&a[l]&&(i||a[l].data)||void 0!==o||"string"!=typeof t)return a[l=l||(s?e[r]=d.pop()||w.guid++:r)]||(a[l]=s?{}:{toJSON:w.noop}),"object"!=typeof t&&"function"!=typeof t||(i?a[l]=w.extend(a[l],t):a[l].data=w.extend(a[l].data,t)),e=a[l],i||(e.data||(e.data={}),e=e.data),void 0!==o&&(e[w.camelCase(t)]=o),"string"==typeof t?null==(n=e[t])&&(n=e[w.camelCase(t)]):n=e,n}}function ce(e,t,o){if(w.acceptData(e)){var i,n,r=e.nodeType,s=r?w.cache:e,a=r?e[w.expando]:w.expando;if(s[a]){if(t&&(i=o?s[a]:s[a].data)){n=(t=w.isArray(t)?t.concat(w.map(t,w.camelCase)):t in i?[t]:(t=w.camelCase(t))in i?[t]:t.split(" ")).length;for(;n--;)delete i[t[n]];if(o?!ae(i):!w.isEmptyObject(i))return}(o||(delete s[a].data,ae(s[a])))&&(r?w.cleanData([e],!0):g.deleteExpando||s!=s.window?delete s[a]:s[a]=null)}}}w.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?w.cache[e[w.expando]]:e[w.expando])&&!ae(e)},data:function(e,t,o){return le(e,t,o)},removeData:function(e,t){return ce(e,t)},_data:function(e,t,o){return le(e,t,o,!0)},_removeData:function(e,t){return ce(e,t,!0)}}),w.fn.extend({data:function(e,t){var o,i,n,r=this[0],s=r&&r.attributes;if(void 0!==e)return"object"==typeof e?this.each(function(){w.data(this,e)}):1<arguments.length?this.each(function(){w.data(this,e,t)}):r?se(r,e,w.data(r,e)):void 0;if(this.length&&(n=w.data(r),1===r.nodeType&&!w._data(r,"parsedAttrs"))){for(o=s.length;o--;)0===(i=s[o].name).indexOf("data-")&&se(r,i=w.camelCase(i.slice(5)),n[i]);w._data(r,"parsedAttrs",!0)}return n},removeData:function(e){return this.each(function(){w.removeData(this,e)})}}),w.extend({queue:function(e,t,o){var i;return e?(i=w._data(e,t=(t||"fx")+"queue"),o&&(!i||w.isArray(o)?i=w._data(e,t,w.makeArray(o)):i.push(o)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var o=w.queue(e,t),i=o.length,n=o.shift(),r=w._queueHooks(e,t);"inprogress"===n&&(n=o.shift(),i--),n&&("fx"===t&&o.unshift("inprogress"),delete r.stop,n.call(e,function(){w.dequeue(e,t)},r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return w._data(e,o)||w._data(e,o,{empty:w.Callbacks("once memory").add(function(){w._removeData(e,t+"queue"),w._removeData(e,o)})})}}),w.fn.extend({queue:function(t,o){var e=2;return"string"!=typeof t&&(o=t,t="fx",e--),arguments.length<e?w.queue(this[0],t):void 0===o?this:this.each(function(){var e=w.queue(this,t,o);w._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&w.dequeue(this,t)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function o(){--n||r.resolveWith(s,[s])}var i,n=1,r=w.Deferred(),s=this,a=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(i=w._data(s[a],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(o));return o(),r.promise(t)}});function y(e,t){return"none"===w.css(e=t||e,"display")||!w.contains(e.ownerDocument,e)}var e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,a=["Top","Right","Bottom","Left"],l=w.access=function(e,t,o,i,n,r,s){var a=0,l=e.length,c=null==o;if("object"===w.type(o))for(a in n=!0,o)w.access(e,t,a,o[a],!0,r,s);else if(void 0!==i&&(n=!0,w.isFunction(i)||(s=!0),t=c?s?(t.call(e,i),null):(c=t,function(e,t,o){return c.call(w(e),o)}):t))for(;a<l;a++)t(e[a],o,s?i:i.call(e[a],a,t(e[a],o)));return n?e:c?t.call(e):l?t(e[0],o):r},ue=/^(?:checkbox|radio)$/i,r=v.createDocumentFragment(),s=v.createElement("div"),c=v.createElement("input");if(s.setAttribute("className","t"),s.innerHTML="  <link/><table></table><a href='/a'>a</a>",g.leadingWhitespace=3===s.firstChild.nodeType,g.tbody=!s.getElementsByTagName("tbody").length,g.htmlSerialize=!!s.getElementsByTagName("link").length,g.html5Clone="<:nav></:nav>"!==v.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,r.appendChild(c),g.appendChecked=c.checked,s.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!s.cloneNode(!0).lastChild.defaultValue,r.appendChild(s),s.innerHTML="<input type='radio' checked='checked' name='t'/>",g.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,g.noCloneEvent=!0,s.attachEvent&&(s.attachEvent("onclick",function(){g.noCloneEvent=!1}),s.cloneNode(!0).click()),null==g.deleteExpando){g.deleteExpando=!0;try{delete s.test}catch(e){g.deleteExpando=!1}}var h,p,de=v.createElement("div");for(h in{submit:!0,change:!0,focusin:!0})p="on"+h,(g[h+"Bubbles"]=p in f)||(de.setAttribute(p,"t"),g[h+"Bubbles"]=!1===de.attributes[p].expando);var he=/^(?:input|select|textarea)$/i,pe=/^key/,fe=/^(?:mouse|contextmenu)|click/,me=/^(?:focusinfocus|focusoutblur)$/,ge=/^([^.]*)(?:\.(.+)|)$/;function ve(){return!0}function C(){return!1}function be(){try{return v.activeElement}catch(e){}}function ye(e){var t=Ce.split("|"),o=e.createDocumentFragment();if(o.createElement)for(;t.length;)o.createElement(t.pop());return o}w.event={global:{},add:function(e,t,o,i,n){var r,s,a,l,c,u,d,h,p,f=w._data(e);if(f)for(o.handler&&(o=(a=o).handler,n=a.selector),o.guid||(o.guid=w.guid++),(r=f.events)||(r=f.events={}),(c=f.handle)||((c=f.handle=function(e){return typeof w==b||e&&w.event.triggered===e.type?void 0:w.event.dispatch.apply(c.elem,arguments)}).elem=e),s=(t=(t||"").match(x)||[""]).length;s--;)d=p=(h=ge.exec(t[s])||[])[1],h=(h[2]||"").split(".").sort(),d&&(l=w.event.special[d]||{},d=(n?l.delegateType:l.bindType)||d,l=w.event.special[d]||{},p=w.extend({type:d,origType:p,data:i,handler:o,guid:o.guid,selector:n,needsContext:n&&w.expr.match.needsContext.test(n),namespace:h.join(".")},a),(u=r[d])||((u=r[d]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(e,i,h,c)||(e.addEventListener?e.addEventListener(d,c,!1):e.attachEvent&&e.attachEvent("on"+d,c))),l.add&&(l.add.call(e,p),p.handler.guid||(p.handler.guid=o.guid)),n?u.splice(u.delegateCount++,0,p):u.push(p),w.event.global[d]=!0)},remove:function(e,t,o,i,n){var r,s,a,l,c,u,d,h,p,f,m,g=w.hasData(e)&&w._data(e);if(g&&(u=g.events)){for(c=(t=(t||"").match(x)||[""]).length;c--;)if(p=m=(a=ge.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=w.event.special[p]||{},h=u[p=(i?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=h.length;r--;)s=h[r],!n&&m!==s.origType||o&&o.guid!==s.guid||a&&!a.test(s.namespace)||i&&i!==s.selector&&("**"!==i||!s.selector)||(h.splice(r,1),s.selector&&h.delegateCount--,d.remove&&d.remove.call(e,s));l&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,g.handle)||w.removeEvent(e,p,g.handle),delete u[p])}else for(p in u)w.event.remove(e,p+t[c],o,i,!0);w.isEmptyObject(u)&&(delete g.handle,w._removeData(e,"events"))}},trigger:function(e,t,o,i){var n,r,s,a,l,c,u=[o||v],d=m.call(e,"type")?e.type:e,h=m.call(e,"namespace")?e.namespace.split("."):[],p=l=o=o||v;if(3!==o.nodeType&&8!==o.nodeType&&!me.test(d+w.event.triggered)&&(0<=d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),r=d.indexOf(":")<0&&"on"+d,(e=e[w.expando]?e:new w.Event(d,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=h.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=o),t=null==t?[e]:w.makeArray(t,[e]),a=w.event.special[d]||{},i||!a.trigger||!1!==a.trigger.apply(o,t))){if(!i&&!a.noBubble&&!w.isWindow(o)){for(s=a.delegateType||d,me.test(s+d)||(p=p.parentNode);p;p=p.parentNode)u.push(p),l=p;l===(o.ownerDocument||v)&&u.push(l.defaultView||l.parentWindow||f)}for(c=0;(p=u[c++])&&!e.isPropagationStopped();)e.type=1<c?s:a.bindType||d,(n=(w._data(p,"events")||{})[e.type]&&w._data(p,"handle"))&&n.apply(p,t),(n=r&&p[r])&&n.apply&&w.acceptData(p)&&(e.result=n.apply(p,t),!1===e.result&&e.preventDefault());if(e.type=d,!i&&!e.isDefaultPrevented()&&(!a._default||!1===a._default.apply(u.pop(),t))&&w.acceptData(o)&&r&&o[d]&&!w.isWindow(o)){(l=o[r])&&(o[r]=null),w.event.triggered=d;try{o[d]()}catch(e){}w.event.triggered=void 0,l&&(o[r]=l)}return e.result}},dispatch:function(e){e=w.event.fix(e);var t,o,i,n,r,s=u.call(arguments),a=(w._data(this,"events")||{})[e.type]||[],l=w.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(r=w.event.handlers.call(this,e,a),t=0;(i=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(o=((w.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(e.result=o)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,i,n,r,s=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(n=[],r=0;r<a;r++)void 0===n[o=(i=t[r]).selector+" "]&&(n[o]=i.needsContext?0<=w(o,this).index(l):w.find(o,this,null,[l]).length),n[o]&&n.push(i);n.length&&s.push({elem:l,handlers:n})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},fix:function(e){if(e[w.expando])return e;var t,o,i,n=e.type,r=e,s=this.fixHooks[n];for(s||(this.fixHooks[n]=s=fe.test(n)?this.mouseHooks:pe.test(n)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,e=new w.Event(r),t=i.length;t--;)e[o=i[t]]=r[o];return e.target||(e.target=r.srcElement||v),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var o,i,n=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(o=e.target.ownerDocument||v).documentElement,o=o.body,e.pageX=t.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===n||(e.which=1&n?1:2&n?3:4&n?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==be()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===be()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return w.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,o,i){e=w.extend(new w.Event,o,{type:e,isSimulated:!0,originalEvent:{}});i?w.event.trigger(e,null,t):w.event.dispatch.call(t,e),e.isDefaultPrevented()&&o.preventDefault()}},w.removeEvent=v.removeEventListener?function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o,!1)}:function(e,t,o){t="on"+t;e.detachEvent&&(typeof e[t]==b&&(e[t]=null),e.detachEvent(t,o))},w.Event=function(e,t){return this instanceof w.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault())?ve:C):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||w.now(),void(this[w.expando]=!0)):new w.Event(e,t)},w.Event.prototype={isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ve,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ve,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ve,this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,n){w.event.special[e]={delegateType:n,bindType:n,handle:function(e){var t,o=e.relatedTarget,i=e.handleObj;return o&&(o===this||w.contains(this,o))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=n),t}}}),g.submitBubbles||(w.event.special.submit={setup:function(){return!w.nodeName(this,"form")&&void w.event.add(this,"click._submit keypress._submit",function(e){e=e.target,e=w.nodeName(e,"input")||w.nodeName(e,"button")?e.form:void 0;e&&!w._data(e,"submitBubbles")&&(w.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),w._data(e,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&w.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return!w.nodeName(this,"form")&&void w.event.remove(this,"._submit")}}),g.changeBubbles||(w.event.special.change={setup:function(){return he.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(w.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),w.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),w.event.simulate("change",this,e,!0)})),!1):void w.event.add(this,"beforeactivate._change",function(e){e=e.target;he.test(e.nodeName)&&!w._data(e,"changeBubbles")&&(w.event.add(e,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||w.event.simulate("change",this.parentNode,e,!0)}),w._data(e,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return w.event.remove(this,"._change"),!he.test(this.nodeName)}}),g.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(o,i){function n(e){w.event.simulate(i,e.target,w.event.fix(e),!0)}w.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=w._data(e,i);t||e.addEventListener(o,n,!0),w._data(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=w._data(e,i)-1;t?w._data(e,i,t):(e.removeEventListener(o,n,!0),w._removeData(e,i))}}}),w.fn.extend({on:function(e,t,o,i,n){var r,s;if("object"==typeof e){for(r in"string"!=typeof t&&(o=o||t,t=void 0),e)this.on(r,t,o,e[r],n);return this}if(null==o&&null==i?(i=t,o=t=void 0):null==i&&("string"==typeof t?(i=o,o=void 0):(i=o,o=t,t=void 0)),!1===i)i=C;else if(!i)return this;return 1===n&&(s=i,(i=function(e){return w().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=w.guid++)),this.each(function(){w.event.add(this,e,i,o,t)})},one:function(e,t,o,i){return this.on(e,t,o,i,1)},off:function(e,t,o){var i,n;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(o=t,t=void 0),!1===o&&(o=C),this.each(function(){w.event.remove(this,e,o,t)});for(n in e)this.off(n,t,e[n]);return this},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var o=this[0];return o?w.event.trigger(e,t,o,!0):void 0}});var Ce="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",we=/ jQuery\d+="(?:null|\d+)"/g,xe=new RegExp("<(?:"+Ce+")[\\s/>]","i"),_e=/^\s+/,Se=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ke=/<([\w:]+)/,Te=/<tbody/i,Fe=/<|&#?\w+;/,Ee=/<(?:script|style|link)/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^$|\/(?:java|ecma)script/i,Ae=/^true\/(.*)/,Ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,_={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:g.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Me=ye(v).appendChild(v.createElement("div"));function S(e,t){var o,i,n=0,r=typeof e.getElementsByTagName!=b?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!=b?e.querySelectorAll(t||"*"):void 0;if(!r)for(r=[],o=e.childNodes||e;null!=(i=o[n]);n++)!t||w.nodeName(i,t)?r.push(i):w.merge(r,S(i,t));return void 0===t||t&&w.nodeName(e,t)?w.merge([e],r):r}function Re(e){ue.test(e.type)&&(e.defaultChecked=e.checked)}function Ne(e,t){return w.nodeName(e,"table")&&w.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Le(e){return e.type=(null!==w.find.attr(e,"type"))+"/"+e.type,e}function Oe(e){var t=Ae.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function ze(e,t){for(var o,i=0;null!=(o=e[i]);i++)w._data(o,"globalEval",!t||w._data(t[i],"globalEval"))}function He(e,t){if(1===t.nodeType&&w.hasData(e)){var o,i,n,e=w._data(e),r=w._data(t,e),s=e.events;if(s)for(o in delete r.handle,r.events={},s)for(i=0,n=s[o].length;i<n;i++)w.event.add(t,o,s[o][i]);r.data&&(r.data=w.extend({},r.data))}}_.optgroup=_.option,_.tbody=_.tfoot=_.colgroup=_.caption=_.thead,_.th=_.td,w.extend({clone:function(e,t,o){var i,n,r,s,a,l,c,u,d=w.contains(e.ownerDocument,e);if(g.html5Clone||w.isXMLDoc(e)||!xe.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(Me.innerHTML=e.outerHTML,Me.removeChild(r=Me.firstChild)),!(g.noCloneEvent&&g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(i=S(r),a=S(e),s=0;null!=(n=a[s]);++s)if(i[s]){h=void 0;p=void 0;l=void 0;c=void 0;u=void 0;var h=n;var p=i[s];if(1===p.nodeType){if(l=p.nodeName.toLowerCase(),!g.noCloneEvent&&p[w.expando]){for(c in(u=w._data(p)).events)w.removeEvent(p,c,u.handle);p.removeAttribute(w.expando)}"script"===l&&p.text!==h.text?(Le(p).text=h.text,Oe(p)):"object"===l?(p.parentNode&&(p.outerHTML=h.outerHTML),g.html5Clone&&h.innerHTML&&!w.trim(p.innerHTML)&&(p.innerHTML=h.innerHTML)):"input"===l&&ue.test(h.type)?(p.defaultChecked=p.checked=h.checked,p.value!==h.value&&(p.value=h.value)):"option"===l?p.defaultSelected=p.selected=h.defaultSelected:"input"!==l&&"textarea"!==l||(p.defaultValue=h.defaultValue)}}if(t)if(o)for(a=a||S(e),i=i||S(r),s=0;null!=(n=a[s]);s++)He(n,i[s]);else He(e,r);return 0<(i=S(r,"script")).length&&ze(i,!d&&S(e,"script")),i=a=n=null,r},buildFragment:function(e,t,o,i){for(var n,r,s,a,l,c,u,d=e.length,h=ye(t),p=[],f=0;f<d;f++)if((r=e[f])||0===r)if("object"===w.type(r))w.merge(p,r.nodeType?[r]:r);else if(Fe.test(r)){for(a=a||h.appendChild(t.createElement("div")),l=(ke.exec(r)||["",""])[1].toLowerCase(),u=_[l]||_._default,a.innerHTML=u[1]+r.replace(Se,"<$1></$2>")+u[2],n=u[0];n--;)a=a.lastChild;if(!g.leadingWhitespace&&_e.test(r)&&p.push(t.createTextNode(_e.exec(r)[0])),!g.tbody)for(n=(r="table"!==l||Te.test(r)?"<table>"!==u[1]||Te.test(r)?0:a:a.firstChild)&&r.childNodes.length;n--;)w.nodeName(c=r.childNodes[n],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(w.merge(p,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=h.lastChild}else p.push(t.createTextNode(r));for(a&&h.removeChild(a),g.appendChecked||w.grep(S(p,"input"),Re),f=0;r=p[f++];)if((!i||-1===w.inArray(r,i))&&(s=w.contains(r.ownerDocument,r),a=S(h.appendChild(r),"script"),s&&ze(a),o))for(n=0;r=a[n++];)Pe.test(r.type||"")&&o.push(r);return a=null,h},cleanData:function(e,t){for(var o,i,n,r,s=0,a=w.expando,l=w.cache,c=g.deleteExpando,u=w.event.special;null!=(o=e[s]);s++)if((t||w.acceptData(o))&&(r=(n=o[a])&&l[n])){if(r.events)for(i in r.events)u[i]?w.event.remove(o,i):w.removeEvent(o,i,r.handle);l[n]&&(delete l[n],c?delete o[a]:typeof o.removeAttribute!=b?o.removeAttribute(a):o[a]=null,d.push(n))}}}),w.fn.extend({text:function(e){return l(this,function(e){return void 0===e?w.text(this):this.empty().append((this[0]&&this[0].ownerDocument||v).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ne(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=Ne(this,e)).insertBefore(e,t.firstChild)})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var o,i=e?w.filter(e,this):this,n=0;null!=(o=i[n]);n++)t||1!==o.nodeType||w.cleanData(S(o)),o.parentNode&&(t&&w.contains(o.ownerDocument,o)&&ze(S(o,"script")),o.parentNode.removeChild(o));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&w.cleanData(S(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&w.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return l(this,function(e){var t=this[0]||{},o=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(we,""):void 0;if(!("string"!=typeof e||Ee.test(e)||!g.htmlSerialize&&xe.test(e)||!g.leadingWhitespace&&_e.test(e)||_[(ke.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Se,"<$1></$2>");try{for(;o<i;o++)1===(t=this[o]||{}).nodeType&&(w.cleanData(S(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,w.cleanData(S(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(o,i){o=z.apply([],o);var e,t,n,r,s,a,l=0,c=this.length,u=this,d=c-1,h=o[0],p=w.isFunction(h);if(p||1<c&&"string"==typeof h&&!g.checkClone&&De.test(h))return this.each(function(e){var t=u.eq(e);p&&(o[0]=h.call(this,e,t.html())),t.domManip(o,i)});if(c&&(e=(a=w.buildFragment(o,this[0].ownerDocument,!1,this)).firstChild,1===a.childNodes.length&&(a=e),e)){for(n=(r=w.map(S(a,"script"),Le)).length;l<c;l++)t=a,l!==d&&(t=w.clone(t,!0,!0),n&&w.merge(r,S(t,"script"))),i.call(this[l],t,l);if(n)for(s=r[r.length-1].ownerDocument,w.map(r,Oe),l=0;l<n;l++)t=r[l],Pe.test(t.type||"")&&!w._data(t,"globalEval")&&w.contains(s,t)&&(t.src?w._evalUrl&&w._evalUrl(t.src):w.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Ie,"")));a=e=null}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){w.fn[e]=function(e){for(var t,o=0,i=[],n=w(e),r=n.length-1;o<=r;o++)t=o===r?this:this.clone(!0),w(n[o])[s](t),H.apply(i,t.get());return this.pushStack(i)}});var Be,Ue,je={};function Ve(e,t){e=w(t.createElement(e)).appendTo(t.body),t=f.getDefaultComputedStyle?f.getDefaultComputedStyle(e[0]).display:w.css(e[0],"display");return e.detach(),t}function We(e){var t=v,o=je[e];return o||("none"!==(o=Ve(e,t))&&o||((t=((Be=(Be||w("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Be[0].contentDocument).document).write(),t.close(),o=Ve(e,t),Be.detach()),je[e]=o),o}(c=v.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(r=c.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",g.opacity=/^0.5/.test(r.style.opacity),g.cssFloat=!!r.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===c.style.backgroundClip,r=c=null,g.shrinkWrapBlocks=function(){var e,t,o;if(null==Ue){if(!(e=v.getElementsByTagName("body")[0]))return;t=v.createElement("div"),o=v.createElement("div"),e.appendChild(t).appendChild(o),Ue=!1,typeof o.style.zoom!=b&&(o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0;width:1px;padding:1px;zoom:1",o.innerHTML="<div></div>",o.firstChild.style.width="5px",Ue=3!==o.offsetWidth),e.removeChild(t),e=o=null}return Ue};var k,T,Ge,$e,Ye,Ke,qe,Xe,Je=/^margin/,Ze=new RegExp("^("+e+")(?!px)[a-z%]+$","i"),Qe=/^(top|right|bottom|left)$/;function et(t,o){return{get:function(){var e=t();if(null!=e)return e?void delete this.get:(this.get=o).apply(this,arguments)}}}function tt(){var e,t,o=v.getElementsByTagName("body")[0];o&&(e=v.createElement("div"),t=v.createElement("div"),e.style.cssText=Xe,o.appendChild(e).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",w.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){$e=4===t.offsetWidth}),qe=!(Ke=!(Ye=!0)),f.getComputedStyle&&(Ke="1%"!==(f.getComputedStyle(t,null)||{}).top,Ye="4px"===(f.getComputedStyle(t,null)||{width:"4px"}).width),o.removeChild(e),t=null)}f.getComputedStyle?(k=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},T=function(e,t,o){var i,n=e.style,r=(o=o||k(e))?o.getPropertyValue(t)||o[t]:void 0;return o&&(""!==r||w.contains(e.ownerDocument,e)||(r=w.style(e,t)),Ze.test(r)&&Je.test(t)&&(e=n.width,t=n.minWidth,i=n.maxWidth,n.minWidth=n.maxWidth=n.width=r,r=o.width,n.width=e,n.minWidth=t,n.maxWidth=i)),void 0===r?r:r+""}):v.documentElement.currentStyle&&(k=function(e){return e.currentStyle},T=function(e,t,o){var i,n,r,s=e.style;return null==(o=(o=o||k(e))?o[t]:void 0)&&s&&s[t]&&(o=s[t]),Ze.test(o)&&!Qe.test(t)&&(i=s.left,(r=(n=e.runtimeStyle)&&n.left)&&(n.left=e.currentStyle.left),s.left="fontSize"===t?"1em":o,o=s.pixelLeft+"px",s.left=i,r&&(n.left=r)),void 0===o?o:o+""||"auto"}),s=v.createElement("div"),Xe="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(c=s.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",g.opacity=/^0.5/.test(c.style.opacity),g.cssFloat=!!c.style.cssFloat,s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===s.style.backgroundClip,c=s=null,w.extend(g,{reliableHiddenOffsets:function(){if(null!=Ge)return Ge;var e,t,o,i=v.createElement("div"),n=v.getElementsByTagName("body")[0];return n?(i.setAttribute("className","t"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(e=v.createElement("div")).style.cssText=Xe,n.appendChild(e).appendChild(i),i.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(t=i.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",o=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",Ge=o&&0===t[0].offsetHeight,n.removeChild(e),i=n=null,Ge):void 0},boxSizing:function(){return null==$e&&tt(),$e},boxSizingReliable:function(){return null==Ye&&tt(),Ye},pixelPosition:function(){return null==Ke&&tt(),Ke},reliableMarginRight:function(){var e,t,o,i;if(null==qe&&f.getComputedStyle){if(!(e=v.getElementsByTagName("body")[0]))return;t=v.createElement("div"),o=v.createElement("div"),t.style.cssText=Xe,e.appendChild(t).appendChild(o),(i=o.appendChild(v.createElement("div"))).style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",i.style.marginRight=i.style.width="0",o.style.width="1px",qe=!parseFloat((f.getComputedStyle(i,null)||{}).marginRight),e.removeChild(t)}return qe}}),w.swap=function(e,t,o,i){var n,r={};for(n in t)r[n]=e.style[n],e.style[n]=t[n];for(n in o=o.apply(e,i||[]),t)e.style[n]=r[n];return o};var ot=/alpha\([^)]*\)/i,it=/opacity\s*=\s*([^)]*)/,nt=/^(none|table(?!-c[ea]).+)/,rt=new RegExp("^("+e+")(.*)$","i"),st=new RegExp("^([+-])=("+e+")","i"),at={position:"absolute",visibility:"hidden",display:"block"},lt={letterSpacing:0,fontWeight:400},ct=["Webkit","O","Moz","ms"];function ut(e,t){if(t in e)return t;for(var o=t.charAt(0).toUpperCase()+t.slice(1),i=t,n=ct.length;n--;)if((t=ct[n]+o)in e)return t;return i}function dt(e,t){for(var o,i,n,r=[],s=0,a=e.length;s<a;s++)(i=e[s]).style&&(r[s]=w._data(i,"olddisplay"),o=i.style.display,t?(r[s]||"none"!==o||(i.style.display=""),""===i.style.display&&y(i)&&(r[s]=w._data(i,"olddisplay",We(i.nodeName)))):r[s]||(n=y(i),(o&&"none"!==o||!n)&&w._data(i,"olddisplay",n?o:w.css(i,"display"))));for(s=0;s<a;s++)!(i=e[s]).style||t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[s]||"":"none");return e}function ht(e,t,o){var i=rt.exec(t);return i?Math.max(0,i[1]-(o||0))+(i[2]||"px"):t}function pt(e,t,o,i,n){for(var r=o===(i?"border":"content")?4:"width"===t?1:0,s=0;r<4;r+=2)"margin"===o&&(s+=w.css(e,o+a[r],!0,n)),i?("content"===o&&(s-=w.css(e,"padding"+a[r],!0,n)),"margin"!==o&&(s-=w.css(e,"border"+a[r]+"Width",!0,n))):(s+=w.css(e,"padding"+a[r],!0,n),"padding"!==o&&(s+=w.css(e,"border"+a[r]+"Width",!0,n)));return s}function ft(e,t,o){var i=!0,n="width"===t?e.offsetWidth:e.offsetHeight,r=k(e),s=g.boxSizing()&&"border-box"===w.css(e,"boxSizing",!1,r);if(n<=0||null==n){if(((n=T(e,t,r))<0||null==n)&&(n=e.style[t]),Ze.test(n))return n;i=s&&(g.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+pt(e,t,o||(s?"border":"content"),i,r)+"px"}function F(e,t,o,i,n){return new F.prototype.init(e,t,o,i,n)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t)return""===(t=T(e,"opacity"))?"1":t}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:g.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,o,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,r,s,a=w.camelCase(t),l=e.style;if(t=w.cssProps[a]||(w.cssProps[a]=ut(l,a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===o)return s&&"get"in s&&void 0!==(n=s.get(e,!1,i))?n:l[t];if("string"===(r=typeof o)&&(n=st.exec(o))&&(o=(n[1]+1)*n[2]+parseFloat(w.css(e,t)),r="number"),null!=o&&o==o&&("number"!==r||w.cssNumber[a]||(o+="px"),g.clearCloneStyle||""!==o||0!==t.indexOf("background")||(l[t]="inherit"),!(s&&"set"in s&&void 0===(o=s.set(e,o,i)))))try{l[t]="",l[t]=o}catch(e){}}},css:function(e,t,o,i){var n,r=w.camelCase(t);return t=w.cssProps[r]||(w.cssProps[r]=ut(e.style,r)),"normal"===(n=void 0===(n=(r=w.cssHooks[t]||w.cssHooks[r])&&"get"in r?r.get(e,!0,o):n)?T(e,t,i):n)&&t in lt&&(n=lt[t]),""===o||o?(r=parseFloat(n),!0===o||w.isNumeric(r)?r||0:n):n}}),w.each(["height","width"],function(e,n){w.cssHooks[n]={get:function(e,t,o){return t?0===e.offsetWidth&&nt.test(w.css(e,"display"))?w.swap(e,at,function(){return ft(e,n,o)}):ft(e,n,o):void 0},set:function(e,t,o){var i=o&&k(e);return ht(0,t,o?pt(e,n,o,g.boxSizing()&&"border-box"===w.css(e,"boxSizing",!1,i),i):0)}}}),g.opacity||(w.cssHooks.opacity={get:function(e,t){return it.test((t&&e.currentStyle?e.currentStyle:e.style).filter||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var o=e.style,e=e.currentStyle,i=w.isNumeric(t)?"alpha(opacity="+100*t+")":"",n=e&&e.filter||o.filter||"";((o.zoom=1)<=t||""===t)&&""===w.trim(n.replace(ot,""))&&o.removeAttribute&&(o.removeAttribute("filter"),""===t||e&&!e.filter)||(o.filter=ot.test(n)?n.replace(ot,i):n+" "+i)}}),w.cssHooks.marginRight=et(g.reliableMarginRight,function(e,t){return t?w.swap(e,{display:"inline-block"},T,[e,"marginRight"]):void 0}),w.each({margin:"",padding:"",border:"Width"},function(n,r){w.cssHooks[n+r]={expand:function(e){for(var t=0,o={},i="string"==typeof e?e.split(" "):[e];t<4;t++)o[n+a[t]+r]=i[t]||i[t-2]||i[0];return o}},Je.test(n)||(w.cssHooks[n+r].set=ht)}),w.fn.extend({css:function(e,t){return l(this,function(e,t,o){var i,n,r={},s=0;if(w.isArray(t)){for(i=k(e),n=t.length;s<n;s++)r[t[s]]=w.css(e,t[s],!1,i);return r}return void 0!==o?w.style(e,t,o):w.css(e,t)},e,t,1<arguments.length)},show:function(){return dt(this,!0)},hide:function(){return dt(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){y(this)?w(this).show():w(this).hide()})}}),((w.Tween=F).prototype={constructor:F,init:function(e,t,o,i,n,r){this.elem=e,this.prop=o,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(w.cssNumber[o]?"":"px")},cur:function(){var e=F.propHooks[this.prop];return(e&&e.get?e:F.propHooks._default).get(this)},run:function(e){var t=F.propHooks[this.prop];return this.pos=e=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(t&&t.set?t:F.propHooks._default).set(this),this}}).init.prototype=F.prototype,(F.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[w.cssProps[e.prop]]||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}}).scrollTop=F.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.fx=F.prototype.init,w.fx.step={};var E,mt,D,gt=/^(?:toggle|show|hide)$/,vt=new RegExp("^(?:([+-])=|)("+e+")([a-z%]*)$","i"),bt=/queueHooks$/,yt=[function(t,e,o){var i,n,r,s,a,l,c,u,d=this,h={},p=t.style,f=t.nodeType&&y(t),m=w._data(t,"fxshow");for(i in o.queue||(null==(a=w._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,w.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(o.overflow=[p.overflow,p.overflowX,p.overflowY],c=w.css(t,"display"),u=We(t.nodeName),"inline"===(c="none"===c?u:c)&&"none"===w.css(t,"float")&&(g.inlineBlockNeedsLayout&&"inline"!==u?p.zoom=1:p.display="inline-block")),o.overflow&&(p.overflow="hidden",g.shrinkWrapBlocks()||d.always(function(){p.overflow=o.overflow[0],p.overflowX=o.overflow[1],p.overflowY=o.overflow[2]})),e)if(n=e[i],gt.exec(n)){if(delete e[i],r=r||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!m||void 0===m[i])continue;f=!0}h[i]=m&&m[i]||w.style(t,i)}if(!w.isEmptyObject(h))for(i in m?"hidden"in m&&(f=m.hidden):m=w._data(t,"fxshow",{}),r&&(m.hidden=!f),f?w(t).show():d.done(function(){w(t).hide()}),d.done(function(){for(var e in w._removeData(t,"fxshow"),h)w.style(t,e,h[e])}),h)s=xt(f?m[i]:0,i,d),i in m||(m[i]=s.start,f&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}],P={"*":[function(e,t){var o=this.createTween(e,t),i=o.cur(),t=vt.exec(t),n=t&&t[3]||(w.cssNumber[e]?"":"px"),r=(w.cssNumber[e]||"px"!==n&&+i)&&vt.exec(w.css(o.elem,e)),s=1,a=20;if(r&&r[3]!==n)for(n=n||r[3],t=t||[],r=+i||1;w.style(o.elem,e,(r/=s=s||".5")+n),s!==(s=o.cur()/i)&&1!==s&&--a;);return t&&(r=o.start=+r||+i||0,o.unit=n,o.end=t[1]?r+(t[1]+1)*t[2]:+t[2]),o}]};function Ct(){return setTimeout(function(){E=void 0}),E=w.now()}function wt(e,t){var o,i={height:e},n=0;for(t=t?1:0;n<4;n+=2-t)i["margin"+(o=a[n])]=i["padding"+o]=e;return t&&(i.opacity=i.width=e),i}function xt(e,t,o){for(var i,n=(P[t]||[]).concat(P["*"]),r=0,s=n.length;r<s;r++)if(i=n[r].call(o,t,e))return i}function _t(n,e,t){var o,r,i,s,a,l,c,u=0,d=yt.length,h=w.Deferred().always(function(){delete p.elem}),p=function(){if(r)return!1;for(var e=E||Ct(),e=Math.max(0,f.startTime+f.duration-e),t=1-(e/f.duration||0),o=0,i=f.tweens.length;o<i;o++)f.tweens[o].run(t);return h.notifyWith(n,[f,t,e]),t<1&&i?e:(h.resolveWith(n,[f]),!1)},f=h.promise({elem:n,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:E||Ct(),duration:t.duration,tweens:[],createTween:function(e,t){t=w.Tween(n,f.opts,e,t,f.opts.specialEasing[e]||f.opts.easing);return f.tweens.push(t),t},stop:function(e){var t=0,o=e?f.tweens.length:0;if(r)return this;for(r=!0;t<o;t++)f.tweens[t].run(1);return e?h.resolveWith(n,[f,e]):h.rejectWith(n,[f,e]),this}}),m=f.props,g=m,v=f.opts.specialEasing;for(i in g)if(s=w.camelCase(i),a=v[s],l=g[i],w.isArray(l)&&(a=l[1],l=g[i]=l[0]),i!==s&&(g[s]=l,delete g[i]),c=w.cssHooks[s],c&&"expand"in c)for(i in l=c.expand(l),delete g[s],l)i in g||(g[i]=l[i],v[i]=a);else v[s]=a;for(;u<d;u++)if(o=yt[u].call(f,n,m,f.opts))return o;return w.map(m,xt,f),w.isFunction(f.opts.start)&&f.opts.start.call(n,f),w.fx.timer(w.extend(p,{elem:n,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}w.Animation=w.extend(_t,{tweener:function(e,t){for(var o,i=0,n=(e=w.isFunction(e)?(t=e,["*"]):e.split(" ")).length;i<n;i++)o=e[i],P[o]=P[o]||[],P[o].unshift(t)},prefilter:function(e,t){t?yt.unshift(e):yt.push(e)}}),w.speed=function(e,t,o){var i=e&&"object"==typeof e?w.extend({},e):{complete:o||!o&&t||w.isFunction(e)&&e,duration:e,easing:o&&t||t&&!w.isFunction(t)&&t};return i.duration=w.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in w.fx.speeds?w.fx.speeds[i.duration]:w.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){w.isFunction(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(e,t,o,i){return this.filter(y).css("opacity",0).show().end().animate({opacity:t},e,o,i)},animate:function(t,e,o,i){function n(){var e=_t(this,w.extend({},t),s);(r||w._data(this,"finish"))&&e.stop(!0)}var r=w.isEmptyObject(t),s=w.speed(e,o,i);return n.finish=n,r||!1===s.queue?this.each(n):this.queue(s.queue,n)},stop:function(n,e,r){function s(e){var t=e.stop;delete e.stop,t(r)}return"string"!=typeof n&&(r=e,e=n,n=void 0),e&&!1!==n&&this.queue(n||"fx",[]),this.each(function(){var e=!0,t=null!=n&&n+"queueHooks",o=w.timers,i=w._data(this);if(t)i[t]&&i[t].stop&&s(i[t]);else for(t in i)i[t]&&i[t].stop&&bt.test(t)&&s(i[t]);for(t=o.length;t--;)o[t].elem!==this||null!=n&&o[t].queue!==n||(o[t].anim.stop(r),e=!1,o.splice(t,1));!e&&r||w.dequeue(this,n)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var e,t=w._data(this),o=t[s+"queue"],i=t[s+"queueHooks"],n=w.timers,r=o?o.length:0;for(t.finish=!0,w.queue(this,s,[]),i&&i.stop&&i.stop.call(this,!0),e=n.length;e--;)n[e].elem===this&&n[e].queue===s&&(n[e].anim.stop(!0),n.splice(e,1));for(e=0;e<r;e++)o[e]&&o[e].finish&&o[e].finish.call(this);delete t.finish})}}),w.each(["toggle","show","hide"],function(e,i){var n=w.fn[i];w.fn[i]=function(e,t,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(wt(i,!0),e,t,o)}}),w.each({slideDown:wt("show"),slideUp:wt("hide"),slideToggle:wt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){w.fn[e]=function(e,t,o){return this.animate(i,e,t,o)}}),w.timers=[],w.fx.tick=function(){var e,t=w.timers,o=0;for(E=w.now();o<t.length;o++)(e=t[o])()||t[o]!==e||t.splice(o--,1);t.length||w.fx.stop(),E=void 0},w.fx.timer=function(e){w.timers.push(e),e()?w.fx.start():w.timers.pop()},w.fx.interval=13,w.fx.start=function(){mt=mt||setInterval(w.fx.tick,w.fx.interval)},w.fx.stop=function(){clearInterval(mt),mt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(i,e){return i=w.fx&&w.fx.speeds[i]||i,this.queue(e=e||"fx",function(e,t){var o=setTimeout(e,i);t.stop=function(){clearTimeout(o)}})},(r=v.createElement("div")).setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",s=r.getElementsByTagName("a")[0],e=(c=v.createElement("select")).appendChild(v.createElement("option")),D=r.getElementsByTagName("input")[0],s.style.cssText="top:1px",g.getSetAttribute="t"!==r.className,g.style=/top/.test(s.getAttribute("style")),g.hrefNormalized="/a"===s.getAttribute("href"),g.checkOn=!!D.value,g.optSelected=e.selected,g.enctype=!!v.createElement("form").enctype,c.disabled=!0,g.optDisabled=!e.disabled,(D=v.createElement("input")).setAttribute("value",""),g.input=""===D.getAttribute("value"),D.value="t",D.setAttribute("type","radio"),g.radioValue="t"===D.value;var St=/\r/g;w.fn.extend({val:function(t){var o,e,i,n=this[0];return arguments.length?(i=w.isFunction(t),this.each(function(e){1===this.nodeType&&(null==(e=i?t.call(this,e,w(this).val()):t)?e="":"number"==typeof e?e+="":w.isArray(e)&&(e=w.map(e,function(e){return null==e?"":e+""})),(o=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in o&&void 0!==o.set(this,e,"value")||(this.value=e))})):n?(o=w.valHooks[n.type]||w.valHooks[n.nodeName.toLowerCase()])&&"get"in o&&void 0!==(e=o.get(n,"value"))?e:"string"==typeof(e=n.value)?e.replace(St,""):null==e?"":e:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:w.text(e)}},select:{get:function(e){for(var t,o=e.options,i=e.selectedIndex,n="select-one"===e.type||i<0,r=n?null:[],s=n?i+1:o.length,a=i<0?s:n?i:0;a<s;a++)if(!(!(t=o[a]).selected&&a!==i||(g.optDisabled?t.disabled:null!==t.getAttribute("disabled"))||t.parentNode.disabled&&w.nodeName(t.parentNode,"optgroup"))){if(t=w(t).val(),n)return t;r.push(t)}return r},set:function(e,t){for(var o,i,n=e.options,r=w.makeArray(t),s=n.length;s--;)if(i=n[s],0<=w.inArray(w.valHooks.option.get(i),r))try{i.selected=o=!0}catch(e){i.scrollHeight}else i.selected=!1;return o||(e.selectedIndex=-1),n}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){return w.isArray(t)?e.checked=0<=w.inArray(w(e).val(),t):void 0}},g.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var A,kt,I=w.expr.attrHandle,Tt=/^(?:checked|selected)$/i,M=g.getSetAttribute,Ft=g.input,Et=(w.fn.extend({attr:function(e,t){return l(this,w.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,o){var i,n,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute==b?w.prop(e,t,o):(1===r&&w.isXMLDoc(e)||(t=t.toLowerCase(),i=w.attrHooks[t]||(w.expr.match.bool.test(t)?kt:A)),void 0===o?i&&"get"in i&&null!==(n=i.get(e,t))?n:null==(n=w.find.attr(e,t))?void 0:n:null!==o?i&&"set"in i&&void 0!==(n=i.set(e,o,t))?n:(e.setAttribute(t,o+""),o):void w.removeAttr(e,t))},removeAttr:function(e,t){var o,i,n=0,r=t&&t.match(x);if(r&&1===e.nodeType)for(;o=r[n++];)i=w.propFix[o]||o,w.expr.match.bool.test(o)?Ft&&M||!Tt.test(o)?e[i]=!1:e[w.camelCase("default-"+o)]=e[i]=!1:w.attr(e,o,""),e.removeAttribute(M?o:i)},attrHooks:{type:{set:function(e,t){var o;if(!g.radioValue&&"radio"===t&&w.nodeName(e,"input"))return o=e.value,e.setAttribute("type",t),o&&(e.value=o),t}}}}),kt={set:function(e,t,o){return!1===t?w.removeAttr(e,o):Ft&&M||!Tt.test(o)?e.setAttribute(!M&&w.propFix[o]||o,o):e[w.camelCase("default-"+o)]=e[o]=!0,o}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var r=I[t]||w.find.attr;I[t]=Ft&&M||!Tt.test(t)?function(e,t,o){var i,n;return o||(n=I[t],I[t]=i,i=null!=r(e,t,o)?t.toLowerCase():null,I[t]=n),i}:function(e,t,o){return o?void 0:e[w.camelCase("default-"+t)]?t.toLowerCase():null}}),Ft&&M||(w.attrHooks.value={set:function(e,t,o){return w.nodeName(e,"input")?void(e.defaultValue=t):A&&A.set(e,t,o)}}),M||(A={set:function(e,t,o){var i=e.getAttributeNode(o);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(o)),i.value=t+="","value"===o||t===e.getAttribute(o)?t:void 0}},I.id=I.name=I.coords=function(e,t,o){return o?void 0:(o=e.getAttributeNode(t))&&""!==o.value?o.value:null},w.valHooks.button={get:function(e,t){e=e.getAttributeNode(t);return e&&e.specified?e.value:void 0},set:A.set},w.attrHooks.contenteditable={set:function(e,t,o){A.set(e,""!==t&&t,o)}},w.each(["width","height"],function(e,o){w.attrHooks[o]={set:function(e,t){return""===t?(e.setAttribute(o,"auto"),t):void 0}}})),g.style||(w.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}}),/^(?:input|select|textarea|button|object)$/i),Dt=/^(?:a|area)$/i,Pt=(w.fn.extend({prop:function(e,t){return l(this,w.prop,e,t,1<arguments.length)},removeProp:function(e){return e=w.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),w.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,o){var i,n,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return(1!==r||!w.isXMLDoc(e))&&(t=w.propFix[t]||t,n=w.propHooks[t]),void 0!==o?n&&"set"in n&&void 0!==(i=n.set(e,o,t))?i:e[t]=o:n&&"get"in n&&null!==(i=n.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):Et.test(e.nodeName)||Dt.test(e.nodeName)&&e.href?0:-1}}}}),g.hrefNormalized||w.each(["href","src"],function(e,t){w.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),g.optSelected||(w.propHooks.selected={get:function(e){e=e.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),g.enctype||(w.propFix.enctype="encoding"),/[\t\r\n\f]/g),At=(w.fn.extend({addClass:function(t){var e,o,i,n,r,s,a=0,l=this.length,c="string"==typeof t&&t;if(w.isFunction(t))return this.each(function(e){w(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(x)||[];a<l;a++)if(i=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(Pt," "):" ")){for(r=0;n=e[r++];)i.indexOf(" "+n+" ")<0&&(i+=n+" ");s=w.trim(i),o.className!==s&&(o.className=s)}return this},removeClass:function(t){var e,o,i,n,r,s,a=0,l=this.length,c=0===arguments.length||"string"==typeof t&&t;if(w.isFunction(t))return this.each(function(e){w(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(x)||[];a<l;a++)if(i=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(Pt," "):"")){for(r=0;n=e[r++];)for(;0<=i.indexOf(" "+n+" ");)i=i.replace(" "+n+" "," ");s=t?w.trim(i):"",o.className!==s&&(o.className=s)}return this},toggleClass:function(n,t){var r=typeof n;return"boolean"==typeof t&&"string"==r?t?this.addClass(n):this.removeClass(n):this.each(w.isFunction(n)?function(e){w(this).toggleClass(n.call(this,e,this.className,t),t)}:function(){if("string"==r)for(var e,t=0,o=w(this),i=n.match(x)||[];e=i[t++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else r!=b&&"boolean"!=r||(this.className&&w._data(this,"__className__",this.className),this.className=!this.className&&!1!==n&&w._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",o=0,i=this.length;o<i;o++)if(1===this[o].nodeType&&0<=(" "+this[o].className+" ").replace(Pt," ").indexOf(t))return!0;return!1}}),w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,o){w.fn[o]=function(e,t){return 0<arguments.length?this.on(o,null,e,t):this.trigger(o)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,o){return this.on(e,null,t,o)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,o,i){return this.on(t,e,o,i)},undelegate:function(e,t,o){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",o)}}),w.now()),It=/\?/,Mt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;w.parseJSON=function(e){if(f.JSON&&f.JSON.parse)return f.JSON.parse(e+"");var n,r=null,t=w.trim(e+"");return t&&!w.trim(t.replace(Mt,function(e,t,o,i){return 0===(r=n&&t?0:r)?e:(n=o||t,r+=!i-!o,"")}))?Function("return "+t)():w.error("Invalid JSON: "+e)},w.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{f.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),t};var R,N,Rt=/#.*$/,Nt=/([?&])_=[^&]*/,Lt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ot=/^(?:GET|HEAD)$/,zt=/^\/\//,Ht=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Bt={},Ut={},jt="*/".concat("*");try{N=location.href}catch(e){(N=v.createElement("a")).href="",N=N.href}function Vt(r){return function(e,t){"string"!=typeof e&&(t=e,e="*");var o,i=0,n=e.toLowerCase().match(x)||[];if(w.isFunction(t))for(;o=n[i++];)"+"===o.charAt(0)?(o=o.slice(1)||"*",(r[o]=r[o]||[]).unshift(t)):(r[o]=r[o]||[]).push(t)}}function Wt(t,i,n,r){var s={},a=t===Ut;function l(e){var o;return s[e]=!0,w.each(t[e]||[],function(e,t){t=t(i,n,r);return"string"!=typeof t||a||s[t]?a?!(o=t):void 0:(i.dataTypes.unshift(t),l(t),!1)}),o}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var o,i,n=w.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:o=o||{})[i]=t[i]);return o&&w.extend(!0,e,o),e}R=Ht.exec(N.toLowerCase())||[],w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:N,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(R[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":jt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,w.ajaxSettings),t):Gt(w.ajaxSettings,e)},ajaxPrefilter:Vt(Bt),ajaxTransport:Vt(Ut),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0);var o,l,c,u,d,h,i,p=w.ajaxSetup({},t=t||{}),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?w(f):w.event,g=w.Deferred(),v=w.Callbacks("once memory"),b=p.statusCode||{},n={},r={},y=0,s="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!i)for(i={};t=Lt.exec(c);)i[t[1].toLowerCase()]=t[2];t=i[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?c:null},setRequestHeader:function(e,t){var o=e.toLowerCase();return y||(e=r[o]=r[o]||e,n[e]=t),this},overrideMimeType:function(e){return y||(p.mimeType=e),this},statusCode:function(e){if(e)if(y<2)for(var t in e)b[t]=[b[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){e=e||s;return h&&h.abort(e),a(0,e),this}};if(g.promise(C).complete=v.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||N)+"").replace(Rt,"").replace(zt,R[1]+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=w.trim(p.dataType||"*").toLowerCase().match(x)||[""],null==p.crossDomain&&(e=Ht.exec(p.url.toLowerCase()),p.crossDomain=!(!e||e[1]===R[1]&&e[2]===R[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(R[3]||("http:"===R[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=w.param(p.data,p.traditional)),Wt(Bt,p,t,C),2===y)return C;for(o in(d=p.global)&&0==w.active++&&w.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ot.test(p.type),l=p.url,p.hasContent||(p.data&&(l=p.url+=(It.test(l)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=Nt.test(l)?l.replace(Nt,"$1_="+At++):l+(It.test(l)?"&":"?")+"_="+At++)),p.ifModified&&(w.lastModified[l]&&C.setRequestHeader("If-Modified-Since",w.lastModified[l]),w.etag[l]&&C.setRequestHeader("If-None-Match",w.etag[l])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+jt+"; q=0.01":""):p.accepts["*"]),p.headers)C.setRequestHeader(o,p.headers[o]);if(p.beforeSend&&(!1===p.beforeSend.call(f,C,p)||2===y))return C.abort();for(o in s="abort",{success:1,error:1,complete:1})C[o](p[o]);if(h=Wt(Ut,p,t,C)){C.readyState=1,d&&m.trigger("ajaxSend",[C,p]),p.async&&0<p.timeout&&(u=setTimeout(function(){C.abort("timeout")},p.timeout));try{y=1,h.send(n,a)}catch(e){if(!(y<2))throw e;a(-1,e)}}else a(-1,"No Transport");function a(e,t,o,i){var n,r,s,a=t;2!==y&&(y=2,u&&clearTimeout(u),h=void 0,c=i||"",C.readyState=0<e?4:0,i=200<=e&&e<300||304===e,o&&(s=function(e,t,o){for(var i,n,r,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){l.unshift(s);break}if(l[0]in o)r=l[0];else{for(s in o){if(!l[0]||e.converters[s+" "+l[0]]){r=s;break}i=i||s}r=r||i}return r?(r!==l[0]&&l.unshift(r),o[r]):void 0}(p,C,o)),s=function(e,t,o,i){var n,r,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(r=u.shift();r;)if(e.responseFields[r]&&(o[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(n in c)if(a=n.split(" "),a[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[n]:!0!==c[n]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(p,s,C,i),i?(p.ifModified&&((o=C.getResponseHeader("Last-Modified"))&&(w.lastModified[l]=o),(o=C.getResponseHeader("etag"))&&(w.etag[l]=o)),204===e||"HEAD"===p.type?a="nocontent":304===e?a="notmodified":(a=s.state,n=s.data,i=!(r=s.error))):(r=a,!e&&a||(a="error",e<0&&(e=0))),C.status=e,C.statusText=(t||a)+"",i?g.resolveWith(f,[n,a,C]):g.rejectWith(f,[C,a,r]),C.statusCode(b),b=void 0,d&&m.trigger(i?"ajaxSuccess":"ajaxError",[C,p,i?n:r]),v.fireWith(f,[C,a]),d&&(m.trigger("ajaxComplete",[C,p]),--w.active||w.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,o){return w.get(e,t,o,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,t,o,i){return w.isFunction(t)&&(i=i||o,o=t,t=void 0),w.ajax({url:e,type:n,dataType:i,data:t,success:o})}}),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},w.fn.extend({wrapAll:function(t){return w.isFunction(t)?this.each(function(e){w(this).wrapAll(t.call(this,e))}):(this[0]&&(e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)),this);var e},wrapInner:function(o){return this.each(w.isFunction(o)?function(e){w(this).wrapInner(o.call(this,e))}:function(){var e=w(this),t=e.contents();t.length?t.wrapAll(o):e.append(o)})},wrap:function(t){var o=w.isFunction(t);return this.each(function(e){w(this).wrapAll(o?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}}),w.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!g.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||w.css(e,"display"))},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)};var $t=/%20/g,Yt=/\[\]$/,Kt=/\r?\n/g,qt=/^(?:submit|button|image|reset|file)$/i,Xt=/^(?:input|select|textarea|keygen)/i;w.param=function(e,t){function o(e,t){t=w.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var i,n=[];if(void 0===t&&(t=w.ajaxSettings&&w.ajaxSettings.traditional),w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){o(this.name,this.value)});else for(i in e)!function o(i,e,n,r){if(w.isArray(e))w.each(e,function(e,t){n||Yt.test(i)?r(i,t):o(i+"["+("object"==typeof t?e:"")+"]",t,n,r)});else if(n||"object"!==w.type(e))r(i,e);else for(var t in e)o(i+"["+t+"]",e[t],n,r)}(i,e[i],t,o);return n.join("&").replace($t,"+")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&Xt.test(this.nodeName)&&!qt.test(e)&&(this.checked||!ue.test(e))}).map(function(e,t){var o=w(this).val();return null==o?null:w.isArray(o)?w.map(o,function(e){return{name:t.name,value:e.replace(Kt,"\r\n")}}):{name:t.name,value:o.replace(Kt,"\r\n")}}).get()}}),w.ajaxSettings.xhr=void 0!==f.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Qt()||function(){try{return new f.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:Qt;var Jt=0,Zt={},r=w.ajaxSettings.xhr();function Qt(){try{return new f.XMLHttpRequest}catch(e){}}f.ActiveXObject&&w(f).on("unload",function(){for(var e in Zt)Zt[e](void 0,!0)}),g.cors=!!r&&"withCredentials"in r,(r=g.ajax=!!r)&&w.ajaxTransport(function(l){var c;if(!l.crossDomain||g.cors)return{send:function(e,r){var t,s=l.xhr(),a=++Jt;if(s.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)s[t]=l.xhrFields[t];for(t in l.mimeType&&s.overrideMimeType&&s.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)void 0!==e[t]&&s.setRequestHeader(t,e[t]+"");s.send(l.hasContent&&l.data||null),c=function(e,t){var o,i,n;if(c&&(t||4===s.readyState))if(delete Zt[a],c=void 0,s.onreadystatechange=w.noop,t)4!==s.readyState&&s.abort();else{n={},o=s.status,"string"==typeof s.responseText&&(n.text=s.responseText);try{i=s.statusText}catch(e){i=""}o||!l.isLocal||l.crossDomain?1223===o&&(o=204):o=n.text?200:404}n&&r(o,i,n,s.getAllResponseHeaders())},l.async?4===s.readyState?setTimeout(c):s.onreadystatechange=Zt[a]=c:c()},abort:function(){c&&c(void 0,!0)}}}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),w.ajaxTransport("script",function(t){var i,n;if(t.crossDomain)return n=v.head||w("head")[0]||v.documentElement,{send:function(e,o){(i=v.createElement("script")).async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||o(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(void 0,!0)}}});var eo=[],to=/(=)\?(?=&|$)|\?\?/,oo=(w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=eo.pop()||w.expando+"_"+At++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(e,t,o){var i,n,r,s=!1!==e.jsonp&&(to.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&to.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(i=e.jsonpCallback=w.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(to,"$1"+i):!1!==e.jsonp&&(e.url+=(It.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return r||w.error(i+" was not called"),r[0]},e.dataTypes[0]="json",n=f[i],f[i]=function(){r=arguments},o.always(function(){f[i]=n,e[i]&&(e.jsonpCallback=t.jsonpCallback,eo.push(i)),r&&w.isFunction(n)&&n(r[0]),r=n=void 0}),"script"):void 0}),w.parseHTML=function(e,t,o){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(o=t,t=!1),t=t||v;var i=K.exec(e),o=!o&&[];return i?[t.createElement(i[1])]:(i=w.buildFragment([e],t,o),o&&o.length&&w(o).remove(),w.merge([],i.childNodes))},w.fn.load),io=(w.fn.load=function(e,t,o){if("string"!=typeof e&&oo)return oo.apply(this,arguments);var i,n,r,s=this,a=e.indexOf(" ");return 0<=a&&(i=e.slice(a,e.length),e=e.slice(0,a)),w.isFunction(t)?(o=t,t=void 0):t&&"object"==typeof t&&(r="POST"),0<s.length&&w.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){n=arguments,s.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).complete(o&&function(e,t){s.each(o,n||[e.responseText,t,e])}),this},w.expr.filters.animated=function(t){return w.grep(w.timers,function(e){return t===e.elem}).length},f.document.documentElement);function no(e){return w.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}w.offset={setOffset:function(e,t,o){var i,n,r,s,a=w.css(e,"position"),l=w(e),c={};"static"===a&&(e.style.position="relative"),r=l.offset(),i=w.css(e,"top"),s=w.css(e,"left"),a=("absolute"===a||"fixed"===a)&&-1<w.inArray("auto",[i,s])?(n=(a=l.position()).top,a.left):(n=parseFloat(i)||0,parseFloat(s)||0),null!=(t=w.isFunction(t)?t.call(e,o,r):t).top&&(c.top=t.top-r.top+n),null!=t.left&&(c.left=t.left-r.left+a),"using"in t?t.using.call(e,c):l.css(c)}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){w.offset.setOffset(this,t,e)});var e,o={top:0,left:0},i=this[0],n=i&&i.ownerDocument;return n?(e=n.documentElement,w.contains(e,i)?(typeof i.getBoundingClientRect!=b&&(o=i.getBoundingClientRect()),i=no(n),{top:o.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:o.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):o):void 0},position:function(){var e,t,o,i;if(this[0])return o={top:0,left:0},i=this[0],"fixed"===w.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),(o=w.nodeName(e[0],"html")?o:e.offset()).top+=w.css(e[0],"borderTopWidth",!0),o.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-o.top-w.css(i,"marginTop",!0),left:t.left-o.left-w.css(i,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||io;e&&!w.nodeName(e,"html")&&"static"===w.css(e,"position");)e=e.offsetParent;return e||io})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r=/Y/.test(n);w.fn[t]=function(e){return l(this,function(e,t,o){var i=no(e);return void 0===o?i?n in i?i[n]:i.document.documentElement[t]:e[t]:void(i?i.scrollTo(r?w(i).scrollLeft():o,r?o:w(i).scrollTop()):e[t]=o)},t,e,arguments.length,null)}}),w.each(["top","left"],function(e,o){w.cssHooks[o]=et(g.pixelPosition,function(e,t){return t?(t=T(e,o),Ze.test(t)?w(e).position()[o]+"px":t):void 0})}),w.each({Height:"height",Width:"width"},function(r,s){w.each({padding:"inner"+r,content:s,"":"outer"+r},function(i,e){w.fn[e]=function(e,t){var o=arguments.length&&(i||"boolean"!=typeof e),n=i||(!0===e||!0===t?"margin":"border");return l(this,function(e,t,o){var i;return w.isWindow(e)?e.document.documentElement["client"+r]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+r],i["scroll"+r],e.body["offset"+r],i["offset"+r],i["client"+r])):void 0===o?w.css(e,t,n):w.style(e,t,o,n)},s,o?e:void 0,o,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var ro=f.jQuery,so=f.$;return w.noConflict=function(e){return f.$===w&&(f.$=so),e&&f.jQuery===w&&(f.jQuery=ro),w},typeof L==b&&(f.jQuery=f.$=w),w}),function(){var e=function(r){var s,a=!1;return r(function(){var e=(document.body||document.documentElement).style;return a=void 0!==e.animation||void 0!==e.WebkitAnimation||void 0!==e.MozAnimation||void 0!==e.MsAnimation||void 0!==e.OAnimation,r(window).bind("keyup.vex",function(e){return 27===e.keyCode?s.closeByEscape():void 0})}),s={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(e){return(e=r.extend({},s.defaultOptions,e)).id=s.globalID,s.globalID+=1,e.$vex=r("<div>").addClass(s.baseClassNames.vex).addClass(e.className).css(e.css).data({vex:e}),e.$vexOverlay=r("<div>").addClass(s.baseClassNames.overlay).addClass(e.overlayClassName).css(e.overlayCSS).data({vex:e}),e.overlayClosesOnClick&&e.$vexOverlay.bind("click.vex",function(e){return e.target===this?s.close(r(this).data().vex.id):void 0}),e.$vex.append(e.$vexOverlay),e.$vexContent=r("<div>").addClass(s.baseClassNames.content).addClass(e.contentClassName).css(e.contentCSS).append(e.content).data({vex:e}),e.$vex.append(e.$vexContent),e.showCloseButton&&(e.$closeButton=r("<div>").addClass(s.baseClassNames.close).addClass(e.closeClassName).css(e.closeCSS).data({vex:e}).bind("click.vex",function(){return s.close(r(this).data().vex.id)}),e.$vexContent.append(e.$closeButton)),r(e.appendLocation).append(e.$vex),s.setupBodyClassName(e.$vex),e.afterOpen&&e.afterOpen(e.$vexContent,e),setTimeout(function(){return e.$vexContent.trigger("vexOpen",e)},0),e.$vexContent},getAllVexes:function(){return r("."+s.baseClassNames.vex+':not(".'+s.baseClassNames.closing+'") .'+s.baseClassNames.content)},getVexByID:function(e){return s.getAllVexes().filter(function(){return r(this).data().vex.id===e})},close:function(e){var t;if(!e){if(!(t=s.getAllVexes().last()).length)return!1;e=t.data().vex.id}return s.closeByID(e)},closeAll:function(){var e=s.getAllVexes().map(function(){return r(this).data().vex.id}).toArray();return!(null==e||!e.length)&&(r.each(e.reverse(),function(e,t){return s.closeByID(t)}),!0)},closeByID:function(e){var t,o,i,n=s.getVexByID(e);return n.length?(t=n.data().vex.$vex,i=r.extend({},n.data().vex),e=function(){return i.beforeClose?i.beforeClose(n,i):void 0},o=function(){return n.trigger("vexClose",i),t.remove(),i.afterClose?i.afterClose(n,i):void 0},a?(e(),t.unbind(s.animationEndEvent).bind(s.animationEndEvent,o).addClass(s.baseClassNames.closing)):(e(),o()),!0):void 0},closeByEscape:function(){var e=s.getAllVexes().map(function(){return r(this).data().vex.id}).toArray();return!(null==e||!e.length)&&(e=Math.max.apply(Math,e),!0===s.getVexByID(e).data().vex.escapeButtonCloses&&s.closeByID(e))},setupBodyClassName:function(e){return e.bind("vexOpen.vex",function(){return r("body").addClass(s.baseClassNames.open)}).bind("vexClose.vex",function(){return s.getAllVexes().length?void 0:r("body").removeClass(s.baseClassNames.open)})},hideLoading:function(){return r(".vex-loading-spinner").remove()},showLoading:function(){return s.hideLoading(),r("body").append('<div class="vex-loading-spinner '+s.defaultOptions.className+'"></div>')}}};"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):window.vex=e(jQuery)}.call(this),function(){var e=function(n,r){var i,s;return null==r?n.error("Vex is required to use vex.dialog"):(i=function(e){var t={};return n.each(e.serializeArray(),function(){return t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},(s={}).buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e){return e.data().vex.value=!1,r.close(e.data().vex.id)}}},s.defaultOptions={callback:function(){},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[s.buttons.YES,s.buttons.NO],showCloseButton:!1,onSubmit:function(e){var t=n(this),o=t.parent();return e.preventDefault(),e.stopPropagation(),o.data().vex.value=s.getFormValueOnSubmit(i(t)),r.close(o.data().vex.id)},focusFirstInput:!0},s.defaultAlertOptions={message:"Alert",buttons:[s.buttons.YES]},s.defaultConfirmOptions={message:"Confirm"},s.open=function(t){var e;return(t=n.extend({},r.defaultOptions,s.defaultOptions,t)).content=s.buildDialogForm(t),t.beforeClose=function(e){return t.callback(e.data().vex.value)},e=r.open(t),t.focusFirstInput&&e.find('input[type="submit"], textarea, input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="email"], input[type="month"], input[type="number"], input[type="password"], input[type="search"], input[type="tel"], input[type="text"], input[type="time"], input[type="url"], input[type="week"]').first().focus(),e},s.alert=function(e){return e=n.extend({},s.defaultAlertOptions,e="string"==typeof e?{message:e}:e),s.open(e)},s.confirm=function(e){return"string"==typeof e?n.error("dialog.confirm(options) requires options.callback."):(e=n.extend({},s.defaultConfirmOptions,e),s.open(e))},s.prompt=function(e){var t;return"string"==typeof e?n.error("dialog.prompt(options) requires options.callback."):(t={message:'<label for="vex">'+(e.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(e.placeholder||"")+'"  value="'+(e.value||"")+'" />'},e=n.extend({},t,e),s.open(e))},s.buildDialogForm=function(e){var t=n('<form class="vex-dialog-form" />'),o=n('<div class="vex-dialog-message" />'),i=n('<div class="vex-dialog-input" />');return t.append(o.append(e.message)).append(i.append(e.input)).append(s.buttonsToDOM(e.buttons)).bind("submit.vex",e.onSubmit),t},s.getFormValueOnSubmit=function(e){return e.vex||""===e.vex?"_vex-empty-value"===e.vex||e.vex:e},s.buttonsToDOM=function(o){var i=n('<div class="vex-dialog-buttons" />');return n.each(o,function(e,t){return i.append(n('<input type="'+t.type+'" />').val(t.text).addClass(t.className+" vex-dialog-button "+(0===e?"vex-first ":"")+(e===o.length-1?"vex-last ":"")).bind("click.vex",function(e){return t.click?t.click(n(this).parents("."+r.baseClassNames.content),e):void 0}))}),i},s)};"function"==typeof define&&define.amd?define(["jquery","vex"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("vex")):window.vex.dialog=e(window.jQuery,window.vex)}.call(this),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(x){function i(e,t){var o,i,n=e.nodeName.toLowerCase();return"area"===n?(o=(i=e.parentNode).name,!(!e.href||!o||"map"!==i.nodeName.toLowerCase())&&(!!(i=x("img[usemap='#"+o+"']")[0])&&r(i))):(/^(input|select|textarea|button|object)$/.test(n)?!e.disabled:"a"===n&&e.href||t)&&r(e)}function r(e){return x.expr.filters.visible(e)&&!x(e).parents().addBack().filter(function(){return"hidden"===x.css(this,"visibility")}).length}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},x.extend(this._defaults,this.regional[""]),this.regional.en=x.extend(!0,{},this.regional[""]),this.regional["en-US"]=x.extend(!0,{},this.regional.en),this.dpDiv=o(x("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function o(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){x(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",s)}function s(){x.datepicker._isDisabledDatepicker((R.inline?R.dpDiv.parent():R.input)[0])||(x(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),x(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).addClass("ui-datepicker-next-hover"))}function l(e,t){for(var o in x.extend(e,t),t)null==t[o]&&(e[o]=t[o])}function t(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}x.ui=x.ui||{},x.extend(x.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),x.fn.extend({scrollParent:function(e){var t=this.css("position"),o="absolute"===t,i=e?/(auto|scroll|hidden)/:/(auto|scroll)/,e=this.parents().filter(function(){var e=x(this);return(!o||"static"!==e.css("position"))&&i.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&e.length?e:x(this[0].ownerDocument||document)},uniqueId:(u=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++u)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&x(this).removeAttr("id")})}}),x.extend(x.expr[":"],{data:x.expr.createPseudo?x.expr.createPseudo(function(t){return function(e){return!!x.data(e,t)}}):function(e,t,o){return!!x.data(e,o[3])},focusable:function(e){return i(e,!isNaN(x.attr(e,"tabindex")))},tabbable:function(e){var t=x.attr(e,"tabindex"),o=isNaN(t);return(o||0<=t)&&i(e,!o)}}),x("<a>").outerWidth(1).jquery||x.each(["Width","Height"],function(e,o){function i(e,t,o,i){return x.each(n,function(){t-=parseFloat(x.css(e,"padding"+this))||0,o&&(t-=parseFloat(x.css(e,"border"+this+"Width"))||0),i&&(t-=parseFloat(x.css(e,"margin"+this))||0)}),t}var n="Width"===o?["Left","Right"]:["Top","Bottom"],r=o.toLowerCase(),s={innerWidth:x.fn.innerWidth,innerHeight:x.fn.innerHeight,outerWidth:x.fn.outerWidth,outerHeight:x.fn.outerHeight};x.fn["inner"+o]=function(e){return void 0===e?s["inner"+o].call(this):this.each(function(){x(this).css(r,i(this,e)+"px")})},x.fn["outer"+o]=function(e,t){return"number"!=typeof e?s["outer"+o].call(this,e):this.each(function(){x(this).css(r,i(this,e,!0,t)+"px")})}}),x.fn.addBack||(x.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),x("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(x.fn.removeData=(c=x.fn.removeData,function(e){return arguments.length?c.call(this,x.camelCase(e)):c.call(this)})),x.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),x.fn.extend({focus:(a=x.fn.focus,function(t,o){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){x(e).focus(),o&&o.call(e)},t)}):a.apply(this,arguments)}),disableSelection:(n="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(n+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,o=x(this[0]);o.length&&o[0]!==document;){if(("absolute"===(t=o.css("position"))||"relative"===t||"fixed"===t)&&(t=parseInt(o.css("zIndex"),10),!isNaN(t)&&0!==t))return t;o=o.parent()}return 0}}),x.ui.plugin={add:function(e,t,o){var i,n=x.ui[e].prototype;for(i in o)n.plugins[i]=n.plugins[i]||[],n.plugins[i].push([t,o[i]])},call:function(e,t,o,i){var n,r=e.plugins[t];if(r&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;r.length>n;n++)e.options[r[n][0]]&&r[n][1].apply(e.element,o)}};var n,a,c,u,d,L=0,h=Array.prototype.slice,p=(x.cleanData=(d=x.cleanData,function(e){for(var t,o,i=0;null!=(o=e[i]);i++)try{(t=x._data(o,"events"))&&t.remove&&x(o).triggerHandler("remove")}catch(e){}d(e)}),x.widget=function(e,o,t){var i,n,r,s,a={},l=e.split(".")[0];return e=e.split(".")[1],i=l+"-"+e,t||(t=o,o=x.Widget),x.expr[":"][i.toLowerCase()]=function(e){return!!x.data(e,i)},x[l]=x[l]||{},n=x[l][e],r=x[l][e]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},x.extend(r,n,{version:t.version,_proto:x.extend({},t),_childConstructors:[]}),(s=new o).options=x.widget.extend({},s.options),x.each(t,function(t,i){return x.isFunction(i)?void(a[t]=function(){var e,t=this._super,o=this._superApply;return this._super=n,this._superApply=r,e=i.apply(this,arguments),this._super=t,this._superApply=o,e}):void(a[t]=i);function n(){return o.prototype[t].apply(this,arguments)}function r(e){return o.prototype[t].apply(this,e)}}),r.prototype=x.widget.extend(s,{widgetEventPrefix:n&&s.widgetEventPrefix||e},a,{constructor:r,namespace:l,widgetName:e,widgetFullName:i}),n?(x.each(n._childConstructors,function(e,t){var o=t.prototype;x.widget(o.namespace+"."+o.widgetName,r,t._proto)}),delete n._childConstructors):o._childConstructors.push(r),x.widget.bridge(e,r),r},x.widget.extend=function(e){for(var t,o,i=h.call(arguments,1),n=0,r=i.length;n<r;n++)for(t in i[n])o=i[n][t],i[n].hasOwnProperty(t)&&void 0!==o&&(e[t]=x.isPlainObject(o)?x.isPlainObject(e[t])?x.widget.extend({},e[t],o):x.widget.extend({},o):o);return e},x.widget.bridge=function(r,t){var s=t.prototype.widgetFullName||r;x.fn[r]=function(o){var e="string"==typeof o,i=h.call(arguments,1),n=this;return e?this.each(function(){var e,t=x.data(this,s);return"instance"===o?(n=t,!1):t?x.isFunction(t[o])&&"_"!==o.charAt(0)?(e=t[o].apply(t,i))!==t&&void 0!==e?(n=e&&e.jquery?n.pushStack(e.get()):e,!1):void 0:x.error("no such method '"+o+"' for "+r+" widget instance"):x.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+o+"'")}):(i.length&&(o=x.widget.extend.apply(null,[o].concat(i))),this.each(function(){var e=x.data(this,s);e?(e.option(o||{}),e._init&&e._init()):x.data(this,s,new t(o,this))})),n}},x.Widget=function(){},x.Widget._childConstructors=[],x.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=x(t||this.defaultElement||this)[0],this.element=x(t),this.uuid=L++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=x(),this.hoverable=x(),this.focusable=x(),t!==this&&(x.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=x(t.style?t.ownerDocument:t.document||t),this.window=x(this.document[0].defaultView||this.document[0].parentWindow)),this.options=x.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:x.noop,_getCreateEventData:x.noop,_create:x.noop,_init:x.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(x.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:x.noop,widget:function(){return this.element},option:function(e,t){var o,i,n,r=e;if(0===arguments.length)return x.widget.extend({},this.options);if("string"==typeof e)if(r={},e=(o=e.split(".")).shift(),o.length){for(i=r[e]=x.widget.extend({},this.options[e]),n=0;o.length-1>n;n++)i[o[n]]=i[o[n]]||{},i=i[o[n]];if(e=o.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=t}return this._setOptions(r),this},_setOptions:function(e){for(var t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(n,r,e){var s,a=this;"boolean"!=typeof n&&(e=r,r=n,n=!1),e?(r=s=x(r),this.bindings=this.bindings.add(r)):(e=r,r=this.element,s=this.widget()),x.each(e,function(e,t){function o(){return n||!0!==a.options.disabled&&!x(this).hasClass("ui-state-disabled")?("string"==typeof t?a[t]:t).apply(a,arguments):void 0}"string"!=typeof t&&(o.guid=t.guid=t.guid||o.guid||x.guid++);var e=e.match(/^([\w:-]*)\s*(.*)$/),i=e[1]+a.eventNamespace,e=e[2];e?s.delegate(e,i,o):r.bind(i,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=x(this.bindings.not(e).get()),this.focusable=x(this.focusable.not(e).get()),this.hoverable=x(this.hoverable.not(e).get())},_delay:function(e,t){var o=this;return setTimeout(function(){return("string"==typeof e?o[e]:e).apply(o,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){x(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){x(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){x(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){x(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,o){var i,n,r=this.options[e];if(o=o||{},(t=x.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],n=t.originalEvent)for(i in n)i in t||(t[i]=n[i]);return this.element.trigger(t,o),!(x.isFunction(r)&&!1===r.apply(this.element[0],[t].concat(o))||t.isDefaultPrevented())}},x.each({show:"fadeIn",hide:"fadeOut"},function(r,s){x.Widget.prototype["_"+r]=function(t,e,o){var i=(e="string"==typeof e?{effect:e}:e)?!0!==e&&"number"!=typeof e&&e.effect||s:r,n=!x.isEmptyObject(e="number"==typeof(e=e||{})?{duration:e}:e);e.complete=o,e.delay&&t.delay(e.delay),n&&x.effects&&x.effects.effect[i]?t[r](e):i!==r&&t[i]?t[i](e.duration,e.easing,o):t.queue(function(e){x(this)[r](),o&&o.call(t[0]),e()})}}),x.widget,!1);function _(e,t,o){return[parseFloat(e[0])*(m.test(e[0])?t/100:1),parseFloat(e[1])*(m.test(e[1])?o/100:1)]}function S(e,t){return parseInt(x.css(e,t),10)||0}x(document).mouseup(function(){p=!1}),x.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){return!0===x.data(e.target,t.widgetName+".preventClickEvent")?(x.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){var t,o,i;if(!p)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),o=1===(this._mouseDownEvent=e).which,i=!("string"!=typeof(t=this).options.cancel||!e.target.nodeName)&&x(e.target).closest(this.options.cancel).length,o&&!i&&this._mouseCapture(e)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?e.preventDefault():(!0===x.data(e.target,this.widgetName+".preventClickEvent")&&x.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),p=!0)),!0},_mouseMove:function(e){if(this._mouseMoved){if(x.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&x.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),p=!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),x.ui=x.ui||{};var f,k,T=Math.max,F=Math.abs,E=Math.round,D=/left|center|right/,P=/top|center|bottom/,A=/[\+\-]\d+(\.[\d]+)?%?/,I=/^\w+/,m=/%$/,O=x.fn.position;x.position={scrollbarWidth:function(){if(void 0!==f)return f;var e,t=x("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=t.children()[0];return x("body").append(t),e=o.offsetWidth,t.css("overflow","scroll"),e===(o=o.offsetWidth)&&(o=t[0].clientWidth),t.remove(),f=e-o},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),o=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),t="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===o||"auto"===o&&e.height<e.element[0].scrollHeight?x.position.scrollbarWidth():0,height:t?x.position.scrollbarWidth():0}},getWithinInfo:function(e){var e=x(e||window),t=x.isWindow(e[0]),o=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:t,isDocument:o,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:t||o?e.width():e.outerWidth(),height:t||o?e.height():e.outerHeight()}}},x.fn.position=function(d){if(!d||!d.of)return O.apply(this,arguments);d=x.extend({},d);var h,p,f,m,g,e,v=x(d.of),b=x.position.getWithinInfo(d.within),y=x.position.getScrollInfo(b),C=(d.collision||"flip").split(" "),w={},t=9===(t=(e=v)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:x.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()};return v[0].preventDefault&&(d.at="left top"),p=t.width,f=t.height,g=x.extend({},m=t.offset),x.each(["my","at"],function(){var e,t,o=(d[this]||"").split(" ");(o=1===o.length?D.test(o[0])?o.concat(["center"]):P.test(o[0])?["center"].concat(o):["center","center"]:o)[0]=D.test(o[0])?o[0]:"center",o[1]=P.test(o[1])?o[1]:"center",e=A.exec(o[0]),t=A.exec(o[1]),w[this]=[e?e[0]:0,t?t[0]:0],d[this]=[I.exec(o[0])[0],I.exec(o[1])[0]]}),1===C.length&&(C[1]=C[0]),"right"===d.at[0]?g.left+=p:"center"===d.at[0]&&(g.left+=p/2),"bottom"===d.at[1]?g.top+=f:"center"===d.at[1]&&(g.top+=f/2),h=_(w.at,p,f),g.left+=h[0],g.top+=h[1],this.each(function(){var o,e,s=x(this),a=s.outerWidth(),l=s.outerHeight(),t=S(this,"marginLeft"),i=S(this,"marginTop"),n=a+t+S(this,"marginRight")+y.width,r=l+i+S(this,"marginBottom")+y.height,c=x.extend({},g),u=_(w.my,s.outerWidth(),s.outerHeight());"right"===d.my[0]?c.left-=a:"center"===d.my[0]&&(c.left-=a/2),"bottom"===d.my[1]?c.top-=l:"center"===d.my[1]&&(c.top-=l/2),c.left+=u[0],c.top+=u[1],k||(c.left=E(c.left),c.top=E(c.top)),o={marginLeft:t,marginTop:i},x.each(["left","top"],function(e,t){x.ui.position[C[e]]&&x.ui.position[C[e]][t](c,{targetWidth:p,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:o,collisionWidth:n,collisionHeight:r,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:b,elem:s})}),d.using&&(e=function(e){var t=m.left-c.left,o=t+p-a,i=m.top-c.top,n=i+f-l,r={target:{element:v,left:m.left,top:m.top,width:p,height:f},element:{element:s,left:c.left,top:c.top,width:a,height:l},horizontal:o<0?"left":0<t?"right":"center",vertical:n<0?"top":0<i?"bottom":"middle"};p<a&&p>F(t+o)&&(r.horizontal="center"),f<l&&f>F(i+n)&&(r.vertical="middle"),r.important=T(F(t),F(o))>T(F(i),F(n))?"horizontal":"vertical",d.using.call(this,e,r)}),s.offset(x.extend(c,{using:e}))})},x.ui.position={fit:{left:function(e,t){var o,i=t.within,n=i.isWindow?i.scrollLeft:i.offset.left,i=i.width,r=e.left-t.collisionPosition.marginLeft,s=n-r,a=r+t.collisionWidth-i-n;t.collisionWidth>i?0<s&&a<=0?(o=e.left+s+t.collisionWidth-i-n,e.left+=s-o):e.left=!(0<a&&s<=0)&&a<s?n+i-t.collisionWidth:n:0<s?e.left+=s:0<a?e.left-=a:e.left=T(e.left-r,e.left)},top:function(e,t){var o,i=t.within,i=i.isWindow?i.scrollTop:i.offset.top,n=t.within.height,r=e.top-t.collisionPosition.marginTop,s=i-r,a=r+t.collisionHeight-n-i;t.collisionHeight>n?0<s&&a<=0?(o=e.top+s+t.collisionHeight-n-i,e.top+=s-o):e.top=!(0<a&&s<=0)&&a<s?i+n-t.collisionHeight:i:0<s?e.top+=s:0<a?e.top-=a:e.top=T(e.top-r,e.top)}},flip:{left:function(e,t){var o=t.within,i=o.offset.left+o.scrollLeft,n=o.width,o=o.isWindow?o.scrollLeft:o.offset.left,r=e.left-t.collisionPosition.marginLeft,s=r-o,r=r+t.collisionWidth-n-o,a="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,l="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,c=-2*t.offset[0];s<0?((n=e.left+a+l+c+t.collisionWidth-n-i)<0||F(s)>n)&&(e.left+=a+l+c):0<r&&((0<(i=e.left-t.collisionPosition.marginLeft+a+l+c-o)||r>F(i))&&(e.left+=a+l+c))},top:function(e,t){var o=t.within,i=o.offset.top+o.scrollTop,n=o.height,o=o.isWindow?o.scrollTop:o.offset.top,r=e.top-t.collisionPosition.marginTop,s=r-o,r=r+t.collisionHeight-n-o,a="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,l="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,c=-2*t.offset[1];s<0?((n=e.top+a+l+c+t.collisionHeight-n-i)<0||F(s)>n)&&(e.top+=a+l+c):0<r&&((0<(i=e.top-t.collisionPosition.marginTop+a+l+c-o)||r>F(i))&&(e.top+=a+l+c))}},flipfit:{left:function(){x.ui.position.flip.left.apply(this,arguments),x.ui.position.fit.left.apply(this,arguments)},top:function(){x.ui.position.flip.top.apply(this,arguments),x.ui.position.fit.top.apply(this,arguments)}}};var g,v=document.getElementsByTagName("body")[0],b=document.createElement("div"),y=document.createElement(v?"div":"body"),C={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(g in v&&x.extend(C,{position:"absolute",left:"-1000px",top:"-1000px"}),C)y.style[g]=C[g];function w(e,t,o){return t<=e&&e<t+o}y.appendChild(b),(v=v||document.documentElement).insertBefore(y,v.firstChild),b.style.cssText="position: absolute; left: 10.7432222px;",b=x(b).offset().left,k=10<b&&b<11,y.innerHTML="",v.removeChild(y),x.ui.position,x.widget("ui.draggable",x.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||0<x(e.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=x(this);return x("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&x(t.activeElement).blur()}catch(e){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),x.ui.ddmanager&&(x.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===x(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),x.ui.ddmanager&&!t.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),x.ui.ddmanager&&x.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){t=this._uiHash();if(!1===this._trigger("drag",e,t))return this._mouseUp({}),!1;this.position=t.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",x.ui.ddmanager&&x.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,o=!1;return x.ui.ddmanager&&!this.options.dropBehaviour&&(o=x.ui.ddmanager.drop(this,e)),this.dropped&&(o=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!o||"valid"===this.options.revert&&o||!0===this.options.revert||x.isFunction(this.options.revert)&&this.options.revert.call(this.element,o)?x(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==t._trigger("stop",e)&&t._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),x.ui.ddmanager&&x.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),x.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!x(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,o=x.isFunction(t.helper),e=o?x(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),o&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),"left"in(e=x.isArray(e)?{left:+e[0],top:+e[1]||0}:e)&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),{top:(e=this._isRootNode(this.offsetParent[0])?{top:0,left:0}:e).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t=this.options,o=this.document[0];return this.relativeContainer=null,t.containment?"window"===t.containment?void(this.containment=[x(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,x(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,x(window).scrollLeft()+x(window).width()-this.helperProportions.width-this.margins.left,x(window).scrollTop()+(x(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===t.containment?void(this.containment=[0,0,x(o).width()-this.helperProportions.width-this.margins.left,(x(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):t.containment.constructor===Array?void(this.containment=t.containment):("parent"===t.containment&&(t.containment=this.helper[0].parentNode),void((t=(o=x(t.containment))[0])&&(e=/(scroll|auto)/.test(o.css("overflow")),this.containment=[(parseInt(o.css("borderLeftWidth"),10)||0)+(parseInt(o.css("paddingLeft"),10)||0),(parseInt(o.css("borderTopWidth"),10)||0)+(parseInt(o.css("paddingTop"),10)||0),(e?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(o.css("borderRightWidth"),10)||0)-(parseInt(o.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(o.css("borderBottomWidth"),10)||0)-(parseInt(o.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=o))):void(this.containment=null)},_convertPositionTo:function(e,t){t=t||this.position;var e="absolute"===e?1:-1,o=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top)*e,left:t.left+this.offset.relative.left*e+this.offset.parent.left*e-("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)*e}},_generatePosition:function(e,t){var o,i=this.options,n=this._isRootNode(this.scrollParent[0]),r=e.pageX,s=e.pageY;return n&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(o=this.relativeContainer?(t=this.relativeContainer.offset(),[this.containment[0]+t.left,this.containment[1]+t.top,this.containment[2]+t.left,this.containment[3]+t.top]):this.containment,e.pageX-this.offset.click.left<o[0]&&(r=o[0]+this.offset.click.left),e.pageY-this.offset.click.top<o[1]&&(s=o[1]+this.offset.click.top),e.pageX-this.offset.click.left>o[2]&&(r=o[2]+this.offset.click.left),e.pageY-this.offset.click.top>o[3]&&(s=o[3]+this.offset.click.top)),i.grid&&(t=i.grid[1]?this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1]:this.originalPageY,s=!o||t-this.offset.click.top>=o[1]||t-this.offset.click.top>o[3]?t:t-this.offset.click.top>=o[1]?t-i.grid[1]:t+i.grid[1],e=i.grid[0]?this.originalPageX+Math.round((r-this.originalPageX)/i.grid[0])*i.grid[0]:this.originalPageX,r=!o||e-this.offset.click.left>=o[0]||e-this.offset.click.left>o[2]?e:e-this.offset.click.left>=o[0]?e-i.grid[0]:e+i.grid[0]),"y"===i.axis&&(r=this.originalPageX),"x"===i.axis&&(s=this.originalPageY)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,o){return o=o||this._uiHash(),x.ui.plugin.call(this,e,[t,o,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),o.offset=this.positionAbs),x.Widget.prototype._trigger.call(this,e,t,o)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),x.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,o){var i=x.extend({},e,{item:o.element});o.sortables=[],x(o.options.connectToSortable).each(function(){var e=x(this).sortable("instance");e&&!e.options.disabled&&(o.sortables.push(e),e.refreshPositions(),e._trigger("activate",t,i))})},stop:function(t,e,o){var i=x.extend({},e,{item:o.element});o.cancelHelperRemoval=!1,x.each(o.sortables,function(){var e=this;e.isOver?(e.isOver=0,o.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,i))})},drag:function(o,i,n){x.each(n.sortables,function(){var e=!1,t=this;t.positionAbs=n.positionAbs,t.helperProportions=n.helperProportions,t.offset.click=n.offset.click,t._intersectsWith(t.containerCache)&&(e=!0,x.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,e=this!==t&&this._intersectsWith(this.containerCache)&&x.contains(t.element[0],this.element[0])?!1:e})),e?(t.isOver||(t.isOver=1,n._parent=i.helper.parent(),t.currentItem=i.helper.appendTo(t.element).data("ui-sortable-item",!0),t.options._helper=t.options.helper,t.options.helper=function(){return i.helper[0]},o.target=t.currentItem[0],t._mouseCapture(o,!0),t._mouseStart(o,!0,!0),t.offset.click.top=n.offset.click.top,t.offset.click.left=n.offset.click.left,t.offset.parent.left-=n.offset.parent.left-t.offset.parent.left,t.offset.parent.top-=n.offset.parent.top-t.offset.parent.top,n._trigger("toSortable",o),n.dropped=t.element,x.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,t.fromOutside=n),t.currentItem&&(t._mouseDrag(o),i.position=t.position)):t.isOver&&(t.isOver=0,t.cancelHelperRemoval=!0,t.options._revert=t.options.revert,t.options.revert=!1,t._trigger("out",o,t._uiHash(t)),t._mouseStop(o,!0),t.options.revert=t.options._revert,t.options.helper=t.options._helper,t.placeholder&&t.placeholder.remove(),i.helper.appendTo(n._parent),n._refreshOffsets(o),i.position=n._generatePosition(o,!0),n._trigger("fromSortable",o),n.dropped=!1,x.each(n.sortables,function(){this.refreshPositions()}))})}}),x.ui.plugin.add("draggable","cursor",{start:function(e,t,o){var i=x("body"),o=o.options;i.css("cursor")&&(o._cursor=i.css("cursor")),i.css("cursor",o.cursor)},stop:function(e,t,o){o=o.options;o._cursor&&x("body").css("cursor",o._cursor)}}),x.ui.plugin.add("draggable","opacity",{start:function(e,t,o){t=x(t.helper),o=o.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(e,t,o){o=o.options;o._opacity&&x(t.helper).css("opacity",o._opacity)}}),x.ui.plugin.add("draggable","scroll",{start:function(e,t,o){o.scrollParentNotHidden||(o.scrollParentNotHidden=o.helper.scrollParent(!1)),o.scrollParentNotHidden[0]!==o.document[0]&&"HTML"!==o.scrollParentNotHidden[0].tagName&&(o.overflowOffset=o.scrollParentNotHidden.offset())},drag:function(e,t,o){var i=o.options,n=!1,r=o.scrollParentNotHidden[0],s=o.document[0];r!==s&&"HTML"!==r.tagName?(i.axis&&"x"===i.axis||(o.overflowOffset.top+r.offsetHeight-e.pageY<i.scrollSensitivity?r.scrollTop=n=r.scrollTop+i.scrollSpeed:e.pageY-o.overflowOffset.top<i.scrollSensitivity&&(r.scrollTop=n=r.scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(o.overflowOffset.left+r.offsetWidth-e.pageX<i.scrollSensitivity?r.scrollLeft=n=r.scrollLeft+i.scrollSpeed:e.pageX-o.overflowOffset.left<i.scrollSensitivity&&(r.scrollLeft=n=r.scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(e.pageY-x(s).scrollTop()<i.scrollSensitivity?n=x(s).scrollTop(x(s).scrollTop()-i.scrollSpeed):x(window).height()-(e.pageY-x(s).scrollTop())<i.scrollSensitivity&&(n=x(s).scrollTop(x(s).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(e.pageX-x(s).scrollLeft()<i.scrollSensitivity?n=x(s).scrollLeft(x(s).scrollLeft()-i.scrollSpeed):x(window).width()-(e.pageX-x(s).scrollLeft())<i.scrollSensitivity&&(n=x(s).scrollLeft(x(s).scrollLeft()+i.scrollSpeed)))),!1!==n&&x.ui.ddmanager&&!i.dropBehaviour&&x.ui.ddmanager.prepareOffsets(o,e)}}),x.ui.plugin.add("draggable","snap",{start:function(e,t,o){var i=o.options;o.snapElements=[],x(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var e=x(this),t=e.offset();this!==o.element[0]&&o.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})})},drag:function(e,t,o){for(var i,n,r,s,a,l,c,u,d,h=o.options,p=h.snapTolerance,f=t.offset.left,m=f+o.helperProportions.width,g=t.offset.top,v=g+o.helperProportions.height,b=o.snapElements.length-1;0<=b;b--)l=(a=o.snapElements[b].left-o.margins.left)+o.snapElements[b].width,u=(c=o.snapElements[b].top-o.margins.top)+o.snapElements[b].height,m<a-p||l+p<f||v<c-p||u+p<g||!x.contains(o.snapElements[b].item.ownerDocument,o.snapElements[b].item)?(o.snapElements[b].snapping&&o.options.snap.release&&o.options.snap.release.call(o.element,e,x.extend(o._uiHash(),{snapItem:o.snapElements[b].item})),o.snapElements[b].snapping=!1):("inner"!==h.snapMode&&(i=p>=Math.abs(c-v),n=p>=Math.abs(u-g),r=p>=Math.abs(a-m),s=p>=Math.abs(l-f),i&&(t.position.top=o._convertPositionTo("relative",{top:c-o.helperProportions.height,left:0}).top),n&&(t.position.top=o._convertPositionTo("relative",{top:u,left:0}).top),r&&(t.position.left=o._convertPositionTo("relative",{top:0,left:a-o.helperProportions.width}).left),s&&(t.position.left=o._convertPositionTo("relative",{top:0,left:l}).left)),d=i||n||r||s,"outer"!==h.snapMode&&(i=p>=Math.abs(c-g),n=p>=Math.abs(u-v),r=p>=Math.abs(a-f),s=p>=Math.abs(l-m),i&&(t.position.top=o._convertPositionTo("relative",{top:c,left:0}).top),n&&(t.position.top=o._convertPositionTo("relative",{top:u-o.helperProportions.height,left:0}).top),r&&(t.position.left=o._convertPositionTo("relative",{top:0,left:a}).left),s&&(t.position.left=o._convertPositionTo("relative",{top:0,left:l-o.helperProportions.width}).left)),!o.snapElements[b].snapping&&(i||n||r||s||d)&&o.options.snap.snap&&o.options.snap.snap.call(o.element,e,x.extend(o._uiHash(),{snapItem:o.snapElements[b].item})),o.snapElements[b].snapping=i||n||r||s||d)}}),x.ui.plugin.add("draggable","stack",{start:function(e,t,o){var i,o=o.options,o=x.makeArray(x(o.stack)).sort(function(e,t){return(parseInt(x(e).css("zIndex"),10)||0)-(parseInt(x(t).css("zIndex"),10)||0)});o.length&&(i=parseInt(x(o[0]).css("zIndex"),10)||0,x(o).each(function(e){x(this).css("zIndex",i+e)}),this.css("zIndex",i+o.length))}}),x.ui.plugin.add("draggable","zIndex",{start:function(e,t,o){t=x(t.helper),o=o.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(e,t,o){o=o.options;o._zIndex&&x(t.helper).css("zIndex",o._zIndex)}}),x.ui.draggable,x.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,o=t.accept;this.isover=!1,this.isout=!0,this.accept=x.isFunction(o)?o:function(e){return e.is(o)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e=e||{width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){x.ui.ddmanager.droppables[e]=x.ui.ddmanager.droppables[e]||[],x.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=x.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){var o;"accept"===e?this.accept=x.isFunction(t)?t:function(e){return e.is(t)}:"scope"===e&&(o=x.ui.ddmanager.droppables[this.options.scope],this._splice(o),this._addToManager(t)),this._super(e,t)},_activate:function(e){var t=x.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=x.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=x.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=x.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(t,e){var o=e||x.ui.ddmanager.current,i=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=x(this).droppable("instance");return e.options.greedy&&!e.options.disabled&&e.options.scope===o.options.scope&&e.accept.call(e.element[0],o.currentItem||o.element)&&x.ui.intersect(o,x.extend(e,{offset:e.element.offset()}),e.options.tolerance,t)?!(i=!0):void 0}),!i&&(!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(o)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),x.ui.intersect=function(e,t,o,i){if(!t.offset)return!1;var n=(e.positionAbs||e.position.absolute).left+e.margins.left,r=(e.positionAbs||e.position.absolute).top+e.margins.top,s=n+e.helperProportions.width,a=r+e.helperProportions.height,l=t.offset.left,c=t.offset.top,u=l+t.proportions().width,d=c+t.proportions().height;switch(o){case"fit":return l<=n&&s<=u&&c<=r&&a<=d;case"intersect":return n+e.helperProportions.width/2>l&&u>s-e.helperProportions.width/2&&r+e.helperProportions.height/2>c&&d>a-e.helperProportions.height/2;case"pointer":return w(i.pageY,c,t.proportions().height)&&w(i.pageX,l,t.proportions().width);case"touch":return(c<=r&&r<=d||c<=a&&a<=d||r<c&&d<a)&&(l<=n&&n<=u||l<=s&&s<=u||n<l&&u<s);default:return!1}},x.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var o,i,n=x.ui.ddmanager.droppables[e.options.scope]||[],r=t?t.type:null,s=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(o=0;n.length>o;o++)if(!(n[o].options.disabled||e&&!n[o].accept.call(n[o].element[0],e.currentItem||e.element))){for(i=0;s.length>i;i++)if(s[i]===n[o].element[0]){n[o].proportions().height=0;continue e}n[o].visible="none"!==n[o].element.css("display"),n[o].visible&&("mousedown"===r&&n[o]._activate.call(n[o],t),n[o].offset=n[o].element.offset(),n[o].proportions({width:n[o].element[0].offsetWidth,height:n[o].element[0].offsetHeight}))}},drop:function(e,t){var o=!1;return x.each((x.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&x.ui.intersect(e,this,this.options.tolerance,t)&&(o=this._drop.call(this,t)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),o},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||x.ui.ddmanager.prepareOffsets(e,t)})},drag:function(n,r){n.options.refreshPositions&&x.ui.ddmanager.prepareOffsets(n,r),x.each(x.ui.ddmanager.droppables[n.options.scope]||[],function(){var e,t,o,i;this.options.disabled||this.greedyChild||!this.visible||(i=!(i=x.ui.intersect(n,this,this.options.tolerance,r))&&this.isover?"isout":i&&!this.isover?"isover":null)&&(this.options.greedy&&(t=this.options.scope,(o=this.element.parents(":data(ui-droppable)").filter(function(){return x(this).droppable("instance").options.scope===t})).length&&((e=x(o[0]).droppable("instance")).greedyChild="isover"===i)),e&&"isover"===i&&(e.isover=!1,e.isout=!0,e._out.call(e,r)),this[i]=!0,this["isout"===i?"isover":"isout"]=!1,this["isover"===i?"_over":"_out"].call(this,r),e&&"isout"===i&&(e.isout=!1,e.isover=!0,e._over.call(e,r)))})},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||x.ui.ddmanager.prepareOffsets(e,t)}},x.ui.droppable,x.widget("ui.resizable",x.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(e,t){if("hidden"===x(e).css("overflow"))return!1;var o,t=t&&"left"===t?"scrollLeft":"scrollTop";return 0<e[t]||(e[t]=1,o=0<e[t],e[t]=0,o)},_create:function(){var e,t,o,i,n=this,r=this.options;if(this.element.addClass("ui-resizable"),x.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(x("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(x(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=x(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},t=0;e.length>t;t++)o=x.trim(e[t]),(i=x("<div class='ui-resizable-handle "+("ui-resizable-"+o)+"'></div>")).css({zIndex:r.zIndex}),"se"===o&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[o]=".ui-resizable-"+o,this.element.append(i);this._renderAxis=function(e){var t,o,i;for(t in e=e||this.element,this.handles)this.handles[t].constructor===String?this.handles[t]=this.element.children(this.handles[t]).first().show():(this.handles[t].jquery||this.handles[t].nodeType)&&(this.handles[t]=x(this.handles[t]),this._on(this.handles[t],{mousedown:n._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=x(this.handles[t],this.element),i=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth(),o=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(o,i),this._proportionallyResize()),this._handles=this._handles.add(this.handles[t])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){n.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),n.axis=i&&i[1]?i[1]:"se")}),r.autoHide&&(this._handles.hide(),x(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(x(this).removeClass("ui-resizable-autohide"),n._handles.show())}).mouseleave(function(){r.disabled||n.resizing||(x(this).addClass("ui-resizable-autohide"),n._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();function e(e){x(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()}var t;return this.elementIsWrapper&&(e(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var t,o,i=!1;for(t in this.handles)o=x(this.handles[t])[0],o!==e.target&&!x.contains(o,e.target)||(i=!0);return!this.options.disabled&&i},_mouseStart:function(e){var t,o,i=this.options,n=this.element;return this.resizing=!0,this._renderProxy(),o=this._num(this.helper.css("left")),t=this._num(this.helper.css("top")),i.containment&&(o+=x(i.containment).scrollLeft()||0,t+=x(i.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:t},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:n.width(),height:n.height()},this.originalSize=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()},this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()},this.originalPosition={left:o,top:t},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof i.aspectRatio?i.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=x(".ui-resizable-"+this.axis).css("cursor"),x("body").css("cursor","auto"===o?this.axis+"-resize":o),n.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var t=this.originalMousePosition,o=this.axis,i=e.pageX-t.left||0,t=e.pageY-t.top||0,o=this._change[o];return this._updatePrevProperties(),o&&(o=o.apply(this,[e,i,t]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(o=this._updateRatio(o,e)),o=this._respectSize(o,e),this._updateCache(o),this._propagate("resize",e),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),x.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges())),!1},_mouseStop:function(e){this.resizing=!1;var t,o,i,n=this.options,r=this;return this._helper&&(o=(t=(o=this._proportionallyResizeElements).length&&/textarea/i.test(o[0].nodeName))&&this._hasScroll(o[0],"left")?0:r.sizeDiff.height,t=t?0:r.sizeDiff.width,t={width:r.helper.width()-t,height:r.helper.height()-o},o=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,i=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null,n.animate||this.element.css(x.extend(t,{top:i,left:o})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()),x("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,o,i,n=this.options,n={minWidth:this._isNumber(n.minWidth)?n.minWidth:0,maxWidth:this._isNumber(n.maxWidth)?n.maxWidth:1/0,minHeight:this._isNumber(n.minHeight)?n.minHeight:0,maxHeight:this._isNumber(n.maxHeight)?n.maxHeight:1/0};(this._aspectRatio||e)&&(e=n.minHeight*this.aspectRatio,o=n.minWidth/this.aspectRatio,t=n.maxHeight*this.aspectRatio,i=n.maxWidth/this.aspectRatio,e>n.minWidth&&(n.minWidth=e),o>n.minHeight&&(n.minHeight=o),n.maxWidth>t&&(n.maxWidth=t),n.maxHeight>i&&(n.maxHeight=i)),this._vBoundaries=n},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,o=this.size,i=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===i&&(e.left=t.left+(o.width-e.width),e.top=null),"nw"===i&&(e.top=t.top+(o.height-e.height),e.left=t.left+(o.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,o=this.axis,i=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,r=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,s=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(o),o=/nw|ne|n/.test(o);return r&&(e.width=t.minWidth),s&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),r&&c&&(e.left=a-t.minWidth),i&&c&&(e.left=a-t.maxWidth),s&&o&&(e.top=l-t.minHeight),n&&o&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,o=[],i=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)o[t]=parseInt(i[t],10)||0,o[t]+=parseInt(n[t],10)||0;return{height:o[0]+o[2],width:o[1]+o[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,o=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:o.height()-this.outerDimensions.height||0,width:o.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||x("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var o=this.originalSize;return{left:this.originalPosition.left+t,width:o.width-t}},n:function(e,t,o){var i=this.originalSize;return{top:this.originalPosition.top+o,height:i.height-o}},s:function(e,t,o){return{height:this.originalSize.height+o}},se:function(e,t,o){return x.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,o]))},sw:function(e,t,o){return x.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,o]))},ne:function(e,t,o){return x.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,o]))},nw:function(e,t,o){return x.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,o]))}},_propagate:function(e,t){x.ui.plugin.call(this,e,[t,this.ui()]),"resize"!==e&&this._trigger(e,t,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),x.ui.plugin.add("resizable","animate",{stop:function(t){var o=x(this).resizable("instance"),e=o.options,i=o._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),r=n&&o._hasScroll(i[0],"left")?0:o.sizeDiff.height,n=n?0:o.sizeDiff.width,n={width:o.size.width-n,height:o.size.height-r},r=parseInt(o.element.css("left"),10)+(o.position.left-o.originalPosition.left)||null,s=parseInt(o.element.css("top"),10)+(o.position.top-o.originalPosition.top)||null;o.element.animate(x.extend(n,s&&r?{top:s,left:r}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseInt(o.element.css("width"),10),height:parseInt(o.element.css("height"),10),top:parseInt(o.element.css("top"),10),left:parseInt(o.element.css("left"),10)};i&&i.length&&x(i[0]).css({width:e.width,height:e.height}),o._updateCache(e),o._propagate("resize",t)}})}}),x.ui.plugin.add("resizable","containment",{start:function(){var o,i,e,t,n=x(this).resizable("instance"),r=n.options,s=n.element,r=r.containment,s=r instanceof x?r.get(0):/parent/.test(r)?s.parent().get(0):r;s&&(n.containerElement=x(s),/document/.test(r)||r===document?(n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:x(document),left:0,top:0,width:x(document).width(),height:x(document).height()||document.body.parentNode.scrollHeight}):(o=x(s),i=[],x(["Top","Right","Left","Bottom"]).each(function(e,t){i[e]=n._num(o.css("padding"+t))}),n.containerOffset=o.offset(),n.containerPosition=o.position(),n.containerSize={height:o.innerHeight()-i[3],width:o.innerWidth()-i[1]},r=n.containerOffset,t=n.containerSize.height,e=n.containerSize.width,e=n._hasScroll(s,"left")?s.scrollWidth:e,t=n._hasScroll(s)?s.scrollHeight:t,n.parentData={element:s,left:r.left,top:r.top,width:e,height:t}))},resize:function(e){var t=x(this).resizable("instance"),o=t.options,i=t.containerOffset,n=t.position,e=t._aspectRatio||e.shiftKey,r={top:0,left:0},s=t.containerElement,a=!0;s[0]!==document&&/static/.test(s.css("position"))&&(r=i),n.left<(t._helper?i.left:0)&&(t.size.width=t.size.width+(t._helper?t.position.left-i.left:t.position.left-r.left),e&&(t.size.height=t.size.width/t.aspectRatio,a=!1),t.position.left=o.helper?i.left:0),n.top<(t._helper?i.top:0)&&(t.size.height=t.size.height+(t._helper?t.position.top-i.top:t.position.top),e&&(t.size.width=t.size.height*t.aspectRatio,a=!1),t.position.top=t._helper?i.top:0),s=t.containerElement.get(0)===t.element.parent().get(0),o=/relative|absolute/.test(t.containerElement.css("position")),s&&o?(t.offset.left=t.parentData.left+t.position.left,t.offset.top=t.parentData.top+t.position.top):(t.offset.left=t.element.offset().left,t.offset.top=t.element.offset().top),n=Math.abs(t.sizeDiff.width+(t._helper?t.offset.left-r.left:t.offset.left-i.left)),s=Math.abs(t.sizeDiff.height+(t._helper?t.offset.top-r.top:t.offset.top-i.top)),n+t.size.width>=t.parentData.width&&(t.size.width=t.parentData.width-n,e&&(t.size.height=t.size.width/t.aspectRatio,a=!1)),s+t.size.height>=t.parentData.height&&(t.size.height=t.parentData.height-s,e&&(t.size.width=t.size.height*t.aspectRatio,a=!1)),a||(t.position.left=t.prevPosition.left,t.position.top=t.prevPosition.top,t.size.width=t.prevSize.width,t.size.height=t.prevSize.height)},stop:function(){var e=x(this).resizable("instance"),t=e.options,o=e.containerOffset,i=e.containerPosition,n=e.containerElement,r=x(e.helper),s=r.offset(),a=r.outerWidth()-e.sizeDiff.width,r=r.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(n.css("position"))&&x(this).css({left:s.left-i.left-o.left,width:a,height:r}),e._helper&&!t.animate&&/static/.test(n.css("position"))&&x(this).css({left:s.left-i.left-o.left,width:a,height:r})}}),x.ui.plugin.add("resizable","alsoResize",{start:function(){var e=x(this).resizable("instance").options;x(e.alsoResize).each(function(){var e=x(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})},resize:function(e,o){var t=x(this).resizable("instance"),i=t.options,n=t.originalSize,r=t.originalPosition,s={height:t.size.height-n.height||0,width:t.size.width-n.width||0,top:t.position.top-r.top||0,left:t.position.left-r.left||0};x(i.alsoResize).each(function(){var e=x(this),i=x(this).data("ui-resizable-alsoresize"),n={},t=e.parents(o.originalElement[0]).length?["width","height"]:["width","height","top","left"];x.each(t,function(e,t){var o=(i[t]||0)+(s[t]||0);o&&0<=o&&(n[t]=o||null)}),e.css(n)})},stop:function(){x(this).removeData("resizable-alsoresize")}}),x.ui.plugin.add("resizable","ghost",{start:function(){var e=x(this).resizable("instance"),t=e.options,o=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:o.height,width:o.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof t.ghost?t.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=x(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=x(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),x.ui.plugin.add("resizable","grid",{resize:function(){var e,t=x(this).resizable("instance"),o=t.options,i=t.size,n=t.originalSize,r=t.originalPosition,s=t.axis,a="number"==typeof o.grid?[o.grid,o.grid]:o.grid,l=a[0]||1,c=a[1]||1,u=Math.round((i.width-n.width)/l)*l,i=Math.round((i.height-n.height)/c)*c,d=n.width+u,h=n.height+i,p=o.maxWidth&&d>o.maxWidth,f=o.maxHeight&&h>o.maxHeight,m=o.minWidth&&o.minWidth>d,g=o.minHeight&&o.minHeight>h;o.grid=a,m&&(d+=l),g&&(h+=c),p&&(d-=l),f&&(h-=c),/^(se|s|e)$/.test(s)?(t.size.width=d,t.size.height=h):/^(ne)$/.test(s)?(t.size.width=d,t.size.height=h,t.position.top=r.top-i):/^(sw)$/.test(s)?(t.size.width=d,t.size.height=h,t.position.left=r.left-u):((h-c<=0||d-l<=0)&&(e=t._getPaddingPlusBorderDimensions(this)),0<h-c?(t.size.height=h,t.position.top=r.top-i):(h=c-e.height,t.size.height=h,t.position.top=r.top+n.height-h),0<d-l?(t.size.width=d,t.position.left=r.left-u):(d=l-e.width,t.size.width=d,t.position.left=r.left+n.width-d))}}),x.ui.resizable,x.widget("ui.selectable",x.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,t=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(e=x(t.options.filter,t.element[0])).addClass("ui-selectee"),e.each(function(){var e=x(this),t=e.offset();x.data(this,"selectable-item",{element:this,$element:e,left:t.left,top:t.top,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=x("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(o){var i=this,e=this.options;this.opos=[o.pageX,o.pageY],this.options.disabled||(this.selectees=x(e.filter,this.element[0]),this._trigger("start",o),x(e.appendTo).append(this.helper),this.helper.css({left:o.pageX,top:o.pageY,width:0,height:0}),e.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var e=x.data(this,"selectable-item");e.startselected=!0,o.metaKey||o.ctrlKey||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,i._trigger("unselecting",o,{unselecting:e.element}))}),x(o.target).parents().addBack().each(function(){var e,t=x.data(this,"selectable-item");return t?(e=!o.metaKey&&!o.ctrlKey||!t.$element.hasClass("ui-selected"),t.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),t.unselecting=!e,t.selecting=e,(t.selected=e)?i._trigger("selecting",o,{selecting:t.element}):i._trigger("unselecting",o,{unselecting:t.element}),!1):void 0}))},_mouseDrag:function(o){var e,i,n,r,s,a,l;if(this.dragged=!0,!this.options.disabled)return n=(i=this).options,r=this.opos[0],s=this.opos[1],a=o.pageX,l=o.pageY,a<r&&(e=a,a=r,r=e),l<s&&(e=l,l=s,s=e),this.helper.css({left:r,top:s,width:a-r,height:l-s}),this.selectees.each(function(){var e=x.data(this,"selectable-item"),t=!1;e&&e.element!==i.element[0]&&("touch"===n.tolerance?t=!(e.left>a||r>e.right||e.top>l||s>e.bottom):"fit"===n.tolerance&&(t=e.left>r&&a>e.right&&e.top>s&&l>e.bottom),t?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,i._trigger("selecting",o,{selecting:e.element}))):(e.selecting&&((o.metaKey||o.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),i._trigger("unselecting",o,{unselecting:e.element}))),!e.selected||o.metaKey||o.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,i._trigger("unselecting",o,{unselecting:e.element}))))}),!1},_mouseStop:function(t){var o=this;return this.dragged=!1,x(".ui-unselecting",this.element[0]).each(function(){var e=x.data(this,"selectable-item");e.$element.removeClass("ui-unselecting"),e.unselecting=!1,e.startselected=!1,o._trigger("unselected",t,{unselected:e.element})}),x(".ui-selecting",this.element[0]).each(function(){var e=x.data(this,"selectable-item");e.$element.removeClass("ui-selecting").addClass("ui-selected"),e.selecting=!1,e.selected=!0,e.startselected=!0,o._trigger("selected",t,{selected:e.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),x.widget("ui.sortable",x.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,o){return t<=e&&e<t+o},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),x.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;0<=e;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,t){var o=null,i=!1,n=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),x(e.target).parents().each(function(){return x.data(this,n.widgetName+"-item")===n?(o=x(this),!1):void 0}),!!(o=x.data(e.target,n.widgetName+"-item")===n?x(e.target):o)&&(!(this.options.handle&&!t&&(x(this.options.handle,o).find("*").addBack().each(function(){this===e.target&&(i=!0)}),!i))&&(this.currentItem=o,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,t,o){var i,n,r=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},x.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(n=this.document.find("body"),this.storedCursor=n.css("cursor"),n.css("cursor",r.cursor),this.storedStylesheet=x("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(n)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!o)for(i=this.containers.length-1;0<=i;i--)this.containers[i]._trigger("activate",e,this._uiHash(this));return x.ui.ddmanager&&(x.ui.ddmanager.current=this),x.ui.ddmanager&&!r.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var t,o,i,n,r=this.options,s=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+r.scrollSpeed:e.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+r.scrollSpeed:e.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(e.pageY-this.document.scrollTop()<r.scrollSensitivity?s=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<r.scrollSensitivity&&(s=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),e.pageX-this.document.scrollLeft()<r.scrollSensitivity?s=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(s=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),!1!==s&&x.ui.ddmanager&&!r.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t=this.items.length-1;0<=t;t--)if(i=(o=this.items[t]).item[0],(n=this._intersectsWithPointer(o))&&o.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===n?"next":"prev"]()[0]!==i&&!x.contains(this.placeholder[0],i)&&("semi-dynamic"!==this.options.type||!x.contains(this.element[0],i))){if(this.direction=1===n?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(o))break;this._rearrange(e,o),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),x.ui.ddmanager&&x.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){var o,i,n,r;if(e)return x.ui.ddmanager&&!this.options.dropBehaviour&&x.ui.ddmanager.drop(this,e),this.options.revert?(i=(o=this).placeholder.offset(),r={},(n=this.options.axis)&&"x"!==n||(r.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),n&&"y"!==n||(r.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,x(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){o._clear(e)})):this._clear(e,t),!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),x.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?x(this.domPosition.prev).after(this.currentItem):x(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),o=[];return t=t||{},x(e).each(function(){var e=(x(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);e&&o.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}),!o.length&&t.key&&o.push(t.key+"="),o.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),o=[];return e=e||{},t.each(function(){o.push(x(e.item||this).attr(e.attribute||"id")||"")}),o},_intersectsWith:function(e){var t=this.positionAbs.left,o=t+this.helperProportions.width,i=this.positionAbs.top,n=i+this.helperProportions.height,r=e.left,s=r+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,c="x"===this.options.axis||a<i+c&&i+c<l,u="y"===this.options.axis||r<t+u&&t+u<s;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c&&u:t+this.helperProportions.width/2>r&&s>o-this.helperProportions.width/2&&i+this.helperProportions.height/2>a&&l>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),e="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),t=t&&e,e=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return!!t&&(this.floating?o&&"right"===o||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),e=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),o=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"===i&&e||"left"===i&&!e:o&&("down"===o&&t||"up"===o&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(0<e?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(0<e?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){function t(){s.push(this)}var o,i,n,r,s=[],a=[],l=this._connectWith();if(l&&e)for(o=l.length-1;0<=o;o--)for(i=(n=x(l[o],this.document[0])).length-1;0<=i;i--)(r=x.data(n[i],this.widgetFullName))&&r!==this&&!r.options.disabled&&a.push([x.isFunction(r.options.items)?r.options.items.call(r.element):x(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([x.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):x(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),o=a.length-1;0<=o;o--)a[o][0].each(t);return x(s)},_removeCurrentsFromItems:function(){var o=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=x.grep(this.items,function(e){for(var t=0;o.length>t;t++)if(o[t]===e.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var t,o,i,n,r,s,a,l,c=this.items,u=[[x.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):x(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(t=d.length-1;0<=t;t--)for(o=(i=x(d[t],this.document[0])).length-1;0<=o;o--)(n=x.data(i[o],this.widgetFullName))&&n!==this&&!n.options.disabled&&(u.push([x.isFunction(n.options.items)?n.options.items.call(n.element[0],e,{item:this.currentItem}):x(n.options.items,n.element),n]),this.containers.push(n));for(t=u.length-1;0<=t;t--)for(r=u[t][1],l=(s=u[t][o=0]).length;o<l;o++)(a=x(s[o])).data(this.widgetName+"-item",r),c.push({item:a,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var t,o,i,n;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),t=this.items.length-1;0<=t;t--)(o=this.items[t]).instance!==this.currentContainer&&this.currentContainer&&o.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?x(this.options.toleranceElement,o.item):o.item,e||(o.width=i.outerWidth(),o.height=i.outerHeight()),n=i.offset(),o.left=n.left,o.top=n.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;0<=t;t--)n=this.containers[t].element.offset(),this.containers[t].containerCache.left=n.left,this.containers[t].containerCache.top=n.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(o){var i,n=(o=o||this).options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var e=o.currentItem[0].nodeName.toLowerCase(),t=x("<"+e+">",o.document[0]).addClass(i||o.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===e?o._createTrPlaceholder(o.currentItem.find("tr").eq(0),x("<tr>",o.document[0]).appendTo(t)):"tr"===e?o._createTrPlaceholder(o.currentItem,t):"img"===e&&t.attr("src",o.currentItem.attr("src")),i||t.css("visibility","hidden"),t},update:function(e,t){i&&!n.forcePlaceholderSize||(t.height()||t.height(o.currentItem.innerHeight()-parseInt(o.currentItem.css("paddingTop")||0,10)-parseInt(o.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(o.currentItem.innerWidth()-parseInt(o.currentItem.css("paddingLeft")||0,10)-parseInt(o.currentItem.css("paddingRight")||0,10)))}}),o.placeholder=x(n.placeholder.element.call(o.element,o.currentItem)),o.currentItem.after(o.placeholder),n.placeholder.update(o,o.placeholder)},_createTrPlaceholder:function(e,t){var o=this;e.children().each(function(){x("<td>&#160;</td>",o.document[0]).attr("colspan",x(this).attr("colspan")||1).appendTo(t)})},_contactContainers:function(e){for(var t,o,i,n,r,s,a,l,c,u=null,d=null,h=this.containers.length-1;0<=h;h--)if(!x.contains(this.currentItem[0],this.containers[h].element[0]))if(this._intersectsWith(this.containers[h].containerCache)){if(u&&x.contains(this.containers[h].element[0],u.element[0]))continue;u=this.containers[h],d=h}else this.containers[h].containerCache.over&&(this.containers[h]._trigger("out",e,this._uiHash(this)),this.containers[h].containerCache.over=0);if(u)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(o=1e4,i=null,n=(l=u.floating||this._isFloating(this.currentItem))?"left":"top",r=l?"width":"height",c=l?"clientX":"clientY",t=this.items.length-1;0<=t;t--)x.contains(this.containers[d].element[0],this.items[t].item[0])&&this.items[t].item[0]!==this.currentItem[0]&&(s=this.items[t].item.offset()[n],a=!1,e[c]-s>this.items[t][r]/2&&(a=!0),o>Math.abs(e[c]-s)&&(o=Math.abs(e[c]-s),i=this.items[t],this.direction=a?"up":"down"));(i||this.options.dropOnEmpty)&&(this.currentContainer===this.containers[d]?this.currentContainer.containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1):(i?this._rearrange(e,i,null,!0):this._rearrange(e,null,this.containers[d].element,!0),this._trigger("change",e,this._uiHash()),this.containers[d]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1))}},_createHelper:function(e){var t=this.options,e=x.isFunction(t.helper)?x(t.helper.apply(this.element[0],[e,this.currentItem])):"clone"===t.helper?this.currentItem.clone():this.currentItem;return e.parents("body").length||x("parent"!==t.appendTo?t.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0]),e[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),e[0].style.width&&!t.forceHelperSize||e.width(this.currentItem.width()),e[0].style.height&&!t.forceHelperSize||e.height(this.currentItem.height()),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),"left"in(e=x.isArray(e)?{left:+e[0],top:+e[1]||0}:e)&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),{top:(e=this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&x.ui.ie?{top:0,left:0}:e).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var e;return"relative"===this.cssPosition?{top:(e=this.currentItem.position()).top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}:{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(e=x(o.containment)[0],o=x(o.containment).offset(),t="hidden"!==x(e).css("overflow"),this.containment=[o.left+(parseInt(x(e).css("borderLeftWidth"),10)||0)+(parseInt(x(e).css("paddingLeft"),10)||0)-this.margins.left,o.top+(parseInt(x(e).css("borderTopWidth"),10)||0)+(parseInt(x(e).css("paddingTop"),10)||0)-this.margins.top,o.left+(t?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(x(e).css("borderLeftWidth"),10)||0)-(parseInt(x(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,o.top+(t?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(x(e).css("borderTopWidth"),10)||0)-(parseInt(x(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t=t||this.position;var e="absolute"===e?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(o[0].tagName);return{top:t.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:o.scrollTop())*e,left:t.left+this.offset.relative.left*e+this.offset.parent.left*e-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:o.scrollLeft())*e}},_generatePosition:function(e){var t=this.options,o=e.pageX,i=e.pageY,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(i=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(i=this.containment[3]+this.offset.click.top)),t.grid&&(e=this.originalPageY+Math.round((i-this.originalPageY)/t.grid[1])*t.grid[1],i=!this.containment||e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-t.grid[1]:e+t.grid[1],e=this.originalPageX+Math.round((o-this.originalPageX)/t.grid[0])*t.grid[0],o=!this.containment||e-this.offset.click.left>=this.containment[0]&&e-this.offset.click.left<=this.containment[2]?e:e-this.offset.click.left>=this.containment[0]?e-t.grid[0]:e+t.grid[0])),{top:i-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())}},_rearrange:function(e,t,o,i){o?o[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){function o(t,o,i){return function(e){i._trigger(t,e,o._uiHash(o))}}this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this===this.currentContainer||t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))),i=this.containers.length-1;0<=i;i--)t||n.push(o("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(o("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(i=0;n.length>i;i++)n[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===x.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||x([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}}),x.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=x(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():x()}},_createIcons:function(){var e=this.options.icons;e&&(x("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var t=x.ui.keyCode,o=this.headers.length,i=this.headers.index(e.target),n=!1;switch(e.keyCode){case t.RIGHT:case t.DOWN:n=this.headers[(i+1)%o];break;case t.LEFT:case t.UP:n=this.headers[(i-1+o)%o];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:n=this.headers[0];break;case t.END:n=this.headers[o-1]}n&&(x(e.target).attr("tabIndex",-1),x(n).attr("tabIndex",0),n.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===x.ui.keyCode.UP&&e.ctrlKey&&x(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=x()):!1===e.active?this._activate(0):this.active.length&&!x.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=x()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var o,e=this.options,t=e.heightStyle,i=this.element.parent();this.active=this._findActive(e.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=x(this),t=e.uniqueId().attr("id"),o=e.next(),i=o.uniqueId().attr("id");e.attr("aria-controls",i),o.attr("aria-labelledby",t)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(e.event),"fill"===t?(o=i.height(),this.element.siblings(":visible").each(function(){var e=x(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(o-=e.outerHeight(!0))}),this.headers.each(function(){o-=x(this).outerHeight(!0)}),this.headers.next().each(function(){x(this).height(Math.max(0,o-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===t&&(o=0,this.headers.next().each(function(){o=Math.max(o,x(this).css("height","").height())}).height(o))},_activate:function(e){e=this._findActive(e)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):x()},_setupEvents:function(e){var o={keydown:"_keydown"};e&&x.each(e.split(" "),function(e,t){o[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,o),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var t=this.options,o=this.active,i=x(e.currentTarget),n=i[0]===o[0],r=n&&t.collapsible,s=r?x():i.next(),a=o.next(),a={oldHeader:o,oldPanel:a,newHeader:r?x():i,newPanel:s};e.preventDefault(),n&&!t.collapsible||!1===this._trigger("beforeActivate",e,a)||(t.active=!r&&this.headers.index(i),this.active=n?x():i,this._toggle(a),o.removeClass("ui-accordion-header-active ui-state-active"),t.icons&&o.children(".ui-accordion-header-icon").removeClass(t.icons.activeHeader).addClass(t.icons.header),n||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),t.icons&&i.children(".ui-accordion-header-icon").removeClass(t.icons.header).addClass(t.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var t=e.newPanel,o=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=t,this.prevHide=o,this.options.animate?this._animate(t,o,e):(o.hide(),t.show(),this._toggleComplete(e)),o.attr({"aria-hidden":"true"}),o.prev().attr({"aria-selected":"false","aria-expanded":"false"}),t.length&&o.length?o.prev().attr({tabIndex:-1,"aria-expanded":"false"}):t.length&&this.headers.filter(function(){return 0===parseInt(x(this).attr("tabIndex"),10)}).attr("tabIndex",-1),t.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,o,t){function i(){r._toggleComplete(t)}var n,r=this,s=0,a=e.css("box-sizing"),l=e.length&&(!o.length||e.index()<o.index()),c=this.options.animate||{},l=l&&c.down||c,u=(u="string"==typeof l?l:u)||l.easing||c.easing,d=(d="number"==typeof l?l:d)||l.duration||c.duration;return o.length?e.length?(n=e.show().outerHeight(),o.animate(this.hideProps,{duration:d,easing:u,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:d,easing:u,complete:i,step:function(e,t){t.now=Math.round(e),"height"!==t.prop?"content-box"===a&&(s+=t.now):"content"!==r.options.heightStyle&&(t.now=Math.round(n-o.outerHeight()-s),s=0)}})):o.animate(this.hideProps,d,u,i):e.animate(this.showProps,d,u,i)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),x.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(e){var t=x(e.target);!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),t.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&x(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var t;this.previousFilter||((t=x(e.currentTarget)).siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,t))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var o=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,o)},blur:function(e){this._delay(function(){x.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=x(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var t,o,i,n=!0;switch(e.keyCode){case x.ui.keyCode.PAGE_UP:this.previousPage(e);break;case x.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case x.ui.keyCode.HOME:this._move("first","first",e);break;case x.ui.keyCode.END:this._move("last","last",e);break;case x.ui.keyCode.UP:this.previous(e);break;case x.ui.keyCode.DOWN:this.next(e);break;case x.ui.keyCode.LEFT:this.collapse(e);break;case x.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case x.ui.keyCode.ENTER:case x.ui.keyCode.SPACE:this._activate(e);break;case x.ui.keyCode.ESCAPE:this.collapse(e);break;default:n=!1,t=this.previousFilter||"",o=String.fromCharCode(e.keyCode),i=!1,clearTimeout(this.filterTimer),o===t?i=!0:o=t+o,t=this._filterMenuItems(o),(t=i&&-1!==t.index(this.active.next())?this.active.nextAll(".ui-menu-item"):t).length||(o=String.fromCharCode(e.keyCode),t=this._filterMenuItems(o)),t.length?(this.focus(e,t),this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}n&&e.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t=this,i=this.options.icons.submenu,e=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),e.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=x(this),t=e.parent(),o=x("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);t.attr("aria-haspopup","true").prepend(o),e.attr("aria-labelledby",t.attr("id"))}),(e=e.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=x(this);t._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),e.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!x.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var o;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),o=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",o.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(o=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(o),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,o,i;this._hasScroll()&&(t=parseFloat(x.css(this.activeMenu[0],"borderTopWidth"))||0,o=parseFloat(x.css(this.activeMenu[0],"paddingTop"))||0,t=e.offset().top-this.activeMenu.offset().top-t-o,o=this.activeMenu.scrollTop(),i=this.activeMenu.height(),e=e.outerHeight(),t<0?this.activeMenu.scrollTop(o+t):i<t+e&&this.activeMenu.scrollTop(o+t-i+e))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=x.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,o){clearTimeout(this.timer),this.timer=this._delay(function(){var e=o?this.element:x(t&&t.target).closest(this.element.find(".ui-menu"));e.length||(e=this.element),this._close(e),this.blur(t),this.activeMenu=e},this.delay)},_close:function(e){(e=e||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!x(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,o){var i;(i=this.active?"first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0):i)&&i.length&&this.active||(i=this.activeMenu.find(this.options.items)[t]()),this.focus(o,i)},nextPage:function(e){var t,o,i;return this.active?void(this.isLastItem()||(this._hasScroll()?(o=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(t=x(this)).offset().top-o-i<0}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var t,o,i;return this.active?void(this.isFirstItem()||(this._hasScroll()?(o=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=x(this)).offset().top-o+i}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||x(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)},_filterMenuItems:function(e){var e=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),t=RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return t.test(x.trim(x(this).text()))})}}),x.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var o,i,n,e=this.element[0].nodeName.toLowerCase(),t="textarea"===e,e="input"===e;this.isMultiLine=t||!e&&this.element.prop("isContentEditable"),this.valueMethod=this.element[t||e?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))i=n=o=!0;else{i=n=o=!1;var t=x.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:o=!0,this._move("previousPage",e);break;case t.PAGE_DOWN:o=!0,this._move("nextPage",e);break;case t.UP:o=!0,this._keyEvent("previous",e);break;case t.DOWN:o=!0,this._keyEvent("next",e);break;case t.ENTER:this.menu.active&&(o=!0,e.preventDefault(),this.menu.select(e));break;case t.TAB:this.menu.active&&this.menu.select(e);break;case t.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:i=!0,this._searchTimeout(e)}}},keypress:function(e){if(o)return o=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||e.preventDefault());if(!i){var t=x.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e)}}},input:function(e){return n?(n=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=x("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var o=this.menu.element[0];x(e.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(e){e.target===t.element[0]||e.target===o||x.contains(o,e.target)||t.close()})})},menufocus:function(e,t){var o;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){x(e.target).trigger(e.originalEvent)})):(o=t.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:o})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(o.value),void((t=t.item.attr("aria-label")||o.value)&&x.trim(t).length&&(this.liveRegion.children().hide(),x("<div>").text(t).appendTo(this.liveRegion))))},menuselect:function(e,t){var o=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=o})),!1!==this._trigger("select",e,{item:o})&&this._value(o.value),this.term=this._value(),this.close(e),this.selectedItem=o}}),this.liveRegion=x("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e=(e=(e=e&&(e.jquery||e.nodeType?x(e):this.document.find(e).eq(0)))&&e[0]?e:this.element.closest(".ui-front")).length?e:this.document[0].body},_initSource:function(){var o,i,n=this;x.isArray(this.options.source)?(o=this.options.source,this.source=function(e,t){t(x.ui.autocomplete.filter(o,e.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,t){n.xhr&&n.xhr.abort(),n.xhr=x.ajax({url:i,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}):this.source=this.options.source},_searchTimeout:function(i){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),t=this.menu.element.is(":visible"),o=i.altKey||i.ctrlKey||i.metaKey||i.shiftKey;e&&(t||o)||(this.selectedItem=null,this.search(null,i))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return x.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e=e&&this._normalize(e),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:x.map(e,function(e){return"string"==typeof e?{label:e,value:e}:x.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position(x.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(o,e){var i=this;x.each(e,function(e,t){i._renderItemData(o,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return x("<li>").text(t.label).appendTo(e)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),x.extend(x.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var o=RegExp(x.ui.autocomplete.escapeRegex(t),"i");return x.grep(e,function(e){return o.test(e.label||e.value||e)})}}),x.widget("ui.autocomplete",x.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(1<e?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),x("<div>").text(t).appendTo(this.liveRegion))}}),x.ui.autocomplete;function z(){var e=x(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)}function H(e){var t=e.name,o=e.form,i=x([]);return t&&(t=t.replace(/'/g,"\\'"),i=o?x(o).find("[name='"+t+"'][type=radio]"):x("[name='"+t+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),i}var M,R,N,B="ui-button ui-widget ui-state-default ui-corner-all",U="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only";x.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,z),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,o=this.options,e="checkbox"===this.type||"radio"===this.type,i=e?"":"ui-state-active";null===o.label&&(o.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(B).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){o.disabled||this===M&&x(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){o.disabled||x(this).removeClass(i)}).bind("click"+this.eventNamespace,function(e){o.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),e&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!o.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(o.disabled)return!1;x(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var e=t.element[0];H(e).not(e).map(function(){return x(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!o.disabled&&(x(this).addClass("ui-state-active"),M=this,void t.document.one("mouseup",function(){M=null}))}).bind("mouseup"+this.eventNamespace,function(){return!o.disabled&&void x(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!o.disabled&&void(e.keyCode!==x.ui.keyCode.SPACE&&e.keyCode!==x.ui.keyCode.ENTER||x(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){x(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===x.ui.keyCode.SPACE&&x(this).click()})),this._setOption("disabled",o.disabled),this._resetButton()},_determineButtonType:function(){var e,t;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=(t.length?t:this.element).siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),(t=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",t)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(B+" ui-state-active "+U).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?H(this.element[0]).each(function(){x(this).is(":checked")?x(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):x(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){var e,t,o,i,n;"input"===this.type?this.options.label&&this.element.val(this.options.label):(e=this.buttonElement.removeClass(U),t=x("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),i=(o=this.options.icons).primary&&o.secondary,n=[],o.primary||o.secondary?(this.options.text&&n.push("ui-button-text-icon"+(i?"s":o.primary?"-primary":"-secondary")),o.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+o.primary+"'></span>"),o.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+o.secondary+"'></span>"),this.options.text||(n.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",x.trim(t)))):n.push("ui-button-text-only"),e.addClass(n.join(" ")))}}),x.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var e="rtl"===this.element.css("direction"),t=this.element.find(this.options.items),o=t.filter(":ui-button");t.not(":ui-button").button(),o.button("refresh"),this.buttons=t.map(function(){return x(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return x(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),x.ui.button,x.extend(x.ui,{datepicker:{version:"1.11.4"}}),x.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return l(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var o,i=e.nodeName.toLowerCase(),n="div"===i||"span"===i;e.id||(this.uuid+=1,e.id="dp"+this.uuid),(o=this._newInst(x(e),n)).settings=x.extend({},t||{}),"input"===i?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?o(x("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var o=x(e);t.append=x([]),t.trigger=x([]),o.hasClass(this.markerClassName)||(this._attachments(o,t),o.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),x.data(e,"datepicker",t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var o,i=this._get(t,"appendText"),n=this._get(t,"isRTL");t.append&&t.append.remove(),i&&(t.append=x("<span class='"+this._appendClass+"'>"+i+"</span>"),e[n?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),"focus"!==(i=this._get(t,"showOn"))&&"both"!==i||e.focus(this._showDatepicker),"button"!==i&&"both"!==i||(i=this._get(t,"buttonText"),o=this._get(t,"buttonImage"),t.trigger=x(this._get(t,"buttonImageOnly")?x("<img/>").addClass(this._triggerClass).attr({src:o,alt:i,title:i}):x("<button type='button'></button>").addClass(this._triggerClass).html(o?x("<img/>").attr({src:o,alt:i,title:i}):i)),e[n?"before":"after"](t.trigger),t.trigger.click(function(){return x.datepicker._datepickerShowing&&x.datepicker._lastInput===e[0]?x.datepicker._hideDatepicker():(x.datepicker._datepickerShowing&&x.datepicker._lastInput!==e[0]&&x.datepicker._hideDatepicker(),x.datepicker._showDatepicker(e[0])),!1}))},_autoSize:function(e){var t,o,i,n,r,s;this._get(e,"autoSize")&&!e.inline&&(r=new Date(2009,11,20),(s=this._get(e,"dateFormat")).match(/[DM]/)&&(r.setMonth((t=function(e){for(n=i=o=0;e.length>n;n++)e[n].length>o&&(o=e[n].length,i=n);return i})(this._get(e,s.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(t(this._get(e,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),e.input.attr("size",this._formatDate(e,r).length))},_inlineDatepicker:function(e,t){var o=x(e);o.hasClass(this.markerClassName)||(o.addClass(this.markerClassName).append(t.dpDiv),x.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,o,i,n){var r,s=this._dialogInst;return s||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=x("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),x("body").append(this._dialogInput),(s=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},x.data(this._dialogInput[0],"datepicker",s)),l(s.settings,i||{}),t=t&&t.constructor===Date?this._formatDate(s,t):t,this._dialogInput.val(t),this._pos=n?n.length?n:[n.pageX,n.pageY]:null,this._pos||(r=document.documentElement.clientWidth,i=document.documentElement.clientHeight,t=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[r/2-100+t,i/2-150+n]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=o,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),x.blockUI&&x.blockUI(this.dpDiv),x.data(this._dialogInput[0],"datepicker",s),this},_destroyDatepicker:function(e){var t,o=x(e),i=x.data(e,"datepicker");o.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),x.removeData(e,"datepicker"),"input"===t?(i.append.remove(),i.trigger.remove(),o.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==t&&"span"!==t||o.removeClass(this.markerClassName).empty(),R===i&&(R=null))},_enableDatepicker:function(t){var e,o=x(t),i=x.data(t,"datepicker");o.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!1,i.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==e&&"span"!==e||((i=o.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,o=x(t),i=x.data(t,"datepicker");o.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!0,i.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==e&&"span"!==e||((i=o.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return x.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,o){var i,n,r,s,a=this._getInst(e);return 2===arguments.length&&"string"==typeof t?"defaults"===t?x.extend({},x.datepicker._defaults):a?"all"===t?x.extend({},a.settings):this._get(a,t):null:(i=t||{},"string"==typeof t&&((i={})[t]=o),void(a&&(this._curInst===a&&this._hideDatepicker(),n=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(a,"min"),s=this._getMinMaxDate(a,"max"),l(a.settings,i),null!==r&&void 0!==i.dateFormat&&void 0===i.minDate&&(a.settings.minDate=this._formatDate(a,r)),null!==s&&void 0!==i.dateFormat&&void 0===i.maxDate&&(a.settings.maxDate=this._formatDate(a,s)),"disabled"in i&&(i.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(x(e),a),this._autoSize(a),this._setDate(a,n),this._updateAlternate(a),this._updateDatepicker(a))))},_changeDatepicker:function(e,t,o){this._optionDatepicker(e,t,o)},_refreshDatepicker:function(e){e=this._getInst(e);e&&this._updateDatepicker(e)},_setDateDatepicker:function(e,t){e=this._getInst(e);e&&(this._setDate(e,t),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(e,t){e=this._getInst(e);return e&&!e.inline&&this._setDateFromField(e,t),e?this._getDate(e):null},_doKeyDown:function(e){var t,o,i=x.datepicker._getInst(e.target),n=!0,r=i.dpDiv.is(".ui-datepicker-rtl");if(i._keyEvent=!0,x.datepicker._datepickerShowing)switch(e.keyCode){case 9:x.datepicker._hideDatepicker(),n=!1;break;case 13:return(o=x("td."+x.datepicker._dayOverClass+":not(."+x.datepicker._currentClass+")",i.dpDiv))[0]&&x.datepicker._selectDay(e.target,i.selectedMonth,i.selectedYear,o[0]),(o=x.datepicker._get(i,"onSelect"))?(t=x.datepicker._formatDate(i),o.apply(i.input?i.input[0]:null,[t,i])):x.datepicker._hideDatepicker(),!1;case 27:x.datepicker._hideDatepicker();break;case 33:x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(i,"stepBigMonths"):-x.datepicker._get(i,"stepMonths"),"M");break;case 34:x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(i,"stepBigMonths"):+x.datepicker._get(i,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&x.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&x.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(i,"stepBigMonths"):-x.datepicker._get(i,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(i,"stepBigMonths"):+x.datepicker._get(i,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else 36===e.keyCode&&e.ctrlKey?x.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,o=x.datepicker._getInst(e.target);return x.datepicker._get(o,"constrainInput")?(o=x.datepicker._possibleChars(x.datepicker._get(o,"dateFormat")),t=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||t<" "||!o||-1<o.indexOf(t)):void 0},_doKeyUp:function(e){e=x.datepicker._getInst(e.target);if(e.input.val()!==e.lastVal)try{x.datepicker.parseDate(x.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,x.datepicker._getFormatConfig(e))&&(x.datepicker._setDateFromField(e),x.datepicker._updateAlternate(e),x.datepicker._updateDatepicker(e))}catch(e){}return!0},_showDatepicker:function(e){var t,o,i,n;"input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=x("input",e.parentNode)[0]),x.datepicker._isDisabledDatepicker(e)||x.datepicker._lastInput===e||(n=x.datepicker._getInst(e),x.datepicker._curInst&&x.datepicker._curInst!==n&&(x.datepicker._curInst.dpDiv.stop(!0,!0),n&&x.datepicker._datepickerShowing&&x.datepicker._hideDatepicker(x.datepicker._curInst.input[0])),!1!==(o=(o=x.datepicker._get(n,"beforeShow"))?o.apply(e,[e,n]):{})&&(l(n.settings,o),n.lastVal=null,x.datepicker._lastInput=e,x.datepicker._setDateFromField(n),x.datepicker._inDialog&&(e.value=""),x.datepicker._pos||(x.datepicker._pos=x.datepicker._findPos(e),x.datepicker._pos[1]+=e.offsetHeight),t=!1,x(e).parents().each(function(){return!(t|="fixed"===x(this).css("position"))}),o={left:x.datepicker._pos[0],top:x.datepicker._pos[1]},x.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),x.datepicker._updateDatepicker(n),o=x.datepicker._checkOffset(n,o,t),n.dpDiv.css({position:x.datepicker._inDialog&&x.blockUI?"static":t?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"}),n.inline||(o=x.datepicker._get(n,"showAnim"),i=x.datepicker._get(n,"duration"),n.dpDiv.css("z-index",function(e){for(var t;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(t=parseInt(e.css("zIndex"),10),!isNaN(t)&&0!==t))return t;e=e.parent()}return 0}(x(e))+1),x.datepicker._datepickerShowing=!0,x.effects&&x.effects.effect[o]?n.dpDiv.show(o,x.datepicker._get(n,"showOptions"),i):n.dpDiv[o||"show"](o?i:null),x.datepicker._shouldFocusInput(n)&&n.input.focus(),x.datepicker._curInst=n)))},_updateDatepicker:function(e){this.maxRows=4,(R=e).dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var t,o=this._getNumberOfMonths(e),i=o[1],n=e.dpDiv.find("."+this._dayOverClass+" a");0<n.length&&s.apply(n.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<i&&e.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",17*i+"em"),e.dpDiv[(1!==o[0]||1!==o[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===x.datepicker._curInst&&x.datepicker._datepickerShowing&&x.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,o){var i=e.dpDiv.outerWidth(),n=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,a=document.documentElement.clientWidth+(o?0:x(document).scrollLeft()),l=document.documentElement.clientHeight+(o?0:x(document).scrollTop());return t.left-=this._get(e,"isRTL")?i-r:0,t.left-=o&&t.left===e.input.offset().left?x(document).scrollLeft():0,t.top-=o&&t.top===e.input.offset().top+s?x(document).scrollTop():0,t.left-=Math.min(t.left,t.left+i>a&&i<a?Math.abs(t.left+i-a):0),t.top-=Math.min(t.top,t.top+n>l&&n<l?Math.abs(n+s):0),t},_findPos:function(e){for(var t=this._getInst(e),o=this._get(t,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||x.expr.filters.hidden(e));)e=e[o?"previousSibling":"nextSibling"];return[(t=x(e).offset()).left,t.top]},_hideDatepicker:function(e){var t,o,i=this._curInst;!i||e&&i!==x.data(e,"datepicker")||this._datepickerShowing&&(e=this._get(i,"showAnim"),o=this._get(i,"duration"),t=function(){x.datepicker._tidyDialog(i)},x.effects&&(x.effects.effect[e]||x.effects[e])?i.dpDiv.hide(e,x.datepicker._get(i,"showOptions"),o,t):i.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?o:null,t),e||t(),this._datepickerShowing=!1,(o=this._get(i,"onClose"))&&o.apply(i.input?i.input[0]:null,[i.input?i.input.val():"",i]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),x.blockUI&&(x.unblockUI(),x("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){var t;x.datepicker._curInst&&(e=x(e.target),t=x.datepicker._getInst(e[0]),(!(e[0].id===x.datepicker._mainDivId||0!==e.parents("#"+x.datepicker._mainDivId).length||e.hasClass(x.datepicker.markerClassName)||e.closest("."+x.datepicker._triggerClass).length||!x.datepicker._datepickerShowing||x.datepicker._inDialog&&x.blockUI)||e.hasClass(x.datepicker.markerClassName)&&x.datepicker._curInst!==t)&&x.datepicker._hideDatepicker())},_adjustDate:function(e,t,o){var e=x(e),i=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(i,t+("M"===o?this._get(i,"showCurrentAtPos"):0),o),this._updateDatepicker(i))},_gotoToday:function(e){var t,e=x(e),o=this._getInst(e[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(t=new Date,o.selectedDay=t.getDate(),o.drawMonth=o.selectedMonth=t.getMonth(),o.drawYear=o.selectedYear=t.getFullYear()),this._notifyChange(o),this._adjustDate(e)},_selectMonthYear:function(e,t,o){var e=x(e),i=this._getInst(e[0]);i["selected"+("M"===o?"Month":"Year")]=i["draw"+("M"===o?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(e)},_selectDay:function(e,t,o,i){var n=x(e);x(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(n[0])||((n=this._getInst(n[0])).selectedDay=n.currentDay=x("a",i).html(),n.selectedMonth=n.currentMonth=t,n.selectedYear=n.currentYear=o,this._selectDate(e,this._formatDate(n,n.currentDay,n.currentMonth,n.currentYear)))},_clearDate:function(e){e=x(e);this._selectDate(e,"")},_selectDate:function(e,t){var o,e=x(e),e=this._getInst(e[0]);t=null!=t?t:this._formatDate(e),e.input&&e.input.val(t),this._updateAlternate(e),(o=this._get(e,"onSelect"))?o.apply(e.input?e.input[0]:null,[t,e]):e.input&&e.input.trigger("change"),e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,o,i,n=this._get(e,"altField");n&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),o=this._getDate(e),i=this.formatDate(t,o,this._getFormatConfig(e)),x(n).each(function(){x(this).val(i)}))},noWeekends:function(e){e=e.getDay();return[0<e&&e<6,""]},iso8601Week:function(e){var t,e=new Date(e.getTime());return e.setDate(e.getDate()+4-(e.getDay()||7)),t=e.getTime(),e.setMonth(0),e.setDate(1),Math.floor(Math.round((t-e)/864e5)/7)+1},parseDate:function(t,n,e){if(null==t||null==n)throw"Invalid arguments";if(""===(n="object"==typeof n?""+n:n+""))return null;function o(e){var t=y(e),t="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,e=RegExp("^\\d{"+("y"===e?t:1)+","+t+"}");if(t=n.substring(l).match(e))return l+=t[0].length,parseInt(t[0],10);throw"Missing number at position "+l}function i(e,t,o){var i=-1,e=x.map(y(e)?o:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(x.each(e,function(e,t){var o=t[1];return n.substr(l,o.length).toLowerCase()===o.toLowerCase()?(i=t[0],l+=o.length,!1):void 0}),-1!==i)return i+1;throw"Unknown name at position "+l}function r(){if(n.charAt(l)!==t.charAt(C))throw"Unexpected literal at position "+l;l++}for(var s,a,l=0,c=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,d=(e?e.dayNames:null)||this._defaults.dayNames,h=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,p=(e?e.monthNames:null)||this._defaults.monthNames,f=-1,m=-1,g=-1,v=-1,b=!1,y=function(e){e=t.length>C+1&&t.charAt(C+1)===e;return e&&C++,e},C=0;t.length>C;C++)if(b)"'"!==t.charAt(C)||y("'")?r():b=!1;else switch(t.charAt(C)){case"d":g=o("d");break;case"D":i("D",u,d);break;case"o":v=o("o");break;case"m":m=o("m");break;case"M":m=i("M",h,p);break;case"y":f=o("y");break;case"@":f=(a=new Date(o("@"))).getFullYear(),m=a.getMonth()+1,g=a.getDate();break;case"!":f=(a=new Date((o("!")-this._ticksTo1970)/1e4)).getFullYear(),m=a.getMonth()+1,g=a.getDate();break;case"'":y("'")?r():b=!0;break;default:r()}if(n.length>l&&(e=n.substr(l),!/^\s+/.test(e)))throw"Extra/unparsed characters found in date: "+e;if(-1===f?f=(new Date).getFullYear():f<100&&(f+=(new Date).getFullYear()-(new Date).getFullYear()%100+(f<=c?0:-100)),-1<v)for(m=1,g=v;!(g<=(s=this._getDaysInMonth(f,m-1)));)m++,g-=s;if((a=this._daylightSavingAdjust(new Date(f,m-1,g))).getFullYear()!==f||a.getMonth()+1!==m||a.getDate()!==g)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,o){if(!e)return"";function i(e,t,o){var i=""+t;if(u(e))for(;o>i.length;)i="0"+i;return i}function n(e,t,o,i){return(u(e)?i:o)[t]}var r,s=(o?o.dayNamesShort:null)||this._defaults.dayNamesShort,a=(o?o.dayNames:null)||this._defaults.dayNames,l=(o?o.monthNamesShort:null)||this._defaults.monthNamesShort,c=(o?o.monthNames:null)||this._defaults.monthNames,u=function(e){e=t.length>r+1&&t.charAt(r+1)===e;return e&&r++,e},d="",h=!1;if(e)for(r=0;t.length>r;r++)if(h)"'"!==t.charAt(r)||u("'")?d+=t.charAt(r):h=!1;else switch(t.charAt(r)){case"d":d+=i("d",e.getDate(),2);break;case"D":d+=n("D",e.getDay(),s,a);break;case"o":d+=i("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=i("m",e.getMonth()+1,2);break;case"M":d+=n("M",e.getMonth(),l,c);break;case"y":d+=u("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=1e4*e.getTime()+this._ticksTo1970;break;case"'":u("'")?d+="'":h=!0;break;default:d+=t.charAt(r)}return d},_possibleChars:function(t){function e(e){return(e=t.length>n+1&&t.charAt(n+1)===e)&&n++,e}for(var o="",i=!1,n=0;t.length>n;n++)if(i)"'"!==t.charAt(n)||e("'")?o+=t.charAt(n):i=!1;else switch(t.charAt(n)){case"d":case"m":case"y":case"@":o+="0123456789";break;case"D":case"M":return null;case"'":e("'")?o+="'":i=!0;break;default:o+=t.charAt(n)}return o},_get:function(e,t){return(void 0!==e.settings[t]?e.settings:this._defaults)[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var o=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),r=n,s=this._getFormatConfig(e);try{r=this.parseDate(o,i,s)||n}catch(e){i=t?"":i}e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),e.currentDay=i?r.getDate():0,e.currentMonth=i?r.getMonth():0,e.currentYear=i?r.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(a,e,t){var o,i=null==e||""===e?t:"string"==typeof e?function(e){try{return x.datepicker.parseDate(x.datepicker._get(a,"dateFormat"),e,x.datepicker._getFormatConfig(a))}catch(e){}for(var t=(e.toLowerCase().match(/^c/)?x.datepicker._getDate(a):null)||new Date,o=t.getFullYear(),i=t.getMonth(),n=t.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=r.exec(e);s;){switch(s[2]||"d"){case"d":case"D":n+=parseInt(s[1],10);break;case"w":case"W":n+=7*parseInt(s[1],10);break;case"m":case"M":i+=parseInt(s[1],10),n=Math.min(n,x.datepicker._getDaysInMonth(o,i));break;case"y":case"Y":o+=parseInt(s[1],10),n=Math.min(n,x.datepicker._getDaysInMonth(o,i))}s=r.exec(e)}return new Date(o,i,n)}(e):"number"==typeof e?isNaN(e)?t:(i=e,(o=new Date).setDate(o.getDate()+i),o):new Date(e.getTime());return(i=i&&"Invalid Date"==""+i?t:i)&&(i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0)),this._daylightSavingAdjust(i)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,o){var i=!t,n=e.selectedMonth,r=e.selectedYear,t=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=t.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=t.getMonth(),e.drawYear=e.selectedYear=e.currentYear=t.getFullYear(),n===e.selectedMonth&&r===e.selectedYear||o||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),o="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){x.datepicker._adjustDate(o,-t,"M")},next:function(){x.datepicker._adjustDate(o,+t,"M")},hide:function(){x.datepicker._hideDatepicker()},today:function(){x.datepicker._gotoToday(o)},selectDay:function(){return x.datepicker._selectDay(o,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return x.datepicker._selectMonthYear(o,this,"M"),!1},selectYear:function(){return x.datepicker._selectMonthYear(o,this,"Y"),!1}};x(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,o,i,n,r,L,O,z,H,s,a,B,l,c,u,d,h,p,f,m,g,v,U,b,y,C,w,j,V,x,_,S,k=new Date,W=this._daylightSavingAdjust(new Date(k.getFullYear(),k.getMonth(),k.getDate())),T=this._get(e,"isRTL"),k=this._get(e,"showButtonPanel"),F=this._get(e,"hideIfNoPrevNext"),E=this._get(e,"navigationAsDateFormat"),D=this._getNumberOfMonths(e),P=this._get(e,"showCurrentAtPos"),A=this._get(e,"stepMonths"),G=1!==D[0]||1!==D[1],$=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),I=this._getMinMaxDate(e,"min"),M=this._getMinMaxDate(e,"max"),R=e.drawMonth-P,N=e.drawYear;if(R<0&&(R+=12,N--),M)for(t=this._daylightSavingAdjust(new Date(M.getFullYear(),M.getMonth()-D[0]*D[1]+1,M.getDate())),t=I&&t<I?I:t;this._daylightSavingAdjust(new Date(N,R,1))>t;)--R<0&&(R=11,N--);for(e.drawMonth=R,e.drawYear=N,P=this._get(e,"prevText"),P=E?this.formatDate(P,this._daylightSavingAdjust(new Date(N,R-A,1)),this._getFormatConfig(e)):P,o=this._canAdjustMonth(e,-1,N,R)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+P+"'><span class='ui-icon ui-icon-circle-triangle-"+(T?"e":"w")+"'>"+P+"</span></a>":F?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+P+"'><span class='ui-icon ui-icon-circle-triangle-"+(T?"e":"w")+"'>"+P+"</span></a>",P=this._get(e,"nextText"),P=E?this.formatDate(P,this._daylightSavingAdjust(new Date(N,R+A,1)),this._getFormatConfig(e)):P,i=this._canAdjustMonth(e,1,N,R)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+P+"'><span class='ui-icon ui-icon-circle-triangle-"+(T?"w":"e")+"'>"+P+"</span></a>":F?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+P+"'><span class='ui-icon ui-icon-circle-triangle-"+(T?"w":"e")+"'>"+P+"</span></a>",A=this._get(e,"currentText"),F=this._get(e,"gotoCurrent")&&e.currentDay?$:W,A=E?this.formatDate(A,F,this._getFormatConfig(e)):A,P=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",E=k?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(T?P:"")+(this._isInRange(e,F)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+A+"</button>":"")+(T?"":P)+"</div>":"",n=parseInt(this._get(e,"firstDay"),10),n=isNaN(n)?0:n,r=this._get(e,"showWeek"),L=this._get(e,"dayNames"),O=this._get(e,"dayNamesMin"),z=this._get(e,"monthNames"),H=this._get(e,"monthNamesShort"),s=this._get(e,"beforeShowDay"),a=this._get(e,"showOtherMonths"),B=this._get(e,"selectOtherMonths"),l=this._getDefaultDate(e),c="",d=0;D[0]>d;d++){for(h="",this.maxRows=4,p=0;D[1]>p;p++){if(f=this._daylightSavingAdjust(new Date(N,R,e.selectedDay)),m=" ui-corner-all",g="",G){if(g+="<div class='ui-datepicker-group",1<D[1])switch(p){case 0:g+=" ui-datepicker-group-first",m=" ui-corner-"+(T?"right":"left");break;case D[1]-1:g+=" ui-datepicker-group-last",m=" ui-corner-"+(T?"left":"right");break;default:g+=" ui-datepicker-group-middle",m=""}g+="'>"}for(g+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+m+"'>"+(/all|left/.test(m)&&0===d?T?i:o:"")+(/all|right/.test(m)&&0===d?T?o:i:"")+this._generateMonthYearHeader(e,R,N,I,M,0<d||0<p,z,H)+"</div><table class='ui-datepicker-calendar'><thead><tr>",v=r?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",u=0;u<7;u++)v+="<th scope='col'"+(5<=(u+n+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+L[U=(u+n)%7]+"'>"+O[U]+"</span></th>";for(g+=v+"</tr></thead><tbody>",y=this._getDaysInMonth(N,R),N===e.selectedYear&&R===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,y)),b=(this._getFirstDayOfMonth(N,R)-n+7)%7,y=Math.ceil((b+y)/7),C=G&&this.maxRows>y?this.maxRows:y,this.maxRows=C,w=this._daylightSavingAdjust(new Date(N,R,1-b)),j=0;j<C;j++){for(g+="<tr>",V=r?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(w)+"</td>":"",u=0;u<7;u++)x=s?s.apply(e.input?e.input[0]:null,[w]):[!0,""],S=(_=w.getMonth()!==R)&&!B||!x[0]||I&&w<I||M&&M<w,V+="<td class='"+(5<=(u+n+6)%7?" ui-datepicker-week-end":"")+(_?" ui-datepicker-other-month":"")+(w.getTime()===f.getTime()&&R===e.selectedMonth&&e._keyEvent||l.getTime()===w.getTime()&&l.getTime()===f.getTime()?" "+this._dayOverClass:"")+(S?" "+this._unselectableClass+" ui-state-disabled":"")+(_&&!a?"":" "+x[1]+(w.getTime()===$.getTime()?" "+this._currentClass:"")+(w.getTime()===W.getTime()?" ui-datepicker-today":""))+"'"+(_&&!a||!x[2]?"":" title='"+x[2].replace(/'/g,"&#39;")+"'")+(S?"":" data-handler='selectDay' data-event='click' data-month='"+w.getMonth()+"' data-year='"+w.getFullYear()+"'")+">"+(_&&!a?"&#xa0;":S?"<span class='ui-state-default'>"+w.getDate()+"</span>":"<a class='ui-state-default"+(w.getTime()===W.getTime()?" ui-state-highlight":"")+(w.getTime()===$.getTime()?" ui-state-active":"")+(_?" ui-priority-secondary":"")+"' href='#'>"+w.getDate()+"</a>")+"</td>",w.setDate(w.getDate()+1),w=this._daylightSavingAdjust(w);g+=V+"</tr>"}11<++R&&(R=0,N++),h+=g+="</tbody></table>"+(G?"</div>"+(0<D[0]&&p===D[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}c+=h}return c+=E,e._keyEvent=!1,c},_generateMonthYearHeader:function(e,t,o,i,n,r,s,a){var l,c,u,d,h,p,f,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),v=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(r||!m)y+="<span class='ui-datepicker-month'>"+s[t]+"</span>";else{for(l=i&&i.getFullYear()===o,c=n&&n.getFullYear()===o,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=i.getMonth())&&(!c||n.getMonth()>=u)&&(y+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+a[u]+"</option>");y+="</select>"}if(v||(b+=y+(!r&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!g)b+="<span class='ui-datepicker-year'>"+o+"</span>";else{for(s=this._get(e,"yearRange").split(":"),d=(new Date).getFullYear(),p=(h=function(e){e=e.match(/c[+\-].*/)?o+parseInt(e.substring(1),10):e.match(/[+\-].*/)?d+parseInt(e,10):parseInt(e,10);return isNaN(e)?d:e})(s[0]),f=Math.max(p,h(s[1]||"")),p=i?Math.max(p,i.getFullYear()):p,f=n?Math.min(f,n.getFullYear()):f,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p<=f;p++)e.yearshtml+="<option value='"+p+"'"+(p===o?" selected='selected'":"")+">"+p+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),v&&(b+=(!r&&m&&g?"":"&#xa0;")+y),b+"</div>"},_adjustInstDate:function(e,t,o){var i=e.drawYear+("Y"===o?t:0),n=e.drawMonth+("M"===o?t:0),t=Math.min(e.selectedDay,this._getDaysInMonth(i,n))+("D"===o?t:0),i=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,n,t)));e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),"M"!==o&&"Y"!==o||this._notifyChange(e)},_restrictMinMax:function(e,t){var o=this._getMinMaxDate(e,"min"),e=this._getMinMaxDate(e,"max"),o=o&&t<o?o:t;return e&&e<o?e:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){e=this._get(e,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,o,i){var n=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(o,i+(t<0?t:n[0]*n[1]),1));return t<0&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var o,i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=null,s=null,e=this._get(e,"yearRange");return e&&(e=e.split(":"),o=(new Date).getFullYear(),r=parseInt(e[0],10),s=parseInt(e[1],10),e[0].match(/[+\-].*/)&&(r+=o),e[1].match(/[+\-].*/)&&(s+=o)),(!i||t.getTime()>=i.getTime())&&(!n||t.getTime()<=n.getTime())&&(!r||t.getFullYear()>=r)&&(!s||s>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,o,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);i=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,o,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),x.fn.datepicker=function(e){if(!this.length)return this;x.datepicker.initialized||(x(document).mousedown(x.datepicker._checkExternalClick),x.datepicker.initialized=!0),0===x("#"+x.datepicker._mainDivId).length&&x("body").append(x.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&("isDisabled"===e||"getDate"===e||"widget"===e)||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this].concat(t)):x.datepicker._attachDatepicker(this,e)})},x.datepicker=new e,x.datepicker.initialized=!1,x.datepicker.uuid=(new Date).getTime(),x.datepicker.version="1.11.4",x.datepicker,x.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=x(this).css(e).offset().top;t<0&&x(this).css("top",e.top-t)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&x.fn.draggable&&this._makeDraggable(),this.options.resizable&&x.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?x(e):this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:x.noop,enable:x.noop,close:function(e){var t,o=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(t=this.document[0].activeElement)&&"body"!==t.nodeName.toLowerCase()&&x(t).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){o._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var o=!1,i=this.uiDialog.siblings(".ui-front:visible").map(function(){return+x(this).css("z-index")}).get(),i=Math.max.apply(null,i);return i>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",i+1),o=!0),o&&!t&&this._trigger("focus",e),o},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=x(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;(e=(e=(e=(e=(e=e||this.element.find("[autofocus]")).length?e:this.element.find(":tabbable")).length?e:this.uiDialogButtonPane.find(":tabbable")).length?e:this.uiDialogTitlebarClose.filter(":tabbable")).length?e:this.uiDialog).eq(0).focus()},_keepFocus:function(e){function t(){var e=this.document[0].activeElement;this.uiDialog[0]===e||x.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),t.call(this),this._delay(t)},_createWrapper:function(){this.uiDialog=x("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===x.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);var t,o,i;e.keyCode!==x.ui.keyCode.TAB||e.isDefaultPrevented()||(t=this.uiDialog.find(":tabbable"),o=t.filter(":first"),i=t.filter(":last"),e.target!==i[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==o[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){i.focus()}),e.preventDefault()):(this._delay(function(){o.focus()}),e.preventDefault()))},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=x("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){x(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=x("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),e=x("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=x("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=x("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var i=this,e=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),x.isEmptyObject(e)||x.isArray(e)&&!e.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(x.each(e,function(e,t){var o;t=x.isFunction(t)?{click:t,text:e}:t,t=x.extend({type:"button"},t),o=t.click,t.click=function(){o.apply(i.element[0],arguments)},e={icons:t.icons,text:t.showText},delete t.icons,delete t.showText,x("<button></button>",t).button(e).appendTo(i.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function n(e){return{position:e.position,offset:e.offset}}var r=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,t){x(this).addClass("ui-dialog-dragging"),r._blockFrames(),r._trigger("dragStart",e,n(t))},drag:function(e,t){r._trigger("drag",e,n(t))},stop:function(e,t){var o=t.offset.left-r.document.scrollLeft(),i=t.offset.top-r.document.scrollTop();s.position={my:"left top",at:"left"+(0<=o?"+":"")+o+" top"+(0<=i?"+":"")+i,of:r.window},x(this).removeClass("ui-dialog-dragging"),r._unblockFrames(),r._trigger("dragStop",e,n(t))}})},_makeResizable:function(){function n(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var r=this,s=this.options,e=s.resizable,t=this.uiDialog.css("position"),e="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:e,start:function(e,t){x(this).addClass("ui-dialog-resizing"),r._blockFrames(),r._trigger("resizeStart",e,n(t))},resize:function(e,t){r._trigger("resize",e,n(t))},stop:function(e,t){var o=r.uiDialog.offset(),i=o.left-r.document.scrollLeft(),o=o.top-r.document.scrollTop();s.height=r.uiDialog.height(),s.width=r.uiDialog.width(),s.position={my:"left top",at:"left"+(0<=i?"+":"")+i+" top"+(0<=o?"+":"")+o,of:r.window},x(this).removeClass("ui-dialog-resizing"),r._unblockFrames(),r._trigger("resizeStop",e,n(t))}}).css("position",t)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=x(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),t=x.inArray(this,e);-1!==t&&e.splice(t,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||this.document.data("ui-dialog-instances",e=[]),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(e){var o=this,i=!1,n={};x.each(e,function(e,t){o._setOption(e,t),e in o.sizeRelatedOptions&&(i=!0),e in o.resizableRelatedOptions&&(n[e]=t)}),i&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var o,i=this.uiDialog;"dialogClass"===e&&i.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&((o=i.is(":data(ui-draggable)"))&&!t&&i.draggable("destroy"),!o&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&((o=i.is(":data(ui-resizable)"))&&!t&&i.resizable("destroy"),o&&"string"==typeof t&&i.resizable("option","handles",t),o||!1===t||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,o,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),e=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),t=Math.max(0,i.minHeight-e),o="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-e):"none","auto"===i.height?this.element.css({minHeight:t,maxHeight:o,height:"auto"}):this.element.height(Math.max(0,i.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=x(this);return x("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!x(e.target).closest(".ui-dialog").length||!!x(e.target).closest(".ui-datepicker").length},_createOverlay:function(){var t;this.options.modal&&(t=!0,this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=x("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1))},_destroyOverlay:function(){var e;this.options.modal&&this.overlay&&((e=this.document.data("ui-dialog-overlays")-1)?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null)}}),x.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=x("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=x("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),x.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this;this.label=x("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=x("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),x("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=x("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var o=this;this.menu=x("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=x("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,t){e.preventDefault(),o._setSelection(),o._select(t.item.data("ui-selectmenu-item"),e)},focus:function(e,t){t=t.item.data("ui-selectmenu-item");null!=o.focusIndex&&t.index!==o.focusIndex&&(o._trigger("focus",e,{item:t}),o.isOpen||o._select(t,e)),o.focusIndex=t.index,o.button.attr("aria-activedescendant",o.menuItems.eq(t.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(x.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(o,e){var i=this,n="";x.each(e,function(e,t){t.optgroup!==n&&(x("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(t.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:t.optgroup}).appendTo(o),n=t.optgroup),i._renderItemData(o,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(e,t){var o=x("<li>");return t.disabled&&o.addClass("ui-state-disabled"),this._setText(o,t.label),o.appendTo(e)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var o,i=".ui-menu-item";this.isOpen?o=this.menuItems.eq(this.focusIndex):(o=this.menuItems.eq(this.element[0].selectedIndex),i+=":not(.ui-state-disabled)"),(o="first"===e||"last"===e?o["first"===e?"prevAll":"nextAll"](i).eq(-1):o[e+"All"](i).eq(0)).length&&this.menuInstance.focus(t,o)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?((e=window.getSelection()).removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){!this.isOpen||x(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e)}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection()).rangeCount&&(this.range=e.getRangeAt(0)):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(e){var t=!0;switch(e.keyCode){case x.ui.keyCode.TAB:case x.ui.keyCode.ESCAPE:this.close(e),t=!1;break;case x.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case x.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case x.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case x.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case x.ui.keyCode.LEFT:this._move("prev",e);break;case x.ui.keyCode.RIGHT:this._move("next",e);break;case x.ui.keyCode.HOME:case x.ui.keyCode.PAGE_UP:this._move("first",e);break;case x.ui.keyCode.END:case x.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),t=!1}t&&e.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var o=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==o&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){e=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e=(e=(e=e&&(e.jquery||e.nodeType?x(e):this.document.find(e).eq(0)))&&e[0]?e:this.element.closest(".ui-front")).length?e:this.document[0].body},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var i=[];e.each(function(e,t){var t=x(t),o=t.parent("optgroup");i.push({element:t,index:e,value:t.val(),label:t.text(),optgroup:o.attr("label")||"",disabled:o.prop("disabled")||t.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),x.widget("ui.slider",x.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,t=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),i=[],n=t.values&&t.values.length||1;for(o.length>n&&(o.slice(n).remove(),o=o.slice(0,n)),e=o.length;e<n;e++)i.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=o.add(x(i.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){x(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,t="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:x.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=x("<div></div>").appendTo(this.element),t="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(t+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var o,i,n,r,t,s,a=this,l=this.options;return!l.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:e.pageX,y:e.pageY},o=this._normValueFromMouse(t),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var t=Math.abs(o-a.values(e));(t<i||i===t&&(e===a._lastChangedValue||a.values(e)===l.min))&&(i=t,n=x(this),r=e)}),!1!==this._start(e,r)&&(this._mouseSliding=!0,this._handleIndex=r,n.addClass("ui-state-active").focus(),t=n.offset(),s=!x(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=s?{left:0,top:0}:{left:e.pageX-t.left-n.width()/2,top:e.pageY-t.top-n.height()/2-(parseInt(n.css("borderTopWidth"),10)||0)-(parseInt(n.css("borderBottomWidth"),10)||0)+(parseInt(n.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,r,o),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},t=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,t),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,e="horizontal"===this.orientation?(t=this.elementSize.width,e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),e=e/t;return(e=1<e?1:e)<0&&(e=0),"vertical"===this.orientation&&(e=1-e),t=this._valueMax()-this._valueMin(),e=this._valueMin()+e*t,this._trimAlignValue(e)},_start:function(e,t){var o={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._trigger("start",e,o)},_slide:function(e,t,o){var i,n;this.options.values&&this.options.values.length?(i=this.values(t?0:1),(o=2===this.options.values.length&&!0===this.options.range&&(0===t&&i<o||1===t&&o<i)?i:o)!==this.values(t)&&((n=this.values())[t]=o,n=this._trigger("slide",e,{handle:this.handles[t],value:o,values:n}),i=this.values(t?0:1),!1!==n&&this.values(t,o))):o===this.value()||!1!==(n=this._trigger("slide",e,{handle:this.handles[t],value:o}))&&this.value(o)},_stop:function(e,t){var o={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._trigger("stop",e,o)},_change:function(e,t){var o;this._keySliding||this._mouseSliding||(o={handle:this.handles[t],value:this.value()},this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,o))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var o,i,n;if(1<arguments.length)return this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!x.isArray(e))return this.options.values&&this.options.values.length?this._values(e):this.value();for(o=this.options.values,i=e,n=0;o.length>n;n+=1)o[n]=this._trimAlignValue(i[n]),this._change(null,n);this._refreshValue()},_setOption:function(e,t){var o,i=0;switch("range"===e&&!0===this.options.range&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),x.isArray(this.options.values)&&(i=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t),this._super(e,t),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===t?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),o=0;o<i;o+=1)this._change(null,o);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return this._trimAlignValue(e)},_values:function(e){var t,o,i;if(arguments.length)return t=this.options.values[e],this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(o=this.options.values.slice(),i=0;o.length>i;i+=1)o[i]=this._trimAlignValue(o[i]);return o}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=0<this.options.step?this.options.step:1,o=(e-this._valueMin())%t,e=e-o;return 2*Math.abs(o)>=t&&(e+=0<o?t:-t),parseFloat(e.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),o=this.options.step,e=Math.floor(+(e-t).toFixed(this._precision())/o)*o+t;this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return e=null!==this.options.min?Math.max(e,this._precisionOf(this.options.min)):e},_precisionOf:function(e){var e=""+e,t=e.indexOf(".");return-1===t?0:e.length-t-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,o,e,i,n,r=this.options.range,s=this.options,a=this,l=!this._animateOff&&s.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(e){o=(a.values(e)-a._valueMin())/(a._valueMax()-a._valueMin())*100,c["horizontal"===a.orientation?"left":"bottom"]=o+"%",x(this).stop(1,1)[l?"animate":"css"](c,s.animate),!0===a.options.range&&("horizontal"===a.orientation?(0===e&&a.range.stop(1,1)[l?"animate":"css"]({left:o+"%"},s.animate),1===e&&a.range[l?"animate":"css"]({width:o-t+"%"},{queue:!1,duration:s.animate})):(0===e&&a.range.stop(1,1)[l?"animate":"css"]({bottom:o+"%"},s.animate),1===e&&a.range[l?"animate":"css"]({height:o-t+"%"},{queue:!1,duration:s.animate}))),t=o}):(e=this.value(),i=this._valueMin(),n=this._valueMax(),o=n!==i?(e-i)/(n-i)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=o+"%",this.handle.stop(1,1)[l?"animate":"css"](c,s.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:o+"%"},s.animate),"max"===r&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-o+"%"},{queue:!1,duration:s.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:o+"%"},s.animate),"max"===r&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-o+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(e){var t,o,i,n=x(e.target).data("ui-slider-handle-index");switch(e.keyCode){case x.ui.keyCode.HOME:case x.ui.keyCode.END:case x.ui.keyCode.PAGE_UP:case x.ui.keyCode.PAGE_DOWN:case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,x(e.target).addClass("ui-state-active"),!1===this._start(e,n)))return}switch(i=this.options.step,t=o=this.options.values&&this.options.values.length?this.values(n):this.value(),e.keyCode){case x.ui.keyCode.HOME:o=this._valueMin();break;case x.ui.keyCode.END:o=this._valueMax();break;case x.ui.keyCode.PAGE_UP:o=this._trimAlignValue(t+(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(t-(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:if(t===this._valueMax())return;o=this._trimAlignValue(t+i);break;case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(t===this._valueMin())return;o=this._trimAlignValue(t-i)}this._slide(e,n,o)},keyup:function(e){var t=x(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,t),this._change(e,t),x(e.target).removeClass("ui-state-active"))}}}),x.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var i={},n=this.element;return x.each(["min","max","step"],function(e,t){var o=n.attr(t);void 0!==o&&o.length&&(i[t]=o)}),i},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((0<t?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(e){function t(){this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=o,this._delay(function(){this.previous=o}))}var o=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();e.preventDefault(),t.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,t.call(this)}),!1!==this._start(e)&&this._repeat(null,x(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return x(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,x(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&0<e.height()&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(e){var t=this.options,o=x.ui.keyCode;switch(e.keyCode){case o.UP:return this._repeat(null,1,e),!0;case o.DOWN:return this._repeat(null,-1,e),!0;case o.PAGE_UP:return this._repeat(null,t.page,e),!0;case o.PAGE_DOWN:return this._repeat(null,-t.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(e,t,o){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,o)},e),this._spin(t*this.options.step,o)},_spin:function(e,t){var o=this.value()||0;this.counter||(this.counter=1),o=this._adjustValue(o+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:o})||(this._value(o),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?x.isFunction(t)?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return e=null!==this.options.min?Math.max(e,this._precisionOf(this.options.min)):e},_precisionOf:function(e){var e=""+e,t=e.indexOf(".");return-1===t?0:e.length-t-1},_adjustValue:function(e){var t=this.options,o=null!==t.min?t.min:0,i=e-o;return e=o+Math.round(i/t.step)*t.step,e=parseFloat(e.toFixed(this._precision())),null!==t.max&&e>t.max?t.max:null!==t.min&&t.min>e?t.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var o;if("culture"===e||"numberFormat"===e)return o=this._parse(this.element.val()),this.options[e]=t,void this.element.val(this._format(o));"max"!==e&&"min"!==e&&"step"!==e||"string"!=typeof t||(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:t(function(e){this._super(e)}),_parse:function(e){return""===(e="string"==typeof e&&""!==e?window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e:e)||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var o;""!==e&&null!==(o=this._parse(e))&&(t||(o=this._adjustValue(o)),e=this._format(o)),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),x.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(N=/#.*$/,function(e){var t=(e=e.cloneNode(!1)).href.replace(N,""),o=location.href.replace(N,"");try{t=decodeURIComponent(t)}catch(e){}try{o=decodeURIComponent(o)}catch(e){}return 1<e.hash.length&&t===o}),_create:function(){var t=this,e=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",e.collapsible),this._processTabs(),e.active=this._initialActive(),x.isArray(e.disabled)&&(e.disabled=x.unique(e.disabled.concat(x.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(e.active):x(),this._refresh(),this.active.length&&this.load(e.active)},_initialActive:function(){var o=this.options.active,e=this.options.collapsible,i=location.hash.substring(1);return null===o&&(i&&this.tabs.each(function(e,t){return x(t).attr("aria-controls")===i?(o=e,!1):void 0}),null!==(o=null===o?this.tabs.index(this.tabs.filter(".ui-tabs-active")):o)&&-1!==o||(o=!!this.tabs.length&&0)),!1!==o&&(-1===(o=this.tabs.index(this.tabs.eq(o)))&&(o=!e&&0)),o=!e&&!1===o&&this.anchors.length?0:o},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):x()}},_tabKeydown:function(e){var t=x(this.document[0].activeElement).closest("li"),o=this.tabs.index(t),i=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:o++;break;case x.ui.keyCode.UP:case x.ui.keyCode.LEFT:i=!1,o--;break;case x.ui.keyCode.END:o=this.anchors.length-1;break;case x.ui.keyCode.HOME:o=0;break;case x.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(o);case x.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(o!==this.options.active&&o);default:return}e.preventDefault(),clearTimeout(this.activating),o=this._focusNextTab(o,i),e.ctrlKey||e.metaKey||(t.attr("aria-selected","false"),this.tabs.eq(o).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",o)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===x.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===x.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===x.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,t){for(var o=this.tabs.length-1;-1!==x.inArray(e=(e=o<e?0:e)<0?o:e,this.options.disabled);)e=t?e+1:e-1;return e},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=x.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!x.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=x()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=x()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this,e=this.tabs,t=this.anchors,o=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(e){x(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){x(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return x("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=x(),this.anchors.each(function(e,t){var o,i,n,r=x(t).uniqueId().attr("id"),s=x(t).closest("li"),a=s.attr("aria-controls");l._isLocal(t)?(n=(o=t.hash).substring(1),i=l.element.find(l._sanitizeSelector(o))):(n=s.attr("aria-controls")||x({}).uniqueId()[0].id,(i=l.element.find(o="#"+n)).length||(i=l._createPanel(n)).insertAfter(l.panels[e-1]||l.tablist),i.attr("aria-live","polite")),i.length&&(l.panels=l.panels.add(i)),a&&s.data("ui-tabs-aria-controls",a),s.attr({"aria-controls":n,"aria-labelledby":r}),i.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),e&&(this._off(e.not(this.tabs)),this._off(t.not(this.anchors)),this._off(o.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return x("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){x.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var t,o=0;t=this.tabs[o];o++)!0===e||-1!==x.inArray(o,e)?x(t).addClass("ui-state-disabled").attr("aria-disabled","true"):x(t).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var o={};e&&x.each(e.split(" "),function(e,t){o[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,o),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var o,t=this.element.parent();"fill"===e?(o=t.height(),o-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=x(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(o-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){o-=x(this).outerHeight(!0)}),this.panels.each(function(){x(this).height(Math.max(0,o-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===e&&(o=0,this.panels.each(function(){o=Math.max(o,x(this).height("").height())}).height(o))},_eventHandler:function(e){var t=this.options,o=this.active,i=x(e.currentTarget).closest("li"),n=i[0]===o[0],r=n&&t.collapsible,s=r?x():this._getPanelForTab(i),a=o.length?this._getPanelForTab(o):x(),o={oldTab:o,oldPanel:a,newTab:r?x():i,newPanel:s};e.preventDefault(),i.hasClass("ui-state-disabled")||i.hasClass("ui-tabs-loading")||this.running||n&&!t.collapsible||!1===this._trigger("beforeActivate",e,o)||(t.active=!r&&this.tabs.index(i),this.active=n?x():i,this.xhr&&this.xhr.abort(),a.length||s.length||x.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(i),e),this._toggle(e,o))},_toggle:function(e,t){function o(){n.running=!1,n._trigger("activate",e,t)}function i(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&n.options.show?n._show(r,n.options.show,o):(r.show(),o())}var n=this,r=t.newPanel,s=t.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),i()),s.attr("aria-hidden","true"),t.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&s.length?t.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===x(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr("aria-hidden","false"),t.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var e=this._findActive(e);e[0]!==this.active[0]&&(e=(e=e.length?e:this.active).find(".ui-tabs-anchor")[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(e){return!1===e?x():this.tabs.eq(e)},_getIndex:function(e){return e="string"==typeof e?this.anchors.index(this.anchors.filter("[href$='"+e+"']")):e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){x.data(this,"ui-tabs-destroy")?x(this).remove():x(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=x(this),t=e.data("ui-tabs-aria-controls");t?e.attr("aria-controls",t).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(o){var e=this.options.disabled;!1!==e&&(e=void 0!==o&&(o=this._getIndex(o),x.isArray(e)?x.map(e,function(e){return e!==o?e:null}):x.map(this.tabs,function(e,t){return t!==o?t:null})),this._setupDisabled(e))},disable:function(e){var t=this.options.disabled;if(!0!==t){if(void 0===e)t=!0;else{if(e=this._getIndex(e),-1!==x.inArray(e,t))return;t=x.isArray(t)?x.merge([e],t).sort():[e]}this._setupDisabled(t)}},load:function(e,i){e=this._getIndex(e);function n(e,t){"abort"===t&&r.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),s.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr}var r=this,o=this.tabs.eq(e),e=o.find(".ui-tabs-anchor"),s=this._getPanelForTab(o),a={tab:o,panel:s};this._isLocal(e[0])||(this.xhr=x.ajax(this._ajaxSettings(e,i,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.done(function(e,t,o){setTimeout(function(){s.html(e),r._trigger("load",i,a),n(o,t)},1)}).fail(function(e,t){setTimeout(function(){n(e,t)},1)})))},_ajaxSettings:function(e,o,i){var n=this;return{url:e.attr("href"),beforeSend:function(e,t){return n._trigger("beforeLoad",o,x.extend({jqXHR:e,ajaxSettings:t},i))}}},_getPanelForTab:function(e){e=x(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}}),x.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var e=x(this).attr("title")||"";return x("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,t){var o=(e.attr("aria-describedby")||"").split(/\s+/);o.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",x.trim(o.join(" ")))},_removeDescribedBy:function(e){var t=e.data("ui-tooltip-id"),o=(e.attr("aria-describedby")||"").split(/\s+/),t=x.inArray(t,o);-1!==t&&o.splice(t,1),e.removeData("ui-tooltip-id"),(o=x.trim(o.join(" ")))?e.attr("aria-describedby",o):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=x("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,t){var o=this;return"disabled"===e?(this[t?"_disable":"_enable"](),void(this.options[e]=t)):(this._super(e,t),void("content"===e&&x.each(this.tooltips,function(e,t){o._updateContent(t.element)})))},_disable:function(){var i=this;x.each(this.tooltips,function(e,t){var o=x.Event("blur");o.target=o.currentTarget=t.element[0],i.close(o,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=x(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=x(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var o=this,t=x(e?e.target:this.element).closest(this.options.items);t.length&&!t.data("ui-tooltip-id")&&(t.attr("title")&&t.data("ui-tooltip-title",t.attr("title")),t.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&t.parents().each(function(){var e,t=x(this);t.data("ui-tooltip-open")&&((e=x.Event("blur")).target=e.currentTarget=this,o.close(e,!0)),t.attr("title")&&(t.uniqueId(),o.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._registerCloseHandlers(e,t),this._updateContent(t,e))},_updateContent:function(t,o){var e=this.options.content,i=this,n=o?o.type:null;return"string"==typeof e?this._open(o,t,e):void((e=e.call(t[0],function(e){i._delay(function(){t.data("ui-tooltip-open")&&(o&&(o.type=n),this._open(o,t,e))})}))&&this._open(o,t,e))},_open:function(e,t,o){function i(e){l.of=e,r.is(":hidden")||r.position(l)}var n,r,s,a,l=x.extend({},this.options.position);o&&((n=this._find(t))?n.tooltip.find(".ui-tooltip-content").html(o):(t.is("[title]")&&(e&&"mouseover"===e.type?t.attr("title",""):t.removeAttr("title")),n=this._tooltip(t),r=n.tooltip,this._addDescribedBy(t,r.attr("id")),r.find(".ui-tooltip-content").html(o),this.liveRegion.children().hide(),o.clone?(a=o.clone()).removeAttr("id").find("[id]").removeAttr("id"):a=o,x("<div>").html(a).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:i}),i(e)):r.position(x.extend({of:t},this.options.position)),r.hide(),this._show(r,this.options.show),this.options.show&&this.options.show.delay&&(s=this.delayedShow=setInterval(function(){r.is(":visible")&&(i(l.of),clearInterval(s))},x.fx.interval)),this._trigger("open",e,{tooltip:r})))},_registerCloseHandlers:function(e,t){var o={keyup:function(e){e.keyCode===x.ui.keyCode.ESCAPE&&((e=x.Event(e)).currentTarget=t[0],this.close(e,!0))}};t[0]!==this.element[0]&&(o.remove=function(){this._removeTooltip(this._find(t).tooltip)}),e&&"mouseover"!==e.type||(o.mouseleave="close"),e&&"focusin"!==e.type||(o.focusout="close"),this._on(!0,t,o)},close:function(e){var t,o=this,i=x(e?e.currentTarget:this.element),n=this._find(i);return n?(t=n.tooltip,void(n.closing||(clearInterval(this.delayedShow),i.data("ui-tooltip-title")&&!i.attr("title")&&i.attr("title",i.data("ui-tooltip-title")),this._removeDescribedBy(i),n.hiding=!0,t.stop(!0),this._hide(t,this.options.hide,function(){o._removeTooltip(x(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&x.each(this.parents,function(e,t){x(t.element).attr("title",t.title),delete o.parents[e]}),n.closing=!0,this._trigger("close",e,{tooltip:t}),n.hiding||(n.closing=!1)))):void i.removeData("ui-tooltip-open")},_tooltip:function(e){var t=x("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),o=t.uniqueId().attr("id");return x("<div>").addClass("ui-tooltip-content").appendTo(t),t.appendTo(this.document[0].body),this.tooltips[o]={element:e,tooltip:t}},_find:function(e){e=e.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var i=this;x.each(this.tooltips,function(e,t){var o=x.Event("blur"),t=t.element;o.target=o.currentTarget=t[0],i.close(o,!0),x("#"+e).remove(),t.data("ui-tooltip-title")&&(t.attr("title")||t.attr("title",t.data("ui-tooltip-title")),t.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})});